import{a as uo,b as vE,c as Mr,d as dR,e as hR,f as mu,g as fR,h as pR,i as gq,k as mq}from"./chunk-RFOXOZ2C.js";import{A as JN,B as fu,C as pu,D as Gg,E as Wg,F as ZN,G as XN,H as eR,I as tR,J as oR,K as aR,L as cR,M as Kg,N as lR,O as Qg,P as uR,Q as hr,W as Rh,Y as pq,a as co,b as kN,c as LN,d as hu,e as Vg,f as FN,g as BN,h as UN,i as jN,j as VN,k as HN,l as uE,m as $N,n as dE,o as Hg,oa as gR,p as $g,pa as mR,q as qg,r as zg,s as qN,t as zN,u as GN,v as Pr,w as WN,x as KN,xa as yq,y as QN,z as YN}from"./chunk-C7WJRSMW.js";import{A as de,C as fE,E as pE,M as iR,O as na,Q as gu,S as _c,U as Us,W as At,Z as gE,a as lt,aa as mE,b as nR,ca as zt,d as Ac,ga as sR,ia as Kt,j as rR,ka as yE,oa as wE,qa as K,r as en,sa as lo,t as Ht,v as dr}from"./chunk-ADXS2CDP.js";import{qb as fq}from"./chunk-4LGCJMV5.js";import"./chunk-Q2QAD6QF.js";import{xa as hE}from"./chunk-E7P2HYXN.js";import"./chunk-7ECBQATZ.js";import{a as H,b as ge,d as MN,e as ni,f as Bs,g as Nh,i as du,j as Fe}from"./chunk-SVM3HCG7.js";var Uv=Bs(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});var Xs={exports:{}};function UX(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}var jX=VX;function VX(n,e,t){var r=t&&t.stringify||UX,i=1;if(typeof n=="object"&&n!==null){var s=e.length+i;if(s===1)return n;var o=new Array(s);o[0]=r(n);for(var a=1;a<s;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof n!="string")return n;var c=e.length;if(c===0)return n;for(var l="",u=1-i,d=-1,h=n&&n.length||0,f=0;f<h;){if(n.charCodeAt(f)===37&&f+1<h){switch(d=d>-1?d:0,n.charCodeAt(f+1)){case 100:case 102:if(u>=c||e[u]==null)break;d<f&&(l+=n.slice(d,f)),l+=Number(e[u]),d=f+2,f++;break;case 105:if(u>=c||e[u]==null)break;d<f&&(l+=n.slice(d,f)),l+=Math.floor(Number(e[u])),d=f+2,f++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;d<f&&(l+=n.slice(d,f));var p=typeof e[u];if(p==="string"){l+="'"+e[u]+"'",d=f+2,f++;break}if(p==="function"){l+=e[u].name||"<anonymous>",d=f+2,f++;break}l+=r(e[u]),d=f+2,f++;break;case 115:if(u>=c)break;d<f&&(l+=n.slice(d,f)),l+=String(e[u]),d=f+2,f++;break;case 37:d<f&&(l+=n.slice(d,f)),l+="%",d=f+2,f++,u--;break}++u}++f}return d===-1?n:(d<h&&(l+=n.slice(d)),l)}var NB=jX;Xs.exports=Bo;var Fp=nee().console||{},HX={mapHttpRequest:Ov,mapHttpResponse:Ov,wrapRequestSerializer:o_,wrapResponseSerializer:o_,wrapErrorSerializer:o_,req:Ov,res:Ov,err:OB,errWithCause:OB};function Ha(n,e){return n==="silent"?1/0:e.levels.values[n]}var h_=Symbol("pino.logFuncs"),a_=Symbol("pino.hierarchy"),$X={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function RB(n,e){let t={logger:e,parent:n[a_]};e[a_]=t}function qX(n,e,t){let r={};e.forEach(i=>{r[i]=t[i]?t[i]:Fp[i]||Fp[$X[i]||"log"]||Bd}),n[h_]=r}function zX(n,e){return Array.isArray(n)?n.filter(function(t){return t!=="!stdSerializers.err"}):n===!0?Object.keys(e):!1}function Bo(n){n=n||{},n.browser=n.browser||{};let e=n.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");let t=n.browser.write||Fp;n.browser.write&&(n.browser.asObject=!0);let r=n.serializers||{},i=zX(n.browser.serialize,r),s=n.browser.serialize;Array.isArray(n.browser.serialize)&&n.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);let o=Object.keys(n.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof t=="function"&&a.forEach(function(g){t[g]=t}),(n.enabled===!1||n.browser.disabled)&&(n.level="silent");let c=n.level||"info",l=Object.create(t);l.log||(l.log=Bd),qX(l,a,t),RB({},l),Object.defineProperty(l,"levelVal",{get:d}),Object.defineProperty(l,"level",{get:h,set:f});let u={transmit:e,serialize:i,asObject:n.browser.asObject,asObjectBindingsOnly:n.browser.asObjectBindingsOnly,formatters:n.browser.formatters,levels:a,timestamp:XX(n),messageKey:n.messageKey||"msg",onChild:n.onChild||Bd};l.levels=GX(n),l.level=c,l.isLevelEnabled=function(g){return this.levels.values[g]?this.levels.values[g]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=Bd,l.serializers=r,l._serialize=i,l._stdErrSerialize=s,l.child=function(...g){return p.call(this,u,...g)},e&&(l._logEvent=c_());function d(){return Ha(this.level,this)}function h(){return this._level}function f(g){if(g!=="silent"&&!this.levels.values[g])throw Error("unknown level "+g);this._level=g,Ml(this,u,l,"error"),Ml(this,u,l,"fatal"),Ml(this,u,l,"warn"),Ml(this,u,l,"info"),Ml(this,u,l,"debug"),Ml(this,u,l,"trace"),o.forEach(m=>{Ml(this,u,l,m)})}function p(g,m,y){if(!m)throw new Error("missing bindings for child Pino");y=y||{},i&&m.serializers&&(y.serializers=m.serializers);let E=y.serializers;if(i&&E){var I=Object.assign({},r,E),L=n.browser.serialize===!0?Object.keys(I):i;delete m.serializers,f_([m],L,I,this._stdErrSerialize)}function k(B){this._childLevel=(B._childLevel|0)+1,this.bindings=m,I&&(this.serializers=I,this._serialize=L),e&&(this._logEvent=c_([].concat(B._logEvent.bindings,m)))}k.prototype=this;let D=new k(this);return RB(this,D),D.child=function(...B){return p.call(this,g,...B)},D.level=y.level||this.level,g.onChild(D),D}return l}function GX(n){let e=n.customLevels||{},t=Object.assign({},Bo.levels.values,e),r=Object.assign({},Bo.levels.labels,WX(e));return{values:t,labels:r}}function WX(n){let e={};return Object.keys(n).forEach(function(t){e[n[t]]=t}),e}Bo.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Bo.stdSerializers=HX,Bo.stdTimeFunctions=Object.assign({},{nullTime:LB,epochTime:FB,unixTime:eee,isoTime:tee});function KX(n){let e=[];n.bindings&&e.push(n.bindings);let t=n[a_];for(;t.parent;)t=t.parent,t.logger.bindings&&e.push(t.logger.bindings);return e.reverse()}function Ml(n,e,t,r){if(Object.defineProperty(n,r,{value:Ha(n.level,t)>Ha(r,t)?Bd:t[h_][r],writable:!0,enumerable:!0,configurable:!0}),n[r]===Bd){if(!e.transmit)return;let s=e.transmit.level||n.level,o=Ha(s,t);if(Ha(r,t)<o)return}n[r]=YX(n,e,t,r);let i=KX(n);i.length!==0&&(n[r]=QX(i,n[r]))}function QX(n,e){return function(){return e.apply(this,[...n,...arguments])}}function YX(n,e,t,r){return(function(i){return function(){let s=e.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Fp?Fp:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];var l=!1;if(e.serialize&&(f_(o,this._serialize,this.serializers,this._stdErrSerialize),l=!0),e.asObject||e.formatters?i.call(a,...JX(this,r,o,s,e)):i.apply(a,o),e.transmit){let u=e.transmit.level||n._level,d=Ha(u,t),h=Ha(r,t);if(h<d)return;ZX(this,{ts:s,methodLevel:r,methodValue:h,transmitLevel:u,transmitValue:t.levels.values[e.transmit.level||n._level],send:e.transmit.send,val:Ha(n._level,t)},o,l)}}})(n[h_][r])}function JX(n,e,t,r,i){let{level:s,log:o=d=>d}=i.formatters||{},a=t.slice(),c=a[0],l={},u=(n._childLevel|0)+1;if(u<1&&(u=1),r&&(l.time=r),s){let d=s(e,n.levels.values[e]);Object.assign(l,d)}else l.level=n.levels.values[e];if(i.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?NB(a.shift(),a):void 0}else typeof c=="string"&&(c=NB(a.shift(),a));return c!==void 0&&(l[i.messageKey]=c),[o(l)]}}function f_(n,e,t,r){for(let i in n)if(r&&n[i]instanceof Error)n[i]=Bo.stdSerializers.err(n[i]);else if(typeof n[i]=="object"&&!Array.isArray(n[i])&&e)for(let s in n[i])e.indexOf(s)>-1&&s in t&&(n[i][s]=t[s](n[i][s]))}function ZX(n,e,t,r=!1){let i=e.send,s=e.ts,o=e.methodLevel,a=e.methodValue,c=e.val,l=n._logEvent.bindings;r||f_(t,n._serialize||Object.keys(n.serializers),n.serializers,n._stdErrSerialize===void 0?!0:n._stdErrSerialize),n._logEvent.ts=s,n._logEvent.messages=t.filter(function(u){return l.indexOf(u)===-1}),n._logEvent.level.label=o,n._logEvent.level.value=a,i(o,n._logEvent,c),n._logEvent=c_(l)}function c_(n){return{ts:0,messages:[],bindings:n||[],level:{label:"",value:0}}}function OB(n){let e={type:n.constructor.name,msg:n.message,stack:n.stack};for(let t in n)e[t]===void 0&&(e[t]=n[t]);return e}function XX(n){return typeof n.timestamp=="function"?n.timestamp:n.timestamp===!1?LB:FB}function Ov(){return{}}function o_(n){return n}function Bd(){}function LB(){return!1}function FB(){return Date.now()}function eee(){return Math.round(Date.now()/1e3)}function tee(){return new Date(Date.now()).toISOString()}function nee(){function n(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return n(self)||n(window)||n(this)||{}}}Xs.exports.default=Bo;var ree=Xs.exports.pino=Bo,BB={level:"info"},Bp="custom_context",Bv=1e3*1024,iee=Object.defineProperty,see=(n,e,t)=>e in n?iee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Va=(n,e,t)=>see(n,typeof e!="symbol"?e+"":e,t),l_=class{constructor(e){Va(this,"nodeValue"),Va(this,"sizeInBytes"),Va(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Mv=class{constructor(e){Va(this,"lengthInNodes"),Va(this,"sizeInBytes"),Va(this,"head"),Va(this,"tail"),Va(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new l_(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}},oee=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t);function PB(n){return typeof n=="string"?n:oee(n)||""}var aee=Object.defineProperty,cee=(n,e,t)=>e in n?aee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Pv=(n,e,t)=>cee(n,typeof e!="symbol"?e+"":e,t),kv=class{constructor(e,t=Bv){Pv(this,"logs"),Pv(this,"level"),Pv(this,"levelValue"),Pv(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Xs.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Mv(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Xs.exports.levels.values.error?console.error(e):t===Xs.exports.levels.values.warn?console.warn(e):t===Xs.exports.levels.values.debug?console.debug(e):t===Xs.exports.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(PB({timestamp:new Date().toISOString(),log:e}));let t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Mv(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push(PB({extraMetadata:e})),new Blob(t,{type:"application/json"})}},lee=Object.defineProperty,uee=(n,e,t)=>e in n?lee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dee=(n,e,t)=>uee(n,typeof e!="symbol"?e+"":e,t),u_=class{constructor(e,t=Bv){dee(this,"baseChunkLogger"),this.baseChunkLogger=new kv(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}},hee=Object.defineProperty,fee=(n,e,t)=>e in n?hee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pee=(n,e,t)=>fee(n,typeof e!="symbol"?e+"":e,t),d_=class{constructor(e,t=Bv){pee(this,"baseChunkLogger"),this.baseChunkLogger=new kv(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}},gee=Object.defineProperty,mee=Object.defineProperties,yee=Object.getOwnPropertyDescriptors,MB=Object.getOwnPropertySymbols,wee=Object.prototype.hasOwnProperty,vee=Object.prototype.propertyIsEnumerable,kB=(n,e,t)=>e in n?gee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Lv=(n,e)=>{for(var t in e||(e={}))wee.call(e,t)&&kB(n,t,e[t]);if(MB)for(var t of MB(e))vee.call(e,t)&&kB(n,t,e[t]);return n},Fv=(n,e)=>mee(n,yee(e));function bee(n){return Fv(Lv({},n),{level:n?.level||BB.level})}function UB(n,e,t=Bp){return n[t]=e,n}function jB(n,e=Bp){return n[e]||""}function VB(n,e,t=Bp){let r=jB(n,t);return r.trim()?`${r}/${e}`:e}function Eee(n,e,t=Bp){let r=VB(n,e,t),i=n.child({context:r});return UB(i,r,t)}function HB(n){var e,t;let r=new u_((e=n.opts)==null?void 0:e.level,n.maxSizeInBytes);return{logger:Xs.exports(Fv(Lv({},n.opts),{level:"trace",browser:Fv(Lv({},(t=n.opts)==null?void 0:t.browser),{write:i=>r.write(i)})})),chunkLoggerController:r}}function $B(n){var e;let t=new d_((e=n.opts)==null?void 0:e.level,n.maxSizeInBytes);return{logger:Xs.exports(Fv(Lv({},n.opts),{level:"trace"}),t),chunkLoggerController:t}}function Iee(n){return typeof n.loggerOverride<"u"&&typeof n.loggerOverride!="string"?{logger:n.loggerOverride,chunkLoggerController:null}:typeof window<"u"?HB(n):$B(n)}Wr.MAX_LOG_SIZE_IN_BYTES_DEFAULT=Bv,Wr.PINO_CUSTOM_CONTEXT_KEY=Bp,Wr.PINO_LOGGER_DEFAULTS=BB,Wr.formatChildLoggerContext=VB,Wr.generateChildLogger=Eee,Wr.generateClientLogger=HB,Wr.generatePlatformLogger=Iee,Wr.generateServerLogger=$B,Wr.getDefaultLoggerOptions=bee,Wr.getLoggerContext=jB,Wr.pino=ree,Wr.setLoggerContext=UB});var eg=Bs(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});var Cee=(LN(),Fe(kN)),Hd=hu(),qo=Vg(),See=FN(),qB=UN(),Aee=jN(),zB=(HN(),Fe(VN)),_ee=BN(),Tee=($g(),Fe(Hg)),mt=(zg(),Fe(qg)),xee=(zN(),Fe(qN)),Dee=GN(),Nee=Uv();function Ree(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var Kp=Ree(Aee),Zv=":";function Y_(n){let[e,t]=n.split(Zv);return{namespace:e,reference:t}}function S3(n){let{namespace:e,reference:t}=n;return[e,t].join(Zv)}function J_(n){let[e,t,r]=n.split(Zv);return{namespace:e,reference:t,address:r}}function A3(n){let{namespace:e,reference:t,address:r}=n;return[e,t,r].join(Zv)}function Z_(n,e){let t=[];return n.forEach(r=>{let i=e(r);t.includes(i)||t.push(i)}),t}function _3(n){let{address:e}=J_(n);return e}function T3(n){let{namespace:e,reference:t}=J_(n);return S3({namespace:e,reference:t})}function Oee(n,e){let{namespace:t,reference:r}=Y_(e);return A3({namespace:t,reference:r,address:n})}function Pee(n){return Z_(n,_3)}function x3(n){return Z_(n,T3)}function Mee(n,e=[]){let t=[];return Object.keys(n).forEach(r=>{if(e.length&&!e.includes(r))return;let i=n[r];t.push(...i.accounts)}),t}function kee(n,e=[]){let t=[];return Object.keys(n).forEach(r=>{if(e.length&&!e.includes(r))return;let i=n[r];t.push(...x3(i.accounts))}),t}function Lee(n,e=[]){let t=[];return Object.keys(n).forEach(r=>{if(e.length&&!e.includes(r))return;let i=n[r];t.push(...Xv(r,i))}),t}function Xv(n,e){return n.includes(":")?[n]:e.chains||[]}var Fee=Object.defineProperty,Bee=Object.defineProperties,Uee=Object.getOwnPropertyDescriptors,GB=Object.getOwnPropertySymbols,jee=Object.prototype.hasOwnProperty,Vee=Object.prototype.propertyIsEnumerable,__=(n,e,t)=>e in n?Fee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,WB=(n,e)=>{for(var t in e||(e={}))jee.call(e,t)&&__(n,t,e[t]);if(GB)for(var t of GB(e))Vee.call(e,t)&&__(n,t,e[t]);return n},Hee=(n,e)=>Bee(n,Uee(e)),KB=(n,e,t)=>__(n,typeof e!="symbol"?e+"":e,t),D3="ReactNative",Ar={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},zv=" ",$ee=":",N3="/",X_=2,qee=1e3,R3="js";function e1(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function ic(){return!qo.getDocument()&&!!qo.getNavigator()&&navigator.product===D3}function zee(){return ic()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function Gee(){return ic()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Qd(){return!e1()&&!!qo.getNavigator()&&!!qo.getDocument()}function jl(){return ic()?Ar.reactNative:e1()?Ar.node:Qd()?Ar.browser:Ar.unknown}function Wee(){var n;try{return ic()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function O3(n,e){let t=new URLSearchParams(n);return Object.entries(e).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!=null&&t.set(r,String(i))}),t.toString()}function Kee(n){var e,t;let r=P3();try{return n!=null&&n.url&&r.url&&new URL(n.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${n.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),n.url=r.url),(e=n?.icons)!=null&&e.length&&n.icons.length>0&&(n.icons=n.icons.filter(i=>i!=="")),Hee(WB(WB({},r),n),{url:n?.url||r.url,name:n?.name||r.name,description:n?.description||r.description,icons:(t=n?.icons)!=null&&t.length&&n.icons.length>0?n.icons:r.icons})}catch(i){return console.warn("Error populating app metadata",i),n||r}}function P3(){return See.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function Qee(n,e){var t;let r=jl(),i={protocol:n,version:e,env:r};return r==="browser"&&(i.host=((t=qo.getLocation())==null?void 0:t.host)||"unknown"),i}function M3(){if(jl()===Ar.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){let{OS:t,Version:r}=global.Platform;return[t,r].join("-")}let n=Cee.detect();if(n===null)return"unknown";let e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function k3(){var n;let e=jl();return e===Ar.browser?[e,((n=qo.getLocation())==null?void 0:n.host)||"unknown"].join(":"):e}function L3(n,e,t){let r=M3(),i=k3();return[[n,e].join("-"),[R3,t].join("-"),r,i].join("/")}function Yee({protocol:n,version:e,relayUrl:t,sdkVersion:r,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){let l=t.split("?"),u=L3(n,e,r),d={auth:i,ua:u,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},h=O3(l[1]||"",d);return l[0]+"?"+h}function Jee(n){let e=(n.match(/^[^:]+(?=:\/\/)/gi)||[])[0],t=typeof e<"u"?n.split("://")[1]:n;return e=e==="wss"?"https":"http",[e,t].join("://")}function Zee(n,e,t){if(!n[e]||typeof n[e]!==t)throw new Error(`Missing or invalid "${e}" param`)}function F3(n,e=X_){return B3(n.split(N3),e)}function Xee(n){return F3(n).join(zv)}function Xa(n,e){return n.filter(t=>e.includes(t)).length===n.length}function B3(n,e=X_){return n.slice(Math.max(n.length-e,0))}function ete(n){return Object.fromEntries(n.entries())}function tte(n){return new Map(Object.entries(n))}function nte(n,e){let t={};return Object.keys(n).forEach(r=>{t[r]=e(n[r])}),t}var rte=n=>n;function U3(n){return n.trim().replace(/^\w/,e=>e.toUpperCase())}function ite(n){return n.split(zv).map(e=>U3(e)).join(zv)}function ste(n=Hd.FIVE_MINUTES,e){let t=Hd.toMiliseconds(n||Hd.FIVE_MINUTES),r,i,s,o;return{resolve:a=>{s&&r&&(clearTimeout(s),r(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{let l=new Error(e);o=Promise.reject(l),c(l)},t),r=a,i=c})}}function ote(n,e,t){return new Promise(async(r,i)=>{let s=setTimeout(()=>i(new Error(t)),e);try{let o=await n;r(o)}catch(o){i(o)}clearTimeout(s)})}function t1(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function ate(n){return t1("topic",n)}function cte(n){return t1("id",n)}function lte(n){let[e,t]=n.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")r.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))r.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return r}function ute(n,e){return Hd.fromMiliseconds((e||Date.now())+Hd.toMiliseconds(n))}function dte(n){return Date.now()>=Hd.toMiliseconds(n)}function hte(n,e){return`${n}${e?`:${e}`:""}`}function Vi(n=[],e=[]){return[...new Set([...n,...e])]}async function fte({id:n,topic:e,wcDeepLink:t}){var r;try{if(!t)return;let i=typeof t=="string"?JSON.parse(t):t,s=i?.href;if(typeof s!="string")return;let o=j3(s,n,e),a=jl();if(a===Ar.browser){if(!((r=qo.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}V3(o)}else a===Ar.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(i){console.error(i)}}function j3(n,e,t){let r=`requestId=${e}&sessionTopic=${t}`;n.endsWith("/")&&(n=n.slice(0,-1));let i=`${n}`;if(n.startsWith("https://t.me")){let s=n.includes("?")?"&startapp=":"?startapp=";i=`${i}${s}${q3(r,!0)}`}else i=`${i}/wc?${r}`;return i}function V3(n){let e="_self";$3()?e="_top":(H3()||n.startsWith("https://")||n.startsWith("http://"))&&(e="_blank"),window.open(n,e,"noreferrer noopener")}async function pte(n,e){let t="";try{if(Qd()&&(t=localStorage.getItem(e),t))return t;t=await n.getItem(e)}catch(r){console.error(r)}return t}function T_(n,e){return n.filter(t=>e.includes(t))}function gte(n,e){if(!n.includes(e))return null;let t=n.split(/([&,?,=])/),r=t.indexOf(e);return t[r+2]}function mte(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,n=>{let e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}function yte(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function H3(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function $3(){try{return window.self!==window.top}catch{return!1}}function q3(n,e=!1){let t=Buffer.from(n).toString("base64");return e?t.replace(/[=]/g,""):t}function n1(n){return Buffer.from(n,"base64").toString("utf-8")}function wte(n){return new Promise(e=>setTimeout(e,n))}var x_=class{constructor({limit:e}){KB(this,"limit"),KB(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){let t=this.set.values().next().value;t&&this.set.delete(t)}this.set.add(e)}}has(e){return this.set.has(e)}},jv=BigInt(2**32-1),QB=BigInt(32);function z3(n,e=!1){return e?{h:Number(n&jv),l:Number(n>>QB&jv)}:{h:Number(n>>QB&jv)|0,l:Number(n&jv)|0}}function G3(n,e=!1){let t=n.length,r=new Uint32Array(t),i=new Uint32Array(t);for(let s=0;s<t;s++){let{h:o,l:a}=z3(n[s],e);[r[s],i[s]]=[o,a]}return[r,i]}var YB=(n,e,t)=>n>>>t,JB=(n,e,t)=>n<<32-t|e>>>t,Qa=(n,e,t)=>n>>>t|e<<32-t,Ya=(n,e,t)=>n<<32-t|e>>>t,Vp=(n,e,t)=>n<<64-t|e>>>t-32,Hp=(n,e,t)=>n>>>t-32|e<<64-t,vte=(n,e)=>e,bte=(n,e)=>n,Ete=(n,e,t)=>n<<t|e>>>32-t,Ite=(n,e,t)=>e<<t|n>>>32-t,Cte=(n,e,t)=>e<<t-32|n>>>64-t,Ste=(n,e,t)=>n<<t-32|e>>>64-t;function As(n,e,t,r){let i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}var r1=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),i1=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,Ate=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),_te=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,Tte=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),xte=(n,e,t,r,i,s)=>e+t+r+i+s+(n/2**32|0)|0,Ud=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function e0(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function zo(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function Ts(n,...e){if(!e0(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function t0(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");zo(n.outputLen),zo(n.blockLen)}function nc(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function s1(n,e){Ts(n);let t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function qp(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function Hi(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function p_(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function eo(n,e){return n<<32-e|n>>>e}var W3=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function K3(n){return n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255}var jo=W3?n=>n:n=>K3(n);function Dte(n){for(let e=0;e<n.length;e++)n[e]=K3(n[e]);return n}var Ja=W3?n=>n:Dte,Q3=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Nte=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function $d(n){if(Ts(n),Q3)return n.toHex();let e="";for(let t=0;t<n.length;t++)e+=Nte[n[t]];return e}var Uo={_0:48,_9:57,A:65,F:70,a:97,f:102};function ZB(n){if(n>=Uo._0&&n<=Uo._9)return n-Uo._0;if(n>=Uo.A&&n<=Uo.F)return n-(Uo.A-10);if(n>=Uo.a&&n<=Uo.f)return n-(Uo.a-10)}function Gv(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);if(Q3)return Uint8Array.fromHex(n);let e=n.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(t);for(let i=0,s=0;i<t;i++,s+=2){let o=ZB(n.charCodeAt(s)),a=ZB(n.charCodeAt(s+1));if(o===void 0||a===void 0){let c=n[s]+n[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=o*16+a}return r}function Y3(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function _s(n){return typeof n=="string"&&(n=Y3(n)),Ts(n),n}function Za(...n){let e=0;for(let r=0;r<n.length;r++){let i=n[r];Ts(i),e+=i.length}let t=new Uint8Array(e);for(let r=0,i=0;r<n.length;r++){let s=n[r];t.set(s,i),i+=s.length}return t}var Gd=class{};function Qp(n){let e=r=>n().update(_s(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Rte(n){let e=(r,i)=>n(i).update(_s(r)).digest(),t=n({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}function Vl(n=32){if(Ud&&typeof Ud.getRandomValues=="function")return Ud.getRandomValues(new Uint8Array(n));if(Ud&&typeof Ud.randomBytes=="function")return Uint8Array.from(Ud.randomBytes(n));throw new Error("crypto.getRandomValues must be defined")}var Ote=BigInt(0),Up=BigInt(1),Pte=BigInt(2),Mte=BigInt(7),kte=BigInt(256),Lte=BigInt(113),J3=[],Z3=[],X3=[];for(let n=0,e=Up,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],J3.push(2*(5*r+t)),Z3.push((n+1)*(n+2)/2%64);let i=Ote;for(let s=0;s<7;s++)e=(e<<Up^(e>>Mte)*Lte)%kte,e&Pte&&(i^=Up<<(Up<<BigInt(s))-Up);X3.push(i)}var eU=G3(X3,!0),Fte=eU[0],Bte=eU[1],XB=(n,e,t)=>t>32?Cte(n,e,t):Ete(n,e,t),e3=(n,e,t)=>t>32?Ste(n,e,t):Ite(n,e,t);function Ute(n,e=24){let t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=XB(l,u,1)^t[a],h=e3(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)n[o+f]^=d,n[o+f+1]^=h}let i=n[2],s=n[3];for(let o=0;o<24;o++){let a=Z3[o],c=XB(i,s,a),l=e3(i,s,a),u=J3[o];i=n[u],s=n[u+1],n[u]=c,n[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=Fte[r],n[1]^=Bte[r]}Hi(t)}var D_=class n extends Gd{constructor(e,t,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,zo(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=qp(this.state)}clone(){return this._cloneInto()}keccak(){Ja(this.state32),Ute(this.state32,this.rounds),Ja(this.state32),this.posOut=0,this.pos=0}update(e){nc(this),e=_s(e),Ts(e);let{blockLen:t,state:r}=this,i=e.length;for(let s=0;s<i;){let o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(t&128)!==0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){nc(this,!1),Ts(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let o=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return zo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(s1(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Hi(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new n(t,r,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}},jte=(n,e,t)=>Qp(()=>new D_(e,n,t)),Vte=jte(1,136,256/8);function Hte(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}function $te(n,e,t){return n&e^~n&t}function qte(n,e,t){return n&e^n&t^e&t}var Wv=class extends Gd{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=p_(this.buffer)}update(e){nc(this),e=_s(e),Ts(e);let{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=p_(e);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){nc(this),s1(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:o}=this;t[o++]=128,Hi(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)t[d]=0;Hte(r,i-8,BigInt(this.length*8),s),this.process(r,0);let a=p_(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=i,e.pos=a,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}},$a=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),er=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),tr=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),zte=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qa=new Uint32Array(64),N_=class extends Wv{constructor(e=32){super(64,e,8,!1),this.A=$a[0]|0,this.B=$a[1]|0,this.C=$a[2]|0,this.D=$a[3]|0,this.E=$a[4]|0,this.F=$a[5]|0,this.G=$a[6]|0,this.H=$a[7]|0}get(){let{A:e,B:t,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[e,t,r,i,s,o,a,c]}set(e,t,r,i,s,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let d=0;d<16;d++,t+=4)qa[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){let h=qa[d-15],f=qa[d-2],p=eo(h,7)^eo(h,18)^h>>>3,g=eo(f,17)^eo(f,19)^f>>>10;qa[d]=g+qa[d-7]+p+qa[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){let h=eo(a,6)^eo(a,11)^eo(a,25),f=u+h+$te(a,c,l)+zte[d]+qa[d]|0,p=(eo(r,2)^eo(r,13)^eo(r,22))+qte(r,i,s)|0;u=l,l=c,c=a,a=o+f|0,o=s,s=i,i=r,r=f+p|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,l,u)}roundClean(){Hi(qa)}destroy(){this.set(0,0,0,0,0,0,0,0),Hi(this.buffer)}},tU=G3(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),Gte=tU[0],Wte=tU[1],za=new Uint32Array(80),Ga=new Uint32Array(80),zp=class extends Wv{constructor(e=64){super(128,e,16,!1),this.Ah=tr[0]|0,this.Al=tr[1]|0,this.Bh=tr[2]|0,this.Bl=tr[3]|0,this.Ch=tr[4]|0,this.Cl=tr[5]|0,this.Dh=tr[6]|0,this.Dl=tr[7]|0,this.Eh=tr[8]|0,this.El=tr[9]|0,this.Fh=tr[10]|0,this.Fl=tr[11]|0,this.Gh=tr[12]|0,this.Gl=tr[13]|0,this.Hh=tr[14]|0,this.Hl=tr[15]|0}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m]}set(e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let I=0;I<16;I++,t+=4)za[I]=e.getUint32(t),Ga[I]=e.getUint32(t+=4);for(let I=16;I<80;I++){let L=za[I-15]|0,k=Ga[I-15]|0,D=Qa(L,k,1)^Qa(L,k,8)^YB(L,k,7),B=Ya(L,k,1)^Ya(L,k,8)^JB(L,k,7),U=za[I-2]|0,T=Ga[I-2]|0,$=Qa(U,T,19)^Vp(U,T,61)^YB(U,T,6),W=Ya(U,T,19)^Hp(U,T,61)^JB(U,T,6),M=Ate(B,W,Ga[I-7],Ga[I-16]),v=_te(M,D,$,za[I-7],za[I-16]);za[I]=v|0,Ga[I]=M|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:y,Hl:E}=this;for(let I=0;I<80;I++){let L=Qa(d,h,14)^Qa(d,h,18)^Vp(d,h,41),k=Ya(d,h,14)^Ya(d,h,18)^Hp(d,h,41),D=d&f^~d&g,B=h&p^~h&m,U=Tte(E,k,B,Wte[I],Ga[I]),T=xte(U,y,L,D,Gte[I],za[I]),$=U|0,W=Qa(r,i,28)^Vp(r,i,34)^Vp(r,i,39),M=Ya(r,i,28)^Hp(r,i,34)^Hp(r,i,39),v=r&s^r&a^s&a,b=i&o^i&c^o&c;y=g|0,E=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=As(l|0,u|0,T|0,$|0),l=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;let w=r1($,M,b);r=i1(w,T,W,v),i=w|0}({h:r,l:i}=As(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=As(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=As(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=As(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=As(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=As(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=As(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:E}=As(this.Hh|0,this.Hl|0,y|0,E|0),this.set(r,i,s,o,a,c,l,u,d,h,f,p,g,m,y,E)}roundClean(){Hi(za,Ga)}destroy(){Hi(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},R_=class extends zp{constructor(){super(48),this.Ah=er[0]|0,this.Al=er[1]|0,this.Bh=er[2]|0,this.Bl=er[3]|0,this.Ch=er[4]|0,this.Cl=er[5]|0,this.Dh=er[6]|0,this.Dl=er[7]|0,this.Eh=er[8]|0,this.El=er[9]|0,this.Fh=er[10]|0,this.Fl=er[11]|0,this.Gh=er[12]|0,this.Gl=er[13]|0,this.Hh=er[14]|0,this.Hl=er[15]|0}},nr=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),O_=class extends zp{constructor(){super(32),this.Ah=nr[0]|0,this.Al=nr[1]|0,this.Bh=nr[2]|0,this.Bl=nr[3]|0,this.Ch=nr[4]|0,this.Cl=nr[5]|0,this.Dh=nr[6]|0,this.Dl=nr[7]|0,this.Eh=nr[8]|0,this.El=nr[9]|0,this.Fh=nr[10]|0,this.Fl=nr[11]|0,this.Gh=nr[12]|0,this.Gl=nr[13]|0,this.Hh=nr[14]|0,this.Hl=nr[15]|0}},n0=Qp(()=>new N_),Kte=Qp(()=>new zp),Qte=Qp(()=>new R_),Yte=Qp(()=>new O_),Jte=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),vn=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),le=new Uint32Array(32);function Wa(n,e,t,r,i,s){let o=i[s],a=i[s+1],c=le[2*n],l=le[2*n+1],u=le[2*e],d=le[2*e+1],h=le[2*t],f=le[2*t+1],p=le[2*r],g=le[2*r+1],m=r1(c,u,o);l=i1(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:vte(g,p),Dl:bte(g)},{h:f,l:h}=As(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:Qa(d,u,24),Bl:Ya(d,u,24)},le[2*n]=c,le[2*n+1]=l,le[2*e]=u,le[2*e+1]=d,le[2*t]=h,le[2*t+1]=f,le[2*r]=p,le[2*r+1]=g}function Ka(n,e,t,r,i,s){let o=i[s],a=i[s+1],c=le[2*n],l=le[2*n+1],u=le[2*e],d=le[2*e+1],h=le[2*t],f=le[2*t+1],p=le[2*r],g=le[2*r+1],m=r1(c,u,o);l=i1(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:Qa(g,p,16),Dl:Ya(g,p,16)},{h:f,l:h}=As(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:Vp(d,u,63),Bl:Hp(d,u,63)},le[2*n]=c,le[2*n+1]=l,le[2*e]=u,le[2*e+1]=d,le[2*t]=h,le[2*t+1]=f,le[2*r]=p,le[2*r+1]=g}function Zte(n,e={},t,r,i){if(zo(t),n<0||n>t)throw new Error("outputLen bigger than keyLen");let{key:s,salt:o,personalization:a}=e;if(s!==void 0&&(s.length<1||s.length>t))throw new Error("key length must be undefined or 1.."+t);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==i)throw new Error("personalization must be undefined or "+i)}var P_=class extends Gd{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,zo(e),zo(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=qp(this.buffer)}update(e){nc(this),e=_s(e),Ts(e);let{blockLen:t,buffer:r,buffer32:i}=this,s=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<s;){this.pos===t&&(Ja(i),this.compress(i,0,!1),Ja(i),this.pos=0);let l=Math.min(t-this.pos,s-c),u=o+c;if(l===t&&!(u%4)&&c+l<s){let d=new Uint32Array(a,u,Math.floor((s-c)/4));Ja(d);for(let h=0;c+t<s;h+=i.length,c+=t)this.length+=t,this.compress(d,h,!1);Ja(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){nc(this),s1(e,this);let{pos:t,buffer32:r}=this;this.finished=!0,Hi(this.buffer.subarray(t)),Ja(r),this.compress(r,0,!0),Ja(r);let i=qp(e);this.get().forEach((s,o)=>i[o]=jo(s))}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){let{buffer:t,length:r,finished:i,destroyed:s,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=s,e.finished=i,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}},M_=class extends P_{constructor(e={}){let t=e.dkLen===void 0?64:e.dkLen;super(128,t),this.v0l=vn[0]|0,this.v0h=vn[1]|0,this.v1l=vn[2]|0,this.v1h=vn[3]|0,this.v2l=vn[4]|0,this.v2h=vn[5]|0,this.v3l=vn[6]|0,this.v3h=vn[7]|0,this.v4l=vn[8]|0,this.v4h=vn[9]|0,this.v5l=vn[10]|0,this.v5h=vn[11]|0,this.v6l=vn[12]|0,this.v6h=vn[13]|0,this.v7l=vn[14]|0,this.v7h=vn[15]|0,Zte(t,e,64,16,16);let{key:r,personalization:i,salt:s}=e,o=0;if(r!==void 0&&(r=_s(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,s!==void 0){s=_s(s);let a=qp(s);this.v4l^=jo(a[0]),this.v4h^=jo(a[1]),this.v5l^=jo(a[2]),this.v5h^=jo(a[3])}if(i!==void 0){i=_s(i);let a=qp(i);this.v6l^=jo(a[0]),this.v6h^=jo(a[1]),this.v7l^=jo(a[2]),this.v7h^=jo(a[3])}if(r!==void 0){let a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:f,v6h:p,v7l:g,v7h:m}=this;return[e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m]}set(e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m){this.v0l=e|0,this.v0h=t|0,this.v1l=r|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=f|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,t,r){this.get().forEach((c,l)=>le[l]=c),le.set(vn,16);let{h:i,l:s}=z3(BigInt(this.length));le[24]=vn[8]^s,le[25]=vn[9]^i,r&&(le[28]=~le[28],le[29]=~le[29]);let o=0,a=Jte;for(let c=0;c<12;c++)Wa(0,4,8,12,e,t+2*a[o++]),Ka(0,4,8,12,e,t+2*a[o++]),Wa(1,5,9,13,e,t+2*a[o++]),Ka(1,5,9,13,e,t+2*a[o++]),Wa(2,6,10,14,e,t+2*a[o++]),Ka(2,6,10,14,e,t+2*a[o++]),Wa(3,7,11,15,e,t+2*a[o++]),Ka(3,7,11,15,e,t+2*a[o++]),Wa(0,5,10,15,e,t+2*a[o++]),Ka(0,5,10,15,e,t+2*a[o++]),Wa(1,6,11,12,e,t+2*a[o++]),Ka(1,6,11,12,e,t+2*a[o++]),Wa(2,7,8,13,e,t+2*a[o++]),Ka(2,7,8,13,e,t+2*a[o++]),Wa(3,4,9,14,e,t+2*a[o++]),Ka(3,4,9,14,e,t+2*a[o++]);this.v0l^=le[0]^le[16],this.v0h^=le[1]^le[17],this.v1l^=le[2]^le[18],this.v1h^=le[3]^le[19],this.v2l^=le[4]^le[20],this.v2h^=le[5]^le[21],this.v3l^=le[6]^le[22],this.v3h^=le[7]^le[23],this.v4l^=le[8]^le[24],this.v4h^=le[9]^le[25],this.v5l^=le[10]^le[26],this.v5h^=le[11]^le[27],this.v6l^=le[12]^le[28],this.v6h^=le[13]^le[29],this.v7l^=le[14]^le[30],this.v7h^=le[15]^le[31],Hi(le)}destroy(){this.destroyed=!0,Hi(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Xte=Rte(n=>new M_(n)),ene="https://rpc.walletconnect.org/v1";function o1(n){let e=`Ethereum Signed Message:
${n.length}`,t=new TextEncoder().encode(e+n);return"0x"+Buffer.from(Vte(t)).toString("hex")}async function nU(n,e,t,r,i,s){switch(t.t){case"eip191":return await rU(n,e,t.s);case"eip1271":return await iU(n,e,t.s,r,i,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function rU(n,e,t){let r=qB.Signature.fromHex(t);return qB.Secp256k1.recoverAddress({payload:o1(e),signature:r}).toLowerCase()===n.toLowerCase()}async function iU(n,e,t,r,i,s){let o=Y_(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{let a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=t.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:o1(e)).substring(2),h=a+d+c+u+l,f=await fetch(`${s||ene}/?chainId=${r}&projectId=${i}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:tne(),jsonrpc:"2.0",method:"eth_call",params:[{to:n,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function tne(){return Date.now()+Math.floor(Math.random()*1e3)}function nne(n){let e=atob(n),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);let r=t[0];if(r===0)throw new Error("No signatures found");let i=1+r*64;if(t.length<i)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");let s=Buffer.from(n,"base64").slice(1,65);return Kp.default.encode(s)}function rne(n){let e=new Uint8Array(Buffer.from(n,"base64")),t=Array.from("TransactionData::").map(s=>s.charCodeAt(0)),r=new Uint8Array(t.length+e.length);r.set(t),r.set(e,t.length);let i=Xte(r,{dkLen:32});return Kp.default.encode(i)}function ine(n){let e=new Uint8Array(n0(sU(n)));return Kp.default.encode(e)}function sU(n){if(n instanceof Uint8Array)return n;if(Array.isArray(n))return new Uint8Array(n);if(typeof n=="object"&&n!=null&&n.data)return new Uint8Array(Object.values(n.data));if(typeof n=="object"&&n)return new Uint8Array(Object.values(n));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function sne(n){let e=Buffer.from(n,"base64"),t=zB.decode(e).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");let r=zB.encode(t),i=Buffer.from("TX"),s=Buffer.concat([i,Buffer.from(r)]),o=Yte(s);return _ee.base32.encode(o).replace(/=+$/,"")}function g_(n){let e=[],t=BigInt(n);for(;t>=BigInt(128);)e.push(Number(t&BigInt(127)|BigInt(128))),t>>=BigInt(7);return e.push(Number(t)),Buffer.from(e)}function one(n){let e=Buffer.from(n.signed.bodyBytes,"base64"),t=Buffer.from(n.signed.authInfoBytes,"base64"),r=Buffer.from(n.signature.signature,"base64"),i=[];i.push(Buffer.from([10])),i.push(g_(e.length)),i.push(e),i.push(Buffer.from([18])),i.push(g_(t.length)),i.push(t),i.push(Buffer.from([26])),i.push(g_(r.length)),i.push(r);let s=Buffer.concat(i),o=n0(s);return Buffer.from(o).toString("hex").toUpperCase()}function ane(n){var e,t;let r=[];try{if(typeof n=="string")return r.push(n),r;if(typeof n!="object")return r;n!=null&&n.id&&r.push(n.id);let i=(t=(e=n?.capabilities)==null?void 0:e.caip345)==null?void 0:t.transactionHashes;i&&r.push(...i)}catch(i){console.warn("getWalletSendCallsHashes failed: ",i)}return r}var cne=Object.defineProperty,lne=Object.defineProperties,une=Object.getOwnPropertyDescriptors,t3=Object.getOwnPropertySymbols,dne=Object.prototype.hasOwnProperty,hne=Object.prototype.propertyIsEnumerable,n3=(n,e,t)=>e in n?cne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,a1=(n,e)=>{for(var t in e||(e={}))dne.call(e,t)&&n3(n,t,e[t]);if(t3)for(var t of t3(e))hne.call(e,t)&&n3(n,t,e[t]);return n},oU=(n,e)=>lne(n,une(e)),aU="did:pkh:",fne={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},pne=n=>n?fne[n]||n:"",Yp=n=>n?.split(":"),cU=n=>{let e=n&&Yp(n);if(e)return n.includes(aU)?e[3]:e[1]},lU=n=>{let e=n&&Yp(n);if(e)return n.includes(aU)?e[2]:e[0]},uU=n=>{let e=n&&Yp(n);if(e)return e[2]+":"+e[3]},c1=n=>{let e=n&&Yp(n);if(e)return e.pop()};async function gne(n){let{cacao:e,projectId:t}=n,{s:r,p:i}=e,s=dU(i,i.iss),o=c1(i.iss);return await nU(o,s,r,uU(i.iss),t)}var dU=(n,e)=>{let t=lU(e);if(!t)throw new Error("Invalid issuer: "+e);let r=`${n.domain} wants you to sign in with your ${pne(t)} account:`,i=c1(e);if(!n.aud&&!n.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=n.statement||void 0,o=`URI: ${n.aud||n.uri}`,a=`Version: ${n.version}`,c=`Chain ID: ${cU(e)}`,l=`Nonce: ${n.nonce}`,u=`Issued At: ${n.iat}`,d=n.exp?`Expiration Time: ${n.exp}`:void 0,h=n.nbf?`Not Before: ${n.nbf}`:void 0,f=n.requestId?`Request ID: ${n.requestId}`:void 0,p=n.resources?`Resources:${n.resources.map(m=>`
- ${m}`).join("")}`:void 0,g=i0(n.resources);if(g){let m=rc(g);s=d1(s,m)}return[r,i,"",s,"",o,a,c,l,u,d,h,f,p].filter(m=>m!=null).join(`
`)};function mne(n,e,t){return t.includes("did:pkh:")||(t=`did:pkh:${t}`),{h:{t:"caip122"},p:{iss:t,domain:n.domain,aud:n.aud,version:n.version,nonce:n.nonce,iat:n.iat,statement:n.statement,requestId:n.requestId,resources:n.resources,nbf:n.nbf,exp:n.exp},s:e}}function yne(n){var e;let{authPayload:t,chains:r,methods:i}=n,s=t.statement||"";if(!(r!=null&&r.length))return t;let o=t.chains,a=T_(o,r);if(!(a!=null&&a.length))throw new Error("No supported chains");let c=hU(t.resources);if(!c)return t;to(c);let l=fU(c,"eip155"),u=t?.resources||[];if(l!=null&&l.length){let d=pU(l),h=T_(d,i);if(!(h!=null&&h.length))throw new Error(`Supported methods don't satisfy the requested: ${JSON.stringify(d)}, supported: ${JSON.stringify(i)}`);let f=l1("request",h,{chains:a}),p=wU(c,"eip155",f);u=((e=t?.resources)==null?void 0:e.slice(0,-1))||[],u.push(r0(p))}return oU(a1({},t),{statement:bU(s,i0(u)),chains:a,resources:t!=null&&t.resources||u.length>0?u:void 0})}function hU(n){let e=i0(n);if(e&&u1(e))return rc(e)}function wne(n,e){var t;return(t=n?.att)==null?void 0:t.hasOwnProperty(e)}function fU(n,e){var t,r;return(t=n?.att)!=null&&t[e]?Object.keys((r=n?.att)==null?void 0:r[e]):[]}function vne(n){return n?.map(e=>Object.keys(e))||[]}function pU(n){return n?.map(e=>{var t;return(t=e.split("/"))==null?void 0:t[1]})||[]}function gU(n){return Buffer.from(JSON.stringify(n)).toString("base64")}function mU(n){return JSON.parse(Buffer.from(n,"base64").toString("utf-8"))}function to(n){if(!n)throw new Error("No recap provided, value is undefined");if(!n.att)throw new Error("No `att` property found");let e=Object.keys(n.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{let r=n.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(i=>{let s=r[i];if(!Array.isArray(s))throw new Error(`Ability limits ${i} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${i} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${i}) must be an array of objects, found: ${o}`)})})})}function yU(n,e,t,r={}){return t?.sort((i,s)=>i.localeCompare(s)),{att:{[n]:l1(e,t,r)}}}function wU(n,e,t){var r;n.att[e]=a1({},t);let i=(r=Object.keys(n.att))==null?void 0:r.sort((o,a)=>o.localeCompare(a)),s={att:{}};return i.reduce((o,a)=>(o.att[a]=n.att[a],o),s)}function l1(n,e,t={}){e=e?.sort((i,s)=>i.localeCompare(s));let r=e.map(i=>({[`${n}/${i}`]:[t]}));return Object.assign({},...r)}function r0(n){return to(n),`urn:recap:${gU(n).replace(/=/g,"")}`}function rc(n){let e=mU(n.replace("urn:recap:",""));return to(e),e}function bne(n,e,t){let r=yU(n,e,t);return r0(r)}function u1(n){return n&&n.includes("urn:recap:")}function Ene(n,e){let t=rc(n),r=rc(e),i=vU(t,r);return r0(i)}function vU(n,e){to(n),to(e);let t=Object.keys(n.att).concat(Object.keys(e.att)).sort((i,s)=>i.localeCompare(s)),r={att:{}};return t.forEach(i=>{var s,o;Object.keys(((s=n.att)==null?void 0:s[i])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[i])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[i]=oU(a1({},r.att[i]),{[a]:((c=n.att[i])==null?void 0:c[a])||((l=e.att[i])==null?void 0:l[a])})})}),r}function d1(n="",e){to(e);let t="I further authorize the stated URI to perform the following actions on my behalf: ";if(n.includes(t))return n;let r=[],i=0;Object.keys(e.att).forEach(a=>{let c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));let l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});let u=Object.keys(l).map(d=>(i++,`(${i}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});let s=r.join(" "),o=`${t}${s}`;return`${n?n+" ":""}${o}`}function Ine(n){var e;let t=rc(n);to(t);let r=(e=t.att)==null?void 0:e.eip155;return r?Object.keys(r).map(i=>i.split("/")[1]):[]}function Cne(n){let e=rc(n);to(e);let t=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(i=>{var s;(s=i?.[0])!=null&&s.chains&&t.push(i[0].chains)})}),[...new Set(t.flat())]}function bU(n,e){if(!e)return n;let t=rc(e);return to(t),d1(n,t)}function i0(n){if(!n)return;let e=n?.[n.length-1];return u1(e)?e:void 0}function EU(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function k_(n){if(typeof n!="boolean")throw new Error(`boolean expected, not ${n}`)}function m_(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function Kr(n,...e){if(!EU(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function r3(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Sne(n,e){Kr(n);let t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function ec(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function Wd(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function Ane(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}var _ne=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Tne(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function L_(n){if(typeof n=="string")n=Tne(n);else if(EU(n))n=F_(n);else throw new Error("Uint8Array expected, got "+typeof n);return n}function xne(n,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(n,e)}function Dne(n,e){if(n.length!==e.length)return!1;let t=0;for(let r=0;r<n.length;r++)t|=n[r]^e[r];return t===0}var Nne=(n,e)=>{function t(r,...i){if(Kr(r),!_ne)throw new Error("Non little-endian hardware is not yet supported");if(n.nonceLength!==void 0){let l=i[0];if(!l)throw new Error("nonce / iv required");n.varSizeNonce?Kr(l):Kr(l,n.nonceLength)}let s=n.tagLength;s&&i[1]!==void 0&&Kr(i[1]);let o=e(r,...i),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Kr(u)}},c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Kr(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Kr(l),s&&l.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,n),t};function i3(n,e,t=!0){if(e===void 0)return new Uint8Array(n);if(e.length!==n)throw new Error("invalid output length, expected "+n+", got: "+e.length);if(t&&!One(e))throw new Error("invalid output, must be aligned");return e}function s3(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}function Rne(n,e,t){k_(t);let r=new Uint8Array(16),i=Ane(r);return s3(i,0,BigInt(e),t),s3(i,8,BigInt(n),t),r}function One(n){return n.byteOffset%4===0}function F_(n){return Uint8Array.from(n)}var IU=n=>Uint8Array.from(n.split("").map(e=>e.charCodeAt(0))),Pne=IU("expand 16-byte k"),Mne=IU("expand 32-byte k"),kne=ec(Pne),Lne=ec(Mne);function st(n,e){return n<<e|n>>>32-e}function B_(n){return n.byteOffset%4===0}var Vv=64,Fne=16,CU=2**32-1,o3=new Uint32Array;function Bne(n,e,t,r,i,s,o,a){let c=i.length,l=new Uint8Array(Vv),u=ec(l),d=B_(i)&&B_(s),h=d?ec(i):o3,f=d?ec(s):o3;for(let p=0;p<c;o++){if(n(e,t,r,u,o,a),o>=CU)throw new Error("arx: counter overflow");let g=Math.min(Vv,c-p);if(d&&g===Vv){let m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let y=0,E;y<Fne;y++)E=m+y,f[E]=h[E]^u[y];p+=Vv;continue}for(let m=0,y;m<g;m++)y=p+m,s[y]=i[y]^l[m];p+=g}}function Une(n,e){let{allowShortKeys:t,extendNonceFn:r,counterLength:i,counterRight:s,rounds:o}=xne({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof n!="function")throw new Error("core must be a function");return m_(i),m_(o),k_(s),k_(t),(a,c,l,u,d=0)=>{Kr(a),Kr(c),Kr(l);let h=l.length;if(u===void 0&&(u=new Uint8Array(h)),Kr(u),m_(d),d<0||d>=CU)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);let f=[],p=a.length,g,m;if(p===32)f.push(g=F_(a)),m=Lne;else if(p===16&&t)g=new Uint8Array(32),g.set(a),g.set(a,16),m=kne,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);B_(c)||f.push(c=F_(c));let y=ec(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,y,ec(c.subarray(0,16)),y),c=c.subarray(16)}let E=16-i;if(E!==c.length)throw new Error(`arx: nonce must be ${E} or 16 bytes`);if(E!==12){let L=new Uint8Array(12);L.set(c,s?0:12-c.length),c=L,f.push(c)}let I=ec(c);return Bne(n,m,y,I,l,u,d,o),Wd(...f),u}}var Bn=(n,e)=>n[e++]&255|(n[e++]&255)<<8,U_=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=L_(e),Kr(e,32);let t=Bn(e,0),r=Bn(e,2),i=Bn(e,4),s=Bn(e,6),o=Bn(e,8),a=Bn(e,10),c=Bn(e,12),l=Bn(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Bn(e,16+2*u)}process(e,t,r=!1){let i=r?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],p=o[7],g=o[8],m=o[9],y=Bn(e,t+0),E=Bn(e,t+2),I=Bn(e,t+4),L=Bn(e,t+6),k=Bn(e,t+8),D=Bn(e,t+10),B=Bn(e,t+12),U=Bn(e,t+14),T=s[0]+(y&8191),$=s[1]+((y>>>13|E<<3)&8191),W=s[2]+((E>>>10|I<<6)&8191),M=s[3]+((I>>>7|L<<9)&8191),v=s[4]+((L>>>4|k<<12)&8191),b=s[5]+(k>>>1&8191),w=s[6]+((k>>>14|D<<2)&8191),C=s[7]+((D>>>11|B<<5)&8191),N=s[8]+((B>>>8|U<<8)&8191),F=s[9]+(U>>>5|i),S=0,P=S+T*a+$*(5*m)+W*(5*g)+M*(5*p)+v*(5*f);S=P>>>13,P&=8191,P+=b*(5*h)+w*(5*d)+C*(5*u)+N*(5*l)+F*(5*c),S+=P>>>13,P&=8191;let V=S+T*c+$*a+W*(5*m)+M*(5*g)+v*(5*p);S=V>>>13,V&=8191,V+=b*(5*f)+w*(5*h)+C*(5*d)+N*(5*u)+F*(5*l),S+=V>>>13,V&=8191;let j=S+T*l+$*c+W*a+M*(5*m)+v*(5*g);S=j>>>13,j&=8191,j+=b*(5*p)+w*(5*f)+C*(5*h)+N*(5*d)+F*(5*u),S+=j>>>13,j&=8191;let oe=S+T*u+$*l+W*c+M*a+v*(5*m);S=oe>>>13,oe&=8191,oe+=b*(5*g)+w*(5*p)+C*(5*f)+N*(5*h)+F*(5*d),S+=oe>>>13,oe&=8191;let ee=S+T*d+$*u+W*l+M*c+v*a;S=ee>>>13,ee&=8191,ee+=b*(5*m)+w*(5*g)+C*(5*p)+N*(5*f)+F*(5*h),S+=ee>>>13,ee&=8191;let Q=S+T*h+$*d+W*u+M*l+v*c;S=Q>>>13,Q&=8191,Q+=b*a+w*(5*m)+C*(5*g)+N*(5*p)+F*(5*f),S+=Q>>>13,Q&=8191;let ae=S+T*f+$*h+W*d+M*u+v*l;S=ae>>>13,ae&=8191,ae+=b*c+w*a+C*(5*m)+N*(5*g)+F*(5*p),S+=ae>>>13,ae&=8191;let te=S+T*p+$*f+W*h+M*d+v*u;S=te>>>13,te&=8191,te+=b*l+w*c+C*a+N*(5*m)+F*(5*g),S+=te>>>13,te&=8191;let be=S+T*g+$*p+W*f+M*h+v*d;S=be>>>13,be&=8191,be+=b*u+w*l+C*c+N*a+F*(5*m),S+=be>>>13,be&=8191;let re=S+T*m+$*g+W*p+M*f+v*h;S=re>>>13,re&=8191,re+=b*d+w*u+C*l+N*c+F*a,S+=re>>>13,re&=8191,S=(S<<2)+S|0,S=S+P|0,P=S&8191,S=S>>>13,V+=S,s[0]=P,s[1]=V,s[2]=j,s[3]=oe,s[4]=ee,s[5]=Q,s[6]=ae,s[7]=te,s[8]=be,s[9]=re}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)r[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;Wd(r)}update(e){r3(this),e=L_(e),Kr(e);let{buffer:t,blockLen:r}=this,i=e.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);if(o===r){for(;r<=i-s;s+=r)this.process(e,s);continue}t.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){Wd(this.h,this.r,this.buffer,this.pad)}digestInto(e){r3(this),Sne(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=r[o]>>>0,e[s++]=r[o]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}};function jne(n){let e=(r,i)=>n(i).update(L_(r)).digest(),t=n(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}var Vne=jne(n=>new U_(n));function Hne(n,e,t,r,i,s=20){let o=n[0],a=n[1],c=n[2],l=n[3],u=e[0],d=e[1],h=e[2],f=e[3],p=e[4],g=e[5],m=e[6],y=e[7],E=i,I=t[0],L=t[1],k=t[2],D=o,B=a,U=c,T=l,$=u,W=d,M=h,v=f,b=p,w=g,C=m,N=y,F=E,S=I,P=L,V=k;for(let oe=0;oe<s;oe+=2)D=D+$|0,F=st(F^D,16),b=b+F|0,$=st($^b,12),D=D+$|0,F=st(F^D,8),b=b+F|0,$=st($^b,7),B=B+W|0,S=st(S^B,16),w=w+S|0,W=st(W^w,12),B=B+W|0,S=st(S^B,8),w=w+S|0,W=st(W^w,7),U=U+M|0,P=st(P^U,16),C=C+P|0,M=st(M^C,12),U=U+M|0,P=st(P^U,8),C=C+P|0,M=st(M^C,7),T=T+v|0,V=st(V^T,16),N=N+V|0,v=st(v^N,12),T=T+v|0,V=st(V^T,8),N=N+V|0,v=st(v^N,7),D=D+W|0,V=st(V^D,16),C=C+V|0,W=st(W^C,12),D=D+W|0,V=st(V^D,8),C=C+V|0,W=st(W^C,7),B=B+M|0,F=st(F^B,16),N=N+F|0,M=st(M^N,12),B=B+M|0,F=st(F^B,8),N=N+F|0,M=st(M^N,7),U=U+v|0,S=st(S^U,16),b=b+S|0,v=st(v^b,12),U=U+v|0,S=st(S^U,8),b=b+S|0,v=st(v^b,7),T=T+$|0,P=st(P^T,16),w=w+P|0,$=st($^w,12),T=T+$|0,P=st(P^T,8),w=w+P|0,$=st($^w,7);let j=0;r[j++]=o+D|0,r[j++]=a+B|0,r[j++]=c+U|0,r[j++]=l+T|0,r[j++]=u+$|0,r[j++]=d+W|0,r[j++]=h+M|0,r[j++]=f+v|0,r[j++]=p+b|0,r[j++]=g+w|0,r[j++]=m+C|0,r[j++]=y+N|0,r[j++]=E+F|0,r[j++]=I+S|0,r[j++]=L+P|0,r[j++]=k+V|0}var $ne=Une(Hne,{counterRight:!1,counterLength:4,allowShortKeys:!1}),qne=new Uint8Array(16),a3=(n,e)=>{n.update(e);let t=e.length%16;t&&n.update(qne.subarray(t))},zne=new Uint8Array(32);function c3(n,e,t,r,i){let s=n(e,t,zne),o=Vne.create(s);i&&a3(o,i),a3(o,r);let a=Rne(r.length,i?i.length:0,!0);o.update(a);let c=o.digest();return Wd(s,a),c}var Gne=n=>(e,t,r)=>({encrypt(i,s){let o=i.length;s=i3(o+16,s,!1),s.set(i);let a=s.subarray(0,-16);n(e,t,a,a,1);let c=c3(n,e,t,a,r);return s.set(c,o),Wd(c),s},decrypt(i,s){s=i3(i.length-16,s,!1);let o=i.subarray(0,-16),a=i.subarray(-16),c=c3(n,e,t,o,r);if(!Dne(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),n(e,t,s,s,1),Wd(c),s}}),SU=Nne({blockSize:64,nonceLength:12,tagLength:16},Gne($ne)),Kv=class extends Gd{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,t0(e);let r=_s(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),Hi(s)}update(e){return nc(this),this.iHash.update(e),this}digestInto(e){nc(this),Ts(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},s0=(n,e,t)=>new Kv(n,e).update(t).digest();s0.create=(n,e)=>new Kv(n,e);function Wne(n,e,t){return t0(n),t===void 0&&(t=new Uint8Array(n.outputLen)),s0(n,_s(t),_s(e))}var y_=Uint8Array.from([0]),l3=Uint8Array.of();function Kne(n,e,t,r=32){t0(n),zo(r);let i=n.outputLen;if(r>255*i)throw new Error("Length should be <= 255*HashLen");let s=Math.ceil(r/i);t===void 0&&(t=l3);let o=new Uint8Array(s*i),a=s0.create(n,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<s;u++)y_[0]=u+1,c.update(u===0?l3:l).update(t).update(y_).digestInto(l),o.set(l,i*u),a._cloneInto(c);return a.destroy(),c.destroy(),Hi(l,y_),o.slice(0,r)}var Qne=(n,e,t,r,i)=>Kne(n,Wne(n,e,t),r,i),o0=n0,h1=BigInt(0),j_=BigInt(1);function Qv(n,e=""){if(typeof n!="boolean"){let t=e&&`"${e}"`;throw new Error(t+"expected boolean, got type="+typeof n)}return n}function kl(n,e,t=""){let r=e0(n),i=n?.length,s=e!==void 0;if(!r||s&&i!==e){let o=t&&`"${t}" `,a=s?` of length ${e}`:"",c=r?`length=${i}`:`type=${typeof n}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return n}function Hv(n){let e=n.toString(16);return e.length&1?"0"+e:e}function AU(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return n===""?h1:BigInt("0x"+n)}function a0(n){return AU($d(n))}function Yv(n){return Ts(n),AU($d(Uint8Array.from(n).reverse()))}function f1(n,e){return Gv(n.toString(16).padStart(e*2,"0"))}function p1(n,e){return f1(n,e).reverse()}function rr(n,e,t){let r;if(typeof e=="string")try{r=Gv(e)}catch(s){throw new Error(n+" must be hex string or Uint8Array, cause: "+s)}else if(e0(e))r=Uint8Array.from(e);else throw new Error(n+" must be hex string or Uint8Array");let i=r.length;if(typeof t=="number"&&i!==t)throw new Error(n+" of length "+t+" expected, got "+i);return r}var w_=n=>typeof n=="bigint"&&h1<=n;function Yne(n,e,t){return w_(n)&&w_(e)&&w_(t)&&e<=n&&n<t}function V_(n,e,t,r){if(!Yne(e,t,r))throw new Error("expected valid "+n+": "+t+" <= n < "+r+", got "+e)}function _U(n){let e;for(e=0;n>h1;n>>=j_,e+=1);return e}var Jp=n=>(j_<<BigInt(n))-j_;function Jne(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=h=>new Uint8Array(h),i=h=>Uint8Array.of(h),s=r(n),o=r(n),a=0,c=()=>{s.fill(1),o.fill(0),a=0},l=(...h)=>t(o,s,...h),u=(h=r(0))=>{o=l(i(0),h),s=l(),h.length!==0&&(o=l(i(1),h),s=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,f=[];for(;h<e;){s=l();let p=s.slice();f.push(p),h+=s.length}return Za(...f)};return(h,f)=>{c(),u(h);let p;for(;!(p=f(d()));)u();return c(),p}}function c0(n,e,t={}){if(!n||typeof n!="object")throw new Error("expected valid options object");function r(i,s,o){let a=n[i];if(o&&a===void 0)return;let c=typeof a;if(c!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach(([i,s])=>r(i,s,!1)),Object.entries(t).forEach(([i,s])=>r(i,s,!0))}function u3(n){let e=new WeakMap;return(t,...r)=>{let i=e.get(t);if(i!==void 0)return i;let s=n(t,...r);return e.set(t,s),s}}var Qr=BigInt(0),_r=BigInt(1),Ll=BigInt(2),TU=BigInt(3),xU=BigInt(4),DU=BigInt(5),Zne=BigInt(7),NU=BigInt(8),Xne=BigInt(9),RU=BigInt(16);function pi(n,e){let t=n%e;return t>=Qr?t:e+t}function Ss(n,e,t){let r=n;for(;e-- >Qr;)r*=r,r%=t;return r}function d3(n,e){if(n===Qr)throw new Error("invert: expected non-zero number");if(e<=Qr)throw new Error("invert: expected positive modulus, got "+e);let t=pi(n,e),r=e,i=Qr,s=_r;for(;t!==Qr;){let o=r/t,a=r%t,c=i-s*o;r=t,t=a,i=s,s=c}if(r!==_r)throw new Error("invert: does not exist");return pi(i,e)}function g1(n,e,t){if(!n.eql(n.sqr(e),t))throw new Error("Cannot find square root")}function OU(n,e){let t=(n.ORDER+_r)/xU,r=n.pow(e,t);return g1(n,r,e),r}function ere(n,e){let t=(n.ORDER-DU)/NU,r=n.mul(e,Ll),i=n.pow(r,t),s=n.mul(e,i),o=n.mul(n.mul(s,Ll),i),a=n.mul(s,n.sub(o,n.ONE));return g1(n,a,e),a}function tre(n){let e=sc(n),t=PU(n),r=t(e,e.neg(e.ONE)),i=t(e,r),s=t(e,e.neg(r)),o=(n+Zne)/RU;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,r),d=a.mul(l,i),h=a.mul(l,s),f=a.eql(a.sqr(u),c),p=a.eql(a.sqr(d),c);l=a.cmov(l,u,f),u=a.cmov(h,d,p);let g=a.eql(a.sqr(u),c),m=a.cmov(l,u,g);return g1(a,m,c),m}}function PU(n){if(n<TU)throw new Error("sqrt is not defined for small field");let e=n-_r,t=0;for(;e%Ll===Qr;)e/=Ll,t++;let r=Ll,i=sc(n);for(;h3(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return OU;let s=i.pow(r,e),o=(e+_r)/Ll;return function(a,c){if(a.is0(c))return c;if(h3(a,c)!==1)throw new Error("Cannot find square root");let l=t,u=a.mul(a.ONE,s),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let f=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===l)throw new Error("Cannot find square root");let g=_r<<BigInt(l-f-1),m=a.pow(u,g);l=f,u=a.sqr(m),d=a.mul(d,u),h=a.mul(h,m)}return h}}function nre(n){return n%xU===TU?OU:n%NU===DU?ere:n%RU===Xne?tre(n):PU(n)}var rre=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ire(n){let e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=rre.reduce((r,i)=>(r[i]="function",r),e);return c0(n,t),n}function sre(n,e,t){if(t<Qr)throw new Error("invalid exponent, negatives unsupported");if(t===Qr)return n.ONE;if(t===_r)return e;let r=n.ONE,i=e;for(;t>Qr;)t&_r&&(r=n.mul(r,i)),i=n.sqr(i),t>>=_r;return r}function MU(n,e,t=!1){let r=new Array(e.length).fill(t?n.ZERO:void 0),i=e.reduce((o,a,c)=>n.is0(a)?o:(r[c]=o,n.mul(o,a)),n.ONE),s=n.inv(i);return e.reduceRight((o,a,c)=>n.is0(a)?o:(r[c]=n.mul(o,r[c]),n.mul(o,a)),s),r}function h3(n,e){let t=(n.ORDER-_r)/Ll,r=n.pow(e,t),i=n.eql(r,n.ONE),s=n.eql(r,n.ZERO),o=n.eql(r,n.neg(n.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function kU(n,e){e!==void 0&&zo(e);let t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function sc(n,e,t=!1,r={}){if(n<=Qr)throw new Error("invalid field: expected ORDER > 0, got "+n);let i,s,o=!1,a;if(typeof e=="object"&&e!=null){if(r.sqrt||t)throw new Error("cannot specify opts in two arguments");let h=e;h.BITS&&(i=h.BITS),h.sqrt&&(s=h.sqrt),typeof h.isLE=="boolean"&&(t=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof e=="number"&&(i=e),r.sqrt&&(s=r.sqrt);let{nBitLength:c,nByteLength:l}=kU(n,i);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u,d=Object.freeze({ORDER:n,isLE:t,BITS:c,BYTES:l,MASK:Jp(c),ZERO:Qr,ONE:_r,allowedLengths:a,create:h=>pi(h,n),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return Qr<=h&&h<n},is0:h=>h===Qr,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&_r)===_r,neg:h=>pi(-h,n),eql:(h,f)=>h===f,sqr:h=>pi(h*h,n),add:(h,f)=>pi(h+f,n),sub:(h,f)=>pi(h-f,n),mul:(h,f)=>pi(h*f,n),pow:(h,f)=>sre(d,h,f),div:(h,f)=>pi(h*d3(f,n),n),sqrN:h=>h*h,addN:(h,f)=>h+f,subN:(h,f)=>h-f,mulN:(h,f)=>h*f,inv:h=>d3(h,n),sqrt:s||(h=>(u||(u=nre(n)),u(d,h))),toBytes:h=>t?p1(h,l):f1(h,l),fromBytes:(h,f=!0)=>{if(a){if(!a.includes(h.length)||h.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);let g=new Uint8Array(l);g.set(h,t?0:g.length-h.length),h=g}if(h.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+h.length);let p=t?Yv(h):a0(h);if(o&&(p=pi(p,n)),!f&&!d.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:h=>MU(d,h),cmov:(h,f,p)=>p?f:h});return Object.freeze(d)}function LU(n){if(typeof n!="bigint")throw new Error("field order must be bigint");let e=n.toString(2).length;return Math.ceil(e/8)}function FU(n){let e=LU(n);return e+Math.ceil(e/2)}function ore(n,e,t=!1){let r=n.length,i=LU(e),s=FU(e);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);let o=t?Yv(n):a0(n),a=pi(o,e-_r)+_r;return t?p1(a,i):f1(a,i)}var Kd=BigInt(0),Fl=BigInt(1);function Jv(n,e){let t=e.negate();return n?t:e}function v_(n,e){let t=MU(n.Fp,e.map(r=>r.Z));return e.map((r,i)=>n.fromAffine(r.toAffine(t[i])))}function BU(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+n)}function b_(n,e){BU(n,e);let t=Math.ceil(e/n)+1,r=2**(n-1),i=2**n,s=Jp(n),o=BigInt(n);return{windows:t,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function f3(n,e,t){let{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=t,a=Number(n&i),c=n>>o;a>r&&(a-=s,c+=Fl);let l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,f=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:l}}function are(n,e){if(!Array.isArray(n))throw new Error("array expected");n.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function cre(n,e){if(!Array.isArray(n))throw new Error("array of scalars expected");n.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}var E_=new WeakMap,UU=new WeakMap;function I_(n){return UU.get(n)||1}function p3(n){if(n!==Kd)throw new Error("invalid wNAF")}var H_=class{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let i=e;for(;t>Kd;)t&Fl&&(r=r.add(i)),i=i.double(),t>>=Fl;return r}precomputeWindow(e,t){let{windows:r,windowSize:i}=b_(t,this.bits),s=[],o=e,a=o;for(let c=0;c<r;c++){a=o,s.push(a);for(let l=1;l<i;l++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(e,t,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE,o=b_(e,this.bits);for(let a=0;a<o.windows;a++){let{nextN:c,offset:l,isZero:u,isNeg:d,isNegF:h,offsetF:f}=f3(r,a,o);r=c,u?s=s.add(Jv(h,t[f])):i=i.add(Jv(d,t[l]))}return p3(r),{p:i,f:s}}wNAFUnsafe(e,t,r,i=this.ZERO){let s=b_(e,this.bits);for(let o=0;o<s.windows&&r!==Kd;o++){let{nextN:a,offset:c,isZero:l,isNeg:u}=f3(r,o,s);if(r=a,!l){let d=t[c];i=i.add(u?d.negate():d)}}return p3(r),i}getPrecomputes(e,t,r){let i=E_.get(t);return i||(i=this.precomputeWindow(t,e),e!==1&&(typeof r=="function"&&(i=r(i)),E_.set(t,i))),i}cached(e,t,r){let i=I_(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)}unsafe(e,t,r,i){let s=I_(e);return s===1?this._unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)}createCache(e,t){BU(t,this.bits),UU.set(e,t),E_.delete(e)}hasCache(e){return I_(e)!==1}};function lre(n,e,t,r){let i=e,s=n.ZERO,o=n.ZERO;for(;t>Kd||r>Kd;)t&Fl&&(s=s.add(i)),r&Fl&&(o=o.add(i)),i=i.double(),t>>=Fl,r>>=Fl;return{p1:s,p2:o}}function ure(n,e,t,r){are(t,n),cre(r,e);let i=t.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");let o=n.ZERO,a=_U(BigInt(i)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=Jp(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c,h=o;for(let f=d;f>=0;f-=c){u.fill(o);for(let g=0;g<s;g++){let m=r[g],y=Number(m>>BigInt(f)&l);u[y]=u[y].add(t[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(h=h.add(p),f!==0)for(let g=0;g<c;g++)h=h.double()}return h}function g3(n,e,t){if(e){if(e.ORDER!==n)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return ire(e),e}else return sc(n,{isLE:t})}function dre(n,e,t={},r){if(r===void 0&&(r=n==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${n} CURVE object`);for(let a of["p","n","h"]){let c=e[a];if(!(typeof c=="bigint"&&c>Kd))throw new Error(`CURVE.${a} must be positive bigint`)}let i=g3(e.p,t.Fp,r),s=g3(e.n,t.Fn,r),o=["Gx","Gy","a",n==="weierstrass"?"b":"d"];for(let a of o)if(!i.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:i,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),Y3("HashToScalar-");var jp=BigInt(0),jd=BigInt(1),$v=BigInt(2);function hre(n){return c0(n,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(H({},n))}function fre(n){let e=hre(n),{P:t,type:r,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");let c=o||Vl,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),f=a?$v**BigInt(254):$v**BigInt(447),p=a?BigInt(8)*$v**BigInt(251)-jd:BigInt(4)*$v**BigInt(445)-jd,g=f+p+jd,m=M=>pi(M,t),y=E(d);function E(M){return p1(m(M),u)}function I(M){let v=rr("u coordinate",M,u);return a&&(v[31]&=127),m(Yv(v))}function L(M){return Yv(i(rr("scalar",M,u)))}function k(M,v){let b=U(I(v),L(M));if(b===jp)throw new Error("invalid private or public key received");return E(b)}function D(M){return k(M,y)}function B(M,v,b){let w=m(M*(v-b));return v=m(v-w),b=m(b+w),{x_2:v,x_3:b}}function U(M,v){V_("u",M,jp,t),V_("scalar",v,f,g);let b=v,w=M,C=jd,N=jp,F=M,S=jd,P=jp;for(let j=BigInt(l-1);j>=jp;j--){let oe=b>>j&jd;P^=oe,{x_2:C,x_3:F}=B(P,C,F),{x_2:N,x_3:S}=B(P,N,S),P=oe;let ee=C+N,Q=m(ee*ee),ae=C-N,te=m(ae*ae),be=Q-te,re=F+S,Ce=F-S,kt=m(Ce*ee),St=m(re*ae),Wt=kt+St,En=kt-St;F=m(Wt*Wt),S=m(w*m(En*En)),C=m(Q*te),N=m(be*(Q+m(h*be)))}({x_2:C,x_3:F}=B(P,C,F)),{x_2:N,x_3:S}=B(P,N,S);let V=s(N);return m(C*V)}let T={secretKey:u,publicKey:u,seed:u},$=(M=c(u))=>(Ts(M,T.seed),M);function W(M){let v=$(M);return{secretKey:v,publicKey:D(v)}}return{keygen:W,getSharedSecret:(M,v)=>k(M,v),getPublicKey:M=>D(M),scalarMult:k,scalarMultBase:D,utils:{randomSecretKey:$,randomPrivateKey:$},GuBytes:y.slice(),lengths:T}}var pre=BigInt(1),m3=BigInt(2),gre=BigInt(3),mre=BigInt(5),yre=BigInt(8),jU=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),wre={p:jU,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:yre,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function vre(n){let e=BigInt(10),t=BigInt(20),r=BigInt(40),i=BigInt(80),s=jU,o=n*n%s*n%s,a=Ss(o,m3,s)*o%s,c=Ss(a,pre,s)*n%s,l=Ss(c,mre,s)*c%s,u=Ss(l,e,s)*l%s,d=Ss(u,t,s)*u%s,h=Ss(d,r,s)*d%s,f=Ss(h,i,s)*h%s,p=Ss(f,i,s)*h%s,g=Ss(p,e,s)*l%s;return{pow_p_5_8:Ss(g,m3,s)*n%s,b2:o}}function bre(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}var Ere=sc(wre.p,{isLE:!0}),$_=(()=>{let n=Ere.ORDER;return fre({P:n,type:"x25519",powPminus2:e=>{let{pow_p_5_8:t,b2:r}=vre(e);return pi(Ss(t,gre,n)*r,n)},adjustScalarBytes:bre})})(),y3=(n,e)=>(n+(n>=0?e:-e)/VU)/e;function Ire(n,e,t){let[[r,i],[s,o]]=e,a=y3(o*n,t),c=y3(-i*n,t),l=n-a*r-c*s,u=-a*i-c*o,d=l<$o,h=u<$o;d&&(l=-l),h&&(u=-u);let f=Jp(Math.ceil(_U(t)/2))+qd;if(l<$o||l>=f||u<$o||u>=f)throw new Error("splitScalar (endomorphism): failed, k="+n);return{k1neg:d,k1:l,k2neg:h,k2:u}}function q_(n){if(!["compact","recovered","der"].includes(n))throw new Error('Signature format must be "compact", "recovered", or "der"');return n}function C_(n,e){let t={};for(let r of Object.keys(e))t[r]=n[r]===void 0?e[r]:n[r];return Qv(t.lowS,"lowS"),Qv(t.prehash,"prehash"),t.format!==void 0&&q_(t.format),t}var z_=class extends Error{constructor(e=""){super(e)}},Vo={Err:z_,_tlv:{encode:(n,e)=>{let{Err:t}=Vo;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");let r=e.length/2,i=Hv(r);if(i.length/2&128)throw new t("tlv.encode: long form length too big");let s=r>127?Hv(i.length/2|128):"";return Hv(n)+s+i+e},decode(n,e){let{Err:t}=Vo,r=0;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[r++]!==n)throw new t("tlv.decode: wrong tlv");let i=e[r++],s=!!(i&128),o=0;if(!s)o=i;else{let c=i&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");let l=e.subarray(r,r+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(let u of l)o=o<<8|u;if(r+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}let a=e.subarray(r,r+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(n){let{Err:e}=Vo;if(n<$o)throw new e("integer: negative integers are not allowed");let t=Hv(n);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(n){let{Err:e}=Vo;if(n[0]&128)throw new e("invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return a0(n)}},toSig(n){let{Err:e,_int:t,_tlv:r}=Vo,i=rr("signature",n),{v:s,l:o}=r.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");let{v:a,l:c}=r.decode(2,s),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(n){let{_tlv:e,_int:t}=Vo,r=e.encode(2,t.encode(n.r)),i=e.encode(2,t.encode(n.s)),s=r+i;return e.encode(48,s)}},$o=BigInt(0),qd=BigInt(1),VU=BigInt(2),qv=BigInt(3),Cre=BigInt(4);function Vd(n,e){let{BYTES:t}=n,r;if(typeof e=="bigint")r=e;else{let i=rr("private key",e);try{r=n.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${t}, got ${typeof e}`)}}if(!n.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function Sre(n,e={}){let t=dre("weierstrass",n,e),{Fp:r,Fn:i}=t,s=t.CURVE,{h:o,n:a}=s;c0(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:c}=e;if(c&&(!r.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let l=$U(r,i);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(M,v,b){let{x:w,y:C}=v.toAffine(),N=r.toBytes(w);if(Qv(b,"isCompressed"),b){u();let F=!r.isOdd(C);return Za(HU(F),N)}else return Za(Uint8Array.of(4),N,r.toBytes(C))}function h(M){kl(M,void 0,"Point");let{publicKey:v,publicKeyUncompressed:b}=l,w=M.length,C=M[0],N=M.subarray(1);if(w===v&&(C===2||C===3)){let F=r.fromBytes(N);if(!r.isValid(F))throw new Error("bad point: is not on curve, wrong x");let S=g(F),P;try{P=r.sqrt(S)}catch(j){let oe=j instanceof Error?": "+j.message:"";throw new Error("bad point: is not on curve, sqrt error"+oe)}u();let V=r.isOdd(P);return(C&1)===1!==V&&(P=r.neg(P)),{x:F,y:P}}else if(w===b&&C===4){let F=r.BYTES,S=r.fromBytes(N.subarray(0,F)),P=r.fromBytes(N.subarray(F,F*2));if(!m(S,P))throw new Error("bad point: is not on curve");return{x:S,y:P}}else throw new Error(`bad point: got length ${w}, expected compressed=${v} or uncompressed=${b}`)}let f=e.toBytes||d,p=e.fromBytes||h;function g(M){let v=r.sqr(M),b=r.mul(v,M);return r.add(r.add(b,r.mul(M,s.a)),s.b)}function m(M,v){let b=r.sqr(v),w=g(M);return r.eql(b,w)}if(!m(s.Gx,s.Gy))throw new Error("bad curve params: generator point");let y=r.mul(r.pow(s.a,qv),Cre),E=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(y,E)))throw new Error("bad curve params: a or b");function I(M,v,b=!1){if(!r.isValid(v)||b&&r.is0(v))throw new Error(`bad point coordinate ${M}`);return v}function L(M){if(!(M instanceof T))throw new Error("ProjectivePoint expected")}function k(M){if(!c||!c.basises)throw new Error("no endo");return Ire(M,c.basises,i.ORDER)}let D=u3((M,v)=>{let{X:b,Y:w,Z:C}=M;if(r.eql(C,r.ONE))return{x:b,y:w};let N=M.is0();v==null&&(v=N?r.ONE:r.inv(C));let F=r.mul(b,v),S=r.mul(w,v),P=r.mul(C,v);if(N)return{x:r.ZERO,y:r.ZERO};if(!r.eql(P,r.ONE))throw new Error("invZ was invalid");return{x:F,y:S}}),B=u3(M=>{if(M.is0()){if(e.allowInfinityPoint&&!r.is0(M.Y))return;throw new Error("bad point: ZERO")}let{x:v,y:b}=M.toAffine();if(!r.isValid(v)||!r.isValid(b))throw new Error("bad point: x or y not field elements");if(!m(v,b))throw new Error("bad point: equation left != right");if(!M.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function U(M,v,b,w,C){return b=new T(r.mul(b.X,M),b.Y,b.Z),v=Jv(w,v),b=Jv(C,b),v.add(b)}class T{constructor(v,b,w){this.X=I("x",v),this.Y=I("y",b,!0),this.Z=I("z",w),Object.freeze(this)}static CURVE(){return s}static fromAffine(v){let{x:b,y:w}=v||{};if(!v||!r.isValid(b)||!r.isValid(w))throw new Error("invalid affine point");if(v instanceof T)throw new Error("projective point not allowed");return r.is0(b)&&r.is0(w)?T.ZERO:new T(b,w,r.ONE)}static fromBytes(v){let b=T.fromAffine(p(kl(v,void 0,"point")));return b.assertValidity(),b}static fromHex(v){return T.fromBytes(rr("pointHex",v))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(v=8,b=!0){return W.createCache(this,v),b||this.multiply(qv),this}assertValidity(){B(this)}hasEvenY(){let{y:v}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(v)}equals(v){L(v);let{X:b,Y:w,Z:C}=this,{X:N,Y:F,Z:S}=v,P=r.eql(r.mul(b,S),r.mul(N,C)),V=r.eql(r.mul(w,S),r.mul(F,C));return P&&V}negate(){return new T(this.X,r.neg(this.Y),this.Z)}double(){let{a:v,b}=s,w=r.mul(b,qv),{X:C,Y:N,Z:F}=this,S=r.ZERO,P=r.ZERO,V=r.ZERO,j=r.mul(C,C),oe=r.mul(N,N),ee=r.mul(F,F),Q=r.mul(C,N);return Q=r.add(Q,Q),V=r.mul(C,F),V=r.add(V,V),S=r.mul(v,V),P=r.mul(w,ee),P=r.add(S,P),S=r.sub(oe,P),P=r.add(oe,P),P=r.mul(S,P),S=r.mul(Q,S),V=r.mul(w,V),ee=r.mul(v,ee),Q=r.sub(j,ee),Q=r.mul(v,Q),Q=r.add(Q,V),V=r.add(j,j),j=r.add(V,j),j=r.add(j,ee),j=r.mul(j,Q),P=r.add(P,j),ee=r.mul(N,F),ee=r.add(ee,ee),j=r.mul(ee,Q),S=r.sub(S,j),V=r.mul(ee,oe),V=r.add(V,V),V=r.add(V,V),new T(S,P,V)}add(v){L(v);let{X:b,Y:w,Z:C}=this,{X:N,Y:F,Z:S}=v,P=r.ZERO,V=r.ZERO,j=r.ZERO,oe=s.a,ee=r.mul(s.b,qv),Q=r.mul(b,N),ae=r.mul(w,F),te=r.mul(C,S),be=r.add(b,w),re=r.add(N,F);be=r.mul(be,re),re=r.add(Q,ae),be=r.sub(be,re),re=r.add(b,C);let Ce=r.add(N,S);return re=r.mul(re,Ce),Ce=r.add(Q,te),re=r.sub(re,Ce),Ce=r.add(w,C),P=r.add(F,S),Ce=r.mul(Ce,P),P=r.add(ae,te),Ce=r.sub(Ce,P),j=r.mul(oe,re),P=r.mul(ee,te),j=r.add(P,j),P=r.sub(ae,j),j=r.add(ae,j),V=r.mul(P,j),ae=r.add(Q,Q),ae=r.add(ae,Q),te=r.mul(oe,te),re=r.mul(ee,re),ae=r.add(ae,te),te=r.sub(Q,te),te=r.mul(oe,te),re=r.add(re,te),Q=r.mul(ae,re),V=r.add(V,Q),Q=r.mul(Ce,re),P=r.mul(be,P),P=r.sub(P,Q),Q=r.mul(be,ae),j=r.mul(Ce,j),j=r.add(j,Q),new T(P,V,j)}subtract(v){return this.add(v.negate())}is0(){return this.equals(T.ZERO)}multiply(v){let{endo:b}=e;if(!i.isValidNot0(v))throw new Error("invalid scalar: out of range");let w,C,N=F=>W.cached(this,F,S=>v_(T,S));if(b){let{k1neg:F,k1:S,k2neg:P,k2:V}=k(v),{p:j,f:oe}=N(S),{p:ee,f:Q}=N(V);C=oe.add(Q),w=U(b.beta,j,ee,F,P)}else{let{p:F,f:S}=N(v);w=F,C=S}return v_(T,[w,C])[0]}multiplyUnsafe(v){let{endo:b}=e,w=this;if(!i.isValid(v))throw new Error("invalid scalar: out of range");if(v===$o||w.is0())return T.ZERO;if(v===qd)return w;if(W.hasCache(this))return this.multiply(v);if(b){let{k1neg:C,k1:N,k2neg:F,k2:S}=k(v),{p1:P,p2:V}=lre(T,w,N,S);return U(b.beta,P,V,C,F)}else return W.unsafe(w,v)}multiplyAndAddUnsafe(v,b,w){let C=this.multiplyUnsafe(b).add(v.multiplyUnsafe(w));return C.is0()?void 0:C}toAffine(v){return D(this,v)}isTorsionFree(){let{isTorsionFree:v}=e;return o===qd?!0:v?v(T,this):W.unsafe(this,a).is0()}clearCofactor(){let{clearCofactor:v}=e;return o===qd?this:v?v(T,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(v=!0){return Qv(v,"isCompressed"),this.assertValidity(),f(T,this,v)}toHex(v=!0){return $d(this.toBytes(v))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(v=!0){return this.toBytes(v)}_setWindowSize(v){this.precompute(v)}static normalizeZ(v){return v_(T,v)}static msm(v,b){return ure(T,i,v,b)}static fromPrivateKey(v){return T.BASE.multiply(Vd(i,v))}}T.BASE=new T(s.Gx,s.Gy,r.ONE),T.ZERO=new T(r.ZERO,r.ONE,r.ZERO),T.Fp=r,T.Fn=i;let $=i.BITS,W=new H_(T,e.endo?Math.ceil($/2):$);return T.BASE.precompute(8),T}function HU(n){return Uint8Array.of(n?2:3)}function $U(n,e){return{secretKey:e.BYTES,publicKey:1+n.BYTES,publicKeyUncompressed:1+2*n.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function Are(n,e={}){let{Fn:t}=n,r=e.randomBytes||Vl,i=Object.assign($U(n.Fp,t),{seed:FU(t.ORDER)});function s(h){try{return!!Vd(t,h)}catch{return!1}}function o(h,f){let{publicKey:p,publicKeyUncompressed:g}=i;try{let m=h.length;return f===!0&&m!==p||f===!1&&m!==g?!1:!!n.fromBytes(h)}catch{return!1}}function a(h=r(i.seed)){return ore(kl(h,i.seed,"seed"),t.ORDER)}function c(h,f=!0){return n.BASE.multiply(Vd(t,h)).toBytes(f)}function l(h){let f=a(h);return{secretKey:f,publicKey:c(f)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof n)return!0;let{secretKey:f,publicKey:p,publicKeyUncompressed:g}=i;if(t.allowedLengths||f===p)return;let m=rr("key",h).length;return m===p||m===g}function d(h,f,p=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(f)===!1)throw new Error("second arg must be public key");let g=Vd(t,h);return n.fromHex(f).multiply(g).toBytes(p)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:l,Point:n,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:h=>Vd(t,h),precompute(h=8,f=n.BASE){return f.precompute(h,!1)}},lengths:i})}function _re(n,e,t={}){t0(e),c0(t,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let r=t.randomBytes||Vl,i=t.hmac||((b,...w)=>s0(e,b,Za(...w))),{Fp:s,Fn:o}=n,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:f}=Are(n,t),p={prehash:!1,lowS:typeof t.lowS=="boolean"?t.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function m(b){let w=a>>qd;return b>w}function y(b,w){if(!o.isValidNot0(w))throw new Error(`invalid signature ${b}: out of range 1..Point.Fn.ORDER`);return w}function E(b,w){q_(w);let C=f.signature,N=w==="compact"?C:w==="recovered"?C+1:void 0;return kl(b,N,`${w} signature`)}class I{constructor(w,C,N){this.r=y("r",w),this.s=y("s",C),N!=null&&(this.recovery=N),Object.freeze(this)}static fromBytes(w,C=g){E(w,C);let N;if(C==="der"){let{r:V,s:j}=Vo.toSig(kl(w));return new I(V,j)}C==="recovered"&&(N=w[0],C="compact",w=w.subarray(1));let F=o.BYTES,S=w.subarray(0,F),P=w.subarray(F,F*2);return new I(o.fromBytes(S),o.fromBytes(P),N)}static fromHex(w,C){return this.fromBytes(Gv(w),C)}addRecoveryBit(w){return new I(this.r,this.s,w)}recoverPublicKey(w){let C=s.ORDER,{r:N,s:F,recovery:S}=this;if(S==null||![0,1,2,3].includes(S))throw new Error("recovery id invalid");if(a*VU<C&&S>1)throw new Error("recovery id is ambiguous for h>1 curve");let P=S===2||S===3?N+a:N;if(!s.isValid(P))throw new Error("recovery id 2 or 3 invalid");let V=s.toBytes(P),j=n.fromBytes(Za(HU((S&1)===0),V)),oe=o.inv(P),ee=k(rr("msgHash",w)),Q=o.create(-ee*oe),ae=o.create(F*oe),te=n.BASE.multiplyUnsafe(Q).add(j.multiplyUnsafe(ae));if(te.is0())throw new Error("point at infinify");return te.assertValidity(),te}hasHighS(){return m(this.s)}toBytes(w=g){if(q_(w),w==="der")return Gv(Vo.hexFromSig(this));let C=o.toBytes(this.r),N=o.toBytes(this.s);if(w==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Za(Uint8Array.of(this.recovery),C,N)}return Za(C,N)}toHex(w){return $d(this.toBytes(w))}assertValidity(){}static fromCompact(w){return I.fromBytes(rr("sig",w),"compact")}static fromDER(w){return I.fromBytes(rr("sig",w),"der")}normalizeS(){return this.hasHighS()?new I(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return $d(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return $d(this.toBytes("compact"))}}let L=t.bits2int||function(b){if(b.length>8192)throw new Error("input is too large");let w=a0(b),C=b.length*8-c;return C>0?w>>BigInt(C):w},k=t.bits2int_modN||function(b){return o.create(L(b))},D=Jp(c);function B(b){return V_("num < 2^"+c,b,$o,D),o.toBytes(b)}function U(b,w){return kl(b,void 0,"message"),w?kl(e(b),void 0,"prehashed message"):b}function T(b,w,C){if(["recovered","canonical"].some(ae=>ae in C))throw new Error("sign() legacy options not supported");let{lowS:N,prehash:F,extraEntropy:S}=C_(C,p);b=U(b,F);let P=k(b),V=Vd(o,w),j=[B(V),B(P)];if(S!=null&&S!==!1){let ae=S===!0?r(f.secretKey):S;j.push(rr("extraEntropy",ae))}let oe=Za(...j),ee=P;function Q(ae){let te=L(ae);if(!o.isValidNot0(te))return;let be=o.inv(te),re=n.BASE.multiply(te).toAffine(),Ce=o.create(re.x);if(Ce===$o)return;let kt=o.create(be*o.create(ee+Ce*V));if(kt===$o)return;let St=(re.x===Ce?0:2)|Number(re.y&qd),Wt=kt;return N&&m(kt)&&(Wt=o.neg(kt),St^=1),new I(Ce,Wt,St)}return{seed:oe,k2sig:Q}}function $(b,w,C={}){b=rr("message",b);let{seed:N,k2sig:F}=T(b,w,C);return Jne(e.outputLen,o.BYTES,i)(N,F)}function W(b){let w,C=typeof b=="string"||e0(b),N=!C&&b!==null&&typeof b=="object"&&typeof b.r=="bigint"&&typeof b.s=="bigint";if(!C&&!N)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(N)w=new I(b.r,b.s);else if(C){try{w=I.fromBytes(rr("sig",b),"der")}catch(F){if(!(F instanceof Vo.Err))throw F}if(!w)try{w=I.fromBytes(rr("sig",b),"compact")}catch{return!1}}return w||!1}function M(b,w,C,N={}){let{lowS:F,prehash:S,format:P}=C_(N,p);if(C=rr("publicKey",C),w=U(rr("message",w),S),"strict"in N)throw new Error("options.strict was renamed to lowS");let V=P===void 0?W(b):I.fromBytes(rr("sig",b),P);if(V===!1)return!1;try{let j=n.fromBytes(C);if(F&&V.hasHighS())return!1;let{r:oe,s:ee}=V,Q=k(w),ae=o.inv(ee),te=o.create(Q*ae),be=o.create(oe*ae),re=n.BASE.multiplyUnsafe(te).add(j.multiplyUnsafe(be));return re.is0()?!1:o.create(re.x)===oe}catch{return!1}}function v(b,w,C={}){let{prehash:N}=C_(C,p);return w=U(w,N),I.fromBytes(b,"recovered").recoverPublicKey(w).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:f,Point:n,sign:$,verify:M,recoverPublicKey:v,Signature:I,hash:e})}function Tre(n){let e={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},t=n.Fp,r=n.allowedPrivateKeyLengths?Array.from(new Set(n.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0,i=sc(e.n,{BITS:n.nBitLength,allowedLengths:r,modFromBytes:n.wrapPrivateKey}),s={Fp:t,Fn:i,allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes};return{CURVE:e,curveOpts:s}}function xre(n){let{CURVE:e,curveOpts:t}=Tre(n),r={hmac:n.hmac,randomBytes:n.randomBytes,lowS:n.lowS,bits2int:n.bits2int,bits2int_modN:n.bits2int_modN};return{CURVE:e,curveOpts:t,hash:n.hash,ecdsaOpts:r}}function Dre(n,e){let t=e.Point;return Object.assign({},e,{ProjectivePoint:t,CURVE:Object.assign({},n,kU(t.Fn.ORDER,t.Fn.BITS))})}function Nre(n){let{CURVE:e,curveOpts:t,hash:r,ecdsaOpts:i}=xre(n),s=Sre(e,t),o=_re(s,r,i);return Dre(n,o)}function G_(n,e){let t=r=>Nre(ge(H({},n),{hash:r}));return ge(H({},t(e)),{create:t})}var qU={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},zU={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},GU={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Rre=sc(qU.p),Ore=sc(zU.p),Pre=sc(GU.p),Mre=G_(ge(H({},qU),{Fp:Rre,lowS:!1}),n0);G_(ge(H({},zU),{Fp:Ore,lowS:!1}),Qte),G_(ge(H({},GU),{Fp:Pre,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),Kte);var kre=Mre,m1="base10",Tr="base16",zd="base64pad",l0="base64url",Yd="utf8",y1=0,Jd=1,Zp=2,Lre=0,w3=1,$p=12,w1=32;function Fre(){let n=$_.utils.randomPrivateKey(),e=$_.getPublicKey(n);return{privateKey:mt.toString(n,Tr),publicKey:mt.toString(e,Tr)}}function Bre(){let n=Vl(w1);return mt.toString(n,Tr)}function Ure(n,e){let t=$_.getSharedSecret(mt.fromString(n,Tr),mt.fromString(e,Tr)),r=Qne(o0,t,void 0,void 0,w1);return mt.toString(r,Tr)}function jre(n){let e=o0(mt.fromString(n,Tr));return mt.toString(e,Tr)}function Vre(n){let e=o0(mt.fromString(n,Yd));return mt.toString(e,Tr)}function v1(n){return mt.fromString(`${n}`,m1)}function Bl(n){return Number(mt.toString(n,m1))}function WU(n){return n.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function KU(n){let e=n.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function Hre(n){let e=v1(typeof n.type<"u"?n.type:y1);if(Bl(e)===Jd&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");let t=typeof n.senderPublicKey<"u"?mt.fromString(n.senderPublicKey,Tr):void 0,r=typeof n.iv<"u"?mt.fromString(n.iv,Tr):Vl($p),i=mt.fromString(n.symKey,Tr),s=SU(i,r).encrypt(mt.fromString(n.message,Yd)),o=b1({type:e,sealed:s,iv:r,senderPublicKey:t});return n.encoding===l0?WU(o):o}function $re(n){let e=mt.fromString(n.symKey,Tr),{sealed:t,iv:r}=u0({encoded:n.encoded,encoding:n.encoding}),i=SU(e,r).decrypt(t);if(i===null)throw new Error("Failed to decrypt");return mt.toString(i,Yd)}function qre(n,e){let t=v1(Zp),r=Vl($p),i=mt.fromString(n,Yd),s=b1({type:t,sealed:i,iv:r});return e===l0?WU(s):s}function zre(n,e){let{sealed:t}=u0({encoded:n,encoding:e});return mt.toString(t,Yd)}function b1(n){if(Bl(n.type)===Zp)return mt.toString(mt.concat([n.type,n.sealed]),zd);if(Bl(n.type)===Jd){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return mt.toString(mt.concat([n.type,n.senderPublicKey,n.iv,n.sealed]),zd)}return mt.toString(mt.concat([n.type,n.iv,n.sealed]),zd)}function u0(n){let e=(n.encoding||zd)===l0?KU(n.encoded):n.encoded,t=mt.fromString(e,zd),r=t.slice(Lre,w3),i=w3;if(Bl(r)===Jd){let c=i+w1,l=c+$p,u=t.slice(i,c),d=t.slice(c,l),h=t.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(Bl(r)===Zp){let c=t.slice(i),l=Vl($p);return{type:r,sealed:c,iv:l}}let s=i+$p,o=t.slice(i,s),a=t.slice(s);return{type:r,sealed:a,iv:o}}function Gre(n,e){let t=u0({encoded:n,encoding:e?.encoding});return QU({type:Bl(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?mt.toString(t.senderPublicKey,Tr):void 0,receiverPublicKey:e?.receiverPublicKey})}function QU(n){let e=n?.type||y1;if(e===Jd){if(typeof n?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof n?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n?.senderPublicKey,receiverPublicKey:n?.receiverPublicKey}}function Wre(n){return n.type===Jd&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}function Kre(n){return n.type===Zp}function YU(n){let e=Buffer.from(n.x,"base64"),t=Buffer.from(n.y,"base64");return mt.concat([new Uint8Array([4]),e,t])}function Qre(n,e){let[t,r,i]=n.split("."),s=Buffer.from(KU(i),"base64");if(s.length!==64)throw new Error("Invalid signature length");let o=s.slice(0,32),a=s.slice(32,64),c=`${t}.${r}`,l=o0(c),u=YU(e);if(!kre.verify(mt.concat([o,a]),l,u))throw new Error("Invalid signature");return Tee.decodeJWT(n).payload}var JU="irn";function Yre(n){return n?.relay||{protocol:JU}}function Jre(n){let e=xee.RELAY_JSONRPC[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var Zre=Object.defineProperty,Xre=Object.defineProperties,eie=Object.getOwnPropertyDescriptors,v3=Object.getOwnPropertySymbols,tie=Object.prototype.hasOwnProperty,nie=Object.prototype.propertyIsEnumerable,b3=(n,e,t)=>e in n?Zre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,S_=(n,e)=>{for(var t in e||(e={}))tie.call(e,t)&&b3(n,t,e[t]);if(v3)for(var t of v3(e))nie.call(e,t)&&b3(n,t,e[t]);return n},rie=(n,e)=>Xre(n,eie(e));function ZU(n,e="-"){let t={},r="relay"+e;return Object.keys(n).forEach(i=>{if(i.startsWith(r)){let s=i.replace(r,""),o=n[i];t[s]=o}}),t}function iie(n){if(!n.includes("wc:")){let l=n1(n);l!=null&&l.includes("wc:")&&(n=l)}n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;let e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,r=n.substring(0,e),i=n.substring(e+1,t).split("@"),s=typeof t<"u"?n.substring(t):"",o=new URLSearchParams(s),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:XU(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:ZU(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function XU(n){return n.startsWith("//")?n.substring(2):n}function ej(n,e="-"){let t="relay",r={};return Object.keys(n).forEach(i=>{let s=i,o=t+e+s;n[s]&&(r[o]=n[s])}),r}function sie(n){let e=new URLSearchParams,t=S_(S_(rie(S_({},ej(n.relay)),{symKey:n.symKey}),n.expiryTimestamp&&{expiryTimestamp:n.expiryTimestamp.toString()}),n.methods&&{methods:n.methods.join(",")});return Object.entries(t).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!==void 0&&e.append(r,String(i))}),`${n.protocol}:${n.topic}@${n.version}?${e}`}function oie(n,e,t){return`${n}?wc_ev=${t}&topic=${e}`}var aie=Object.defineProperty,cie=Object.defineProperties,lie=Object.getOwnPropertyDescriptors,E3=Object.getOwnPropertySymbols,uie=Object.prototype.hasOwnProperty,die=Object.prototype.propertyIsEnumerable,I3=(n,e,t)=>e in n?aie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,hie=(n,e)=>{for(var t in e||(e={}))uie.call(e,t)&&I3(n,t,e[t]);if(E3)for(var t of E3(e))die.call(e,t)&&I3(n,t,e[t]);return n},fie=(n,e)=>cie(n,lie(e));function Hl(n){let e=[];return n.forEach(t=>{let[r,i]=t.split(":");e.push(`${r}:${i}`)}),e}function tj(n){let e=[];return Object.values(n).forEach(t=>{e.push(...Hl(t.accounts))}),[...new Set(e)]}function pie(n){let e=[];return Object.values(n).forEach(t=>{e.push(...t.methods)}),[...new Set(e)]}function gie(n){let e=[];return Object.values(n).forEach(t=>{e.push(...t.events)}),[...new Set(e)]}function nj(n,e){let t=[];return Object.values(n).forEach(r=>{Hl(r.accounts).includes(e)&&t.push(...r.methods)}),t}function rj(n,e){let t=[];return Object.values(n).forEach(r=>{Hl(r.accounts).includes(e)&&t.push(...r.events)}),t}function mie(n,e){let t=pj(n,e);if(t)throw new Error(t.message);let r={};for(let[i,s]of Object.entries(n))r[i]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return r}function yie(n){var e;let{proposal:{requiredNamespaces:t,optionalNamespaces:r={}},supportedNamespaces:i}=n,s=Gp(t),o=Gp(r),a={};Object.keys(i).forEach(u=>{let d=i[u].chains,h=i[u].methods,f=i[u].events,p=i[u].accounts;d.forEach(g=>{if(!p.some(m=>m.includes(g)))throw new Error(`No accounts provided for chain ${g} in namespace ${u}`)}),a[u]={chains:d,methods:h,events:f,accounts:p}});let c=mj(t,a,"approve()");if(c)throw new Error(c.message);let l={};if(!Object.keys(t).length&&!Object.keys(r).length)return a;Object.keys(s).forEach(u=>{let d=i[u].chains.filter(g=>{var m,y;return(y=(m=s[u])==null?void 0:m.chains)==null?void 0:y.includes(g)}),h=i[u].methods.filter(g=>{var m,y;return(y=(m=s[u])==null?void 0:m.methods)==null?void 0:y.includes(g)}),f=i[u].events.filter(g=>{var m,y;return(y=(m=s[u])==null?void 0:m.events)==null?void 0:y.includes(g)}),p=d.map(g=>i[u].accounts.filter(m=>m.includes(`${g}:`))).flat();l[u]={chains:d,methods:h,events:f,accounts:p}}),Object.keys(o).forEach(u=>{var d,h,f,p,g,m;if(!i[u])return;let y=(h=(d=o[u])==null?void 0:d.chains)==null?void 0:h.filter(k=>i[u].chains.includes(k)),E=i[u].methods.filter(k=>{var D,B;return(B=(D=o[u])==null?void 0:D.methods)==null?void 0:B.includes(k)}),I=i[u].events.filter(k=>{var D,B;return(B=(D=o[u])==null?void 0:D.events)==null?void 0:B.includes(k)}),L=y?.map(k=>i[u].accounts.filter(D=>D.includes(`${k}:`))).flat();l[u]={chains:Vi((f=l[u])==null?void 0:f.chains,y),methods:Vi((p=l[u])==null?void 0:p.methods,E),events:Vi((g=l[u])==null?void 0:g.events,I),accounts:Vi((m=l[u])==null?void 0:m.accounts,L)}});for(let[u,d]of Object.entries(l))(d.accounts.length===0||((e=d?.chains)==null?void 0:e.length)===0)&&delete l[u];return l}function E1(n){return n.includes(":")}function ij(n){return E1(n)?n.split(":")[0]:n}function Gp(n){var e,t,r;let i={};if(!d0(n))return i;for(let[s,o]of Object.entries(n)){let a=E1(s)?[s]:o.chains,c=o.methods||[],l=o.events||[],u=ij(s);i[u]=fie(hie({},i[u]),{chains:Vi(a,(e=i[u])==null?void 0:e.chains),methods:Vi(c,(t=i[u])==null?void 0:t.methods),events:Vi(l,(r=i[u])==null?void 0:r.events)})}return i}function sj(n){let e={};return n?.forEach(t=>{var r;let[i,s]=t.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[],methods:[]}),e[i].accounts.push(t),(r=e[i].chains)==null||r.push(`${i}:${s}`)}),e}function wie(n,e){e=e.map(r=>r.replace("did:pkh:",""));let t=sj(e);for(let[r,i]of Object.entries(t))i.methods?i.methods=Vi(i.methods,n):i.methods=n,i.events=["chainChanged","accountsChanged"];return t}function vie(n,e){var t,r,i,s,o,a;let c=Gp(n),l=Gp(e),u={},d=Object.keys(c).concat(Object.keys(l));for(let h of d)u[h]={chains:Vi((t=c[h])==null?void 0:t.chains,(r=l[h])==null?void 0:r.chains),methods:Vi((i=c[h])==null?void 0:i.methods,(s=l[h])==null?void 0:s.methods),events:Vi((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}var oj={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},aj={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Ho(n,e){let{message:t,code:r}=aj[n];return{message:e?`${t} ${e}`:t,code:r}}function Ul(n,e){let{message:t,code:r}=oj[n];return{message:e?`${t} ${e}`:t,code:r}}function Xp(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function d0(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function tc(n){return typeof n>"u"}function gi(n,e){return e&&tc(n)?!0:typeof n=="string"&&!!n.trim().length}function h0(n,e){return e&&tc(n)?!0:typeof n=="number"&&!isNaN(n)}function bie(n,e){let{requiredNamespaces:t}=e,r=Object.keys(n.namespaces),i=Object.keys(t),s=!0;return Xa(i,r)?(r.forEach(o=>{let{accounts:a,methods:c,events:l}=n.namespaces[o],u=Hl(a),d=t[o];(!Xa(Xv(o,d),u)||!Xa(d.methods,c)||!Xa(d.events,l))&&(s=!1)}),s):!1}function Wp(n){return gi(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function cj(n){if(gi(n,!1)&&n.includes(":")){let e=n.split(":");if(e.length===3){let t=e[0]+":"+e[1];return!!e[2]&&Wp(t)}}return!1}function Eie(n){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(gi(n,!1)){if(e(n))return!0;let t=n1(n);return e(t)}}catch{}return!1}function Iie(n){var e;return(e=n?.proposer)==null?void 0:e.publicKey}function Cie(n){return n?.topic}function Sie(n,e){let t=null;return gi(n?.publicKey,!1)||(t=Ho("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function W_(n){let e=!0;return Xp(n)?n.length&&(e=n.every(t=>gi(t,!1))):e=!1,e}function lj(n,e,t){let r=null;return Xp(e)&&e.length?e.forEach(i=>{r||Wp(i)||(r=Ul("UNSUPPORTED_CHAINS",`${t}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):Wp(n)||(r=Ul("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function uj(n,e,t){let r=null;return Object.entries(n).forEach(([i,s])=>{if(r)return;let o=lj(i,Xv(i,s),`${e} ${t}`);o&&(r=o)}),r}function dj(n,e){let t=null;return Xp(n)?n.forEach(r=>{t||cj(r)||(t=Ul("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):t=Ul("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function hj(n,e){let t=null;return Object.values(n).forEach(r=>{if(t)return;let i=dj(r?.accounts,`${e} namespace`);i&&(t=i)}),t}function fj(n,e){let t=null;return W_(n?.methods)?W_(n?.events)||(t=Ul("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ul("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function I1(n,e){let t=null;return Object.values(n).forEach(r=>{if(t)return;let i=fj(r,`${e}, namespace`);i&&(t=i)}),t}function Aie(n,e,t){let r=null;if(n&&d0(n)){let i=I1(n,e);i&&(r=i);let s=uj(n,e,t);s&&(r=s)}else r=Ho("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return r}function pj(n,e){let t=null;if(n&&d0(n)){let r=I1(n,e);r&&(t=r);let i=hj(n,e);i&&(t=i)}else t=Ho("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function gj(n){return gi(n.protocol,!0)}function _ie(n,e){let t=!1;return e&&!n?t=!0:n&&Xp(n)&&n.length&&n.forEach(r=>{t=gj(r)}),t}function Tie(n){return typeof n=="number"}function xie(n){return typeof n<"u"&&typeof n!==null}function Die(n){return!(!n||typeof n!="object"||!n.code||!h0(n.code,!1)||!n.message||!gi(n.message,!1))}function Nie(n){return!(tc(n)||!gi(n.method,!1))}function Rie(n){return!(tc(n)||tc(n.result)&&tc(n.error)||!h0(n.id,!1)||!gi(n.jsonrpc,!1))}function Oie(n){return!(tc(n)||!gi(n.name,!1))}function Pie(n,e){return!(!Wp(e)||!tj(n).includes(e))}function Mie(n,e,t){return gi(t,!1)?nj(n,e).includes(t):!1}function kie(n,e,t){return gi(t,!1)?rj(n,e).includes(t):!1}function mj(n,e,t){let r=null,i=Lie(n),s=Fie(e),o=Object.keys(i),a=Object.keys(s),c=C3(Object.keys(n)),l=C3(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=Ho("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Xa(o,a)||(r=Ho("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;let h=Hl(e[d].accounts);h.includes(d)||(r=Ho("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(Xa(i[d].methods,s[d].methods)?Xa(i[d].events,s[d].events)||(r=Ho("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${d}`)):r=Ho("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function Lie(n){let e={};return Object.keys(n).forEach(t=>{var r;t.includes(":")?e[t]=n[t]:(r=n[t].chains)==null||r.forEach(i=>{e[i]={methods:n[t].methods,events:n[t].events}})}),e}function C3(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Fie(n){let e={};return Object.keys(n).forEach(t=>{t.includes(":")?e[t]=n[t]:Hl(n[t].accounts)?.forEach(i=>{e[i]={accounts:n[t].accounts.filter(s=>s.includes(`${i}:`)),methods:n[t].methods,events:n[t].events}})}),e}function Bie(n,e){return h0(n,!1)&&n<=e.max&&n>=e.min}function Uie(){let n=jl();return new Promise(e=>{switch(n){case Ar.browser:e(yj());break;case Ar.reactNative:e(wj());break;case Ar.node:e(vj());break;default:e(!0)}})}function yj(){return Qd()&&navigator?.onLine}async function wj(){return ic()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function vj(){return!0}function jie(n){switch(jl()){case Ar.browser:bj(n);break;case Ar.reactNative:Ej(n);break;case Ar.node:break}}function bj(n){!ic()&&Qd()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function Ej(n){ic()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>n(e?.isConnected))}function Vie(){var n;return Qd()&&qo.getDocument()?((n=qo.getDocument())==null?void 0:n.visibilityState)==="visible":!0}var A_={},K_=class{static get(e){return A_[e]}static set(e,t){A_[e]=t}static delete(e){delete A_[e]}};function Ij(n){let e=Kp.default.decode(n);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function Cj({publicKey:n,signature:e,payload:t}){var r;let i=Q_(t.method),s=128|parseInt(((r=t.version)==null?void 0:r.toString())||"4"),o=$ie(t.address),a=t.era==="00"?new Uint8Array([0]):Q_(t.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");let c=parseInt(t.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${Hie(t.tip)}`),d=zie(u),h=new Uint8Array([0,...n,o,...e,...a,...l,...d,...i]),f=qie(h.length+1);return new Uint8Array([...f,s,...h])}function Sj(n){let e=Q_(n),t=Dee.blake2b(e,void 0,32);return"0x"+Buffer.from(t).toString("hex")}function Q_(n){return new Uint8Array(n.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Hie(n){return n.startsWith("0x")?n.slice(2):n}function $ie(n){let e=Kp.default.decode(n)[0];return e===42?0:e===60?2:1}function qie(n){if(n<64)return new Uint8Array([n<<2]);if(n<16384){let e=n<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(n<1<<30){let e=n<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function zie(n){if(n<BigInt(1)<<BigInt(6))return new Uint8Array([Number(n<<BigInt(2))]);if(n<BigInt(1)<<BigInt(14)){let e=n<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(n<BigInt(1)<<BigInt(30)){let e=n<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function Gie(n){let e=Uint8Array.from(Buffer.from(n.signature,"hex")),t=Ij(n.transaction.address),r=Cj({publicKey:t,signature:e,payload:n.transaction}),i=Buffer.from(r).toString("hex");return Sj(i)}function Wie({logger:n,name:e}){let t=typeof n=="string"?Nee.generatePlatformLogger({opts:{level:n,name:e}}).logger:n;return t.level=typeof n=="string"?n:n.level,t}R.BASE10=m1,R.BASE16=Tr,R.BASE64=zd,R.BASE64URL=l0,R.COLON=$ee,R.DEFAULT_DEPTH=X_,R.EMPTY_SPACE=zv,R.ENV_MAP=Ar,R.INTERNAL_ERRORS=aj,R.LimitedSet=x_,R.MemoryStore=K_,R.ONE_THOUSAND=qee,R.REACT_NATIVE_PRODUCT=D3,R.RELAYER_DEFAULT_PROTOCOL=JU,R.SDK_ERRORS=oj,R.SDK_TYPE=R3,R.SLASH=N3,R.TYPE_0=y1,R.TYPE_1=Jd,R.TYPE_2=Zp,R.UTF8=Yd,R.addResourceToRecap=wU,R.addSignatureToExtrinsic=Cj,R.appendToQueryString=O3,R.assertType=Zee,R.assignAbilityToActions=l1,R.base64Decode=mU,R.base64Encode=gU,R.buildApprovedNamespaces=yie,R.buildAuthObject=mne,R.buildNamespacesFromAuth=wie,R.buildRecapStatement=bU,R.buildSignedExtrinsicHash=Gie,R.calcExpiry=ute,R.capitalize=ite,R.capitalizeWord=U3,R.createDelayedPromise=ste,R.createEncodedRecap=bne,R.createExpiringPromise=ote,R.createLogger=Wie,R.createRecap=yU,R.decodeRecap=rc,R.decodeTypeByte=Bl,R.decodeTypeTwoEnvelope=zre,R.decrypt=$re,R.deriveExtrinsicHash=Sj,R.deriveSymKey=Ure,R.deserialize=u0,R.encodeRecap=r0,R.encodeTypeByte=v1,R.encodeTypeTwoEnvelope=qre,R.encrypt=Hre,R.engineEvent=hte,R.enumify=rte,R.extractSolanaTransactionId=nne,R.formatAccountId=A3,R.formatAccountWithChain=Oee,R.formatChainId=S3,R.formatDeeplinkUrl=j3,R.formatExpirerTarget=t1,R.formatIdTarget=cte,R.formatMessage=dU,R.formatMessageContext=Xee,R.formatRelayParams=ej,R.formatRelayRpcUrl=Yee,R.formatStatementFromRecap=d1,R.formatTopicTarget=ate,R.formatUA=L3,R.formatUri=sie,R.fromBase64=n1,R.generateKeyPair=Fre,R.generateRandomBytes32=Bre,R.getAccountsChains=Hl,R.getAccountsFromNamespaces=Mee,R.getAddressFromAccount=_3,R.getAddressesFromAccounts=Pee,R.getAlgorandTransactionId=sne,R.getAppId=Wee,R.getAppMetadata=P3,R.getBrowserOnlineStatus=yj,R.getChainFromAccount=T3,R.getChainsFromAccounts=x3,R.getChainsFromNamespace=Xv,R.getChainsFromNamespaces=kee,R.getChainsFromRecap=Cne,R.getChainsFromRequiredNamespaces=Lee,R.getCommonValuesInArrays=T_,R.getCryptoKeyFromKeyData=YU,R.getDecodedRecapFromResources=hU,R.getDeepLink=pte,R.getDidAddress=c1,R.getDidAddressNamespace=lU,R.getDidAddressSegments=Yp,R.getDidChainId=cU,R.getEnvironment=jl,R.getHttpUrl=Jee,R.getInternalError=Ho,R.getJavascriptID=k3,R.getJavascriptOS=M3,R.getLastItems=B3,R.getLinkModeURL=oie,R.getMethodsFromRecap=Ine,R.getNamespacedDidChainId=uU,R.getNamespacesChains=tj,R.getNamespacesEvents=gie,R.getNamespacesEventsForChainId=rj,R.getNamespacesFromAccounts=sj,R.getNamespacesMethods=pie,R.getNamespacesMethodsForChainId=nj,R.getNearTransactionIdFromSignedTransaction=ine,R.getNearUint8ArrayFromBytes=sU,R.getNodeOnlineStatus=vj,R.getReCapActions=pU,R.getReactNativeOnlineStatus=wj,R.getRecapAbilitiesFromResource=vne,R.getRecapFromResources=i0,R.getRecapResource=fU,R.getRelayClientMetadata=Qee,R.getRelayProtocolApi=Jre,R.getRelayProtocolName=Yre,R.getRequiredNamespacesFromNamespaces=mie,R.getSdkError=Ul,R.getSearchParamFromURL=gte,R.getSignDirectHash=one,R.getSuiDigest=rne,R.getUniqueValues=Z_,R.getWalletSendCallsHashes=ane,R.handleDeeplinkRedirect=fte,R.hasOverlap=Xa,R.hashEthereumMessage=o1,R.hashKey=jre,R.hashMessage=Vre,R.isAndroid=zee,R.isAppVisible=Vie,R.isBrowser=Qd,R.isCaipNamespace=E1,R.isConformingNamespaces=mj,R.isExpired=dte,R.isIframe=$3,R.isIos=Gee,R.isNode=e1,R.isOnline=Uie,R.isProposalStruct=Iie,R.isReactNative=ic,R.isRecap=u1,R.isSessionCompatible=bie,R.isSessionStruct=Cie,R.isTelegram=H3,R.isTestRun=yte,R.isTypeOneEnvelope=Wre,R.isTypeTwoEnvelope=Kre,R.isUndefined=tc,R.isValidAccountId=cj,R.isValidAccounts=dj,R.isValidActions=fj,R.isValidArray=Xp,R.isValidChainId=Wp,R.isValidChains=lj,R.isValidController=Sie,R.isValidEip1271Signature=iU,R.isValidEip191Signature=rU,R.isValidErrorReason=Die,R.isValidEvent=Oie,R.isValidId=Tie,R.isValidNamespaceAccounts=hj,R.isValidNamespaceActions=I1,R.isValidNamespaceChains=uj,R.isValidNamespaceMethodsOrEvents=W_,R.isValidNamespaces=pj,R.isValidNamespacesChainId=Pie,R.isValidNamespacesEvent=kie,R.isValidNamespacesRequest=Mie,R.isValidNumber=h0,R.isValidObject=d0,R.isValidParams=xie,R.isValidRecap=to,R.isValidRelay=gj,R.isValidRelays=_ie,R.isValidRequest=Nie,R.isValidRequestExpiry=Bie,R.isValidRequiredNamespaces=Aie,R.isValidResponse=Rie,R.isValidString=gi,R.isValidUrl=Eie,R.mapEntries=nte,R.mapToObj=ete,R.mergeArrays=Vi,R.mergeEncodedRecaps=Ene,R.mergeRecaps=vU,R.mergeRequiredAndOptionalNamespaces=vie,R.normalizeNamespaces=Gp,R.objToMap=tte,R.openDeeplink=V3,R.parseAccountId=J_,R.parseChainId=Y_,R.parseContextNames=F3,R.parseExpirerTarget=lte,R.parseNamespaceKey=ij,R.parseRelayParams=ZU,R.parseTopic=XU,R.parseUri=iie,R.populateAppMetadata=Kee,R.populateAuthPayload=yne,R.recapHasResource=wne,R.serialize=b1,R.sleep=wte,R.ss58AddressToPublicKey=Ij,R.subscribeToBrowserNetworkChange=bj,R.subscribeToNetworkChange=jie,R.subscribeToReactNativeNetworkChange=Ej,R.toBase64=q3,R.uuidv4=mte,R.validateDecoding=Gre,R.validateEncoding=QU,R.validateSignedCacao=gne,R.verifyP256Jwt=Qre,R.verifySignature=nU});var H1={};Nh(H1,{ICore:()=>C1,ICrypto:()=>S1,IEchoClient:()=>L1,IEngine:()=>V1,IEngineEvents:()=>j1,IEventClient:()=>F1,IExpirer:()=>P1,IJsonRpcHistory:()=>A1,IKeyChain:()=>O1,IMessageTracker:()=>_1,IPairing:()=>M1,IPublisher:()=>T1,IRelayer:()=>x1,ISignClient:()=>U1,ISignClientEvents:()=>B1,IStore:()=>D1,ISubscriber:()=>R1,ISubscriberTopicMap:()=>N1,IVerify:()=>k1});var f0,Kie,Qie,Aj,C1,S1,Yie,Jie,Zie,A1,_1,T1,x1,D1,Xie,ese,tse,N1,R1,O1,P1,M1,k1,L1,F1,nse,rse,_j,B1,U1,j1,V1,$1=ni(()=>{"use strict";WN();f0=du(co()),Kie=Object.defineProperty,Qie=(n,e,t)=>e in n?Kie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Aj=(n,e,t)=>Qie(n,typeof e!="symbol"?e+"":e,t),C1=class extends Pr{constructor(e){super(),this.opts=e,Aj(this,"protocol","wc"),Aj(this,"version",2)}},S1=class{constructor(e,t,r){this.core=e,this.logger=t}},Yie=Object.defineProperty,Jie=(n,e,t)=>e in n?Yie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zie=(n,e,t)=>Jie(n,typeof e!="symbol"?e+"":e,t),A1=class extends Pr{constructor(e,t){super(),this.core=e,this.logger=t,Zie(this,"records",new Map)}},_1=class{constructor(e,t){this.logger=e,this.core=t}},T1=class extends Pr{constructor(e,t){super(),this.relayer=e,this.logger=t}},x1=class extends Pr{constructor(e){super()}},D1=class{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}},Xie=Object.defineProperty,ese=(n,e,t)=>e in n?Xie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,tse=(n,e,t)=>ese(n,typeof e!="symbol"?e+"":e,t),N1=class{constructor(){tse(this,"map",new Map)}},R1=class extends Pr{constructor(e,t){super(),this.relayer=e,this.logger=t}},O1=class{constructor(e,t){this.core=e,this.logger=t}},P1=class extends Pr{constructor(e,t){super(),this.core=e,this.logger=t}},M1=class{constructor(e,t){this.logger=e,this.core=t}},k1=class{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}},L1=class{constructor(e,t){this.projectId=e,this.logger=t}},F1=class{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}},nse=Object.defineProperty,rse=(n,e,t)=>e in n?nse(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_j=(n,e,t)=>rse(n,typeof e!="symbol"?e+"":e,t),B1=class extends f0.default{constructor(){super()}},U1=class{constructor(e){this.opts=e,_j(this,"protocol","wc"),_j(this,"version",2)}},j1=class extends f0.EventEmitter{constructor(){super()}},V1=class{constructor(e){this.client=e}}});var V8=Bs(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var ql=co(),zl=(QN(),Fe(KN)),ise=(JN(),Fe(YN)),Ot=Uv(),Ds=($1(),Fe(H1)),Ne=hu(),q1=(dE(),Fe($N)),K1=($g(),Fe(Hg)),q=eg(),sse=(zg(),Fe(qg)),ose=(Wg(),Fe(Gg)),xr=(pu(),Fe(fu)),ase=(XN(),Fe(ZN)),cse=Vg();function pT(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}function lse(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}}),e.default=n,Object.freeze(e)}var use=pT(ql),dse=pT(ise),p0=lse(K1),hse=pT(ase),gT="wc",mT=2,ag="core",xs=`${gT}@2:${ag}:`,Qj={name:ag,logger:"error"},Yj={database:":memory:"},Jj="crypto",Q1="client_ed25519_seed",Zj=Ne.ONE_DAY,Xj="keychain",e8="0.3",t8="messages",n8="0.3",r8=Ne.SIX_HOURS,i8="publisher",s8="irn",o8="error",yT="wss://relay.walletconnect.org",a8="relayer",dn={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},c8="_subscription",yi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},l8=.1,fse={database:":memory:"},g0="2.23.1",pse=1e4,$l={link_mode:"link_mode",relay:"relay"},ig={inbound:"inbound",outbound:"outbound"},u8="0.3",d8="WALLETCONNECT_CLIENT_ID",Y1="WALLETCONNECT_LINK_MODE_APPS",Jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},gse=Ne.THIRTY_DAYS,h8="subscription",f8="0.3",mse=Ne.FIVE_SECONDS*1e3,p8="pairing",g8="0.3",yse=Ne.THIRTY_DAYS,eh={wc_pairingDelete:{req:{ttl:Ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:Ne.ONE_DAY,prompt:!1,tag:0}}},th={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},qi={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},m8="history",y8="0.3",w8="expirer",zi={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},v8="0.3",wse=Ne.ONE_DAY,b8="verify-api",vse="https://verify.walletconnect.com",E8="https://verify.walletconnect.org",sg=E8,I8=`${sg}/v3`,C8=[vse,E8],S8="echo",A8="https://echo.walletconnect.com",bse="event-client",ro={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Go={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Ese={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},Ise={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},Cse={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Sse={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},_8=.1,T8="event-client",x8=86400,D8="https://pulse.walletconnect.org/batch";function Ase(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<n.length;i++){var s=n.charAt(i),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=i}var a=n.length,c=n.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,y=0,E=p.length;y!==E&&p[y]===0;)y++,g++;for(var I=(E-y)*u+1>>>0,L=new Uint8Array(I);y!==E;){for(var k=p[y],D=0,B=I-1;(k!==0||D<m)&&B!==-1;B--,D++)k+=256*L[B]>>>0,L[B]=k%a>>>0,k=k/a>>>0;if(k!==0)throw new Error("Non-zero carry");m=D,y++}for(var U=I-m;U!==I&&L[U]===0;)U++;for(var T=c.repeat(g);U<I;++U)T+=n.charAt(L[U]);return T}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,y=0;p[g]===c;)m++,g++;for(var E=(p.length-g)*l+1>>>0,I=new Uint8Array(E);p[g];){var L=t[p.charCodeAt(g)];if(L===255)return;for(var k=0,D=E-1;(L!==0||k<y)&&D!==-1;D--,k++)L+=a*I[D]>>>0,I[D]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");y=k,g++}if(p[g]!==" "){for(var B=E-y;B!==E&&I[B]===0;)B++;for(var U=new Uint8Array(m+(E-B)),T=m;B!==E;)U[T++]=I[B++];return U}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var _se=Ase,Tse=_se,N8=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},xse=n=>new TextEncoder().encode(n),Dse=n=>new TextDecoder().decode(n),J1=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Z1=class{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return R8(this,e)}},X1=class{constructor(e){this.decoders=e}or(e){return R8(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},R8=(n,e)=>new X1(H(H({},n.decoders||{[n.prefix]:n}),e.decoders||{[e.prefix]:e})),eT=class{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new J1(e,t,r),this.decoder=new Z1(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},D0=({name:n,prefix:e,encode:t,decode:r})=>new eT(n,e,t,r),cg=({prefix:n,name:e,alphabet:t})=>{let{encode:r,decode:i}=Tse(t,e);return D0({prefix:n,name:e,encode:r,decode:s=>N8(i(s))})},Nse=(n,e,t,r)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=n.length;for(;n[s-1]==="=";)--s;let o=new Uint8Array(s*t/8|0),a=0,c=0,l=0;for(let u=0;u<s;++u){let d=i[n[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Rse=(n,e,t)=>{let r=e[e.length-1]==="=",i=(1<<t)-1,s="",o=0,a=0;for(let c=0;c<n.length;++c)for(a=a<<8|n[c],o+=8;o>t;)o-=t,s+=e[i&a>>o];if(o&&(s+=e[i&a<<t-o]),r)for(;s.length*t&7;)s+="=";return s},jn=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>D0({prefix:e,name:n,encode(i){return Rse(i,r,t)},decode(i){return Nse(i,r,t,n)}}),Ose=D0({prefix:"\0",name:"identity",encode:n=>Dse(n),decode:n=>xse(n)}),Pse=Object.freeze({__proto__:null,identity:Ose}),Mse=jn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),kse=Object.freeze({__proto__:null,base2:Mse}),Lse=jn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Fse=Object.freeze({__proto__:null,base8:Lse}),Bse=cg({prefix:"9",name:"base10",alphabet:"0123456789"}),Use=Object.freeze({__proto__:null,base10:Bse}),jse=jn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Vse=jn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Hse=Object.freeze({__proto__:null,base16:jse,base16upper:Vse}),$se=jn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qse=jn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),zse=jn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Gse=jn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Wse=jn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kse=jn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qse=jn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Yse=jn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Jse=jn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Zse=Object.freeze({__proto__:null,base32:$se,base32upper:qse,base32pad:zse,base32padupper:Gse,base32hex:Wse,base32hexupper:Kse,base32hexpad:Qse,base32hexpadupper:Yse,base32z:Jse}),Xse=cg({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),eoe=cg({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),toe=Object.freeze({__proto__:null,base36:Xse,base36upper:eoe}),noe=cg({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),roe=cg({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ioe=Object.freeze({__proto__:null,base58btc:noe,base58flickr:roe}),soe=jn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ooe=jn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),aoe=jn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),coe=jn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),loe=Object.freeze({__proto__:null,base64:soe,base64pad:ooe,base64url:aoe,base64urlpad:coe}),O8=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),uoe=O8.reduce((n,e,t)=>(n[t]=e,n),[]),doe=O8.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function hoe(n){return n.reduce((e,t)=>(e+=uoe[t],e),"")}function foe(n){let e=[];for(let t of n){let r=doe[t.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(r)}return new Uint8Array(e)}var poe=D0({prefix:"\u{1F680}",name:"base256emoji",encode:hoe,decode:foe}),goe=Object.freeze({__proto__:null,base256emoji:poe}),moe=P8,Tj=128,yoe=127,woe=~yoe,voe=Math.pow(2,31);function P8(n,e,t){e=e||[],t=t||0;for(var r=t;n>=voe;)e[t++]=n&255|Tj,n/=128;for(;n&woe;)e[t++]=n&255|Tj,n>>>=7;return e[t]=n|0,P8.bytes=t-r+1,e}var boe=tT,Eoe=128,xj=127;function tT(n,r){var t=0,r=r||0,i=0,s=r,o,a=n.length;do{if(s>=a)throw tT.bytes=0,new RangeError("Could not decode varint");o=n[s++],t+=i<28?(o&xj)<<i:(o&xj)*Math.pow(2,i),i+=7}while(o>=Eoe);return tT.bytes=s-r,t}var Ioe=Math.pow(2,7),Coe=Math.pow(2,14),Soe=Math.pow(2,21),Aoe=Math.pow(2,28),_oe=Math.pow(2,35),Toe=Math.pow(2,42),xoe=Math.pow(2,49),Doe=Math.pow(2,56),Noe=Math.pow(2,63),Roe=function(n){return n<Ioe?1:n<Coe?2:n<Soe?3:n<Aoe?4:n<_oe?5:n<Toe?6:n<xoe?7:n<Doe?8:n<Noe?9:10},Ooe={encode:moe,decode:boe,encodingLength:Roe},M8=Ooe,Dj=(n,e,t=0)=>(M8.encode(n,e,t),e),Nj=n=>M8.encodingLength(n),nT=(n,e)=>{let t=e.byteLength,r=Nj(n),i=r+Nj(t),s=new Uint8Array(i+t);return Dj(n,s,0),Dj(t,s,r),s.set(e,i),new rT(n,t,e,s)},rT=class{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}},k8=({name:n,code:e,encode:t})=>new iT(n,e,t),iT=class{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?nT(this.code,t):t.then(r=>nT(this.code,r))}else throw Error("Unknown type, must be binary type")}},L8=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),Poe=k8({name:"sha2-256",code:18,encode:L8("SHA-256")}),Moe=k8({name:"sha2-512",code:19,encode:L8("SHA-512")}),koe=Object.freeze({__proto__:null,sha256:Poe,sha512:Moe}),F8=0,Loe="identity",B8=N8,Foe=n=>nT(F8,B8(n)),Boe={code:F8,name:Loe,encode:B8,digest:Foe},Uoe=Object.freeze({__proto__:null,identity:Boe});new TextEncoder,new TextDecoder;var Rj=H(H(H(H(H(H(H(H(H(H({},Pse),kse),Fse),Use),Hse),Zse),toe),ioe),loe),goe);H(H({},koe),Uoe);function U8(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function joe(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?U8(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function j8(n,e,t,r){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:r}}}var Oj=j8("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),z1=j8("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);let e=joe(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),Voe=H({utf8:Oj,"utf-8":Oj,hex:Rj.base16,latin1:z1,ascii:z1,binary:z1},Rj);function Hoe(n,e="utf8"){let t=Voe[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?U8(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}var $oe=Object.defineProperty,qoe=(n,e,t)=>e in n?$oe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,no=(n,e,t)=>qoe(n,typeof e!="symbol"?e+"":e,t),m0=class{constructor(e,t){this.core=e,this.logger=t,no(this,"keychain",new Map),no(this,"name",Xj),no(this,"version",e8),no(this,"initialized",!1),no(this,"storagePrefix",xs),no(this,"init",async()=>{if(!this.initialized){let r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),no(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),no(this,"set",async(r,i)=>{this.isInitialized(),this.keychain.set(r,i),await this.persist()}),no(this,"get",r=>{this.isInitialized();let i=this.keychain.get(r);if(typeof i>"u"){let{message:s}=q.getInternalError("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(s)}return i}),no(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=Ot.generateChildLogger(t,this.name)}get context(){return Ot.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,q.mapToObj(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?q.objToMap(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},zoe=Object.defineProperty,Goe=(n,e,t)=>e in n?zoe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xn=(n,e,t)=>Goe(n,typeof e!="symbol"?e+"":e,t),y0=class{constructor(e,t,r){this.core=e,this.logger=t,xn(this,"name",Jj),xn(this,"keychain"),xn(this,"randomSessionIdentifier",q.generateRandomBytes32()),xn(this,"initialized",!1),xn(this,"clientId"),xn(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),xn(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),xn(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;let i=await this.getClientSeed(),s=p0.generateKeyPair(i),o=p0.encodeIss(s.publicKey);return this.clientId=o,o}),xn(this,"generateKeyPair",()=>{this.isInitialized();let i=q.generateKeyPair();return this.setPrivateKey(i.publicKey,i.privateKey)}),xn(this,"signJWT",async i=>{this.isInitialized();let s=await this.getClientSeed(),o=p0.generateKeyPair(s),a=this.randomSessionIdentifier,c=Zj;return await p0.signJWT(a,i,c,o)}),xn(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();let a=this.getPrivateKey(i),c=q.deriveSymKey(a,s);return this.setSymKey(c,o)}),xn(this,"setSymKey",async(i,s)=>{this.isInitialized();let o=s||q.hashKey(i);return await this.keychain.set(o,i),o}),xn(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),xn(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),xn(this,"encode",async(i,s,o)=>{this.isInitialized();let a=q.validateEncoding(o),c=q1.safeJsonStringify(s);if(q.isTypeTwoEnvelope(a))return q.encodeTypeTwoEnvelope(c,o?.encoding);if(q.isTypeOneEnvelope(a)){let h=a.senderPublicKey,f=a.receiverPublicKey;i=await this.generateSharedKey(h,f)}let l=this.getSymKey(i),{type:u,senderPublicKey:d}=a;return q.encrypt({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),xn(this,"decode",async(i,s,o)=>{this.isInitialized();let a=q.validateDecoding(s,o);if(q.isTypeTwoEnvelope(a)){let c=q.decodeTypeTwoEnvelope(s,o?.encoding);return q1.safeJsonParse(c)}if(q.isTypeOneEnvelope(a)){let c=a.receiverPublicKey,l=a.senderPublicKey;i=await this.generateSharedKey(c,l)}try{let c=this.getSymKey(i),l=q.decrypt({symKey:c,encoded:s,encoding:o?.encoding});return q1.safeJsonParse(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),xn(this,"getPayloadType",(i,s=q.BASE64)=>{let o=q.deserialize({encoded:i,encoding:s});return q.decodeTypeByte(o.type)}),xn(this,"getPayloadSenderPublicKey",(i,s=q.BASE64)=>{let o=q.deserialize({encoded:i,encoding:s});return o.senderPublicKey?sse.toString(o.senderPublicKey,q.BASE16):void 0}),this.core=e,this.logger=Ot.generateChildLogger(t,this.name),this.keychain=r||new m0(this.core,this.logger)}get context(){return Ot.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Q1)}catch{e=q.generateRandomBytes32(),await this.keychain.set(Q1,e)}return Hoe(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},Woe=Object.defineProperty,Koe=Object.defineProperties,Qoe=Object.getOwnPropertyDescriptors,Pj=Object.getOwnPropertySymbols,Yoe=Object.prototype.hasOwnProperty,Joe=Object.prototype.propertyIsEnumerable,sT=(n,e,t)=>e in n?Woe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zoe=(n,e)=>{for(var t in e||(e={}))Yoe.call(e,t)&&sT(n,t,e[t]);if(Pj)for(var t of Pj(e))Joe.call(e,t)&&sT(n,t,e[t]);return n},Xoe=(n,e)=>Koe(n,Qoe(e)),mi=(n,e,t)=>sT(n,typeof e!="symbol"?e+"":e,t),w0=class extends Ds.IMessageTracker{constructor(e,t){super(e,t),this.logger=e,this.core=t,mi(this,"messages",new Map),mi(this,"messagesWithoutClientAck",new Map),mi(this,"name",t8),mi(this,"version",n8),mi(this,"initialized",!1),mi(this,"storagePrefix",xs),mi(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);let i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),mi(this,"set",async(r,i,s)=>{this.isInitialized();let o=q.hashMessage(i),a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(r,a),s===ig.inbound){let c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,Xoe(Zoe({},c),{[o]:i}))}return await this.persist(),o}),mi(this,"get",r=>{this.isInitialized();let i=this.messages.get(r);return typeof i>"u"&&(i={}),i}),mi(this,"getWithoutAck",r=>{this.isInitialized();let i={};for(let s of r){let o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),mi(this,"has",(r,i)=>{this.isInitialized();let s=this.get(r),o=q.hashMessage(i);return typeof s[o]<"u"}),mi(this,"ack",async(r,i)=>{this.isInitialized();let s=this.messagesWithoutClientAck.get(r);if(typeof s>"u")return;let o=q.hashMessage(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,s),await this.persist()}),mi(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Ot.generateChildLogger(e,this.name),this.core=t}get context(){return Ot.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,q.mapToObj(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,q.mapToObj(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?q.objToMap(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?q.objToMap(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},eae=Object.defineProperty,tae=Object.defineProperties,nae=Object.getOwnPropertyDescriptors,Mj=Object.getOwnPropertySymbols,rae=Object.prototype.hasOwnProperty,iae=Object.prototype.propertyIsEnumerable,oT=(n,e,t)=>e in n?eae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zd=(n,e)=>{for(var t in e||(e={}))rae.call(e,t)&&oT(n,t,e[t]);if(Mj)for(var t of Mj(e))iae.call(e,t)&&oT(n,t,e[t]);return n},kj=(n,e)=>tae(n,nae(e)),$i=(n,e,t)=>oT(n,typeof e!="symbol"?e+"":e,t),aT=class extends Ds.IPublisher{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,$i(this,"events",new ql.EventEmitter),$i(this,"name",i8),$i(this,"queue",new Map),$i(this,"publishTimeout",Ne.toMiliseconds(Ne.ONE_MINUTE)),$i(this,"initialPublishTimeout",Ne.toMiliseconds(Ne.ONE_SECOND*15)),$i(this,"needsTransportRestart",!1),$i(this,"publish",async(r,i,s)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:i,opts:s}});let d=s?.ttl||r8,h=s?.prompt||!1,f=s?.tag||0,p=s?.id||xr.getBigIntRpcId().toString(),g=q.getRelayProtocolApi(q.getRelayProtocolName().protocol),m={id:p,method:s?.publishMethod||g.publish,params:Zd({topic:r,message:i,ttl:d,prompt:h,tag:f,attestation:s?.attestation},s?.tvf)},y=`Failed to publish payload, please try again. id:${p} tag:${f}`;try{q.isUndefined((o=m.params)==null?void 0:o.prompt)&&((a=m.params)==null||delete a.prompt),q.isUndefined((c=m.params)==null?void 0:c.tag)&&((l=m.params)==null||delete l.tag);let E=new Promise(async I=>{let L=({id:D})=>{var B;((B=m.id)==null?void 0:B.toString())===D.toString()&&(this.removeRequestFromQueue(D),this.relayer.events.removeListener(dn.publish,L),I())};this.relayer.events.on(dn.publish,L);let k=q.createExpiringPromise(new Promise((D,B)=>{this.rpcPublish(m,s).then(D).catch(U=>{this.logger.warn(U,U?.message),B(U)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${f}`);try{await k,this.events.removeListener(dn.publish,L)}catch(D){this.queue.set(p,{request:m,opts:s,attempt:1}),this.logger.warn(D,D?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:r,message:i,opts:s}}),await q.createExpiringPromise(E,this.publishTimeout,y)}catch(E){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(E),(u=s?.internal)!=null&&u.throwOnFailedPublish)throw E}finally{this.queue.delete(p)}}),$i(this,"publishCustom",async r=>{var i,s,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});let{payload:l,opts:u={}}=r,{attestation:d,tvf:h,publishMethod:f,prompt:p,tag:g,ttl:m=Ne.FIVE_MINUTES}=u,y=u.id||xr.getBigIntRpcId().toString(),E=q.getRelayProtocolApi(q.getRelayProtocolName().protocol),I=f||E.publish,L={id:y,method:I,params:Zd(kj(Zd({},l),{ttl:m,prompt:p,tag:g,attestation:d}),h)},k=`Failed to publish custom payload, please try again. id:${y} tag:${g}`;try{q.isUndefined((i=L.params)==null?void 0:i.prompt)&&((s=L.params)==null||delete s.prompt),q.isUndefined((o=L.params)==null?void 0:o.tag)&&((a=L.params)==null||delete a.tag);let D=new Promise(async B=>{let U=({id:$})=>{var W;((W=L.id)==null?void 0:W.toString())===$.toString()&&(this.removeRequestFromQueue($),this.relayer.events.removeListener(dn.publish,U),B())};this.relayer.events.on(dn.publish,U);let T=q.createExpiringPromise(new Promise(($,W)=>{this.rpcPublish(L,u).then($).catch(M=>{this.logger.warn(M,M?.message),W(M)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${I} id:${y} tag:${g}`);try{await T,this.events.removeListener(dn.publish,U)}catch($){this.queue.set(y,{request:L,opts:u,attempt:1}),this.logger.warn($,$?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:y,payload:l,opts:u}}),await q.createExpiringPromise(D,this.publishTimeout,k)}catch(D){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(D),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw D}finally{this.queue.delete(y)}}),$i(this,"on",(r,i)=>{this.events.on(r,i)}),$i(this,"once",(r,i)=>{this.events.once(r,i)}),$i(this,"off",(r,i)=>{this.events.off(r,i)}),$i(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.relayer=e,this.logger=Ot.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Ot.getLoggerContext(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});let r=await this.relayer.request(e);return this.relayer.events.emit(dn.publish,Zd(Zd({},e),t)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var r;let i=e.attempt+1;this.queue.set(t,kj(Zd({},e),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${i}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(zl.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(dn.connection_stalled);return}this.checkQueue()}),this.relayer.on(dn.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}},sae=Object.defineProperty,oae=(n,e,t)=>e in n?sae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Xd=(n,e,t)=>oae(n,typeof e!="symbol"?e+"":e,t),cT=class{constructor(){Xd(this,"map",new Map),Xd(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),Xd(this,"get",e=>this.map.get(e)||[]),Xd(this,"exists",(e,t)=>this.get(e).includes(t)),Xd(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(s=>s!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),Xd(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}},aae=Object.defineProperty,cae=Object.defineProperties,lae=Object.getOwnPropertyDescriptors,Lj=Object.getOwnPropertySymbols,uae=Object.prototype.hasOwnProperty,dae=Object.prototype.propertyIsEnumerable,lT=(n,e,t)=>e in n?aae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,tg=(n,e)=>{for(var t in e||(e={}))uae.call(e,t)&&lT(n,t,e[t]);if(Lj)for(var t of Lj(e))dae.call(e,t)&&lT(n,t,e[t]);return n},G1=(n,e)=>cae(n,lae(e)),Rt=(n,e,t)=>lT(n,typeof e!="symbol"?e+"":e,t),v0=class extends Ds.ISubscriber{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Rt(this,"subscriptions",new Map),Rt(this,"topicMap",new cT),Rt(this,"events",new ql.EventEmitter),Rt(this,"name",h8),Rt(this,"version",f8),Rt(this,"pending",new Map),Rt(this,"cached",[]),Rt(this,"initialized",!1),Rt(this,"storagePrefix",xs),Rt(this,"subscribeTimeout",Ne.toMiliseconds(Ne.ONE_MINUTE)),Rt(this,"initialSubscribeTimeout",Ne.toMiliseconds(Ne.ONE_SECOND*15)),Rt(this,"clientId"),Rt(this,"batchSubscribeTopicsLimit",500),Rt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Rt(this,"subscribe",async(r,i)=>{var s;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}});try{let o=q.getRelayProtocolName(i),a={topic:r,relay:o,transportType:i?.transportType};(s=i?.internal)!=null&&s.skipSubscribe||this.pending.set(r,a);let c=await this.rpcSubscribe(r,o,i);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Rt(this,"unsubscribe",async(r,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(r,i.id,i):await this.unsubscribeByTopic(r,i)}),Rt(this,"isSubscribed",r=>new Promise(i=>{i(this.topicMap.topics.includes(r))})),Rt(this,"isKnownTopic",r=>new Promise(i=>{i(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(s=>s.topic===r))})),Rt(this,"on",(r,i)=>{this.events.on(r,i)}),Rt(this,"once",(r,i)=>{this.events.once(r,i)}),Rt(this,"off",(r,i)=>{this.events.off(r,i)}),Rt(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),Rt(this,"start",async()=>{await this.onConnect()}),Rt(this,"stop",async()=>{await this.onDisconnect()}),Rt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Rt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;let r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}),Rt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(zl.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.events.on(Jr.created,async r=>{let i=Jr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(Jr.deleted,async r=>{let i=Jr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}),this.relayer=e,this.logger=Ot.generateChildLogger(t,this.name),this.clientId=""}get context(){return Ot.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=q.getRelayProtocolName(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let s=q.getSdkError("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,t,r){var i,s;let o=await this.getSubscriptionId(e);if((i=r?.internal)!=null&&i.skipSubscribe)return o;(!r||r?.transportType===$l.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});let a={method:q.getRelayProtocolApi(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});let c=(s=r?.internal)==null?void 0:s.throwOnFailedPublish;try{if(r?.transportType===$l.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},Ne.toMiliseconds(Ne.ONE_SECOND)),o;let l=new Promise(async d=>{let h=f=>{f.topic===e&&(this.events.removeListener(Jr.created,h),d(f.id))};this.events.on(Jr.created,h);try{let f=await q.createExpiringPromise(new Promise((p,g)=>{this.relayer.request(a).catch(m=>{this.logger.warn(m,m?.message),g(m)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Jr.created,h),d(f)}catch{}}),u=await q.createExpiringPromise(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(dn.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t=e[0].relay,r={method:q.getRelayProtocolApi(t.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await q.createExpiringPromise(new Promise(i=>{this.relayer.request(r).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(dn.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;let t=e[0].relay,r={method:q.getRelayProtocolApi(t.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let i;try{i=await await q.createExpiringPromise(new Promise((s,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(dn.connection_stalled)}return i}rpcUnsubscribe(e,t,r){let i={method:q.getRelayProtocolApi(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,G1(tg({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,tg({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,tg({},t)),this.topicMap.set(t.topic,e),this.events.emit(Jr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:r}=q.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Jr.deleted,G1(tg({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Jr.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Jr.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(t=>{var r;return t.topic===((r=this.subscriptions.get(t.id))==null?void 0:r.topic)})){let{message:t}=q.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>G1(tg({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await q.sleep(Ne.toMiliseconds(Ne.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return q.hashMessage(e+await this.getClientId())}},hae=Object.defineProperty,Fj=Object.getOwnPropertySymbols,fae=Object.prototype.hasOwnProperty,pae=Object.prototype.propertyIsEnumerable,uT=(n,e,t)=>e in n?hae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Bj=(n,e)=>{for(var t in e||(e={}))fae.call(e,t)&&uT(n,t,e[t]);if(Fj)for(var t of Fj(e))pae.call(e,t)&&uT(n,t,e[t]);return n},ot=(n,e,t)=>uT(n,typeof e!="symbol"?e+"":e,t),b0=class extends Ds.IRelayer{constructor(e){var t;super(e),ot(this,"protocol","wc"),ot(this,"version",2),ot(this,"core"),ot(this,"logger"),ot(this,"events",new ql.EventEmitter),ot(this,"provider"),ot(this,"messages"),ot(this,"subscriber"),ot(this,"publisher"),ot(this,"name",a8),ot(this,"transportExplicitlyClosed",!1),ot(this,"initialized",!1),ot(this,"connectionAttemptInProgress",!1),ot(this,"relayUrl"),ot(this,"projectId"),ot(this,"packageName"),ot(this,"bundleId"),ot(this,"hasExperiencedNetworkDisruption",!1),ot(this,"pingTimeout"),ot(this,"heartBeatTimeout",Ne.toMiliseconds(Ne.THIRTY_SECONDS+Ne.FIVE_SECONDS)),ot(this,"reconnectTimeout"),ot(this,"connectPromise"),ot(this,"reconnectInProgress",!1),ot(this,"requestsInFlight",[]),ot(this,"connectTimeout",Ne.toMiliseconds(Ne.ONE_SECOND*15)),ot(this,"request",async r=>{var i,s;this.logger.debug("Publishing Request Payload");let o=r.id||xr.getBigIntRpcId().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");let a=`${o}:${((s=r.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(a);let c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),ot(this,"resetPingTimeout",()=>{q.isNode()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,s,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null?void 0:s.terminate)==null||o.call(s)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),ot(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),ot(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(dn.connect)}),ot(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),ot(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(dn.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ot(this,"registerProviderListeners",()=>{this.provider.on(yi.payload,this.onPayloadHandler),this.provider.on(yi.connect,this.onConnectHandler),this.provider.on(yi.disconnect,this.onDisconnectHandler),this.provider.on(yi.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=q.createLogger({logger:(t=e.logger)!=null?t:o8,name:this.name}),this.messages=new w0(this.logger,e.core),this.subscriber=new v0(this,this.logger),this.publisher=new aT(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||yT,q.isAndroid()?this.packageName=q.getAppId():q.isIos()&&(this.bundleId=q.getAppId()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return Ot.getLoggerContext(this.logger)}get connected(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:$l.relay},ig.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var r,i,s;this.isInitialized(),(!(t!=null&&t.transportType)||t?.transportType==="relay")&&await this.toEstablishConnection();let o=typeof((r=t?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(i=t?.internal)==null?void 0:i.throwOnFailedPublish,a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c,l=u=>{u.topic===e&&(this.subscriber.off(Jr.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Jr.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,Bj({internal:{throwOnFailedPublish:o}},t)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await q.createExpiringPromise(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await q.isOnline())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let t=e.sort((r,i)=>r.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(let r of t)try{await this.onMessageEvent(r)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let i=q.calcExpiry(Ne.FIVE_MINUTES),s={topic:r,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,s)}this.events.emit(dn.message,e),await this.recordMessageEvent(e,ig.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(r,i)=>{let s=()=>{i(new Error("Connection interrupted while trying to connect"))};this.provider.once(yi.disconnect,s),await q.createExpiringPromise(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(yi.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{let c=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(yi.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(yi.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();let i=r;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(r=>setTimeout(r,Ne.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,r,i,s;if(q.isNode())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ose.JsonRpcProvider(new hse.default(q.formatRelayRpcUrl({sdkVersion:g0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),xr.isJsonRpcRequest(e)){if(!e.method.endsWith(c8))return;let t=e.params,{topic:r,message:i,publishedAt:s,attestation:o}=t.data,a={topic:r,message:i,publishedAt:s,transportType:$l.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Bj({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else xr.isJsonRpcResponse(e)&&this.events.emit(dn.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,ig.inbound),this.events.emit(dn.message,e))}async acknowledgePayload(e){let t=xr.formatJsonRpcResult(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(yi.payload,this.onPayloadHandler),this.provider.off(yi.connect,this.onConnectHandler),this.provider.off(yi.disconnect,this.onDisconnectHandler),this.provider.off(yi.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await q.isOnline();q.subscribeToNetworkChange(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(zl.HEARTBEAT_EVENTS.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&q.isAppVisible())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(t){this.logger.warn(t,t?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(dn.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Ne.toMiliseconds(l8)))))}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}};function gae(n,e){return n===e||Number.isNaN(n)&&Number.isNaN(e)}function Uj(n){return Object.getOwnPropertySymbols(n).filter(e=>Object.prototype.propertyIsEnumerable.call(n,e))}function jj(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}var mae="[object RegExp]",yae="[object String]",wae="[object Number]",vae="[object Boolean]",Vj="[object Arguments]",bae="[object Symbol]",Eae="[object Date]",Iae="[object Map]",Cae="[object Set]",Sae="[object Array]",Aae="[object Function]",_ae="[object ArrayBuffer]",W1="[object Object]",Tae="[object Error]",xae="[object DataView]",Dae="[object Uint8Array]",Nae="[object Uint8ClampedArray]",Rae="[object Uint16Array]",Oae="[object Uint32Array]",Pae="[object BigUint64Array]",Mae="[object Int8Array]",kae="[object Int16Array]",Lae="[object Int32Array]",Fae="[object BigInt64Array]",Bae="[object Float32Array]",Uae="[object Float64Array]";function jae(){}function Hj(n){if(!n||typeof n!="object")return!1;let e=Object.getPrototypeOf(n);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(n)==="[object Object]":!1}function Vae(n,e,t){return rg(n,e,void 0,void 0,void 0,void 0,t)}function rg(n,e,t,r,i,s,o){let a=o(n,e,t,r,i,s);if(a!==void 0)return a;if(typeof n==typeof e)switch(typeof n){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return n===e;case"number":return n===e||Object.is(n,e);case"function":return n===e;case"object":return og(n,e,s,o)}return og(n,e,s,o)}function og(n,e,t,r){if(Object.is(n,e))return!0;let i=jj(n),s=jj(e);if(i===Vj&&(i=W1),s===Vj&&(s=W1),i!==s)return!1;switch(i){case yae:return n.toString()===e.toString();case wae:{let c=n.valueOf(),l=e.valueOf();return gae(c,l)}case vae:case Eae:case bae:return Object.is(n.valueOf(),e.valueOf());case mae:return n.source===e.source&&n.flags===e.flags;case Aae:return n===e}t=t??new Map;let o=t.get(n),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(n,e),t.set(e,n);try{switch(i){case Iae:{if(n.size!==e.size)return!1;for(let[c,l]of n.entries())if(!e.has(c)||!rg(l,e.get(c),c,n,e,t,r))return!1;return!0}case Cae:{if(n.size!==e.size)return!1;let c=Array.from(n.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){let d=c[u],h=l.findIndex(f=>rg(d,f,void 0,n,e,t,r));if(h===-1)return!1;l.splice(h,1)}return!0}case Sae:case Dae:case Nae:case Rae:case Oae:case Pae:case Mae:case kae:case Lae:case Fae:case Bae:case Uae:{if(typeof Buffer<"u"&&Buffer.isBuffer(n)!==Buffer.isBuffer(e)||n.length!==e.length)return!1;for(let c=0;c<n.length;c++)if(!rg(n[c],e[c],c,n,e,t,r))return!1;return!0}case _ae:return n.byteLength!==e.byteLength?!1:og(new Uint8Array(n),new Uint8Array(e),t,r);case xae:return n.byteLength!==e.byteLength||n.byteOffset!==e.byteOffset?!1:og(new Uint8Array(n),new Uint8Array(e),t,r);case Tae:return n.name===e.name&&n.message===e.message;case W1:{if(!(og(n.constructor,e.constructor,t,r)||Hj(n)&&Hj(e)))return!1;let c=[...Object.keys(n),...Uj(n)],l=[...Object.keys(e),...Uj(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){let d=c[u],h=n[d];if(!Object.hasOwn(e,d))return!1;let f=e[d];if(!rg(h,f,d,n,e,t,r))return!1}return!0}default:return!1}}finally{t.delete(n),t.delete(e)}}function Hae(n,e){return Vae(n,e,jae)}var $ae=Object.defineProperty,$j=Object.getOwnPropertySymbols,qae=Object.prototype.hasOwnProperty,zae=Object.prototype.propertyIsEnumerable,dT=(n,e,t)=>e in n?$ae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qj=(n,e)=>{for(var t in e||(e={}))qae.call(e,t)&&dT(n,t,e[t]);if($j)for(var t of $j(e))zae.call(e,t)&&dT(n,t,e[t]);return n},Yr=(n,e,t)=>dT(n,typeof e!="symbol"?e+"":e,t),E0=class extends Ds.IStore{constructor(e,t,r,i=xs,s=void 0){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,Yr(this,"map",new Map),Yr(this,"version",u8),Yr(this,"cached",[]),Yr(this,"initialized",!1),Yr(this,"getKey"),Yr(this,"storagePrefix",xs),Yr(this,"recentlyDeleted",[]),Yr(this,"recentlyDeletedLimit",200),Yr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!q.isUndefined(o)?this.map.set(this.getKey(o),o):q.isProposalStruct(o)?this.map.set(o.id,o):q.isSessionStruct(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Yr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Yr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Yr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>Hae(a[c],o[c]))):this.values)),Yr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});let c=qj(qj({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Yr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Ot.generateChildLogger(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Ot.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:i}=q.getInternalError("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}let{message:r}=q.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:t}=q.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},Gae=Object.defineProperty,Wae=(n,e,t)=>e in n?Gae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Qe=(n,e,t)=>Wae(n,typeof e!="symbol"?e+"":e,t),I0=class{constructor(e,t){this.core=e,this.logger=t,Qe(this,"name",p8),Qe(this,"version",g8),Qe(this,"events",new use.default),Qe(this,"pairings"),Qe(this,"initialized",!1),Qe(this,"storagePrefix",xs),Qe(this,"ignoredPayloadTypes",[q.TYPE_1]),Qe(this,"registeredMethods",[]),Qe(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Qe(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Qe(this,"create",async r=>{this.isInitialized();let i=q.generateRandomBytes32(),s=await this.core.crypto.setSymKey(i),o=q.calcExpiry(Ne.FIVE_MINUTES),a={protocol:s8},c={topic:s,expiry:o,relay:a,active:!1,methods:r?.methods},l=q.formatUri({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(th.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:r?.transportType,internal:r?.internal}),{topic:s,uri:l}}),Qe(this,"pair",async r=>{this.isInitialized();let i=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[ro.pairing_started]}});this.isValidPair(r,i);let{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:l}=q.parseUri(r.uri);i.props.properties.topic=s,i.addTrace(ro.pairing_uri_validation_success),i.addTrace(ro.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(s)){if(u=this.pairings.get(s),i.addTrace(ro.existing_pairing),u.active)throw i.setError(Go.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(ro.pairing_not_expired)}let d=c||q.calcExpiry(Ne.FIVE_MINUTES),h={topic:s,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(s,d),await this.pairings.set(s,h),i.addTrace(ro.store_new_pairing),r.activatePairing&&await this.activate({topic:s}),this.events.emit(th.create,h),i.addTrace(ro.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(ro.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Go.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(f){throw i.setError(Go.subscribe_pairing_topic_failure),f}return i.addTrace(ro.subscribe_pairing_topic_success),h}),Qe(this,"activate",async({topic:r})=>{this.isInitialized();let i=q.calcExpiry(Ne.FIVE_MINUTES);this.core.expirer.set(r,i),await this.pairings.update(r,{active:!0,expiry:i})}),Qe(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:i}=r;if(this.pairings.keys.includes(i)){let s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=q.createDelayedPromise();this.events.once(q.engineEvent("pairing_ping",s),({error:l})=>{l?c(l):a()}),await o()}}),Qe(this,"updateExpiry",async({topic:r,expiry:i})=>{this.isInitialized(),await this.pairings.update(r,{expiry:i})}),Qe(this,"updateMetadata",async({topic:r,metadata:i})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:i})}),Qe(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Qe(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);let{topic:i}=r;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",q.getSdkError("USER_DISCONNECTED")),await this.deletePairing(i))}),Qe(this,"formatUriFromPairing",r=>{this.isInitialized();let{topic:i,relay:s,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(i);return q.formatUri({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),Qe(this,"sendRequest",async(r,i,s)=>{let o=xr.formatJsonRpcRequest(i,s),a=await this.core.crypto.encode(r,o),c=eh[i].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Qe(this,"sendResult",async(r,i,s)=>{let o=xr.formatJsonRpcResult(r,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,l=eh[c].res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),Qe(this,"sendError",async(r,i,s)=>{let o=xr.formatJsonRpcError(r,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,l=eh[c]?eh[c].res:eh.unregistered_method.res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),Qe(this,"deletePairing",async(r,i)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,q.getSdkError("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),i?Promise.resolve():this.core.expirer.del(r)])}),Qe(this,"cleanup",async()=>{let r=this.pairings.getAll().filter(i=>q.isExpired(i.expiry));await Promise.all(r.map(i=>this.deletePairing(i.topic)))}),Qe(this,"onRelayEventRequest",async r=>{let{topic:i,payload:s}=r;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),Qe(this,"onRelayEventResponse",async r=>{let{topic:i,payload:s}=r,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),Qe(this,"onPairingPingRequest",async(r,i)=>{let{id:s}=i;try{this.isValidPing({topic:r}),await this.sendResult(s,r,!0),this.events.emit(th.ping,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),Qe(this,"onPairingPingResponse",(r,i)=>{let{id:s}=i;setTimeout(()=>{xr.isJsonRpcResult(i)?this.events.emit(q.engineEvent("pairing_ping",s),{}):xr.isJsonRpcError(i)&&this.events.emit(q.engineEvent("pairing_ping",s),{error:i.error})},500)}),Qe(this,"onPairingDeleteRequest",async(r,i)=>{let{id:s}=i;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(th.delete,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),Qe(this,"onUnknownRpcMethodRequest",async(r,i)=>{let{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;let a=q.getSdkError("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,r,a),this.logger.error(a)}catch(a){await this.sendError(s,r,a),this.logger.error(a)}}),Qe(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(q.getSdkError("WC_METHOD_UNSUPPORTED",r))}),Qe(this,"isValidPair",(r,i)=>{var s;if(!q.isValidParams(r)){let{message:a}=q.getInternalError("MISSING_OR_INVALID",`pair() params: ${r}`);throw i.setError(Go.malformed_pairing_uri),new Error(a)}if(!q.isValidUrl(r.uri)){let{message:a}=q.getInternalError("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw i.setError(Go.malformed_pairing_uri),new Error(a)}let o=q.parseUri(r?.uri);if(!((s=o?.relay)!=null&&s.protocol)){let{message:a}=q.getInternalError("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Go.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){let{message:a}=q.getInternalError("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Go.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Ne.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(Go.pairing_expired);let{message:a}=q.getInternalError("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Qe(this,"isValidPing",async r=>{if(!q.isValidParams(r)){let{message:s}=q.getInternalError("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}let{topic:i}=r;await this.isValidPairingTopic(i)}),Qe(this,"isValidDisconnect",async r=>{if(!q.isValidParams(r)){let{message:s}=q.getInternalError("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}let{topic:i}=r;await this.isValidPairingTopic(i)}),Qe(this,"isValidPairingTopic",async r=>{if(!q.isValidString(r,!1)){let{message:i}=q.getInternalError("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.pairings.keys.includes(r)){let{message:i}=q.getInternalError("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(q.isExpired(this.pairings.get(r).expiry)){await this.deletePairing(r);let{message:i}=q.getInternalError("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}),this.core=e,this.logger=Ot.generateChildLogger(t,this.name),this.pairings=new E0(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ot.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(dn.message,async e=>{let{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==$l.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{let s=await this.core.crypto.decode(t,r);xr.isJsonRpcRequest(s)?(this.core.history.set(t,s),await this.onRelayEventRequest({topic:t,payload:s})):xr.isJsonRpcResponse(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id)),await this.core.relayer.messages.ack(t,r)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(zi.expired,async e=>{let{topic:t}=q.parseExpirerTarget(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(th.expire,{topic:t}))})}},Kae=Object.defineProperty,Qae=(n,e,t)=>e in n?Kae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Un=(n,e,t)=>Qae(n,typeof e!="symbol"?e+"":e,t),C0=class extends Ds.IJsonRpcHistory{constructor(e,t){super(e,t),this.core=e,this.logger=t,Un(this,"records",new Map),Un(this,"events",new ql.EventEmitter),Un(this,"name",m8),Un(this,"version",y8),Un(this,"cached",[]),Un(this,"initialized",!1),Un(this,"storagePrefix",xs),Un(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Un(this,"set",(r,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:i,chainId:s}),this.records.has(i.id))return;let o={id:i.id,topic:r,request:{method:i.method,params:i.params||null},chainId:s,expiry:q.calcExpiry(Ne.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(qi.created,o)}),Un(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;let i=await this.getRecord(r.id);typeof i.response>"u"&&(i.response=xr.isJsonRpcError(r)?{error:r.error}:{result:r.result},this.records.set(i.id,i),this.persist(),this.events.emit(qi.updated,i))}),Un(this,"get",async(r,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:i}),await this.getRecord(i))),Un(this,"delete",(r,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===r){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(qi.deleted,s)}}),this.persist()}),Un(this,"exists",async(r,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===r:!1)),Un(this,"on",(r,i)=>{this.events.on(r,i)}),Un(this,"once",(r,i)=>{this.events.once(r,i)}),Un(this,"off",(r,i)=>{this.events.off(r,i)}),Un(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=Ot.generateChildLogger(t,this.name)}get context(){return Ot.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;let r={topic:t.topic,request:xr.formatJsonRpcRequest(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:r}=q.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(qi.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:t}=q.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(qi.created,e=>{let t=qi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(qi.updated,e=>{let t=qi.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(qi.deleted,e=>{let t=qi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(zl.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{Ne.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(qi.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},Yae=Object.defineProperty,Jae=(n,e,t)=>e in n?Yae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ir=(n,e,t)=>Jae(n,typeof e!="symbol"?e+"":e,t),S0=class extends Ds.IExpirer{constructor(e,t){super(e,t),this.core=e,this.logger=t,ir(this,"expirations",new Map),ir(this,"events",new ql.EventEmitter),ir(this,"name",w8),ir(this,"version",v8),ir(this,"cached",[]),ir(this,"initialized",!1),ir(this,"storagePrefix",xs),ir(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),ir(this,"has",r=>{try{let i=this.formatTarget(r);return typeof this.getExpiration(i)<"u"}catch{return!1}}),ir(this,"set",(r,i)=>{this.isInitialized();let s=this.formatTarget(r),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(zi.created,{target:s,expiration:o})}),ir(this,"get",r=>{this.isInitialized();let i=this.formatTarget(r);return this.getExpiration(i)}),ir(this,"del",r=>{if(this.isInitialized(),this.has(r)){let i=this.formatTarget(r),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(zi.deleted,{target:i,expiration:s})}}),ir(this,"on",(r,i)=>{this.events.on(r,i)}),ir(this,"once",(r,i)=>{this.events.once(r,i)}),ir(this,"off",(r,i)=>{this.events.off(r,i)}),ir(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=Ot.generateChildLogger(t,this.name)}get context(){return Ot.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return q.formatTopicTarget(e);if(typeof e=="number")return q.formatIdTarget(e);let{message:t}=q.getInternalError("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(zi.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:t}=q.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:r}=q.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return t}checkExpiry(e,t){let{expiry:r}=t;Ne.toMiliseconds(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(zi.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(zl.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(zi.created,e=>{let t=zi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(zi.expired,e=>{let t=zi.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(zi.deleted,e=>{let t=zi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=q.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},Zae=Object.defineProperty,Xae=(n,e,t)=>e in n?Zae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,un=(n,e,t)=>Xae(n,typeof e!="symbol"?e+"":e,t),A0=class extends Ds.IVerify{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,un(this,"name",b8),un(this,"abortController"),un(this,"isDevEnv"),un(this,"verifyUrlV3",I8),un(this,"storagePrefix",xs),un(this,"version",mT),un(this,"publicKey"),un(this,"fetchPromise"),un(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Ne.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),un(this,"register",async i=>{if(!q.isBrowser()||this.isDevEnv)return;let s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{let l=cse.getDocument(),u=this.startAbortTimer(Ne.ONE_SECOND*5),d=await new Promise((h,f)=>{let p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);let g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});let m=y=>{if(y.data&&typeof y.data=="string")try{let E=JSON.parse(y.data);if(E.type==="verify_attestation"){if(K1.decodeJWT(E.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),h(E.attestation===null?"":E.attestation)}}catch(E){this.logger.warn(E)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(l){this.logger.warn(l)}return""}),un(this,"resolve",async i=>{if(this.isDevEnv)return"";let{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(K1.decodeJWT(s).payload.id!==a)return;let l=await this.isValidJwtAttestation(s);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;let c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),un(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);let o=this.startAbortTimer(Ne.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),un(this,"getVerifyUrl",i=>{let s=i||sg;return C8.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${sg}`),s=sg),s}),un(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let i=this.startAbortTimer(Ne.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),un(this,"persistPublicKey",async i=>{this.logger.debug(i,"persisting public key to local storage"),await this.store.setItem(this.storeKey,i),this.publicKey=i}),un(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),un(this,"isValidJwtAttestation",async i=>{let s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}let o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),un(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),un(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{let o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});let i=await this.fetchPromise;return this.fetchPromise=void 0,i}),un(this,"validateAttestation",(i,s)=>{let o=q.verifyP256Jwt(i,s.publicKey),a={hasExpired:Ne.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Ot.generateChildLogger(t,this.name),this.abortController=new AbortController,this.isDevEnv=q.isTestRun(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Ot.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Ne.toMiliseconds(e))}},ece=Object.defineProperty,tce=(n,e,t)=>e in n?ece(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zj=(n,e,t)=>tce(n,typeof e!="symbol"?e+"":e,t),_0=class extends Ds.IEchoClient{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,zj(this,"context",S8),zj(this,"registerDeviceToken",async r=>{let{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=r,c=`${A8}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=Ot.generateChildLogger(t,this.context)}},nce=Object.defineProperty,Gj=Object.getOwnPropertySymbols,rce=Object.prototype.hasOwnProperty,ice=Object.prototype.propertyIsEnumerable,hT=(n,e,t)=>e in n?nce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ng=(n,e)=>{for(var t in e||(e={}))rce.call(e,t)&&hT(n,t,e[t]);if(Gj)for(var t of Gj(e))ice.call(e,t)&&hT(n,t,e[t]);return n},Dn=(n,e,t)=>hT(n,typeof e!="symbol"?e+"":e,t),T0=class extends Ds.IEventClient{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,Dn(this,"context",T8),Dn(this,"storagePrefix",xs),Dn(this,"storageVersion",_8),Dn(this,"events",new Map),Dn(this,"shouldPersist",!1),Dn(this,"init",async()=>{if(!q.isTestRun())try{let i={eventId:q.uuidv4(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:q.formatUA(this.core.relayer.protocol,this.core.relayer.version,g0)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),Dn(this,"createEvent",i=>{let{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,l=q.uuidv4(),u=this.core.projectId||"",d=Date.now(),h=ng({eventId:l,timestamp:d,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),Dn(this,"getEvent",i=>{let{eventId:s,topic:o}=i;if(s)return this.events.get(s);let a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return ng(ng({},a),this.setMethods(a.eventId))}),Dn(this,"deleteEvent",i=>{let{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),Dn(this,"setEventListeners",()=>{this.core.heartbeat.on(zl.HEARTBEAT_EVENTS.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{Ne.fromMiliseconds(Date.now())-Ne.fromMiliseconds(i.timestamp)>x8&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),Dn(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),Dn(this,"addTrace",(i,s)=>{let o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),Dn(this,"setError",(i,s)=>{let o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),Dn(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Dn(this,"restore",async()=>{try{let i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,ng(ng({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),Dn(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;let i=[];for(let[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(let s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),Dn(this,"sendEvent",async i=>{let s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${D8}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${g0}${s}`,{method:"POST",body:JSON.stringify(i)})}),Dn(this,"getAppDomain",()=>q.getAppMetadata().url),this.logger=Ot.generateChildLogger(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}},sce=Object.defineProperty,Wj=Object.getOwnPropertySymbols,oce=Object.prototype.hasOwnProperty,ace=Object.prototype.propertyIsEnumerable,fT=(n,e,t)=>e in n?sce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Kj=(n,e)=>{for(var t in e||(e={}))oce.call(e,t)&&fT(n,t,e[t]);if(Wj)for(var t of Wj(e))ace.call(e,t)&&fT(n,t,e[t]);return n},Ut=(n,e,t)=>fT(n,typeof e!="symbol"?e+"":e,t),x0=class n extends Ds.ICore{constructor(e){var t;super(e),Ut(this,"protocol",gT),Ut(this,"version",mT),Ut(this,"name",ag),Ut(this,"relayUrl"),Ut(this,"projectId"),Ut(this,"customStoragePrefix"),Ut(this,"events",new ql.EventEmitter),Ut(this,"logger"),Ut(this,"heartbeat"),Ut(this,"relayer"),Ut(this,"crypto"),Ut(this,"storage"),Ut(this,"history"),Ut(this,"expirer"),Ut(this,"pairing"),Ut(this,"verify"),Ut(this,"echoClient"),Ut(this,"linkModeSupportedApps"),Ut(this,"eventClient"),Ut(this,"initialized",!1),Ut(this,"logChunkController"),Ut(this,"on",(a,c)=>this.events.on(a,c)),Ut(this,"once",(a,c)=>this.events.once(a,c)),Ut(this,"off",(a,c)=>this.events.off(a,c)),Ut(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ut(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;let u={topic:a,message:c,publishedAt:Date.now(),transportType:$l.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});let r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||yT,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let i=Ot.getDefaultLoggerOptions({level:typeof e?.logger=="string"&&e.logger?e.logger:Qj.logger,name:ag}),{logger:s,chunkLoggerController:o}=Ot.generatePlatformLogger({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ot.generateChildLogger(s,this.name),this.heartbeat=new zl.HeartBeat,this.crypto=new y0(this,this.logger,e?.keychain),this.history=new C0(this,this.logger),this.expirer=new S0(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new dse.default(Kj(Kj({},Yj),e?.storageOptions)),this.relayer=new b0({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new I0(this,this.logger),this.verify=new A0(this,this.logger,this.storage),this.echoClient=new _0(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new T0(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){let t=new n(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem(d8,r),t}get context(){return Ot.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Y1,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Y1)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;let t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;let r=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&process.env.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}},cce=x0;ie.CORE_CONTEXT=ag,ie.CORE_DEFAULT=Qj,ie.CORE_PROTOCOL=gT,ie.CORE_STORAGE_OPTIONS=Yj,ie.CORE_STORAGE_PREFIX=xs,ie.CORE_VERSION=mT,ie.CRYPTO_CLIENT_SEED=Q1,ie.CRYPTO_CONTEXT=Jj,ie.CRYPTO_JWT_TTL=Zj,ie.Core=cce,ie.Crypto=y0,ie.ECHO_CONTEXT=S8,ie.ECHO_URL=A8,ie.EVENTS_CLIENT_API_URL=D8,ie.EVENTS_STORAGE_CLEANUP_INTERVAL=x8,ie.EVENTS_STORAGE_CONTEXT=T8,ie.EVENTS_STORAGE_VERSION=_8,ie.EVENT_CLIENT_AUTHENTICATE_ERRORS=Sse,ie.EVENT_CLIENT_AUTHENTICATE_TRACES=Cse,ie.EVENT_CLIENT_CONTEXT=bse,ie.EVENT_CLIENT_PAIRING_ERRORS=Go,ie.EVENT_CLIENT_PAIRING_TRACES=ro,ie.EVENT_CLIENT_SESSION_ERRORS=Ise,ie.EVENT_CLIENT_SESSION_TRACES=Ese,ie.EXPIRER_CONTEXT=w8,ie.EXPIRER_DEFAULT_TTL=wse,ie.EXPIRER_EVENTS=zi,ie.EXPIRER_STORAGE_VERSION=v8,ie.EchoClient=_0,ie.EventClient=T0,ie.Expirer=S0,ie.HISTORY_CONTEXT=m8,ie.HISTORY_EVENTS=qi,ie.HISTORY_STORAGE_VERSION=y8,ie.JsonRpcHistory=C0,ie.KEYCHAIN_CONTEXT=Xj,ie.KEYCHAIN_STORAGE_VERSION=e8,ie.KeyChain=m0,ie.MESSAGES_CONTEXT=t8,ie.MESSAGES_STORAGE_VERSION=n8,ie.MESSAGE_DIRECTION=ig,ie.MessageTracker=w0,ie.PAIRING_CONTEXT=p8,ie.PAIRING_DEFAULT_TTL=yse,ie.PAIRING_EVENTS=th,ie.PAIRING_RPC_OPTS=eh,ie.PAIRING_STORAGE_VERSION=g8,ie.PENDING_SUB_RESOLUTION_TIMEOUT=mse,ie.PUBLISHER_CONTEXT=i8,ie.PUBLISHER_DEFAULT_TTL=r8,ie.Pairing=I0,ie.RELAYER_CONTEXT=a8,ie.RELAYER_DEFAULT_LOGGER=o8,ie.RELAYER_DEFAULT_PROTOCOL=s8,ie.RELAYER_DEFAULT_RELAY_URL=yT,ie.RELAYER_EVENTS=dn,ie.RELAYER_PROVIDER_EVENTS=yi,ie.RELAYER_RECONNECT_TIMEOUT=l8,ie.RELAYER_SDK_VERSION=g0,ie.RELAYER_STORAGE_OPTIONS=fse,ie.RELAYER_SUBSCRIBER_SUFFIX=c8,ie.RELAYER_TRANSPORT_CUTOFF=pse,ie.Relayer=b0,ie.STORE_STORAGE_VERSION=u8,ie.SUBSCRIBER_CONTEXT=h8,ie.SUBSCRIBER_DEFAULT_TTL=gse,ie.SUBSCRIBER_EVENTS=Jr,ie.SUBSCRIBER_STORAGE_VERSION=f8,ie.Store=E0,ie.Subscriber=v0,ie.TRANSPORT_TYPES=$l,ie.TRUSTED_VERIFY_URLS=C8,ie.VERIFY_CONTEXT=b8,ie.VERIFY_SERVER=sg,ie.VERIFY_SERVER_V3=I8,ie.Verify=A0,ie.WALLETCONNECT_CLIENT_ID=d8,ie.WALLETCONNECT_LINK_MODE_APPS=Y1,ie.default=x0});var n4=Bs(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});var $8=co(),ye=V8(),q8=($1(),Fe(H1)),A=eg(),lce=Uv(),rt=hu(),Ve=(pu(),Fe(fu));function uce(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var dce=uce($8),DT="wc",NT=2,RT="client",M0=`${DT}@${NT}:${RT}:`,N0={name:RT,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},hce={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire",session_authenticate:"session_authenticate",session_request_expire:"session_request_expire",session_connect:"session_connect"},fce={database:":memory:"},vT="WALLETCONNECT_DEEPLINK_CHOICE",pce={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},gce="history",mce="0.3",z8="proposal",yce=rt.THIRTY_DAYS,bT="Proposal expired",G8="session",Gl=rt.SEVEN_DAYS,W8="engine",Nn={wc_sessionPropose:{req:{ttl:rt.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:rt.ONE_DAY,prompt:!1,tag:1104},res:{ttl:rt.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:rt.ONE_DAY,prompt:!1,tag:1106},res:{ttl:rt.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:rt.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:rt.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:rt.ONE_DAY,prompt:!1,tag:1112},res:{ttl:rt.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:rt.ONE_DAY,prompt:!1,tag:1114},res:{ttl:rt.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:rt.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:rt.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:rt.FIVE_MINUTES,prompt:!1,tag:1119}}},R0={min:rt.FIVE_MINUTES,max:rt.SEVEN_DAYS},Ns={idle:"IDLE",active:"ACTIVE"},K8={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Q8="request",Y8=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],J8="wc",wce=1.5,Z8="auth",X8="authKeys",e4="pairingTopics",t4="requests",ug=`${J8}@${1.5}:${Z8}:`,lg=`${ug}:PUB_KEY`,vce=Object.defineProperty,bce=Object.defineProperties,Ece=Object.getOwnPropertyDescriptors,H8=Object.getOwnPropertySymbols,Ice=Object.prototype.hasOwnProperty,Cce=Object.prototype.propertyIsEnumerable,ET=(n,e,t)=>e in n?vce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ht=(n,e)=>{for(var t in e||(e={}))Ice.call(e,t)&&ET(n,t,e[t]);if(H8)for(var t of H8(e))Cce.call(e,t)&&ET(n,t,e[t]);return n},Vn=(n,e)=>bce(n,Ece(e)),Y=(n,e,t)=>ET(n,typeof e!="symbol"?e+"":e,t),IT=class extends q8.IEngine{constructor(e){super(e),Y(this,"name",W8),Y(this,"events",new dce.default),Y(this,"initialized",!1),Y(this,"requestQueue",{state:Ns.idle,queue:[]}),Y(this,"sessionRequestQueue",{state:Ns.idle,queue:[]}),Y(this,"emittedSessionRequests",new A.LimitedSet({limit:500})),Y(this,"requestQueueDelay",rt.ONE_SECOND),Y(this,"expectedPairingMethodMap",new Map),Y(this,"recentlyDeletedMap",new Map),Y(this,"recentlyDeletedLimit",200),Y(this,"relayMessageCache",[]),Y(this,"pendingSessions",new Map),Y(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Nn)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},rt.toMiliseconds(this.requestQueueDelay)))}),Y(this,"connect",async t=>{var r;this.isInitialized(),await this.confirmOnlineStateOrThrow();let i=Vn(ht({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(i),i.optionalNamespaces=A.mergeRequiredAndOptionalNamespaces(i.requiredNamespaces,i.optionalNamespaces),i.requiredNamespaces={};let{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:d,walletPay:h}=i,f=((r=d?.[0])==null?void 0:r.ttl)||Nn.wc_sessionPropose.req.ttl||rt.FIVE_MINUTES;this.validateRequestExpiry(f);let p=s,g,m=!1;try{if(p){let T=this.client.core.pairing.pairings.get(p);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),m=T.active}}catch(T){throw this.client.logger.error(`connect() -> pairing.get(${p}) failed`),T}if(!p||!m){let{topic:T,uri:$}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});p=T,g=$}if(!p){let{message:T}=A.getInternalError("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(T)}let y=await this.client.core.crypto.generateKeyPair(),E=A.calcExpiry(f),I=ht(Vn(ht(ht({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:ye.RELAYER_DEFAULT_PROTOCOL}],proposer:{publicKey:y,metadata:this.client.metadata},expiryTimestamp:E,pairingTopic:p},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:Ve.payloadId()}),(d||h)&&{requests:{authentication:d?.map(T=>{let{domain:$,chains:W,nonce:M,uri:v,exp:b,nbf:w,type:C,statement:N,requestId:F,resources:S,signatureTypes:P}=T;return{domain:$,chains:W,nonce:M,type:C??"caip122",aud:v,version:"1",iat:new Date().toISOString(),exp:b,nbf:w,statement:N,requestId:F,resources:S,signatureTypes:P}}),walletPay:h}}),L=A.engineEvent("session_connect",I.id),{reject:k,resolve:D,done:B}=A.createDelayedPromise(f,bT),U=({id:T})=>{T===I.id&&(this.client.events.off("proposal_expire",U),this.pendingSessions.delete(I.id),this.events.emit(L,{error:{message:bT,code:0}}))};return this.client.events.on("proposal_expire",U),this.events.once(L,({error:T,session:$})=>{this.client.events.off("proposal_expire",U),T?k(T):$&&D($)}),await this.setProposal(I.id,I),await this.sendProposeSession({proposal:I,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:I.id}}}).catch(T=>{throw this.deleteProposal(I.id),T}),{uri:g,approval:B}}),Y(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(r){throw this.client.logger.error("pair() failed"),r}}),Y(this,"approve",async t=>{var r,i,s;let o=this.client.core.eventClient.createEvent({properties:{topic:(r=t?.id)==null?void 0:r.toString(),trace:[ye.EVENT_CLIENT_SESSION_TRACES.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch($){throw o.setError(ye.EVENT_CLIENT_SESSION_ERRORS.no_internet_connection),$}try{await this.isValidProposalId(t?.id)}catch($){throw this.client.logger.error(`approve() -> proposal.get(${t?.id}) failed`),o.setError(ye.EVENT_CLIENT_SESSION_ERRORS.proposal_not_found),$}try{await this.isValidApprove(t)}catch($){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(ye.EVENT_CLIENT_SESSION_ERRORS.session_approve_namespace_validation_failure),$}let{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:f}=t,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});let{pairingTopic:g,proposer:m,requiredNamespaces:y,optionalNamespaces:E}=p,I=(i=this.client.core.eventClient)==null?void 0:i.getEvent({topic:g});I||(I=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:ye.EVENT_CLIENT_SESSION_TRACES.session_approve_started,properties:{topic:g,trace:[ye.EVENT_CLIENT_SESSION_TRACES.session_approve_started,ye.EVENT_CLIENT_SESSION_TRACES.session_namespaces_validation_success]}}));let L=await this.client.core.crypto.generateKeyPair(),k=m.publicKey,D=await this.client.core.crypto.generateSharedKey(L,k),B=Vn(ht(ht(ht({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:L,metadata:this.client.metadata},expiry:A.calcExpiry(Gl)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{proposalRequestsResponses:f}),U=ye.TRANSPORT_TYPES.relay;I.addTrace(ye.EVENT_CLIENT_SESSION_TRACES.subscribing_session_topic);try{await this.client.core.relayer.subscribe(D,{transportType:U,internal:{skipSubscribe:!0}})}catch($){throw I.setError(ye.EVENT_CLIENT_SESSION_ERRORS.subscribe_session_topic_failure),$}I.addTrace(ye.EVENT_CLIENT_SESSION_TRACES.subscribe_session_topic_success);let T=Vn(ht({},B),{topic:D,requiredNamespaces:y,optionalNamespaces:E,pairingTopic:g,acknowledged:!1,self:B.controller,peer:{publicKey:m.publicKey,metadata:m.metadata},controller:L,transportType:ye.TRANSPORT_TYPES.relay,authentication:f?.authentication,walletPayResult:f?.walletPay});await this.client.session.set(D,T),I.addTrace(ye.EVENT_CLIENT_SESSION_TRACES.store_session);try{await this.sendApproveSession({sessionTopic:D,proposal:p,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:L},sessionSettleRequest:B,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:ht({correlationId:a},this.getTVFApproveParams(T))}}),I.addTrace(ye.EVENT_CLIENT_SESSION_TRACES.session_approve_publish_success)}catch($){throw this.client.logger.error($),this.client.session.delete(D,A.getSdkError("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(D),$}return this.client.core.eventClient.deleteEvent({eventId:I.eventId}),await this.client.core.pairing.updateMetadata({topic:g,metadata:m.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:g}),await this.setExpiry(D,A.calcExpiry(Gl)),{topic:D,acknowledged:()=>Promise.resolve(this.client.session.get(D))}}),Y(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}let{id:r,reason:i}=t,s;try{s=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}s&&await this.sendError({id:r,topic:s,error:i,rpcOpts:Nn.wc_sessionPropose.reject}),await this.deleteProposal(r)}),Y(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}let{topic:r,namespaces:i}=t,{done:s,resolve:o,reject:a}=A.createDelayedPromise(rt.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=Ve.payloadId(),l=Ve.getBigIntRpcId().toString(),u=this.client.session.get(r).namespaces;return this.events.once(A.engineEvent("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:i}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:s}}),Y(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}let{topic:r}=t,i=Ve.payloadId(),{done:s,resolve:o,reject:a}=A.createDelayedPromise(rt.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(A.engineEvent("session_extend",i),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,A.calcExpiry(Gl)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:s}}),Y(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}let{chainId:r,request:i,topic:s,expiry:o=Nn.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(s);a?.transportType===ye.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let c=Ve.payloadId(),l=Ve.getBigIntRpcId().toString(),{done:u,resolve:d,reject:h}=A.createDelayedPromise(o,"Request expired. Please try again.");this.events.once(A.engineEvent("session_request",c),({error:m,result:y})=>{m?h(m):d(y)});let f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:f,params:{request:Vn(ht({},i),{expiryTimestamp:A.calcExpiry(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>h(m)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:r,id:c}),await u();let g={request:Vn(ht({},i),{expiryTimestamp:A.calcExpiry(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:f,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(y=>h(y)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:r,id:c}),m()}),new Promise(async m=>{var y;if(!((y=a.sessionConfig)!=null&&y.disableDeepLink)){let E=await A.getDeepLink(this.client.core.storage,vT);await A.handleDeeplinkRedirect({id:c,topic:s,wcDeepLink:E})}m()}),u()]).then(m=>m[2])}),Y(this,"respond",async t=>{var r,i;this.isInitialized();let s=this.client.core.eventClient.createEvent({properties:{topic:t?.topic||((i=(r=t?.response)==null?void 0:r.id)==null?void 0:i.toString()),trace:[ye.EVENT_CLIENT_SESSION_TRACES.session_request_response_started]}});try{await this.isValidRespond(t)}catch(d){throw s.addTrace(d?.message),s.setError(ye.EVENT_CLIENT_SESSION_ERRORS.session_request_response_validation_failure),d}s.addTrace(ye.EVENT_CLIENT_SESSION_TRACES.session_request_response_validation_success);let{topic:o,response:a}=t,{id:c}=a,l=this.client.session.get(o);l.transportType===ye.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{s.addTrace(ye.EVENT_CLIENT_SESSION_TRACES.session_request_response_publish_started),Ve.isJsonRpcResult(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):Ve.isJsonRpcError(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(t)}catch(d){throw s.addTrace(d?.message),s.setError(ye.EVENT_CLIENT_SESSION_ERRORS.session_request_response_publish_failure),d}}),Y(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}let{topic:r}=t;if(this.client.session.keys.includes(r)){let i=Ve.payloadId(),s=Ve.getBigIntRpcId().toString(),{done:o,resolve:a,reject:c}=A.createDelayedPromise(rt.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(A.engineEvent("session_ping",i),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),Y(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);let{topic:r,event:i,chainId:s}=t,o=Ve.getBigIntRpcId().toString(),a=Ve.payloadId();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:i,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),Y(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);let{topic:r}=t;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:A.getSdkError("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{let{message:i}=A.getInternalError("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(i)}}),Y(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(r=>A.isSessionCompatible(r,t)))),Y(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),Y(this,"authenticate",async(t,r)=>{var i;this.isInitialized(),this.isValidAuthenticate(t);let s=r&&this.client.core.linkModeSupportedApps.includes(r)&&((i=this.client.metadata.redirect)==null?void 0:i.linkMode),o=s?ye.TRANSPORT_TYPES.link_mode:ye.TRANSPORT_TYPES.relay;o===ye.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:f,nbf:p,methods:g=[],expiry:m}=t,y=[...t.resources||[]],{topic:E,uri:I}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:E,uri:I}});let L=await this.client.core.crypto.generateKeyPair(),k=A.hashKey(L);if(await Promise.all([this.client.auth.authKeys.set(lg,{responseTopic:k,publicKey:L}),this.client.auth.pairingTopics.set(k,{topic:k,pairingTopic:E})]),await this.client.core.relayer.subscribe(k,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${E}`),g.length>0){let{namespace:S}=A.parseChainId(a[0]),P=A.createEncodedRecap(S,"request",g);A.getRecapFromResources(y)&&(P=A.mergeEncodedRecaps(P,y.pop())),y.push(P)}let D=m&&m>Nn.wc_sessionAuthenticate.req.ttl?m:Nn.wc_sessionAuthenticate.req.ttl,B={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:y},requester:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:A.calcExpiry(D)},U={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},T={requiredNamespaces:{},optionalNamespaces:U,relays:[{protocol:"irn"}],pairingTopic:E,proposer:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:A.calcExpiry(Nn.wc_sessionPropose.req.ttl),id:Ve.payloadId()},{done:$,resolve:W,reject:M}=A.createDelayedPromise(D,"Request expired"),v=Ve.payloadId(),b=A.engineEvent("session_connect",T.id),w=A.engineEvent("session_request",v),C=async({error:S,session:P})=>{this.events.off(w,N),S?M(S):P&&W({session:P})},N=async S=>{var P,V,j;if(await this.deletePendingAuthRequest(v,{message:"fulfilled",code:0}),S.error){let re=A.getSdkError("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return S.error.code===re.code?void 0:(this.events.off(b,C),M(S.error.message))}await this.deleteProposal(T.id),this.events.off(b,C);let{cacaos:oe,responder:ee}=S.result,Q=[],ae=[];for(let re of oe){await A.validateSignedCacao({cacao:re,projectId:this.client.core.projectId})||(this.client.logger.error(re,"Signature verification failed"),M(A.getSdkError("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:Ce}=re,kt=A.getRecapFromResources(Ce.resources),St=[A.getNamespacedDidChainId(Ce.iss)],Wt=A.getDidAddress(Ce.iss);if(kt){let En=A.getMethodsFromRecap(kt),uu=A.getChainsFromRecap(kt);Q.push(...En),St.push(...uu)}for(let En of St)ae.push(`${En}:${Wt}`)}let te=await this.client.core.crypto.generateSharedKey(L,ee.publicKey),be;Q.length>0&&(be={topic:te,acknowledged:!0,self:{publicKey:L,metadata:this.client.metadata},peer:ee,controller:ee.publicKey,expiry:A.calcExpiry(Gl),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:E,namespaces:A.buildNamespacesFromAuth([...new Set(Q)],[...new Set(ae)]),transportType:o},await this.client.core.relayer.subscribe(te,{transportType:o}),await this.client.session.set(te,be),E&&await this.client.core.pairing.updateMetadata({topic:E,metadata:ee.metadata}),be=this.client.session.get(te)),(P=this.client.metadata.redirect)!=null&&P.linkMode&&(V=ee.metadata.redirect)!=null&&V.linkMode&&(j=ee.metadata.redirect)!=null&&j.universal&&r&&(this.client.core.addLinkModeSupportedApp(ee.metadata.redirect.universal),this.client.session.update(te,{transportType:ye.TRANSPORT_TYPES.link_mode})),W({auths:oe,session:be})};this.events.once(b,C),this.events.once(w,N);let F;try{if(s){let S=Ve.formatJsonRpcRequest("wc_sessionAuthenticate",B,v);this.client.core.history.set(E,S);let P=await this.client.core.crypto.encode("",S,{type:A.TYPE_2,encoding:A.BASE64URL});F=A.getLinkModeURL(r,E,P)}else await Promise.all([this.sendRequest({topic:E,method:"wc_sessionAuthenticate",params:B,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:v}),this.sendRequest({topic:E,method:"wc_sessionPropose",params:T,expiry:Nn.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:T.id})])}catch(S){throw this.events.off(b,C),this.events.off(w,N),S}return await this.setProposal(T.id,T),await this.setAuthRequest(v,{request:Vn(ht({},B),{verifyContext:{}}),pairingTopic:E,transportType:o}),{uri:F??I,response:$}}),Y(this,"approveSessionAuthenticate",async t=>{let{id:r,auths:i}=t,s=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[ye.EVENT_CLIENT_AUTHENTICATE_TRACES.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw s.setError(ye.EVENT_CLIENT_AUTHENTICATE_ERRORS.no_internet_connection),m}let o=this.getPendingAuthRequest(r);if(!o)throw s.setError(ye.EVENT_CLIENT_AUTHENTICATE_ERRORS.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);let a=o.transportType||ye.TRANSPORT_TYPES.relay;a===ye.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=A.hashKey(c),d={type:A.TYPE_1,receiverPublicKey:c,senderPublicKey:l},h=[],f=[];for(let m of i){if(!await A.validateSignedCacao({cacao:m,projectId:this.client.core.projectId})){s.setError(ye.EVENT_CLIENT_AUTHENTICATE_ERRORS.invalid_cacao);let k=A.getSdkError("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:k,encodeOpts:d}),new Error(k.message)}s.addTrace(ye.EVENT_CLIENT_AUTHENTICATE_TRACES.cacaos_verified);let{p:y}=m,E=A.getRecapFromResources(y.resources),I=[A.getNamespacedDidChainId(y.iss)],L=A.getDidAddress(y.iss);if(E){let k=A.getMethodsFromRecap(E),D=A.getChainsFromRecap(E);h.push(...k),I.push(...D)}for(let k of I)f.push(`${k}:${L}`)}let p=await this.client.core.crypto.generateSharedKey(l,c);s.addTrace(ye.EVENT_CLIENT_AUTHENTICATE_TRACES.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:A.calcExpiry(Gl),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:A.buildNamespacesFromAuth([...new Set(h)],[...new Set(f)]),transportType:a},s.addTrace(ye.EVENT_CLIENT_AUTHENTICATE_TRACES.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw s.setError(ye.EVENT_CLIENT_AUTHENTICATE_ERRORS.subscribe_authenticated_session_topic_failure),m}s.addTrace(ye.EVENT_CLIENT_AUTHENTICATE_TRACES.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),s.addTrace(ye.EVENT_CLIENT_AUTHENTICATE_TRACES.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(ye.EVENT_CLIENT_AUTHENTICATE_TRACES.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:i,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw s.setError(ye.EVENT_CLIENT_AUTHENTICATE_ERRORS.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:g}}),Y(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();let{id:r,reason:i}=t,s=this.getPendingAuthRequest(r);if(!s)throw new Error(`Could not find pending auth request with id ${r}`);s.transportType===ye.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=A.hashKey(o),l={type:A.TYPE_1,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:i,encodeOpts:l,rpcOpts:Nn.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),Y(this,"formatAuthMessage",t=>{this.isInitialized();let{request:r,iss:i}=t;return A.formatMessage(r,i)}),Y(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{let t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),Y(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{let r=this.client.core.pairing.pairings.get(t.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&s.topic&&s.topic!==r.topic});if(i.length===0)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),Y(this,"deleteSession",async t=>{var r;let{topic:i,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,A.getSdkError("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i),this.client.core.storage.removeItem(vT).catch(l=>this.client.logger.warn(l)),i===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=Ns.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===i).map(l=>this.deletePendingSessionRequest(l.id,A.getSdkError("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:i})}),Y(this,"deleteProposal",async(t,r)=>{if(r)try{let i=this.client.proposal.get(t);this.client.core.eventClient.getEvent({topic:i.pairingTopic})?.setError(ye.EVENT_CLIENT_SESSION_ERRORS.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,A.getSdkError("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),Y(this,"deletePendingSessionRequest",async(t,r,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,r),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==t),i&&(this.sessionRequestQueue.state=Ns.idle,this.client.events.emit("session_request_expire",{id:t}))}),Y(this,"deletePendingAuthRequest",async(t,r,i=!1)=>{await Promise.all([this.client.auth.requests.delete(t,r),i?Promise.resolve():this.client.core.expirer.del(t)])}),Y(this,"setExpiry",async(t,r)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,r),await this.client.session.update(t,{expiry:r}))}),Y(this,"setProposal",async(t,r)=>{this.client.core.expirer.set(t,A.calcExpiry(Nn.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,r)}),Y(this,"setAuthRequest",async(t,r)=>{let{request:i,pairingTopic:s,transportType:o=ye.TRANSPORT_TYPES.relay}=r;this.client.core.expirer.set(t,i.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:t,pairingTopic:s,verifyContext:i.verifyContext,transportType:o})}),Y(this,"setPendingSessionRequest",async t=>{let{id:r,topic:i,params:s,verifyContext:o}=t,a=s.request.expiryTimestamp||A.calcExpiry(Nn.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:i,params:s,verifyContext:o})}),Y(this,"sendRequest",async t=>{let{topic:r,method:i,params:s,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:h={}}=t,f=Ve.formatJsonRpcRequest(i,s,c),p,g=!!u;try{let E=g?A.BASE64URL:A.BASE64;p=await this.client.core.crypto.encode(r,f,{encoding:E})}catch(E){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),E}let m;if(Y8.includes(i)){let E=A.hashMessage(JSON.stringify(f)),I=A.hashMessage(p);m=await this.client.core.verify.register({id:I,decryptedId:E})}let y=ht(ht({},Nn[i].req),h);if(y.attestation=m,o&&(y.ttl=o),a&&(y.id=a),this.client.core.history.set(r,f),g){let E=A.getLinkModeURL(u,r,p);await global.Linking.openURL(E,this.client.name)}else y.tvf=Vn(ht({},d),{correlationId:f.id}),l?(y.internal=Vn(ht({},y.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,y)):this.client.core.relayer.publish(r,p,y).catch(E=>this.client.logger.error(E));return f.id}),Y(this,"sendProposeSession",async t=>{let{proposal:r,publishOpts:i}=t,s=Ve.formatJsonRpcRequest("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,s);let o=await this.client.core.crypto.encode(r.pairingTopic,s,{encoding:A.BASE64}),a=A.hashMessage(JSON.stringify(s)),c=A.hashMessage(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:Vn(ht({},i),{publishMethod:"wc_proposeSession",attestation:l})})}),Y(this,"sendApproveSession",async t=>{let{sessionTopic:r,pairingProposalResponse:i,proposal:s,sessionSettleRequest:o,publishOpts:a}=t,c=Ve.formatJsonRpcResult(s.id,i),l=await this.client.core.crypto.encode(s.pairingTopic,c,{encoding:A.BASE64}),u=Ve.formatJsonRpcRequest("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(r,u,{encoding:A.BASE64});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:s.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:Vn(ht({},a),{publishMethod:"wc_approveSession"})})}),Y(this,"sendResult",async t=>{let{id:r,topic:i,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=Ve.formatJsonRpcResult(r,s),u,d=c&&typeof(global==null?void 0:global.Linking)<"u";try{let p=d?A.BASE64URL:A.BASE64;u=await this.client.core.crypto.encode(i,l,Vn(ht({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),p}let h,f;try{h=await this.client.core.history.get(i,r);let p=h.request;try{f=this.getTVFParams(r,p.params,s)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${r}) failed`),p}if(d){let p=A.getLinkModeURL(c,i,u);await global.Linking.openURL(p,this.client.name)}else{let p=h.request.method,g=Nn[p].res;g.tvf=Vn(ht({},f),{correlationId:r}),o?(g.internal=Vn(ht({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,u,g)):this.client.core.relayer.publish(i,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),Y(this,"sendError",async t=>{let{id:r,topic:i,error:s,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=Ve.formatJsonRpcError(r,s),u,d=c&&typeof(global==null?void 0:global.Linking)<"u";try{let f=d?A.BASE64URL:A.BASE64;u=await this.client.core.crypto.encode(i,l,Vn(ht({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),f}let h;try{h=await this.client.core.history.get(i,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${i}, ${r}) failed`),f}if(d){let f=A.getLinkModeURL(c,i,u);await global.Linking.openURL(f,this.client.name)}else{let f=h.request.method,p=a||Nn[f].res;this.client.core.relayer.publish(i,u,p)}await this.client.core.history.resolve(l)}),Y(this,"cleanup",async()=>{let t=[],r=[];this.client.session.getAll().forEach(i=>{let s=!1;A.isExpired(i.expiry)&&(s=!0),this.client.core.crypto.keychain.has(i.topic)||(s=!0),s&&t.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{A.isExpired(i.expiryTimestamp)&&r.push(i.id)}),await Promise.all([...t.map(i=>this.deleteSession({topic:i})),...r.map(i=>this.deleteProposal(i))])}),Y(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),Y(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),Y(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Ns.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ns.active;let t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=Ns.idle}),Y(this,"processRequest",async t=>{let{topic:r,payload:i,attestation:s,transportType:o,encryptedId:a}=t,c=i.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:i,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,i);case"wc_sessionPing":return await this.onSessionPingRequest(r,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:i,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:i,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),Y(this,"onRelayEventResponse",async t=>{let{topic:r,payload:i,transportType:s}=t,o=(await this.client.core.history.get(r,i.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(r,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,i);case"wc_sessionExtend":return this.onSessionExtendResponse(r,i);case"wc_sessionPing":return this.onSessionPingResponse(r,i);case"wc_sessionRequest":return this.onSessionRequestResponse(r,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,i);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),Y(this,"onRelayEventUnknownPayload",t=>{let{topic:r}=t,{message:i}=A.getInternalError("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)}),Y(this,"shouldIgnorePairingRequest",t=>{let{topic:r,requestMethod:i}=t,s=this.expectedPairingMethodMap.get(r);return!s||s.includes(i)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),Y(this,"onSessionProposeRequest",async t=>{let{topic:r,payload:i,attestation:s,encryptedId:o}=t,{params:a,id:c}=i;try{let l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(ye.EVENT_CLIENT_PAIRING_ERRORS.proposal_listener_not_found)),this.isValidConnect(ht({},i.params));let u=a.expiryTimestamp||A.calcExpiry(Nn.wc_sessionPropose.req.ttl),d=ht({id:c,pairingTopic:r,expiryTimestamp:u,attestation:s,encryptedId:o},a);await this.setProposal(c,d);let h=await this.getVerifyContext({attestationId:s,hash:A.hashMessage(JSON.stringify(i)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(ye.EVENT_CLIENT_PAIRING_TRACES.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Nn.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),Y(this,"onSessionProposeResponse",async(t,r,i)=>{let{id:s}=r;if(Ve.isJsonRpcResult(r)){let{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});let a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});let c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});let l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});let u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(s,{sessionTopic:u,pairingTopic:t,proposalId:s,publicKey:c});let d=await this.client.core.relayer.subscribe(u,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:t})}else if(Ve.isJsonRpcError(r)){await this.deleteProposal(s);let o=A.engineEvent("session_connect",s);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),Y(this,"onSessionSettleRequest",async(t,r)=>{let{id:i,params:s}=r;try{this.isValidSessionSettleRequest(s);let{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:f}=r.params,p=[...this.pendingSessions.values()].find(y=>y.sessionTopic===t);if(!p)return this.client.logger.error(`Pending session not found for topic ${t}`);let g=this.client.proposal.get(p.proposalId),m=Vn(ht(ht(ht({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:ye.TRANSPORT_TYPES.relay,authentication:f?.authentication,walletPayResult:f?.walletPay});await this.client.session.set(m.topic,m),await this.setExpiry(m.topic,m.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:m.peer.metadata}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(m),await this.sendResult({id:r.id,topic:t,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:m}),this.events.emit(A.engineEvent("session_connect",p.proposalId),{session:m})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),Y(this,"onSessionSettleResponse",async(t,r)=>{let{id:i}=r;Ve.isJsonRpcResult(r)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(A.engineEvent("session_approve",i),{})):Ve.isJsonRpcError(r)&&(await this.client.session.delete(t,A.getSdkError("USER_DISCONNECTED")),this.events.emit(A.engineEvent("session_approve",i),{error:r.error}))}),Y(this,"onSessionUpdateRequest",async(t,r)=>{let{params:i,id:s}=r;try{let o=`${t}_session_update`,a=A.MemoryStore.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:t,error:A.getSdkError("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(ht({topic:t},i));try{A.MemoryStore.set(o,s),await this.client.session.update(t,{namespaces:i.namespaces}),await this.sendResult({id:s,topic:t,result:!0})}catch(c){throw A.MemoryStore.delete(o),c}this.client.events.emit("session_update",{id:s,topic:t,params:i})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),Y(this,"isRequestOutOfSync",(t,r)=>r.toString().slice(0,-3)<t.toString().slice(0,-3)),Y(this,"onSessionUpdateResponse",(t,r)=>{let{id:i}=r,s=A.engineEvent("session_update",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ve.isJsonRpcResult(r)?this.events.emit(A.engineEvent("session_update",i),{}):Ve.isJsonRpcError(r)&&this.events.emit(A.engineEvent("session_update",i),{error:r.error})}),Y(this,"onSessionExtendRequest",async(t,r)=>{let{id:i}=r;try{this.isValidExtend({topic:t}),await this.setExpiry(t,A.calcExpiry(Gl)),await this.sendResult({id:i,topic:t,result:!0}),this.client.events.emit("session_extend",{id:i,topic:t})}catch(s){await this.sendError({id:i,topic:t,error:s}),this.client.logger.error(s)}}),Y(this,"onSessionExtendResponse",(t,r)=>{let{id:i}=r,s=A.engineEvent("session_extend",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ve.isJsonRpcResult(r)?this.events.emit(A.engineEvent("session_extend",i),{}):Ve.isJsonRpcError(r)&&this.events.emit(A.engineEvent("session_extend",i),{error:r.error})}),Y(this,"onSessionPingRequest",async(t,r)=>{let{id:i}=r;try{this.isValidPing({topic:t}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:t})}catch(s){await this.sendError({id:i,topic:t,error:s}),this.client.logger.error(s)}}),Y(this,"onSessionPingResponse",(t,r)=>{let{id:i}=r,s=A.engineEvent("session_ping",i);setTimeout(()=>{if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners 2176`);Ve.isJsonRpcResult(r)?this.events.emit(A.engineEvent("session_ping",i),{}):Ve.isJsonRpcError(r)&&this.events.emit(A.engineEvent("session_ping",i),{error:r.error})},500)}),Y(this,"onSessionDeleteRequest",async(t,r)=>{let{id:i}=r;try{await this.isValidDisconnect({topic:t,reason:r.params}),this.cleanupPendingSentRequestsForTopic({topic:t,error:A.getSdkError("USER_DISCONNECTED")}),await this.deleteSession({topic:t,id:i})}catch(s){this.client.logger.error(s)}}),Y(this,"onSessionRequest",async t=>{var r,i,s;let{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:d,params:h}=a;try{await this.isValidRequest(ht({topic:o},h));let f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:A.hashMessage(JSON.stringify(Ve.formatJsonRpcRequest("wc_sessionRequest",h,d))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),u===ye.TRANSPORT_TYPES.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((i=f.peer.metadata.redirect)==null?void 0:i.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),Y(this,"onSessionRequestResponse",(t,r)=>{let{id:i}=r,s=A.engineEvent("session_request",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ve.isJsonRpcResult(r)?this.events.emit(A.engineEvent("session_request",i),{result:r.result}):Ve.isJsonRpcError(r)&&this.events.emit(A.engineEvent("session_request",i),{error:r.error})}),Y(this,"onSessionEventRequest",async(t,r)=>{let{id:i,params:s}=r;try{let o=`${t}_session_event_${s.event.name}`,a=A.MemoryStore.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.info(`Discarding out of sync request - ${i}`);return}this.isValidEmit(ht({topic:t},s)),this.client.events.emit("session_event",{id:i,topic:t,params:s}),A.MemoryStore.set(o,i)}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),Y(this,"onSessionAuthenticateResponse",(t,r)=>{let{id:i}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:r}),Ve.isJsonRpcResult(r)?this.events.emit(A.engineEvent("session_request",i),{result:r.result}):Ve.isJsonRpcError(r)&&this.events.emit(A.engineEvent("session_request",i),{error:r.error})}),Y(this,"onSessionAuthenticateRequest",async t=>{var r;let{topic:i,payload:s,attestation:o,encryptedId:a,transportType:c}=t;try{let{requester:l,authPayload:u,expiryTimestamp:d}=s.params,h=await this.getVerifyContext({attestationId:o,hash:A.hashMessage(JSON.stringify(s)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:i,id:s.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(s.id,{request:f,pairingTopic:i,transportType:c}),c===ye.TRANSPORT_TYPES.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:s.params,id:s.id,verifyContext:h})}catch(l){this.client.logger.error(l);let u=s.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(s.params.requester.metadata,c),f={type:A.TYPE_1,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:s.id,topic:i,error:l,encodeOpts:f,rpcOpts:Nn.wc_sessionAuthenticate.autoReject,appLink:h})}}),Y(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),Y(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ns.idle,this.processSessionRequestQueue()},rt.toMiliseconds(this.requestQueueDelay))}),Y(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:r})=>{let i=this.client.core.history.pending;i.length>0&&i.filter(s=>s.topic===t&&s.request.method==="wc_sessionRequest").forEach(s=>{this.events.emit(A.engineEvent("session_request",s.request.id),{error:r})})}),Y(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Ns.active){this.client.logger.info("session request queue is already active.");return}let t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(t)}catch(r){this.client.logger.error(r)}}),Y(this,"emitSessionRequest",t=>{if(this.emittedSessionRequests.has(t.id)){this.client.logger.warn({id:t.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${t.id}`);return}this.sessionRequestQueue.state=Ns.active,this.emittedSessionRequests.add(t.id),this.client.events.emit("session_request",t)}),Y(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;let r=this.client.proposal.getAll().find(i=>i.pairingTopic===t.topic);r&&this.onSessionProposeRequest({topic:t.topic,payload:Ve.formatJsonRpcRequest("wc_sessionPropose",Vn(ht({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),Y(this,"isValidConnect",async t=>{if(!A.isValidParams(t)){let{message:l}=A.getInternalError("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:o,scopedProperties:a,relays:c}=t;if(A.isUndefined(r)||await this.isValidPairingTopic(r),!A.isValidRelays(c,!0)){let{message:l}=A.getInternalError("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(i&&!A.isUndefined(i)&&A.isValidObject(i)!==0){let l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(i,"requiredNamespaces")}if(s&&!A.isUndefined(s)&&A.isValidObject(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),o&&!A.isUndefined(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!A.isUndefined(a)){this.validateSessionProps(a,"scopedProperties");let l=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),Y(this,"validateNamespaces",(t,r)=>{let i=A.isValidRequiredNamespaces(t,"connect()",r);if(i)throw new Error(i.message)}),Y(this,"isValidApprove",async t=>{if(!A.isValidParams(t))throw new Error(A.getInternalError("MISSING_OR_INVALID",`approve() params: ${t}`).message);let{id:r,namespaces:i,relayProtocol:s,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);let c=this.client.proposal.get(r),l=A.isValidNamespaces(i,"approve()");if(l)throw new Error(l.message);let u=A.isConformingNamespaces(c.requiredNamespaces,i,"approve()");if(u)throw new Error(u.message);if(!A.isValidString(s,!0)){let{message:d}=A.getInternalError("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(d)}if(o&&!A.isUndefined(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!A.isUndefined(a)){this.validateSessionProps(a,"scopedProperties");let d=new Set(Object.keys(i));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),Y(this,"isValidReject",async t=>{if(!A.isValidParams(t)){let{message:s}=A.getInternalError("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(s)}let{id:r,reason:i}=t;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!A.isValidErrorReason(i)){let{message:s}=A.getInternalError("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}}),Y(this,"isValidSessionSettleRequest",t=>{if(!A.isValidParams(t)){let{message:l}=A.getInternalError("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}let{relay:r,controller:i,namespaces:s,expiry:o}=t;if(!A.isValidRelay(r)){let{message:l}=A.getInternalError("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}let a=A.isValidController(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);let c=A.isValidNamespaces(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(A.isExpired(o)){let{message:l}=A.getInternalError("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),Y(this,"isValidUpdate",async t=>{if(!A.isValidParams(t)){let{message:c}=A.getInternalError("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}let{topic:r,namespaces:i}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let s=this.client.session.get(r),o=A.isValidNamespaces(i,"update()");if(o)throw new Error(o.message);let a=A.isConformingNamespaces(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)}),Y(this,"isValidExtend",async t=>{if(!A.isValidParams(t)){let{message:i}=A.getInternalError("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(i)}let{topic:r}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),Y(this,"isValidRequest",async t=>{if(!A.isValidParams(t)){let{message:c}=A.getInternalError("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}let{topic:r,request:i,chainId:s,expiry:o}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:a}=this.client.session.get(r);if(!A.isValidNamespacesChainId(a,s)){let{message:c}=A.getInternalError("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!A.isValidRequest(i)){let{message:c}=A.getInternalError("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(c)}if(!A.isValidNamespacesRequest(a,s,i.method)){let{message:c}=A.getInternalError("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),Y(this,"isValidRespond",async t=>{var r;if(!A.isValidParams(t)){let{message:a}=A.getInternalError("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(a)}let{topic:i,response:s}=t;try{await this.isValidSessionTopic(i)}catch(a){throw(r=t?.response)!=null&&r.id&&this.cleanupAfterResponse(t),a}if(!A.isValidResponse(s)){let{message:a}=A.getInternalError("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}let o=this.client.pendingRequest.get(s.id);if(o.topic!==i){let{message:a}=A.getInternalError("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${s.id}, expected topic: ${o.topic}, received topic: ${i}`);throw new Error(a)}}),Y(this,"isValidPing",async t=>{if(!A.isValidParams(t)){let{message:i}=A.getInternalError("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(i)}let{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),Y(this,"isValidEmit",async t=>{if(!A.isValidParams(t)){let{message:a}=A.getInternalError("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}let{topic:r,event:i,chainId:s}=t;await this.isValidSessionTopic(r);let{namespaces:o}=this.client.session.get(r);if(!A.isValidNamespacesChainId(o,s)){let{message:a}=A.getInternalError("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!A.isValidEvent(i)){let{message:a}=A.getInternalError("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!A.isValidNamespacesEvent(o,s,i.name)){let{message:a}=A.getInternalError("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}}),Y(this,"isValidDisconnect",async t=>{if(!A.isValidParams(t)){let{message:i}=A.getInternalError("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(i)}let{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),Y(this,"isValidAuthenticate",t=>{let{chains:r,uri:i,domain:s,nonce:o}=t;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!A.isValidString(i,!1))throw new Error("uri is required parameter");if(!A.isValidString(s,!1))throw new Error("domain is required parameter");if(!A.isValidString(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>A.parseChainId(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:a}=A.parseChainId(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),Y(this,"getVerifyContext",async t=>{let{attestationId:r,hash:i,encryptedId:s,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||ye.VERIFY_SERVER,validation:"UNKNOWN",origin:o.url||""}};try{if(a===ye.TRANSPORT_TYPES.link_mode){let u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}let l=await this.client.core.verify.resolve({attestationId:r,hash:i,encryptedId:s,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),Y(this,"validateSessionProps",(t,r)=>{Object.values(t).forEach((i,s)=>{if(i==null){let{message:o}=A.getInternalError("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${i} for key ${Object.keys(t)[s]}`);throw new Error(o)}})}),Y(this,"getPendingAuthRequest",t=>{let r=this.client.auth.requests.get(t);return typeof r=="object"?r:void 0}),Y(this,"addToRecentlyDeleted",(t,r)=>{if(this.recentlyDeletedMap.set(t,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0,s=this.recentlyDeletedLimit/2;for(let o of this.recentlyDeletedMap.keys()){if(i++>=s)break;this.recentlyDeletedMap.delete(o)}}}),Y(this,"checkRecentlyDeleted",t=>{let r=this.recentlyDeletedMap.get(t);if(r){let{message:i}=A.getInternalError("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${t}`);throw new Error(i)}}),Y(this,"isLinkModeEnabled",(t,r)=>{var i,s,o,a,c,l,u,d,h;return!t||r!==ye.TRANSPORT_TYPES.link_mode?!1:((s=(i=this.client.metadata)==null?void 0:i.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t?.redirect)==null?void 0:u.universal)!==void 0&&((d=t?.redirect)==null?void 0:d.universal)!==""&&((h=t?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),Y(this,"getAppLinkIfEnabled",(t,r)=>{var i;return this.isLinkModeEnabled(t,r)?(i=t?.redirect)==null?void 0:i.universal:void 0}),Y(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;let r=A.getSearchParamFromURL(t,"topic")||"",i=decodeURIComponent(A.getSearchParamFromURL(t,"wc_ev")||""),s=this.client.session.keys.includes(r);s&&this.client.session.update(r,{transportType:ye.TRANSPORT_TYPES.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:i,sessionExists:s})}),Y(this,"registerLinkModeListeners",async()=>{var t;if(A.isTestRun()||A.isReactNative()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){let r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);let i=await r.getInitialURL();i&&setTimeout(()=>{this.handleLinkModeMessage({url:i})},50)}}}),Y(this,"getTVFApproveParams",t=>{try{let r=A.getNamespacesChains(t.namespaces),i=A.getNamespacesMethods(t.namespaces),s=A.getNamespacesEvents(t.namespaces),o=t.sessionProperties,a=t.scopedProperties;return{approvedChains:r,approvedMethods:i,approvedEvents:s,sessionProperties:o,scopedProperties:a}}catch(r){return this.client.logger.warn(r,"Error getting TVF approve params"),{}}}),Y(this,"getTVFParams",(t,r,i)=>{var s,o,a;if(!((s=r.request)!=null&&s.method))return{};let c={correlationId:t,rpcMethods:[r.request.method],chainId:r.chainId};try{let l=this.extractTxHashesFromResult(r.request,i);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),Y(this,"isValidContractData",t=>{var r;if(!t)return!1;try{let i=t?.data||((r=t?.[0])==null?void 0:r.data);if(!i.startsWith("0x"))return!1;let s=i.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),Y(this,"extractTxHashesFromResult",(t,r)=>{var i;try{if(!r)return[];let s=t.method,o=K8[s];if(s==="sui_signTransaction")return[A.getSuiDigest(r.transactionBytes)];if(s==="near_signTransaction")return[A.getNearTransactionIdFromSignedTransaction(r)];if(s==="near_signTransactions")return r.map(c=>A.getNearTransactionIdFromSignedTransaction(c));if(s==="xrpl_signTransactionFor"||s==="xrpl_signTransaction")return[(i=r.tx_json)==null?void 0:i.hash];if(s==="polkadot_signTransaction")return[A.buildSignedExtrinsicHash({transaction:t.params.transactionPayload,signature:r.signature})];if(s==="algo_signTxn")return A.isValidArray(r)?r.map(c=>A.getAlgorandTransactionId(c)):[A.getAlgorandTransactionId(r)];if(s==="cosmos_signDirect")return[A.getSignDirectHash(r)];if(s==="wallet_sendCalls")return A.getWalletSendCallsHashes(r);if(typeof r=="string")return[r];let a=r[o.key];if(A.isValidArray(a))return s==="solana_signAllTransactions"?a.map(c=>A.extractSolanaTransactionId(c)):a;if(typeof a=="string")return[a]}catch(s){this.client.logger.warn(s,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[r,i]of Object.entries(t))for(let s of i)try{await this.onProviderMessageEvent({topic:r,message:s,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${s}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){let{message:e}=A.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(ye.RELAYER_EVENTS.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(lg)?this.client.auth.authKeys.get(lg):{responseTopic:void 0,publicKey:void 0};try{let a=await this.client.core.crypto.decode(t,r,{receiverPublicKey:o,encoding:s===ye.TRANSPORT_TYPES.link_mode?A.BASE64URL:A.BASE64});Ve.isJsonRpcRequest(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:i,transportType:s,encryptedId:A.hashMessage(r)})):Ve.isJsonRpcResponse(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:s}),this.client.core.history.delete(t,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:s})),await this.client.core.relayer.messages.ack(t,r)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${r}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(ye.EXPIRER_EVENTS.expired,async e=>{let{topic:t,id:r}=A.parseExpirerTarget(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,A.getInternalError("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,A.getInternalError("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(ye.PAIRING_EVENTS.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(ye.PAIRING_EVENTS.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!A.isValidString(e,!1)){let{message:t}=A.getInternalError("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=A.getInternalError("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(A.isExpired(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=A.getInternalError("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!A.isValidString(e,!1)){let{message:t}=A.getInternalError("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=A.getInternalError("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(A.isExpired(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=A.getInternalError("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=A.getInternalError("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(A.isValidString(e,!1)){let{message:t}=A.getInternalError("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{let{message:t}=A.getInternalError("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!A.isValidId(e)){let{message:t}=A.getInternalError("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=A.getInternalError("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(A.isExpired(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=A.getInternalError("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}validateRequestExpiry(e){if(e&&!A.isValidRequestExpiry(e,R0)){let{message:t}=A.getInternalError("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${R0.min} and ${R0.max}`);throw new Error(t)}}},CT=class extends ye.Store{constructor(e,t){super(e,t,z8,M0),this.core=e,this.logger=t}},O0=class extends ye.Store{constructor(e,t){super(e,t,G8,M0),this.core=e,this.logger=t}},ST=class extends ye.Store{constructor(e,t){super(e,t,Q8,M0,r=>r.id),this.core=e,this.logger=t}},AT=class extends ye.Store{constructor(e,t){super(e,t,X8,ug,()=>lg),this.core=e,this.logger=t}},_T=class extends ye.Store{constructor(e,t){super(e,t,e4,ug),this.core=e,this.logger=t}},TT=class extends ye.Store{constructor(e,t){super(e,t,t4,ug,r=>r.id),this.core=e,this.logger=t}},Sce=Object.defineProperty,Ace=(n,e,t)=>e in n?Sce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wT=(n,e,t)=>Ace(n,typeof e!="symbol"?e+"":e,t),xT=class{constructor(e,t){this.core=e,this.logger=t,wT(this,"authKeys"),wT(this,"pairingTopics"),wT(this,"requests"),this.authKeys=new AT(this.core,this.logger),this.pairingTopics=new _T(this.core,this.logger),this.requests=new TT(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}},_ce=Object.defineProperty,Tce=(n,e,t)=>e in n?_ce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ye=(n,e,t)=>Tce(n,typeof e!="symbol"?e+"":e,t),P0=class n extends q8.ISignClient{constructor(e){super(e),Ye(this,"protocol",DT),Ye(this,"version",NT),Ye(this,"name",N0.name),Ye(this,"metadata"),Ye(this,"core"),Ye(this,"logger"),Ye(this,"events",new $8.EventEmitter),Ye(this,"engine"),Ye(this,"session"),Ye(this,"proposal"),Ye(this,"pendingRequest"),Ye(this,"auth"),Ye(this,"signConfig"),Ye(this,"on",(r,i)=>this.events.on(r,i)),Ye(this,"once",(r,i)=>this.events.once(r,i)),Ye(this,"off",(r,i)=>this.events.off(r,i)),Ye(this,"removeListener",(r,i)=>this.events.removeListener(r,i)),Ye(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Ye(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"update",async r=>{try{return await this.engine.update(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"request",async r=>{try{return await this.engine.request(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"find",r=>{try{return this.engine.find(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Ye(this,"authenticate",async(r,i)=>{try{return await this.engine.authenticate(r,i)}catch(s){throw this.logger.error(s.message),s}}),Ye(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(i){throw this.logger.error(i.message),i}}),Ye(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(i){throw this.logger.error(i.message),i}}),this.name=e?.name||N0.name,this.metadata=A.populateAppMetadata(e?.metadata),this.signConfig=e?.signConfig;let t=A.createLogger({logger:e?.logger||N0.logger,name:this.name});this.logger=t,this.core=e?.core||new ye.Core(e),this.session=new O0(this.core,this.logger),this.proposal=new CT(this.core,this.logger),this.pendingRequest=new ST(this.core,this.logger),this.engine=new IT(this),this.auth=new xT(this.core,this.logger)}static async init(e){let t=new n(e);return await t.initialize(),t}get context(){return lce.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}},xce=O0,Dce=P0;qe.AUTH_CONTEXT=Z8,qe.AUTH_KEYS_CONTEXT=X8,qe.AUTH_PAIRING_TOPIC_CONTEXT=e4,qe.AUTH_PROTOCOL=J8,qe.AUTH_PUBLIC_KEY_NAME=lg,qe.AUTH_REQUEST_CONTEXT=t4,qe.AUTH_STORAGE_PREFIX=ug,qe.AUTH_VERSION=wce,qe.ENGINE_CONTEXT=W8,qe.ENGINE_QUEUE_STATES=Ns,qe.ENGINE_RPC_OPTS=Nn,qe.HISTORY_CONTEXT=gce,qe.HISTORY_EVENTS=pce,qe.HISTORY_STORAGE_VERSION=mce,qe.METHODS_TO_VERIFY=Y8,qe.PROPOSAL_CONTEXT=z8,qe.PROPOSAL_EXPIRY=yce,qe.PROPOSAL_EXPIRY_MESSAGE=bT,qe.REQUEST_CONTEXT=Q8,qe.SESSION_CONTEXT=G8,qe.SESSION_EXPIRY=Gl,qe.SESSION_REQUEST_EXPIRY_BOUNDARIES=R0,qe.SIGN_CLIENT_CONTEXT=RT,qe.SIGN_CLIENT_DEFAULT=N0,qe.SIGN_CLIENT_EVENTS=hce,qe.SIGN_CLIENT_PROTOCOL=DT,qe.SIGN_CLIENT_STORAGE_OPTIONS=fce,qe.SIGN_CLIENT_STORAGE_PREFIX=M0,qe.SIGN_CLIENT_VERSION=NT,qe.SessionStore=xce,qe.SignClient=Dce,qe.TVF_METHODS=K8,qe.WALLETCONNECT_DEEPLINK_CHOICE=vT,qe.default=P0});var F4=Bs(j0=>{"use strict";Object.defineProperty(j0,"__esModule",{value:!0});var Nce=n4(),Et=eg(),qT=(pu(),Fe(fu)),I4=(Wg(),Fe(Gg)),C4=(tR(),Fe(eR)),Rce=co();function S4(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var Oce=S4(C4),Pce=S4(Rce);function zT(n){return n==null||typeof n!="object"&&typeof n!="function"}function A4(n){return Object.getOwnPropertySymbols(n).filter(e=>Object.prototype.propertyIsEnumerable.call(n,e))}function _4(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}var Mce="[object RegExp]",T4="[object String]",x4="[object Number]",D4="[object Boolean]",N4="[object Arguments]",kce="[object Symbol]",Lce="[object Date]",Fce="[object Map]",Bce="[object Set]",Uce="[object Array]",jce="[object ArrayBuffer]",Vce="[object Object]",Hce="[object DataView]",$ce="[object Uint8Array]",qce="[object Uint8ClampedArray]",zce="[object Uint16Array]",Gce="[object Uint32Array]",Wce="[object Int8Array]",Kce="[object Int16Array]",Qce="[object Int32Array]",Yce="[object Float32Array]",Jce="[object Float64Array]";function GT(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Zce(n,e){return rh(n,void 0,n,new Map,e)}function rh(n,e,t,r=new Map,i=void 0){let s=i?.(n,e,t,r);if(s!=null)return s;if(zT(n))return n;if(r.has(n))return r.get(n);if(Array.isArray(n)){let o=new Array(n.length);r.set(n,o);for(let a=0;a<n.length;a++)o[a]=rh(n[a],a,t,r,i);return Object.hasOwn(n,"index")&&(o.index=n.index),Object.hasOwn(n,"input")&&(o.input=n.input),o}if(n instanceof Date)return new Date(n.getTime());if(n instanceof RegExp){let o=new RegExp(n.source,n.flags);return o.lastIndex=n.lastIndex,o}if(n instanceof Map){let o=new Map;r.set(n,o);for(let[a,c]of n)o.set(a,rh(c,a,t,r,i));return o}if(n instanceof Set){let o=new Set;r.set(n,o);for(let a of n)o.add(rh(a,void 0,t,r,i));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(n))return n.subarray();if(GT(n)){let o=new(Object.getPrototypeOf(n)).constructor(n.length);r.set(n,o);for(let a=0;a<n.length;a++)o[a]=rh(n[a],a,t,r,i);return o}if(n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer)return n.slice(0);if(n instanceof DataView){let o=new DataView(n.buffer.slice(0),n.byteOffset,n.byteLength);return r.set(n,o),Kl(o,n,t,r,i),o}if(typeof File<"u"&&n instanceof File){let o=new File([n],n.name,{type:n.type});return r.set(n,o),Kl(o,n,t,r,i),o}if(n instanceof Blob){let o=new Blob([n],{type:n.type});return r.set(n,o),Kl(o,n,t,r,i),o}if(n instanceof Error){let o=new n.constructor;return r.set(n,o),o.message=n.message,o.name=n.name,o.stack=n.stack,o.cause=n.cause,Kl(o,n,t,r,i),o}if(typeof n=="object"&&Xce(n)){let o=Object.create(Object.getPrototypeOf(n));return r.set(n,o),Kl(o,n,t,r,i),o}return n}function Kl(n,e,t=n,r,i){let s=[...Object.keys(e),...A4(e)];for(let o=0;o<s.length;o++){let a=s[o],c=Object.getOwnPropertyDescriptor(n,a);(c==null||c.writable)&&(n[a]=rh(e[a],a,t,r,i))}}function Xce(n){switch(_4(n)){case N4:case Uce:case jce:case Hce:case D4:case Lce:case Yce:case Jce:case Wce:case Kce:case Qce:case Fce:case x4:case Vce:case Mce:case Bce:case T4:case kce:case $ce:case qce:case zce:case Gce:return!0;default:return!1}}function ele(n,e){return Zce(n,(t,r,i,s)=>{let o=e?.(t,r,i,s);if(o!=null)return o;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case x4:case T4:case D4:{let a=new n.constructor(n?.valueOf());return Kl(a,n),a}case N4:{let a={};return Kl(a,n),a.length=n.length,a[Symbol.iterator]=n[Symbol.iterator],a}default:return}})}function r4(n){return ele(n)}function i4(n){return n!==null&&typeof n=="object"&&_4(n)==="[object Arguments]"}function s4(n){return typeof n=="object"&&n!==null}function tle(){}function nle(n){return GT(n)}function rle(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){let t=n[Symbol.toStringTag];return t==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${t}]`}let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e}function ile(n){if(zT(n))return n;if(Array.isArray(n)||GT(n)||n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer)return n.slice(0);let e=Object.getPrototypeOf(n),t=e.constructor;if(n instanceof Date||n instanceof Map||n instanceof Set)return new t(n);if(n instanceof RegExp){let r=new t(n);return r.lastIndex=n.lastIndex,r}if(n instanceof DataView)return new t(n.buffer.slice(0));if(n instanceof Error){let r=new t(n.message);return r.stack=n.stack,r.name=n.name,r.cause=n.cause,r}if(typeof File<"u"&&n instanceof File)return new t([n],n.name,{type:n.type,lastModified:n.lastModified});if(typeof n=="object"){let r=Object.create(e);return Object.assign(r,n)}return n}function sle(n,...e){let t=e.slice(0,-1),r=e[e.length-1],i=n;for(let s=0;s<t.length;s++){let o=t[s];i=BT(i,o,r,new Map)}return i}function BT(n,e,t,r){if(zT(n)&&(n=Object(n)),e==null||typeof e!="object")return n;if(r.has(e))return ile(r.get(e));if(r.set(e,n),Array.isArray(e)){e=e.slice();for(let s=0;s<e.length;s++)e[s]=e[s]??void 0}let i=[...Object.keys(e),...A4(e)];for(let s=0;s<i.length;s++){let o=i[s],a=e[o],c=n[o];if(i4(a)&&(a=H({},a)),i4(c)&&(c=H({},c)),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=r4(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){let u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){let f=d[h];u[f]=c[f]}c=u}else c=[];let l=t(c,a,o,n,e,r);l!=null?n[o]=l:Array.isArray(a)||s4(c)&&s4(a)?n[o]=BT(c,a,t,r):c==null&&rle(a)?n[o]=BT({},a,t,r):c==null&&nle(a)?n[o]=r4(a):(c===void 0||a!==void 0)&&(n[o]=a)}return n}function ole(n,...e){return sle(n,...e,tle)}var o4="error",ale="wss://relay.walletconnect.org",cle="wc",R4="universal_provider",k0=`${cle}@2:${R4}:`,O4="https://rpc.walletconnect.org/v1/",P4="generic",lle=`${O4}bundler`,ih="call_status",ule=86400,WT={DEFAULT_CHAIN_CHANGED:"default_chain_changed"},dle=Object.defineProperty,hle=Object.defineProperties,fle=Object.getOwnPropertyDescriptors,a4=Object.getOwnPropertySymbols,ple=Object.prototype.hasOwnProperty,gle=Object.prototype.propertyIsEnumerable,c4=(n,e,t)=>e in n?dle(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,L0=(n,e)=>{for(var t in e||(e={}))ple.call(e,t)&&c4(n,t,e[t]);if(a4)for(var t of a4(e))gle.call(e,t)&&c4(n,t,e[t]);return n},mle=(n,e)=>hle(n,fle(e));function M4(n,e,t){var r;let i=Et.parseChainId(n);return((r=e.rpcMap)==null?void 0:r[i.reference])||`${O4}?chainId=${i.namespace}:${i.reference}&projectId=${t}`}function yle(n){return n.includes(":")?n.split(":")[1]:n}function k4(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function wle(n,e){let t=Object.keys(e.namespaces).filter(i=>i.includes(n));if(!t.length)return[];let r=[];return t.forEach(i=>{let s=e.namespaces[i].accounts;r.push(...s)}),r}function l4(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>{var r,i;return((r=t?.chains)==null?void 0:r.length)&&((i=t?.chains)==null?void 0:i.length)>0}))}function F0(n={},e={}){let t=l4(u4(n)),r=l4(u4(e));return ole(t,r)}function u4(n){var e,t,r,i,s;let o={};if(!Et.isValidObject(n))return o;for(let[a,c]of Object.entries(n)){let l=Et.isCaipNamespace(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},f=Et.parseNamespaceKey(a);o[f]=mle(L0(L0({},o[f]),c),{chains:Et.mergeArrays(l,(e=o[f])==null?void 0:e.chains),methods:Et.mergeArrays(u,(t=o[f])==null?void 0:t.methods),events:Et.mergeArrays(d,(r=o[f])==null?void 0:r.events)}),(Et.isValidObject(h)||Et.isValidObject(((i=o[f])==null?void 0:i.rpcMap)||{}))&&(o[f].rpcMap=L0(L0({},h),(s=o[f])==null?void 0:s.rpcMap))}return o}function d4(n){return n.includes(":")?n.split(":")[2]:n}function h4(n){let e={};for(let[t,r]of Object.entries(n)){let i=r.methods||[],s=r.events||[],o=r.accounts||[],a=Et.isCaipNamespace(t)?[t]:r.chains?r.chains:k4(r.accounts);e[t]={chains:a,methods:i,events:s,accounts:o}}return e}function OT(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):(n=n.includes(":")?n.split(":")[1]:n,isNaN(Number(n))?n:Number(n))}function vle(n){try{let e=JSON.parse(n);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}var L4={},sh=n=>L4[n],PT=(n,e)=>{L4[n]=e},ble=Object.defineProperty,f4=Object.getOwnPropertySymbols,Ele=Object.prototype.hasOwnProperty,Ile=Object.prototype.propertyIsEnumerable,p4=(n,e,t)=>e in n?ble(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,g4=(n,e)=>{for(var t in e||(e={}))Ele.call(e,t)&&p4(n,t,e[t]);if(f4)for(var t of f4(e))Ile.call(e,t)&&p4(n,t,e[t]);return n},m4="eip155",Cle=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],Sle=n=>n&&n.startsWith("0x")?BigInt(n).toString(10):n,MT=n=>n&&n.startsWith("0x")?n:`0x${BigInt(n).toString(16)}`,y4=n=>Object.keys(n).filter(e=>Cle.includes(e)).reduce((e,t)=>(e[t]=Ale(n[t]),e),{}),Ale=n=>typeof n=="string"&&vle(n)?JSON.parse(n):n,_le=(n,e,t)=>{let{sessionProperties:r={},scopedProperties:i={}}=n,s={};if(!Et.isValidObject(i)&&!Et.isValidObject(r))return;let o=y4(r);for(let a of t){let c=Sle(a);if(!c)continue;s[MT(c)]=o;let l=i?.[`${m4}:${c}`];if(l){let u=l?.[`${m4}:${c}:${e}`];s[MT(c)]=g4(g4({},s[MT(c)]),y4(u||l))}}for(let[a,c]of Object.entries(s))Object.keys(c).length===0&&delete s[a];return Object.keys(s).length>0?s:void 0},Tle=Object.defineProperty,xle=(n,e,t)=>e in n?Tle(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Dle=(n,e,t)=>xle(n,typeof e!="symbol"?e+"":e,t),kT,UT=class n{constructor(e){Dle(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,t){return await this.storage.setItem(e,t)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return kT||(kT=new n(e)),kT}},Nle=Object.defineProperty,Rle=Object.defineProperties,Ole=Object.getOwnPropertyDescriptors,w4=Object.getOwnPropertySymbols,Ple=Object.prototype.hasOwnProperty,Mle=Object.prototype.propertyIsEnumerable,v4=(n,e,t)=>e in n?Nle(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,kle=(n,e)=>{for(var t in e||(e={}))Ple.call(e,t)&&v4(n,t,e[t]);if(w4)for(var t of w4(e))Mle.call(e,t)&&v4(n,t,e[t]);return n},Lle=(n,e)=>Rle(n,Ole(e));async function Fle(n,e){let t=Et.parseChainId(n.result.capabilities.caip345.caip2),r=n.result.capabilities.caip345.transactionHashes,i=await Promise.allSettled(r.map(d=>Ble(t.reference,d,e))),s=i.filter(d=>d.status==="fulfilled").map(d=>d.value).filter(d=>d);i.filter(d=>d.status==="rejected").forEach(d=>console.warn("Failed to fetch transaction receipt:",d.reason));let o=!s.length||s.some(d=>!d),a=s.every(d=>d?.status==="0x1"),c=s.every(d=>d?.status==="0x0"),l=s.some(d=>d?.status==="0x0"),u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:n.result.id,version:n.request.version,atomic:n.request.atomicRequired,chainId:n.request.chainId,capabilities:n.result.capabilities,receipts:s,status:u}}async function Ble(n,e,t){return await t(parseInt(n)).request(qT.formatJsonRpcRequest("eth_getTransactionReceipt",[e]))}async function Ule({sendCalls:n,storage:e}){let t=await e.getItem(ih);await e.setItem(ih,Lle(kle({},t),{[n.result.id]:{request:n.request,result:n.result,expiry:Et.calcExpiry(ule)}}))}async function jle({resultId:n,storage:e}){let t=await e.getItem(ih);if(t){delete t[n],await e.setItem(ih,t);for(let r in t)Et.isExpired(t[r].expiry)&&delete t[r];await e.setItem(ih,t)}}async function Vle({resultId:n,storage:e}){let t=await e.getItem(ih),r=t?.[n];if(r&&!Et.isExpired(r.expiry))return r;await jle({resultId:n,storage:e})}var Hle=Object.defineProperty,$le=Object.defineProperties,qle=Object.getOwnPropertyDescriptors,b4=Object.getOwnPropertySymbols,zle=Object.prototype.hasOwnProperty,Gle=Object.prototype.propertyIsEnumerable,jT=(n,e,t)=>e in n?Hle(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,LT=(n,e)=>{for(var t in e||(e={}))zle.call(e,t)&&jT(n,t,e[t]);if(b4)for(var t of b4(e))Gle.call(e,t)&&jT(n,t,e[t]);return n},FT=(n,e)=>$le(n,qle(e)),Wl=(n,e,t)=>jT(n,typeof e!="symbol"?e+"":e,t),VT=class{constructor(e){Wl(this,"name","eip155"),Wl(this,"client"),Wl(this,"chainId"),Wl(this,"namespace"),Wl(this,"httpProviders"),Wl(this,"events"),Wl(this,"storage"),this.namespace=e.namespace,this.events=sh("events"),this.client=sh("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=UT.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t);let r=this.chainId;this.chainId=parseInt(e),this.events.emit(WT.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let r=t||M4(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new I4.JsonRpcProvider(new C4.HttpConnection(r,sh("disableProviderPing")))}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=parseInt(yle(t));e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(e){let t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=FT(LT({},this.httpProviders),{[t]:this.createHttpProvider(t)}),this.httpProviders[t])}async handleSwitchChain(e){var t,r;let i=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;let s=parseInt(i,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${s}`);else throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,i,s,o;let a=(r=(t=e.request)==null?void 0:t.params)==null?void 0:r[0],c=((s=(i=e.request)==null?void 0:i.params)==null?void 0:s[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");let l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let f;try{f=_le(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(f)return f;let p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:FT(LT({},l.sessionProperties||{}),{capabilities:FT(LT({},u||{}),{[d]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var t,r,i;let s=this.client.session.get(e.topic),o=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(o){let l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}let a=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}let c=await Vle({resultId:(i=e.request.params)==null?void 0:i[0],storage:this.storage});if(c)try{return await Fle(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;let i=new URL(e),s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(qT.formatJsonRpcRequest("eth_getUserOperationReceipt",[(r=t.request.params)==null?void 0:r[0]]))});if(!s.ok)throw new Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${lle}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}async sendCalls(e){var t,r,i;let s=await this.client.request(e),o=(t=e.request.params)==null?void 0:t[0],a=s?.id,c=s?.capabilities||{},l=(r=c?.caip345)==null?void 0:r.caip2,u=(i=c?.caip345)==null?void 0:i.transactionHashes;return!a||!l||!(u!=null&&u.length)||await Ule({sendCalls:{request:o,result:s},storage:this.storage}),s}},Wle=Object.defineProperty,Kle=(n,e,t)=>e in n?Wle(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,nh=(n,e,t)=>Kle(n,typeof e!="symbol"?e+"":e,t),HT=class{constructor(e){nh(this,"name",P4),nh(this,"client"),nh(this,"httpProviders"),nh(this,"events"),nh(this,"namespace"),nh(this,"chainId"),this.namespace=e.namespace,this.events=sh("events"),this.client=sh("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t);let r=this.chainId;this.chainId=e,this.events.emit(WT.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return Et.parseChainId(e).namespace}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;let r={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(i=>{var s,o;let a=Et.parseChainId(i),c=(o=(s=this.namespace)==null?void 0:s.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];r[a.reference]=this.createHttpProvider(i,c)}),r}getHttpProvider(e){let t=Et.parseChainId(e).reference,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||M4(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new I4.JsonRpcProvider(new Oce.default(r,sh("disableProviderPing")))}},Qle=Object.defineProperty,Yle=Object.defineProperties,Jle=Object.getOwnPropertyDescriptors,E4=Object.getOwnPropertySymbols,Zle=Object.prototype.hasOwnProperty,Xle=Object.prototype.propertyIsEnumerable,$T=(n,e,t)=>e in n?Qle(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dg=(n,e)=>{for(var t in e||(e={}))Zle.call(e,t)&&$T(n,t,e[t]);if(E4)for(var t of E4(e))Xle.call(e,t)&&$T(n,t,e[t]);return n},B0=(n,e)=>Yle(n,Jle(e)),wi=(n,e,t)=>$T(n,typeof e!="symbol"?e+"":e,t),U0=class n{constructor(e){wi(this,"client"),wi(this,"namespaces"),wi(this,"optionalNamespaces"),wi(this,"sessionProperties"),wi(this,"scopedProperties"),wi(this,"events",new Pce.default),wi(this,"rpcProviders",{}),wi(this,"session"),wi(this,"providerOpts"),wi(this,"logger"),wi(this,"uri"),wi(this,"disableProviderPing",!1),wi(this,"connectParams");var t,r;this.providerOpts=e,this.logger=Et.createLogger({logger:(t=e.logger)!=null?t:o4,name:(r=this.providerOpts.name)!=null?r:R4}),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new n(e);return await t.initialize(),t}async request(e,t,r){let[i,s]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:dg({},e),chainId:`${i}:${s}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){let s=new Date().getTime();this.request(e,r,i).then(o=>t(null,qT.formatJsonRpcResult(s,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Et.getSdkError("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.connectParams=e,this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));let s=await i();if(this.session=s.session,this.session){let o=h4(this.session.namespaces);this.namespaces=F0(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){var t,r;let{uri:i,approval:s}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties,authentication:(t=this.connectParams)==null?void 0:t.authentication,walletPay:(r=this.connectParams)==null?void 0:r.walletPay});i&&(this.uri=i,this.events.emit("display_uri",i));let o=await s();this.session=o;let a=h4(o.namespaces);return this.namespaces=F0(this.namespaces,a),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[r,i]=this.validateChain(e);this.getProvider(r).setDefaultChain(i,t)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(!Et.isValidArray(t))return;for(let r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}catch(t){this.logger.warn(t,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await Nce.SignClient.init({core:this.providerOpts.core,logger:this.providerOpts.logger||o4,relayUrl:this.providerOpts.relayUrl||ale,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error(r,"Failed to get session"),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{let r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(t=>Et.parseNamespaceKey(t)))];PT("client",this.client),PT("events",this.events),PT("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;let r=wle(t,this.session);if(r?.length===0)return;let i=k4(r),s=F0(this.namespaces,this.optionalNamespaces),o=B0(dg({},s[t]),{accounts:r,chains:i});switch(t){case"eip155":this.rpcProviders[t]=new VT({namespace:o});break;default:this.rpcProviders[t]=new HT({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:r}=e;r===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:r,topic:i}=e;if(i!==((t=this.session)==null?void 0:t.topic))return;let{event:s}=r;if(s.name==="accountsChanged"){let o=s.data;o&&Et.isValidArray(o)&&this.events.emit("accountsChanged",o.map(d4))}else if(s.name==="chainChanged"){let o=r.chainId,a=r.event.data,c=Et.parseNamespaceKey(o),l=OT(o)!==OT(a)?`${c}:${OT(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,i;if(e!==((r=this.session)==null?void 0:r.topic))return;let{namespaces:s}=t,o=(i=this.client)==null?void 0:i.session.get(e);this.session=B0(dg({},o),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",B0(dg({},Et.getSdkError("USER_DISCONNECTED")),{data:e.topic})))}),this.on(WT.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(B0(dg({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[P4]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t={},optionalNamespaces:r={},sessionProperties:i,scopedProperties:s}=e;this.optionalNamespaces=F0(t,r),this.sessionProperties=i,this.scopedProperties=s}validateChain(e){let[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(o=>Et.parseNamespaceKey(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];let i=Et.parseNamespaceKey(Object.keys(this.namespaces)[0]),s=this.rpcProviders[i].getDefaultChain();return[i,s]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:t,internal:r=!1}){if(!this.namespaces)return;let[i,s]=this.validateChain(e);s&&(this.updateNamespaceChain(i,s),r?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:i,currentCaipChainId:e,previousCaipChainId:t})):this.getProvider(i).setDefaultChain(s),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:t,previousCaipChainId:r}){var i,s;try{if(r===t)return;let o=(s=(i=this.session)==null?void 0:i.namespaces[e])==null?void 0:s.accounts;if(!o)return;let a=o.filter(c=>c.includes(`${t}:`)).map(d4);if(!Et.isValidArray(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,t){if(!this.namespaces)return;let r=this.namespaces[e]?e:`${e}:${t}`,i={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=i}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.connectParams=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;let i=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${k0}/${e}${i}`,t)}async getFromStore(e){var t;let r=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${k0}/${e}${r}`)}async deleteFromStore(e){var t;let r=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${k0}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;let t=await this.client.core.storage.getKeys();for(let r of t)r.startsWith(k0)&&await this.client.core.storage.removeItem(r)}catch(t){this.logger.warn(t,"Failed to cleanup storage")}}},eue=U0;j0.UniversalProvider=eue,j0.default=U0});var W0={};Nh(W0,{MAX_LOG_SIZE_IN_BYTES_DEFAULT:()=>G0,PINO_CUSTOM_CONTEXT_KEY:()=>hg,PINO_LOGGER_DEFAULTS:()=>V4,formatChildLoggerContext:()=>q4,generateChildLogger:()=>yue,generateClientLogger:()=>z4,generatePlatformLogger:()=>wue,generateServerLogger:()=>G4,getDefaultLoggerOptions:()=>mue,getLoggerContext:()=>$4,pino:()=>j4.pino,setLoggerContext:()=>H4});function mue(n){return z0(q0({},n),{level:n?.level||V4.level})}function H4(n,e,t=hg){return n[t]=e,n}function $4(n,e=hg){return n[e]||""}function q4(n,e,t=hg){let r=$4(n,t);return r.trim()?`${r}/${e}`:e}function yue(n,e,t=hg){let r=q4(n,e,t),i=n.child({context:r});return H4(i,r,t)}function z4(n){var e,t;let r=new QT((e=n.opts)==null?void 0:e.level,n.maxSizeInBytes);return{logger:(0,Wo.default)(z0(q0({},n.opts),{level:"trace",browser:z0(q0({},(t=n.opts)==null?void 0:t.browser),{write:i=>r.write(i)})})),chunkLoggerController:r}}function G4(n){var e;let t=new YT((e=n.opts)==null?void 0:e.level,n.maxSizeInBytes);return{logger:(0,Wo.default)(z0(q0({},n.opts),{level:"trace"}),t),chunkLoggerController:t}}function wue(n){return typeof n.loggerOverride<"u"&&typeof n.loggerOverride!="string"?{logger:n.loggerOverride,chunkLoggerController:null}:typeof window<"u"?z4(n):G4(n)}var Wo,j4,V4,hg,G0,tue,nue,oc,KT,H0,rue,iue,V0,$0,sue,oue,aue,QT,cue,lue,uue,YT,due,hue,fue,B4,pue,gue,U4,q0,z0,K0=ni(()=>{"use strict";Wo=du(aR()),j4=du(aR());dE();V4={level:"info"},hg="custom_context",G0=1e3*1024,tue=Object.defineProperty,nue=(n,e,t)=>e in n?tue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,oc=(n,e,t)=>nue(n,typeof e!="symbol"?e+"":e,t),KT=class{constructor(e){oc(this,"nodeValue"),oc(this,"sizeInBytes"),oc(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},H0=class{constructor(e){oc(this,"lengthInNodes"),oc(this,"sizeInBytes"),oc(this,"head"),oc(this,"tail"),oc(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new KT(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}},rue=Object.defineProperty,iue=(n,e,t)=>e in n?rue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,V0=(n,e,t)=>iue(n,typeof e!="symbol"?e+"":e,t),$0=class{constructor(e,t=G0){V0(this,"logs"),V0(this,"level"),V0(this,"levelValue"),V0(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Wo.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new H0(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Wo.levels.values.error?console.error(e):t===Wo.levels.values.warn?console.warn(e):t===Wo.levels.values.debug?console.debug(e):t===Wo.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(uE({timestamp:new Date().toISOString(),log:e}));let t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new H0(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push(uE({extraMetadata:e})),new Blob(t,{type:"application/json"})}},sue=Object.defineProperty,oue=(n,e,t)=>e in n?sue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,aue=(n,e,t)=>oue(n,typeof e!="symbol"?e+"":e,t),QT=class{constructor(e,t=G0){aue(this,"baseChunkLogger"),this.baseChunkLogger=new $0(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}},cue=Object.defineProperty,lue=(n,e,t)=>e in n?cue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,uue=(n,e,t)=>lue(n,typeof e!="symbol"?e+"":e,t),YT=class{constructor(e,t=G0){uue(this,"baseChunkLogger"),this.baseChunkLogger=new $0(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}},due=Object.defineProperty,hue=Object.defineProperties,fue=Object.getOwnPropertyDescriptors,B4=Object.getOwnPropertySymbols,pue=Object.prototype.hasOwnProperty,gue=Object.prototype.propertyIsEnumerable,U4=(n,e,t)=>e in n?due(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,q0=(n,e)=>{for(var t in e||(e={}))pue.call(e,t)&&U4(n,t,e[t]);if(B4)for(var t of B4(e))gue.call(e,t)&&U4(n,t,e[t]);return n},z0=(n,e)=>hue(n,fue(e))});var mx={};Nh(mx,{ICore:()=>JT,ICrypto:()=>ZT,IEchoClient:()=>ux,IEngine:()=>gx,IEngineEvents:()=>px,IEventClient:()=>dx,IExpirer:()=>ax,IJsonRpcHistory:()=>XT,IKeyChain:()=>ox,IMessageTracker:()=>ex,IPairing:()=>cx,IPublisher:()=>tx,IRelayer:()=>nx,ISignClient:()=>fx,ISignClientEvents:()=>hx,IStore:()=>rx,ISubscriber:()=>sx,ISubscriberTopicMap:()=>ix,IVerify:()=>lx});var Q0,vue,bue,W4,JT,ZT,Eue,Iue,Cue,XT,ex,tx,nx,rx,Sue,Aue,_ue,ix,sx,ox,ax,cx,lx,ux,dx,Tue,xue,K4,hx,fx,px,gx,yx=ni(()=>{"use strict";WN();Q0=du(co()),vue=Object.defineProperty,bue=(n,e,t)=>e in n?vue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,W4=(n,e,t)=>bue(n,typeof e!="symbol"?e+"":e,t),JT=class extends Pr{constructor(e){super(),this.opts=e,W4(this,"protocol","wc"),W4(this,"version",2)}},ZT=class{constructor(e,t,r){this.core=e,this.logger=t}},Eue=Object.defineProperty,Iue=(n,e,t)=>e in n?Eue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Cue=(n,e,t)=>Iue(n,typeof e!="symbol"?e+"":e,t),XT=class extends Pr{constructor(e,t){super(),this.core=e,this.logger=t,Cue(this,"records",new Map)}},ex=class{constructor(e,t){this.logger=e,this.core=t}},tx=class extends Pr{constructor(e,t){super(),this.relayer=e,this.logger=t}},nx=class extends Pr{constructor(e){super()}},rx=class{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}},Sue=Object.defineProperty,Aue=(n,e,t)=>e in n?Sue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_ue=(n,e,t)=>Aue(n,typeof e!="symbol"?e+"":e,t),ix=class{constructor(){_ue(this,"map",new Map)}},sx=class extends Pr{constructor(e,t){super(),this.relayer=e,this.logger=t}},ox=class{constructor(e,t){this.core=e,this.logger=t}},ax=class extends Pr{constructor(e,t){super(),this.core=e,this.logger=t}},cx=class{constructor(e,t){this.logger=e,this.core=t}},lx=class{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}},ux=class{constructor(e,t){this.projectId=e,this.logger=t}},dx=class{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}},Tue=Object.defineProperty,xue=(n,e,t)=>e in n?Tue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,K4=(n,e,t)=>xue(n,typeof e!="symbol"?e+"":e,t),hx=class extends Q0.default{constructor(){super()}},fx=class{constructor(e){this.opts=e,K4(this,"protocol","wc"),K4(this,"version",2)}},px=class extends Q0.EventEmitter{constructor(){super()}},gx=class{constructor(e){this.client=e}}});var Sb=Bs(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});var Due=(LN(),Fe(kN)),lh=hu(),Xo=Vg(),Nue=FN(),Q4=UN(),Rue=jN(),Y4=(HN(),Fe(VN)),Oue=BN(),Pue=($g(),Fe(Hg)),yt=(zg(),Fe(qg)),Mue=(zN(),Fe(qN)),kue=GN(),Lue=(K0(),Fe(W0));function Fue(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var Ig=Fue(Rue),cb=":";function eD(n){let[e,t]=n.split(cb);return{namespace:e,reference:t}}function D6(n){let{namespace:e,reference:t}=n;return[e,t].join(cb)}function tD(n){let[e,t,r]=n.split(cb);return{namespace:e,reference:t,address:r}}function N6(n){let{namespace:e,reference:t,address:r}=n;return[e,t,r].join(cb)}function nD(n,e){let t=[];return n.forEach(r=>{let i=e(r);t.includes(i)||t.push(i)}),t}function R6(n){let{address:e}=tD(n);return e}function O6(n){let{namespace:e,reference:t}=tD(n);return D6({namespace:e,reference:t})}function Bue(n,e){let{namespace:t,reference:r}=eD(e);return N6({namespace:t,reference:r,address:n})}function Uue(n){return nD(n,R6)}function P6(n){return nD(n,O6)}function jue(n,e=[]){let t=[];return Object.keys(n).forEach(r=>{if(e.length&&!e.includes(r))return;let i=n[r];t.push(...i.accounts)}),t}function Vue(n,e=[]){let t=[];return Object.keys(n).forEach(r=>{if(e.length&&!e.includes(r))return;let i=n[r];t.push(...P6(i.accounts))}),t}function Hue(n,e=[]){let t=[];return Object.keys(n).forEach(r=>{if(e.length&&!e.includes(r))return;let i=n[r];t.push(...lb(r,i))}),t}function lb(n,e){return n.includes(":")?[n]:e.chains||[]}var $ue=Object.defineProperty,que=Object.defineProperties,zue=Object.getOwnPropertyDescriptors,J4=Object.getOwnPropertySymbols,Gue=Object.prototype.hasOwnProperty,Wue=Object.prototype.propertyIsEnumerable,Nx=(n,e,t)=>e in n?$ue(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Z4=(n,e)=>{for(var t in e||(e={}))Gue.call(e,t)&&Nx(n,t,e[t]);if(J4)for(var t of J4(e))Wue.call(e,t)&&Nx(n,t,e[t]);return n},Kue=(n,e)=>que(n,zue(e)),X4=(n,e,t)=>Nx(n,typeof e!="symbol"?e+"":e,t),M6="ReactNative",Dr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},tb=" ",Que=":",k6="/",rD=2,Yue=1e3,L6="js";function iD(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ic(){return!Xo.getDocument()&&!!Xo.getNavigator()&&navigator.product===M6}function Jue(){return Ic()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function Zue(){return Ic()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function mh(){return!iD()&&!!Xo.getNavigator()&&!!Xo.getDocument()}function eu(){return Ic()?Dr.reactNative:iD()?Dr.node:mh()?Dr.browser:Dr.unknown}function Xue(){var n;try{return Ic()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function F6(n,e){let t=new URLSearchParams(n);return Object.entries(e).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!=null&&t.set(r,String(i))}),t.toString()}function ede(n){var e,t;let r=B6();try{return n!=null&&n.url&&r.url&&new URL(n.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${n.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),n.url=r.url),(e=n?.icons)!=null&&e.length&&n.icons.length>0&&(n.icons=n.icons.filter(i=>i!=="")),Kue(Z4(Z4({},r),n),{url:n?.url||r.url,name:n?.name||r.name,description:n?.description||r.description,icons:(t=n?.icons)!=null&&t.length&&n.icons.length>0?n.icons:r.icons})}catch(i){return console.warn("Error populating app metadata",i),n||r}}function B6(){return Nue.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function tde(n,e){var t;let r=eu(),i={protocol:n,version:e,env:r};return r==="browser"&&(i.host=((t=Xo.getLocation())==null?void 0:t.host)||"unknown"),i}function U6(){if(eu()===Dr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){let{OS:t,Version:r}=global.Platform;return[t,r].join("-")}let n=Due.detect();if(n===null)return"unknown";let e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function j6(){var n;let e=eu();return e===Dr.browser?[e,((n=Xo.getLocation())==null?void 0:n.host)||"unknown"].join(":"):e}function V6(n,e,t){let r=U6(),i=j6();return[[n,e].join("-"),[L6,t].join("-"),r,i].join("/")}function nde({protocol:n,version:e,relayUrl:t,sdkVersion:r,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){let l=t.split("?"),u=V6(n,e,r),d={auth:i,ua:u,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},h=F6(l[1]||"",d);return l[0]+"?"+h}function rde(n){let e=(n.match(/^[^:]+(?=:\/\/)/gi)||[])[0],t=typeof e<"u"?n.split("://")[1]:n;return e=e==="wss"?"https":"http",[e,t].join("://")}function ide(n,e,t){if(!n[e]||typeof n[e]!==t)throw new Error(`Missing or invalid "${e}" param`)}function H6(n,e=rD){return $6(n.split(k6),e)}function sde(n){return H6(n).join(tb)}function yc(n,e){return n.filter(t=>e.includes(t)).length===n.length}function $6(n,e=rD){return n.slice(Math.max(n.length-e,0))}function ode(n){return Object.fromEntries(n.entries())}function ade(n){return new Map(Object.entries(n))}function cde(n,e){let t={};return Object.keys(n).forEach(r=>{t[r]=e(n[r])}),t}var lde=n=>n;function q6(n){return n.trim().replace(/^\w/,e=>e.toUpperCase())}function ude(n){return n.split(tb).map(e=>q6(e)).join(tb)}function dde(n=lh.FIVE_MINUTES,e){let t=lh.toMiliseconds(n||lh.FIVE_MINUTES),r,i,s,o;return{resolve:a=>{s&&r&&(clearTimeout(s),r(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{let l=new Error(e);o=Promise.reject(l),c(l)},t),r=a,i=c})}}function hde(n,e,t){return new Promise(async(r,i)=>{let s=setTimeout(()=>i(new Error(t)),e);try{let o=await n;r(o)}catch(o){i(o)}clearTimeout(s)})}function sD(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function fde(n){return sD("topic",n)}function pde(n){return sD("id",n)}function gde(n){let[e,t]=n.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")r.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))r.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return r}function mde(n,e){return lh.fromMiliseconds((e||Date.now())+lh.toMiliseconds(n))}function yde(n){return Date.now()>=lh.toMiliseconds(n)}function wde(n,e){return`${n}${e?`:${e}`:""}`}function Gi(n=[],e=[]){return[...new Set([...n,...e])]}async function vde({id:n,topic:e,wcDeepLink:t}){var r;try{if(!t)return;let i=typeof t=="string"?JSON.parse(t):t,s=i?.href;if(typeof s!="string")return;let o=z6(s,n,e),a=eu();if(a===Dr.browser){if(!((r=Xo.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}G6(o)}else a===Dr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(i){console.error(i)}}function z6(n,e,t){let r=`requestId=${e}&sessionTopic=${t}`;n.endsWith("/")&&(n=n.slice(0,-1));let i=`${n}`;if(n.startsWith("https://t.me")){let s=n.includes("?")?"&startapp=":"?startapp=";i=`${i}${s}${Q6(r,!0)}`}else i=`${i}/wc?${r}`;return i}function G6(n){let e="_self";K6()?e="_top":(W6()||n.startsWith("https://")||n.startsWith("http://"))&&(e="_blank"),window.open(n,e,"noreferrer noopener")}async function bde(n,e){let t="";try{if(mh()&&(t=localStorage.getItem(e),t))return t;t=await n.getItem(e)}catch(r){console.error(r)}return t}function Rx(n,e){return n.filter(t=>e.includes(t))}function Ede(n,e){if(!n.includes(e))return null;let t=n.split(/([&,?,=])/),r=t.indexOf(e);return t[r+2]}function Ide(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,n=>{let e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}function Cde(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function W6(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function K6(){try{return window.self!==window.top}catch{return!1}}function Q6(n,e=!1){let t=Buffer.from(n).toString("base64");return e?t.replace(/[=]/g,""):t}function oD(n){return Buffer.from(n,"base64").toString("utf-8")}function Sde(n){return new Promise(e=>setTimeout(e,n))}var Ox=class{constructor({limit:e}){X4(this,"limit"),X4(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){let t=this.set.values().next().value;t&&this.set.delete(t)}this.set.add(e)}}has(e){return this.set.has(e)}},Y0=BigInt(2**32-1),e6=BigInt(32);function Y6(n,e=!1){return e?{h:Number(n&Y0),l:Number(n>>e6&Y0)}:{h:Number(n>>e6&Y0)|0,l:Number(n&Y0)|0}}function J6(n,e=!1){let t=n.length,r=new Uint32Array(t),i=new Uint32Array(t);for(let s=0;s<t;s++){let{h:o,l:a}=Y6(n[s],e);[r[s],i[s]]=[o,a]}return[r,i]}var t6=(n,e,t)=>n>>>t,n6=(n,e,t)=>n<<32-t|e>>>t,fc=(n,e,t)=>n>>>t|e<<32-t,pc=(n,e,t)=>n<<32-t|e>>>t,gg=(n,e,t)=>n<<64-t|e>>>t-32,mg=(n,e,t)=>n>>>t-32|e<<64-t,Ade=(n,e)=>e,_de=(n,e)=>n,Tde=(n,e,t)=>n<<t|e>>>32-t,xde=(n,e,t)=>e<<t|n>>>32-t,Dde=(n,e,t)=>e<<t-32|n>>>64-t,Nde=(n,e,t)=>n<<t-32|e>>>64-t;function Os(n,e,t,r){let i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}var aD=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),cD=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,Rde=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),Ode=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,Pde=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),Mde=(n,e,t,r,i,s)=>e+t+r+i+s+(n/2**32|0)|0,oh=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ub(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function ea(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function Ms(n,...e){if(!ub(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function db(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ea(n.outputLen),ea(n.blockLen)}function bc(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function lD(n,e){Ms(n);let t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function wg(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function Wi(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function wx(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function io(n,e){return n<<32-e|n>>>e}var Z6=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function X6(n){return n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255}var Qo=Z6?n=>n:n=>X6(n);function kde(n){for(let e=0;e<n.length;e++)n[e]=X6(n[e]);return n}var gc=Z6?n=>n:kde,e5=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Lde=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function uh(n){if(Ms(n),e5)return n.toHex();let e="";for(let t=0;t<n.length;t++)e+=Lde[n[t]];return e}var Ko={_0:48,_9:57,A:65,F:70,a:97,f:102};function r6(n){if(n>=Ko._0&&n<=Ko._9)return n-Ko._0;if(n>=Ko.A&&n<=Ko.F)return n-(Ko.A-10);if(n>=Ko.a&&n<=Ko.f)return n-(Ko.a-10)}function nb(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);if(e5)return Uint8Array.fromHex(n);let e=n.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(t);for(let i=0,s=0;i<t;i++,s+=2){let o=r6(n.charCodeAt(s)),a=r6(n.charCodeAt(s+1));if(o===void 0||a===void 0){let c=n[s]+n[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=o*16+a}return r}function t5(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function Ps(n){return typeof n=="string"&&(n=t5(n)),Ms(n),n}function mc(...n){let e=0;for(let r=0;r<n.length;r++){let i=n[r];Ms(i),e+=i.length}let t=new Uint8Array(e);for(let r=0,i=0;r<n.length;r++){let s=n[r];t.set(s,i),i+=s.length}return t}var fh=class{};function Cg(n){let e=r=>n().update(Ps(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Fde(n){let e=(r,i)=>n(i).update(Ps(r)).digest(),t=n({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}function tu(n=32){if(oh&&typeof oh.getRandomValues=="function")return oh.getRandomValues(new Uint8Array(n));if(oh&&typeof oh.randomBytes=="function")return Uint8Array.from(oh.randomBytes(n));throw new Error("crypto.getRandomValues must be defined")}var Bde=BigInt(0),fg=BigInt(1),Ude=BigInt(2),jde=BigInt(7),Vde=BigInt(256),Hde=BigInt(113),n5=[],r5=[],i5=[];for(let n=0,e=fg,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],n5.push(2*(5*r+t)),r5.push((n+1)*(n+2)/2%64);let i=Bde;for(let s=0;s<7;s++)e=(e<<fg^(e>>jde)*Hde)%Vde,e&Ude&&(i^=fg<<(fg<<BigInt(s))-fg);i5.push(i)}var s5=J6(i5,!0),$de=s5[0],qde=s5[1],i6=(n,e,t)=>t>32?Dde(n,e,t):Tde(n,e,t),s6=(n,e,t)=>t>32?Nde(n,e,t):xde(n,e,t);function zde(n,e=24){let t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=i6(l,u,1)^t[a],h=s6(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)n[o+f]^=d,n[o+f+1]^=h}let i=n[2],s=n[3];for(let o=0;o<24;o++){let a=r5[o],c=i6(i,s,a),l=s6(i,s,a),u=n5[o];i=n[u],s=n[u+1],n[u]=c,n[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=$de[r],n[1]^=qde[r]}Wi(t)}var Px=class n extends fh{constructor(e,t,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,ea(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=wg(this.state)}clone(){return this._cloneInto()}keccak(){gc(this.state32),zde(this.state32,this.rounds),gc(this.state32),this.posOut=0,this.pos=0}update(e){bc(this),e=Ps(e),Ms(e);let{blockLen:t,state:r}=this,i=e.length;for(let s=0;s<i;){let o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(t&128)!==0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){bc(this,!1),Ms(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let o=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ea(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(lD(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Wi(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new n(t,r,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}},Gde=(n,e,t)=>Cg(()=>new Px(e,n,t)),Wde=Gde(1,136,256/8);function Kde(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}function Qde(n,e,t){return n&e^~n&t}function Yde(n,e,t){return n&e^n&t^e&t}var rb=class extends fh{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=wx(this.buffer)}update(e){bc(this),e=Ps(e),Ms(e);let{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=wx(e);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){bc(this),lD(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:o}=this;t[o++]=128,Wi(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)t[d]=0;Kde(r,i-8,BigInt(this.length*8),s),this.process(r,0);let a=wx(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=i,e.pos=a,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}},ac=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),sr=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),or=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Jde=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cc=new Uint32Array(64),Mx=class extends rb{constructor(e=32){super(64,e,8,!1),this.A=ac[0]|0,this.B=ac[1]|0,this.C=ac[2]|0,this.D=ac[3]|0,this.E=ac[4]|0,this.F=ac[5]|0,this.G=ac[6]|0,this.H=ac[7]|0}get(){let{A:e,B:t,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[e,t,r,i,s,o,a,c]}set(e,t,r,i,s,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let d=0;d<16;d++,t+=4)cc[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){let h=cc[d-15],f=cc[d-2],p=io(h,7)^io(h,18)^h>>>3,g=io(f,17)^io(f,19)^f>>>10;cc[d]=g+cc[d-7]+p+cc[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){let h=io(a,6)^io(a,11)^io(a,25),f=u+h+Qde(a,c,l)+Jde[d]+cc[d]|0,p=(io(r,2)^io(r,13)^io(r,22))+Yde(r,i,s)|0;u=l,l=c,c=a,a=o+f|0,o=s,s=i,i=r,r=f+p|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,l,u)}roundClean(){Wi(cc)}destroy(){this.set(0,0,0,0,0,0,0,0),Wi(this.buffer)}},o5=J6(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),Zde=o5[0],Xde=o5[1],lc=new Uint32Array(80),uc=new Uint32Array(80),vg=class extends rb{constructor(e=64){super(128,e,16,!1),this.Ah=or[0]|0,this.Al=or[1]|0,this.Bh=or[2]|0,this.Bl=or[3]|0,this.Ch=or[4]|0,this.Cl=or[5]|0,this.Dh=or[6]|0,this.Dl=or[7]|0,this.Eh=or[8]|0,this.El=or[9]|0,this.Fh=or[10]|0,this.Fl=or[11]|0,this.Gh=or[12]|0,this.Gl=or[13]|0,this.Hh=or[14]|0,this.Hl=or[15]|0}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m]}set(e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let I=0;I<16;I++,t+=4)lc[I]=e.getUint32(t),uc[I]=e.getUint32(t+=4);for(let I=16;I<80;I++){let L=lc[I-15]|0,k=uc[I-15]|0,D=fc(L,k,1)^fc(L,k,8)^t6(L,k,7),B=pc(L,k,1)^pc(L,k,8)^n6(L,k,7),U=lc[I-2]|0,T=uc[I-2]|0,$=fc(U,T,19)^gg(U,T,61)^t6(U,T,6),W=pc(U,T,19)^mg(U,T,61)^n6(U,T,6),M=Rde(B,W,uc[I-7],uc[I-16]),v=Ode(M,D,$,lc[I-7],lc[I-16]);lc[I]=v|0,uc[I]=M|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:y,Hl:E}=this;for(let I=0;I<80;I++){let L=fc(d,h,14)^fc(d,h,18)^gg(d,h,41),k=pc(d,h,14)^pc(d,h,18)^mg(d,h,41),D=d&f^~d&g,B=h&p^~h&m,U=Pde(E,k,B,Xde[I],uc[I]),T=Mde(U,y,L,D,Zde[I],lc[I]),$=U|0,W=fc(r,i,28)^gg(r,i,34)^gg(r,i,39),M=pc(r,i,28)^mg(r,i,34)^mg(r,i,39),v=r&s^r&a^s&a,b=i&o^i&c^o&c;y=g|0,E=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Os(l|0,u|0,T|0,$|0),l=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;let w=aD($,M,b);r=cD(w,T,W,v),i=w|0}({h:r,l:i}=Os(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Os(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Os(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Os(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Os(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Os(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Os(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:E}=Os(this.Hh|0,this.Hl|0,y|0,E|0),this.set(r,i,s,o,a,c,l,u,d,h,f,p,g,m,y,E)}roundClean(){Wi(lc,uc)}destroy(){Wi(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},kx=class extends vg{constructor(){super(48),this.Ah=sr[0]|0,this.Al=sr[1]|0,this.Bh=sr[2]|0,this.Bl=sr[3]|0,this.Ch=sr[4]|0,this.Cl=sr[5]|0,this.Dh=sr[6]|0,this.Dl=sr[7]|0,this.Eh=sr[8]|0,this.El=sr[9]|0,this.Fh=sr[10]|0,this.Fl=sr[11]|0,this.Gh=sr[12]|0,this.Gl=sr[13]|0,this.Hh=sr[14]|0,this.Hl=sr[15]|0}},ar=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),Lx=class extends vg{constructor(){super(32),this.Ah=ar[0]|0,this.Al=ar[1]|0,this.Bh=ar[2]|0,this.Bl=ar[3]|0,this.Ch=ar[4]|0,this.Cl=ar[5]|0,this.Dh=ar[6]|0,this.Dl=ar[7]|0,this.Eh=ar[8]|0,this.El=ar[9]|0,this.Fh=ar[10]|0,this.Fl=ar[11]|0,this.Gh=ar[12]|0,this.Gl=ar[13]|0,this.Hh=ar[14]|0,this.Hl=ar[15]|0}},hb=Cg(()=>new Mx),ehe=Cg(()=>new vg),the=Cg(()=>new kx),nhe=Cg(()=>new Lx),rhe=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),bn=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ue=new Uint32Array(32);function dc(n,e,t,r,i,s){let o=i[s],a=i[s+1],c=ue[2*n],l=ue[2*n+1],u=ue[2*e],d=ue[2*e+1],h=ue[2*t],f=ue[2*t+1],p=ue[2*r],g=ue[2*r+1],m=aD(c,u,o);l=cD(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:Ade(g,p),Dl:_de(g)},{h:f,l:h}=Os(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:fc(d,u,24),Bl:pc(d,u,24)},ue[2*n]=c,ue[2*n+1]=l,ue[2*e]=u,ue[2*e+1]=d,ue[2*t]=h,ue[2*t+1]=f,ue[2*r]=p,ue[2*r+1]=g}function hc(n,e,t,r,i,s){let o=i[s],a=i[s+1],c=ue[2*n],l=ue[2*n+1],u=ue[2*e],d=ue[2*e+1],h=ue[2*t],f=ue[2*t+1],p=ue[2*r],g=ue[2*r+1],m=aD(c,u,o);l=cD(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:fc(g,p,16),Dl:pc(g,p,16)},{h:f,l:h}=Os(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:gg(d,u,63),Bl:mg(d,u,63)},ue[2*n]=c,ue[2*n+1]=l,ue[2*e]=u,ue[2*e+1]=d,ue[2*t]=h,ue[2*t+1]=f,ue[2*r]=p,ue[2*r+1]=g}function ihe(n,e={},t,r,i){if(ea(t),n<0||n>t)throw new Error("outputLen bigger than keyLen");let{key:s,salt:o,personalization:a}=e;if(s!==void 0&&(s.length<1||s.length>t))throw new Error("key length must be undefined or 1.."+t);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==i)throw new Error("personalization must be undefined or "+i)}var Fx=class extends fh{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,ea(e),ea(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=wg(this.buffer)}update(e){bc(this),e=Ps(e),Ms(e);let{blockLen:t,buffer:r,buffer32:i}=this,s=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<s;){this.pos===t&&(gc(i),this.compress(i,0,!1),gc(i),this.pos=0);let l=Math.min(t-this.pos,s-c),u=o+c;if(l===t&&!(u%4)&&c+l<s){let d=new Uint32Array(a,u,Math.floor((s-c)/4));gc(d);for(let h=0;c+t<s;h+=i.length,c+=t)this.length+=t,this.compress(d,h,!1);gc(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){bc(this),lD(e,this);let{pos:t,buffer32:r}=this;this.finished=!0,Wi(this.buffer.subarray(t)),gc(r),this.compress(r,0,!0),gc(r);let i=wg(e);this.get().forEach((s,o)=>i[o]=Qo(s))}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){let{buffer:t,length:r,finished:i,destroyed:s,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=s,e.finished=i,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}},Bx=class extends Fx{constructor(e={}){let t=e.dkLen===void 0?64:e.dkLen;super(128,t),this.v0l=bn[0]|0,this.v0h=bn[1]|0,this.v1l=bn[2]|0,this.v1h=bn[3]|0,this.v2l=bn[4]|0,this.v2h=bn[5]|0,this.v3l=bn[6]|0,this.v3h=bn[7]|0,this.v4l=bn[8]|0,this.v4h=bn[9]|0,this.v5l=bn[10]|0,this.v5h=bn[11]|0,this.v6l=bn[12]|0,this.v6h=bn[13]|0,this.v7l=bn[14]|0,this.v7h=bn[15]|0,ihe(t,e,64,16,16);let{key:r,personalization:i,salt:s}=e,o=0;if(r!==void 0&&(r=Ps(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,s!==void 0){s=Ps(s);let a=wg(s);this.v4l^=Qo(a[0]),this.v4h^=Qo(a[1]),this.v5l^=Qo(a[2]),this.v5h^=Qo(a[3])}if(i!==void 0){i=Ps(i);let a=wg(i);this.v6l^=Qo(a[0]),this.v6h^=Qo(a[1]),this.v7l^=Qo(a[2]),this.v7h^=Qo(a[3])}if(r!==void 0){let a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:f,v6h:p,v7l:g,v7h:m}=this;return[e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m]}set(e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m){this.v0l=e|0,this.v0h=t|0,this.v1l=r|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=f|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,t,r){this.get().forEach((c,l)=>ue[l]=c),ue.set(bn,16);let{h:i,l:s}=Y6(BigInt(this.length));ue[24]=bn[8]^s,ue[25]=bn[9]^i,r&&(ue[28]=~ue[28],ue[29]=~ue[29]);let o=0,a=rhe;for(let c=0;c<12;c++)dc(0,4,8,12,e,t+2*a[o++]),hc(0,4,8,12,e,t+2*a[o++]),dc(1,5,9,13,e,t+2*a[o++]),hc(1,5,9,13,e,t+2*a[o++]),dc(2,6,10,14,e,t+2*a[o++]),hc(2,6,10,14,e,t+2*a[o++]),dc(3,7,11,15,e,t+2*a[o++]),hc(3,7,11,15,e,t+2*a[o++]),dc(0,5,10,15,e,t+2*a[o++]),hc(0,5,10,15,e,t+2*a[o++]),dc(1,6,11,12,e,t+2*a[o++]),hc(1,6,11,12,e,t+2*a[o++]),dc(2,7,8,13,e,t+2*a[o++]),hc(2,7,8,13,e,t+2*a[o++]),dc(3,4,9,14,e,t+2*a[o++]),hc(3,4,9,14,e,t+2*a[o++]);this.v0l^=ue[0]^ue[16],this.v0h^=ue[1]^ue[17],this.v1l^=ue[2]^ue[18],this.v1h^=ue[3]^ue[19],this.v2l^=ue[4]^ue[20],this.v2h^=ue[5]^ue[21],this.v3l^=ue[6]^ue[22],this.v3h^=ue[7]^ue[23],this.v4l^=ue[8]^ue[24],this.v4h^=ue[9]^ue[25],this.v5l^=ue[10]^ue[26],this.v5h^=ue[11]^ue[27],this.v6l^=ue[12]^ue[28],this.v6h^=ue[13]^ue[29],this.v7l^=ue[14]^ue[30],this.v7h^=ue[15]^ue[31],Wi(ue)}destroy(){this.destroyed=!0,Wi(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},she=Fde(n=>new Bx(n)),ohe="https://rpc.walletconnect.org/v1";function uD(n){let e=`Ethereum Signed Message:
${n.length}`,t=new TextEncoder().encode(e+n);return"0x"+Buffer.from(Wde(t)).toString("hex")}async function a5(n,e,t,r,i,s){switch(t.t){case"eip191":return await c5(n,e,t.s);case"eip1271":return await l5(n,e,t.s,r,i,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function c5(n,e,t){let r=Q4.Signature.fromHex(t);return Q4.Secp256k1.recoverAddress({payload:uD(e),signature:r}).toLowerCase()===n.toLowerCase()}async function l5(n,e,t,r,i,s){let o=eD(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{let a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=t.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:uD(e)).substring(2),h=a+d+c+u+l,f=await fetch(`${s||ohe}/?chainId=${r}&projectId=${i}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:ahe(),jsonrpc:"2.0",method:"eth_call",params:[{to:n,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function ahe(){return Date.now()+Math.floor(Math.random()*1e3)}function che(n){let e=atob(n),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);let r=t[0];if(r===0)throw new Error("No signatures found");let i=1+r*64;if(t.length<i)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");let s=Buffer.from(n,"base64").slice(1,65);return Ig.default.encode(s)}function lhe(n){let e=new Uint8Array(Buffer.from(n,"base64")),t=Array.from("TransactionData::").map(s=>s.charCodeAt(0)),r=new Uint8Array(t.length+e.length);r.set(t),r.set(e,t.length);let i=she(r,{dkLen:32});return Ig.default.encode(i)}function uhe(n){let e=new Uint8Array(hb(u5(n)));return Ig.default.encode(e)}function u5(n){if(n instanceof Uint8Array)return n;if(Array.isArray(n))return new Uint8Array(n);if(typeof n=="object"&&n!=null&&n.data)return new Uint8Array(Object.values(n.data));if(typeof n=="object"&&n)return new Uint8Array(Object.values(n));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function dhe(n){let e=Buffer.from(n,"base64"),t=Y4.decode(e).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");let r=Y4.encode(t),i=Buffer.from("TX"),s=Buffer.concat([i,Buffer.from(r)]),o=nhe(s);return Oue.base32.encode(o).replace(/=+$/,"")}function vx(n){let e=[],t=BigInt(n);for(;t>=BigInt(128);)e.push(Number(t&BigInt(127)|BigInt(128))),t>>=BigInt(7);return e.push(Number(t)),Buffer.from(e)}function hhe(n){let e=Buffer.from(n.signed.bodyBytes,"base64"),t=Buffer.from(n.signed.authInfoBytes,"base64"),r=Buffer.from(n.signature.signature,"base64"),i=[];i.push(Buffer.from([10])),i.push(vx(e.length)),i.push(e),i.push(Buffer.from([18])),i.push(vx(t.length)),i.push(t),i.push(Buffer.from([26])),i.push(vx(r.length)),i.push(r);let s=Buffer.concat(i),o=hb(s);return Buffer.from(o).toString("hex").toUpperCase()}function fhe(n){var e,t;let r=[];try{if(typeof n=="string")return r.push(n),r;if(typeof n!="object")return r;n!=null&&n.id&&r.push(n.id);let i=(t=(e=n?.capabilities)==null?void 0:e.caip345)==null?void 0:t.transactionHashes;i&&r.push(...i)}catch(i){console.warn("getWalletSendCallsHashes failed: ",i)}return r}var phe=Object.defineProperty,ghe=Object.defineProperties,mhe=Object.getOwnPropertyDescriptors,o6=Object.getOwnPropertySymbols,yhe=Object.prototype.hasOwnProperty,whe=Object.prototype.propertyIsEnumerable,a6=(n,e,t)=>e in n?phe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dD=(n,e)=>{for(var t in e||(e={}))yhe.call(e,t)&&a6(n,t,e[t]);if(o6)for(var t of o6(e))whe.call(e,t)&&a6(n,t,e[t]);return n},d5=(n,e)=>ghe(n,mhe(e)),vhe="did:pkh:",fb=n=>n?.split(":"),h5=n=>{let e=n&&fb(n);if(e)return n.includes(vhe)?e[3]:e[1]},f5=n=>{let e=n&&fb(n);if(e)return e[2]+":"+e[3]},hD=n=>{let e=n&&fb(n);if(e)return e.pop()};async function bhe(n){let{cacao:e,projectId:t}=n,{s:r,p:i}=e,s=p5(i,i.iss),o=hD(i.iss);return await a5(o,s,r,f5(i.iss),t)}var p5=(n,e)=>{let t=`${n.domain} wants you to sign in with your Ethereum account:`,r=hD(e);if(!n.aud&&!n.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=n.statement||void 0,s=`URI: ${n.aud||n.uri}`,o=`Version: ${n.version}`,a=`Chain ID: ${h5(e)}`,c=`Nonce: ${n.nonce}`,l=`Issued At: ${n.iat}`,u=n.exp?`Expiration Time: ${n.exp}`:void 0,d=n.nbf?`Not Before: ${n.nbf}`:void 0,h=n.requestId?`Request ID: ${n.requestId}`:void 0,f=n.resources?`Resources:${n.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=gb(n.resources);if(p){let g=Ec(p);i=gD(i,g)}return[t,r,"",i,"",s,o,a,c,l,u,d,h,f].filter(g=>g!=null).join(`
`)};function Ehe(n,e,t){return t.includes("did:pkh:")||(t=`did:pkh:${t}`),{h:{t:"caip122"},p:{iss:t,domain:n.domain,aud:n.aud,version:n.version,nonce:n.nonce,iat:n.iat,statement:n.statement,requestId:n.requestId,resources:n.resources,nbf:n.nbf,exp:n.exp},s:e}}function Ihe(n){var e;let{authPayload:t,chains:r,methods:i}=n,s=t.statement||"";if(!(r!=null&&r.length))return t;let o=t.chains,a=Rx(o,r);if(!(a!=null&&a.length))throw new Error("No supported chains");let c=g5(t.resources);if(!c)return t;so(c);let l=m5(c,"eip155"),u=t?.resources||[];if(l!=null&&l.length){let d=y5(l),h=Rx(d,i);if(!(h!=null&&h.length))throw new Error(`Supported methods don't satisfy the requested: ${JSON.stringify(d)}, supported: ${JSON.stringify(i)}`);let f=fD("request",h,{chains:a}),p=E5(c,"eip155",f);u=((e=t?.resources)==null?void 0:e.slice(0,-1))||[],u.push(pb(p))}return d5(dD({},t),{statement:C5(s,gb(u)),chains:a,resources:t!=null&&t.resources||u.length>0?u:void 0})}function g5(n){let e=gb(n);if(e&&pD(e))return Ec(e)}function Che(n,e){var t;return(t=n?.att)==null?void 0:t.hasOwnProperty(e)}function m5(n,e){var t,r;return(t=n?.att)!=null&&t[e]?Object.keys((r=n?.att)==null?void 0:r[e]):[]}function She(n){return n?.map(e=>Object.keys(e))||[]}function y5(n){return n?.map(e=>{var t;return(t=e.split("/"))==null?void 0:t[1]})||[]}function w5(n){return Buffer.from(JSON.stringify(n)).toString("base64")}function v5(n){return JSON.parse(Buffer.from(n,"base64").toString("utf-8"))}function so(n){if(!n)throw new Error("No recap provided, value is undefined");if(!n.att)throw new Error("No `att` property found");let e=Object.keys(n.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{let r=n.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(i=>{let s=r[i];if(!Array.isArray(s))throw new Error(`Ability limits ${i} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${i} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${i}) must be an array of objects, found: ${o}`)})})})}function b5(n,e,t,r={}){return t?.sort((i,s)=>i.localeCompare(s)),{att:{[n]:fD(e,t,r)}}}function E5(n,e,t){var r;n.att[e]=dD({},t);let i=(r=Object.keys(n.att))==null?void 0:r.sort((o,a)=>o.localeCompare(a)),s={att:{}};return i.reduce((o,a)=>(o.att[a]=n.att[a],o),s)}function fD(n,e,t={}){e=e?.sort((i,s)=>i.localeCompare(s));let r=e.map(i=>({[`${n}/${i}`]:[t]}));return Object.assign({},...r)}function pb(n){return so(n),`urn:recap:${w5(n).replace(/=/g,"")}`}function Ec(n){let e=v5(n.replace("urn:recap:",""));return so(e),e}function Ahe(n,e,t){let r=b5(n,e,t);return pb(r)}function pD(n){return n&&n.includes("urn:recap:")}function _he(n,e){let t=Ec(n),r=Ec(e),i=I5(t,r);return pb(i)}function I5(n,e){so(n),so(e);let t=Object.keys(n.att).concat(Object.keys(e.att)).sort((i,s)=>i.localeCompare(s)),r={att:{}};return t.forEach(i=>{var s,o;Object.keys(((s=n.att)==null?void 0:s[i])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[i])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[i]=d5(dD({},r.att[i]),{[a]:((c=n.att[i])==null?void 0:c[a])||((l=e.att[i])==null?void 0:l[a])})})}),r}function gD(n="",e){so(e);let t="I further authorize the stated URI to perform the following actions on my behalf: ";if(n.includes(t))return n;let r=[],i=0;Object.keys(e.att).forEach(a=>{let c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));let l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});let u=Object.keys(l).map(d=>(i++,`(${i}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});let s=r.join(" "),o=`${t}${s}`;return`${n?n+" ":""}${o}`}function The(n){var e;let t=Ec(n);so(t);let r=(e=t.att)==null?void 0:e.eip155;return r?Object.keys(r).map(i=>i.split("/")[1]):[]}function xhe(n){let e=Ec(n);so(e);let t=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(i=>{var s;(s=i?.[0])!=null&&s.chains&&t.push(i[0].chains)})}),[...new Set(t.flat())]}function C5(n,e){if(!e)return n;let t=Ec(e);return so(t),gD(n,t)}function gb(n){if(!n)return;let e=n?.[n.length-1];return pD(e)?e:void 0}function S5(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function Ux(n){if(typeof n!="boolean")throw new Error(`boolean expected, not ${n}`)}function bx(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function Zr(n,...e){if(!S5(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function c6(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Dhe(n,e){Zr(n);let t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function wc(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function ph(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function Nhe(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}var Rhe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ohe(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function jx(n){if(typeof n=="string")n=Ohe(n);else if(S5(n))n=Vx(n);else throw new Error("Uint8Array expected, got "+typeof n);return n}function Phe(n,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(n,e)}function Mhe(n,e){if(n.length!==e.length)return!1;let t=0;for(let r=0;r<n.length;r++)t|=n[r]^e[r];return t===0}var khe=(n,e)=>{function t(r,...i){if(Zr(r),!Rhe)throw new Error("Non little-endian hardware is not yet supported");if(n.nonceLength!==void 0){let l=i[0];if(!l)throw new Error("nonce / iv required");n.varSizeNonce?Zr(l):Zr(l,n.nonceLength)}let s=n.tagLength;s&&i[1]!==void 0&&Zr(i[1]);let o=e(r,...i),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Zr(u)}},c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Zr(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Zr(l),s&&l.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,n),t};function l6(n,e,t=!0){if(e===void 0)return new Uint8Array(n);if(e.length!==n)throw new Error("invalid output length, expected "+n+", got: "+e.length);if(t&&!Fhe(e))throw new Error("invalid output, must be aligned");return e}function u6(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}function Lhe(n,e,t){Ux(t);let r=new Uint8Array(16),i=Nhe(r);return u6(i,0,BigInt(e),t),u6(i,8,BigInt(n),t),r}function Fhe(n){return n.byteOffset%4===0}function Vx(n){return Uint8Array.from(n)}var A5=n=>Uint8Array.from(n.split("").map(e=>e.charCodeAt(0))),Bhe=A5("expand 16-byte k"),Uhe=A5("expand 32-byte k"),jhe=wc(Bhe),Vhe=wc(Uhe);function at(n,e){return n<<e|n>>>32-e}function Hx(n){return n.byteOffset%4===0}var J0=64,Hhe=16,_5=2**32-1,d6=new Uint32Array;function $he(n,e,t,r,i,s,o,a){let c=i.length,l=new Uint8Array(J0),u=wc(l),d=Hx(i)&&Hx(s),h=d?wc(i):d6,f=d?wc(s):d6;for(let p=0;p<c;o++){if(n(e,t,r,u,o,a),o>=_5)throw new Error("arx: counter overflow");let g=Math.min(J0,c-p);if(d&&g===J0){let m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let y=0,E;y<Hhe;y++)E=m+y,f[E]=h[E]^u[y];p+=J0;continue}for(let m=0,y;m<g;m++)y=p+m,s[y]=i[y]^l[m];p+=g}}function qhe(n,e){let{allowShortKeys:t,extendNonceFn:r,counterLength:i,counterRight:s,rounds:o}=Phe({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof n!="function")throw new Error("core must be a function");return bx(i),bx(o),Ux(s),Ux(t),(a,c,l,u,d=0)=>{Zr(a),Zr(c),Zr(l);let h=l.length;if(u===void 0&&(u=new Uint8Array(h)),Zr(u),bx(d),d<0||d>=_5)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);let f=[],p=a.length,g,m;if(p===32)f.push(g=Vx(a)),m=Vhe;else if(p===16&&t)g=new Uint8Array(32),g.set(a),g.set(a,16),m=jhe,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Hx(c)||f.push(c=Vx(c));let y=wc(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,y,wc(c.subarray(0,16)),y),c=c.subarray(16)}let E=16-i;if(E!==c.length)throw new Error(`arx: nonce must be ${E} or 16 bytes`);if(E!==12){let L=new Uint8Array(12);L.set(c,s?0:12-c.length),c=L,f.push(c)}let I=wc(c);return $he(n,m,y,I,l,u,d,o),ph(...f),u}}var Hn=(n,e)=>n[e++]&255|(n[e++]&255)<<8,$x=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=jx(e),Zr(e,32);let t=Hn(e,0),r=Hn(e,2),i=Hn(e,4),s=Hn(e,6),o=Hn(e,8),a=Hn(e,10),c=Hn(e,12),l=Hn(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Hn(e,16+2*u)}process(e,t,r=!1){let i=r?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],p=o[7],g=o[8],m=o[9],y=Hn(e,t+0),E=Hn(e,t+2),I=Hn(e,t+4),L=Hn(e,t+6),k=Hn(e,t+8),D=Hn(e,t+10),B=Hn(e,t+12),U=Hn(e,t+14),T=s[0]+(y&8191),$=s[1]+((y>>>13|E<<3)&8191),W=s[2]+((E>>>10|I<<6)&8191),M=s[3]+((I>>>7|L<<9)&8191),v=s[4]+((L>>>4|k<<12)&8191),b=s[5]+(k>>>1&8191),w=s[6]+((k>>>14|D<<2)&8191),C=s[7]+((D>>>11|B<<5)&8191),N=s[8]+((B>>>8|U<<8)&8191),F=s[9]+(U>>>5|i),S=0,P=S+T*a+$*(5*m)+W*(5*g)+M*(5*p)+v*(5*f);S=P>>>13,P&=8191,P+=b*(5*h)+w*(5*d)+C*(5*u)+N*(5*l)+F*(5*c),S+=P>>>13,P&=8191;let V=S+T*c+$*a+W*(5*m)+M*(5*g)+v*(5*p);S=V>>>13,V&=8191,V+=b*(5*f)+w*(5*h)+C*(5*d)+N*(5*u)+F*(5*l),S+=V>>>13,V&=8191;let j=S+T*l+$*c+W*a+M*(5*m)+v*(5*g);S=j>>>13,j&=8191,j+=b*(5*p)+w*(5*f)+C*(5*h)+N*(5*d)+F*(5*u),S+=j>>>13,j&=8191;let oe=S+T*u+$*l+W*c+M*a+v*(5*m);S=oe>>>13,oe&=8191,oe+=b*(5*g)+w*(5*p)+C*(5*f)+N*(5*h)+F*(5*d),S+=oe>>>13,oe&=8191;let ee=S+T*d+$*u+W*l+M*c+v*a;S=ee>>>13,ee&=8191,ee+=b*(5*m)+w*(5*g)+C*(5*p)+N*(5*f)+F*(5*h),S+=ee>>>13,ee&=8191;let Q=S+T*h+$*d+W*u+M*l+v*c;S=Q>>>13,Q&=8191,Q+=b*a+w*(5*m)+C*(5*g)+N*(5*p)+F*(5*f),S+=Q>>>13,Q&=8191;let ae=S+T*f+$*h+W*d+M*u+v*l;S=ae>>>13,ae&=8191,ae+=b*c+w*a+C*(5*m)+N*(5*g)+F*(5*p),S+=ae>>>13,ae&=8191;let te=S+T*p+$*f+W*h+M*d+v*u;S=te>>>13,te&=8191,te+=b*l+w*c+C*a+N*(5*m)+F*(5*g),S+=te>>>13,te&=8191;let be=S+T*g+$*p+W*f+M*h+v*d;S=be>>>13,be&=8191,be+=b*u+w*l+C*c+N*a+F*(5*m),S+=be>>>13,be&=8191;let re=S+T*m+$*g+W*p+M*f+v*h;S=re>>>13,re&=8191,re+=b*d+w*u+C*l+N*c+F*a,S+=re>>>13,re&=8191,S=(S<<2)+S|0,S=S+P|0,P=S&8191,S=S>>>13,V+=S,s[0]=P,s[1]=V,s[2]=j,s[3]=oe,s[4]=ee,s[5]=Q,s[6]=ae,s[7]=te,s[8]=be,s[9]=re}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)r[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;ph(r)}update(e){c6(this),e=jx(e),Zr(e);let{buffer:t,blockLen:r}=this,i=e.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);if(o===r){for(;r<=i-s;s+=r)this.process(e,s);continue}t.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){ph(this.h,this.r,this.buffer,this.pad)}digestInto(e){c6(this),Dhe(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=r[o]>>>0,e[s++]=r[o]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}};function zhe(n){let e=(r,i)=>n(i).update(jx(r)).digest(),t=n(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}var Ghe=zhe(n=>new $x(n));function Whe(n,e,t,r,i,s=20){let o=n[0],a=n[1],c=n[2],l=n[3],u=e[0],d=e[1],h=e[2],f=e[3],p=e[4],g=e[5],m=e[6],y=e[7],E=i,I=t[0],L=t[1],k=t[2],D=o,B=a,U=c,T=l,$=u,W=d,M=h,v=f,b=p,w=g,C=m,N=y,F=E,S=I,P=L,V=k;for(let oe=0;oe<s;oe+=2)D=D+$|0,F=at(F^D,16),b=b+F|0,$=at($^b,12),D=D+$|0,F=at(F^D,8),b=b+F|0,$=at($^b,7),B=B+W|0,S=at(S^B,16),w=w+S|0,W=at(W^w,12),B=B+W|0,S=at(S^B,8),w=w+S|0,W=at(W^w,7),U=U+M|0,P=at(P^U,16),C=C+P|0,M=at(M^C,12),U=U+M|0,P=at(P^U,8),C=C+P|0,M=at(M^C,7),T=T+v|0,V=at(V^T,16),N=N+V|0,v=at(v^N,12),T=T+v|0,V=at(V^T,8),N=N+V|0,v=at(v^N,7),D=D+W|0,V=at(V^D,16),C=C+V|0,W=at(W^C,12),D=D+W|0,V=at(V^D,8),C=C+V|0,W=at(W^C,7),B=B+M|0,F=at(F^B,16),N=N+F|0,M=at(M^N,12),B=B+M|0,F=at(F^B,8),N=N+F|0,M=at(M^N,7),U=U+v|0,S=at(S^U,16),b=b+S|0,v=at(v^b,12),U=U+v|0,S=at(S^U,8),b=b+S|0,v=at(v^b,7),T=T+$|0,P=at(P^T,16),w=w+P|0,$=at($^w,12),T=T+$|0,P=at(P^T,8),w=w+P|0,$=at($^w,7);let j=0;r[j++]=o+D|0,r[j++]=a+B|0,r[j++]=c+U|0,r[j++]=l+T|0,r[j++]=u+$|0,r[j++]=d+W|0,r[j++]=h+M|0,r[j++]=f+v|0,r[j++]=p+b|0,r[j++]=g+w|0,r[j++]=m+C|0,r[j++]=y+N|0,r[j++]=E+F|0,r[j++]=I+S|0,r[j++]=L+P|0,r[j++]=k+V|0}var Khe=qhe(Whe,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Qhe=new Uint8Array(16),h6=(n,e)=>{n.update(e);let t=e.length%16;t&&n.update(Qhe.subarray(t))},Yhe=new Uint8Array(32);function f6(n,e,t,r,i){let s=n(e,t,Yhe),o=Ghe.create(s);i&&h6(o,i),h6(o,r);let a=Lhe(r.length,i?i.length:0,!0);o.update(a);let c=o.digest();return ph(s,a),c}var Jhe=n=>(e,t,r)=>({encrypt(i,s){let o=i.length;s=l6(o+16,s,!1),s.set(i);let a=s.subarray(0,-16);n(e,t,a,a,1);let c=f6(n,e,t,a,r);return s.set(c,o),ph(c),s},decrypt(i,s){s=l6(i.length-16,s,!1);let o=i.subarray(0,-16),a=i.subarray(-16),c=f6(n,e,t,o,r);if(!Mhe(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),n(e,t,s,s,1),ph(c),s}}),T5=khe({blockSize:64,nonceLength:12,tagLength:16},Jhe(Khe)),ib=class extends fh{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,db(e);let r=Ps(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),Wi(s)}update(e){return bc(this),this.iHash.update(e),this}digestInto(e){bc(this),Ms(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},mb=(n,e,t)=>new ib(n,e).update(t).digest();mb.create=(n,e)=>new ib(n,e);function Zhe(n,e,t){return db(n),t===void 0&&(t=new Uint8Array(n.outputLen)),mb(n,Ps(t),Ps(e))}var Ex=Uint8Array.from([0]),p6=Uint8Array.of();function Xhe(n,e,t,r=32){db(n),ea(r);let i=n.outputLen;if(r>255*i)throw new Error("Length should be <= 255*HashLen");let s=Math.ceil(r/i);t===void 0&&(t=p6);let o=new Uint8Array(s*i),a=mb.create(n,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<s;u++)Ex[0]=u+1,c.update(u===0?p6:l).update(t).update(Ex).digestInto(l),o.set(l,i*u),a._cloneInto(c);return a.destroy(),c.destroy(),Wi(l,Ex),o.slice(0,r)}var efe=(n,e,t,r,i)=>Xhe(n,Zhe(n,e,t),r,i),yb=hb,mD=BigInt(0),qx=BigInt(1);function sb(n,e=""){if(typeof n!="boolean"){let t=e&&`"${e}"`;throw new Error(t+"expected boolean, got type="+typeof n)}return n}function Ql(n,e,t=""){let r=ub(n),i=n?.length,s=e!==void 0;if(!r||s&&i!==e){let o=t&&`"${t}" `,a=s?` of length ${e}`:"",c=r?`length=${i}`:`type=${typeof n}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return n}function Z0(n){let e=n.toString(16);return e.length&1?"0"+e:e}function x5(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return n===""?mD:BigInt("0x"+n)}function wb(n){return x5(uh(n))}function ob(n){return Ms(n),x5(uh(Uint8Array.from(n).reverse()))}function yD(n,e){return nb(n.toString(16).padStart(e*2,"0"))}function wD(n,e){return yD(n,e).reverse()}function cr(n,e,t){let r;if(typeof e=="string")try{r=nb(e)}catch(s){throw new Error(n+" must be hex string or Uint8Array, cause: "+s)}else if(ub(e))r=Uint8Array.from(e);else throw new Error(n+" must be hex string or Uint8Array");let i=r.length;if(typeof t=="number"&&i!==t)throw new Error(n+" of length "+t+" expected, got "+i);return r}var Ix=n=>typeof n=="bigint"&&mD<=n;function tfe(n,e,t){return Ix(n)&&Ix(e)&&Ix(t)&&e<=n&&n<t}function zx(n,e,t,r){if(!tfe(e,t,r))throw new Error("expected valid "+n+": "+t+" <= n < "+r+", got "+e)}function D5(n){let e;for(e=0;n>mD;n>>=qx,e+=1);return e}var Sg=n=>(qx<<BigInt(n))-qx;function nfe(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=h=>new Uint8Array(h),i=h=>Uint8Array.of(h),s=r(n),o=r(n),a=0,c=()=>{s.fill(1),o.fill(0),a=0},l=(...h)=>t(o,s,...h),u=(h=r(0))=>{o=l(i(0),h),s=l(),h.length!==0&&(o=l(i(1),h),s=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,f=[];for(;h<e;){s=l();let p=s.slice();f.push(p),h+=s.length}return mc(...f)};return(h,f)=>{c(),u(h);let p;for(;!(p=f(d()));)u();return c(),p}}function vb(n,e,t={}){if(!n||typeof n!="object")throw new Error("expected valid options object");function r(i,s,o){let a=n[i];if(o&&a===void 0)return;let c=typeof a;if(c!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach(([i,s])=>r(i,s,!1)),Object.entries(t).forEach(([i,s])=>r(i,s,!0))}function g6(n){let e=new WeakMap;return(t,...r)=>{let i=e.get(t);if(i!==void 0)return i;let s=n(t,...r);return e.set(t,s),s}}var Xr=BigInt(0),Nr=BigInt(1),Yl=BigInt(2),N5=BigInt(3),R5=BigInt(4),O5=BigInt(5),rfe=BigInt(7),P5=BigInt(8),ife=BigInt(9),M5=BigInt(16);function vi(n,e){let t=n%e;return t>=Xr?t:e+t}function Rs(n,e,t){let r=n;for(;e-- >Xr;)r*=r,r%=t;return r}function m6(n,e){if(n===Xr)throw new Error("invert: expected non-zero number");if(e<=Xr)throw new Error("invert: expected positive modulus, got "+e);let t=vi(n,e),r=e,i=Xr,s=Nr;for(;t!==Xr;){let o=r/t,a=r%t,c=i-s*o;r=t,t=a,i=s,s=c}if(r!==Nr)throw new Error("invert: does not exist");return vi(i,e)}function vD(n,e,t){if(!n.eql(n.sqr(e),t))throw new Error("Cannot find square root")}function k5(n,e){let t=(n.ORDER+Nr)/R5,r=n.pow(e,t);return vD(n,r,e),r}function sfe(n,e){let t=(n.ORDER-O5)/P5,r=n.mul(e,Yl),i=n.pow(r,t),s=n.mul(e,i),o=n.mul(n.mul(s,Yl),i),a=n.mul(s,n.sub(o,n.ONE));return vD(n,a,e),a}function ofe(n){let e=Cc(n),t=L5(n),r=t(e,e.neg(e.ONE)),i=t(e,r),s=t(e,e.neg(r)),o=(n+rfe)/M5;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,r),d=a.mul(l,i),h=a.mul(l,s),f=a.eql(a.sqr(u),c),p=a.eql(a.sqr(d),c);l=a.cmov(l,u,f),u=a.cmov(h,d,p);let g=a.eql(a.sqr(u),c),m=a.cmov(l,u,g);return vD(a,m,c),m}}function L5(n){if(n<N5)throw new Error("sqrt is not defined for small field");let e=n-Nr,t=0;for(;e%Yl===Xr;)e/=Yl,t++;let r=Yl,i=Cc(n);for(;y6(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return k5;let s=i.pow(r,e),o=(e+Nr)/Yl;return function(a,c){if(a.is0(c))return c;if(y6(a,c)!==1)throw new Error("Cannot find square root");let l=t,u=a.mul(a.ONE,s),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let f=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===l)throw new Error("Cannot find square root");let g=Nr<<BigInt(l-f-1),m=a.pow(u,g);l=f,u=a.sqr(m),d=a.mul(d,u),h=a.mul(h,m)}return h}}function afe(n){return n%R5===N5?k5:n%P5===O5?sfe:n%M5===ife?ofe(n):L5(n)}var cfe=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function lfe(n){let e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=cfe.reduce((r,i)=>(r[i]="function",r),e);return vb(n,t),n}function ufe(n,e,t){if(t<Xr)throw new Error("invalid exponent, negatives unsupported");if(t===Xr)return n.ONE;if(t===Nr)return e;let r=n.ONE,i=e;for(;t>Xr;)t&Nr&&(r=n.mul(r,i)),i=n.sqr(i),t>>=Nr;return r}function F5(n,e,t=!1){let r=new Array(e.length).fill(t?n.ZERO:void 0),i=e.reduce((o,a,c)=>n.is0(a)?o:(r[c]=o,n.mul(o,a)),n.ONE),s=n.inv(i);return e.reduceRight((o,a,c)=>n.is0(a)?o:(r[c]=n.mul(o,r[c]),n.mul(o,a)),s),r}function y6(n,e){let t=(n.ORDER-Nr)/Yl,r=n.pow(e,t),i=n.eql(r,n.ONE),s=n.eql(r,n.ZERO),o=n.eql(r,n.neg(n.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function B5(n,e){e!==void 0&&ea(e);let t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Cc(n,e,t=!1,r={}){if(n<=Xr)throw new Error("invalid field: expected ORDER > 0, got "+n);let i,s,o=!1,a;if(typeof e=="object"&&e!=null){if(r.sqrt||t)throw new Error("cannot specify opts in two arguments");let h=e;h.BITS&&(i=h.BITS),h.sqrt&&(s=h.sqrt),typeof h.isLE=="boolean"&&(t=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof e=="number"&&(i=e),r.sqrt&&(s=r.sqrt);let{nBitLength:c,nByteLength:l}=B5(n,i);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u,d=Object.freeze({ORDER:n,isLE:t,BITS:c,BYTES:l,MASK:Sg(c),ZERO:Xr,ONE:Nr,allowedLengths:a,create:h=>vi(h,n),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return Xr<=h&&h<n},is0:h=>h===Xr,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&Nr)===Nr,neg:h=>vi(-h,n),eql:(h,f)=>h===f,sqr:h=>vi(h*h,n),add:(h,f)=>vi(h+f,n),sub:(h,f)=>vi(h-f,n),mul:(h,f)=>vi(h*f,n),pow:(h,f)=>ufe(d,h,f),div:(h,f)=>vi(h*m6(f,n),n),sqrN:h=>h*h,addN:(h,f)=>h+f,subN:(h,f)=>h-f,mulN:(h,f)=>h*f,inv:h=>m6(h,n),sqrt:s||(h=>(u||(u=afe(n)),u(d,h))),toBytes:h=>t?wD(h,l):yD(h,l),fromBytes:(h,f=!0)=>{if(a){if(!a.includes(h.length)||h.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);let g=new Uint8Array(l);g.set(h,t?0:g.length-h.length),h=g}if(h.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+h.length);let p=t?ob(h):wb(h);if(o&&(p=vi(p,n)),!f&&!d.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:h=>F5(d,h),cmov:(h,f,p)=>p?f:h});return Object.freeze(d)}function U5(n){if(typeof n!="bigint")throw new Error("field order must be bigint");let e=n.toString(2).length;return Math.ceil(e/8)}function j5(n){let e=U5(n);return e+Math.ceil(e/2)}function dfe(n,e,t=!1){let r=n.length,i=U5(e),s=j5(e);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);let o=t?ob(n):wb(n),a=vi(o,e-Nr)+Nr;return t?wD(a,i):yD(a,i)}var gh=BigInt(0),Jl=BigInt(1);function ab(n,e){let t=e.negate();return n?t:e}function Cx(n,e){let t=F5(n.Fp,e.map(r=>r.Z));return e.map((r,i)=>n.fromAffine(r.toAffine(t[i])))}function V5(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+n)}function Sx(n,e){V5(n,e);let t=Math.ceil(e/n)+1,r=2**(n-1),i=2**n,s=Sg(n),o=BigInt(n);return{windows:t,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function w6(n,e,t){let{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=t,a=Number(n&i),c=n>>o;a>r&&(a-=s,c+=Jl);let l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,f=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:l}}function hfe(n,e){if(!Array.isArray(n))throw new Error("array expected");n.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function ffe(n,e){if(!Array.isArray(n))throw new Error("array of scalars expected");n.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}var Ax=new WeakMap,H5=new WeakMap;function _x(n){return H5.get(n)||1}function v6(n){if(n!==gh)throw new Error("invalid wNAF")}var Gx=class{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let i=e;for(;t>gh;)t&Jl&&(r=r.add(i)),i=i.double(),t>>=Jl;return r}precomputeWindow(e,t){let{windows:r,windowSize:i}=Sx(t,this.bits),s=[],o=e,a=o;for(let c=0;c<r;c++){a=o,s.push(a);for(let l=1;l<i;l++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(e,t,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE,o=Sx(e,this.bits);for(let a=0;a<o.windows;a++){let{nextN:c,offset:l,isZero:u,isNeg:d,isNegF:h,offsetF:f}=w6(r,a,o);r=c,u?s=s.add(ab(h,t[f])):i=i.add(ab(d,t[l]))}return v6(r),{p:i,f:s}}wNAFUnsafe(e,t,r,i=this.ZERO){let s=Sx(e,this.bits);for(let o=0;o<s.windows&&r!==gh;o++){let{nextN:a,offset:c,isZero:l,isNeg:u}=w6(r,o,s);if(r=a,!l){let d=t[c];i=i.add(u?d.negate():d)}}return v6(r),i}getPrecomputes(e,t,r){let i=Ax.get(t);return i||(i=this.precomputeWindow(t,e),e!==1&&(typeof r=="function"&&(i=r(i)),Ax.set(t,i))),i}cached(e,t,r){let i=_x(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)}unsafe(e,t,r,i){let s=_x(e);return s===1?this._unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)}createCache(e,t){V5(t,this.bits),H5.set(e,t),Ax.delete(e)}hasCache(e){return _x(e)!==1}};function pfe(n,e,t,r){let i=e,s=n.ZERO,o=n.ZERO;for(;t>gh||r>gh;)t&Jl&&(s=s.add(i)),r&Jl&&(o=o.add(i)),i=i.double(),t>>=Jl,r>>=Jl;return{p1:s,p2:o}}function gfe(n,e,t,r){hfe(t,n),ffe(r,e);let i=t.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");let o=n.ZERO,a=D5(BigInt(i)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=Sg(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c,h=o;for(let f=d;f>=0;f-=c){u.fill(o);for(let g=0;g<s;g++){let m=r[g],y=Number(m>>BigInt(f)&l);u[y]=u[y].add(t[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(h=h.add(p),f!==0)for(let g=0;g<c;g++)h=h.double()}return h}function b6(n,e,t){if(e){if(e.ORDER!==n)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return lfe(e),e}else return Cc(n,{isLE:t})}function mfe(n,e,t={},r){if(r===void 0&&(r=n==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${n} CURVE object`);for(let a of["p","n","h"]){let c=e[a];if(!(typeof c=="bigint"&&c>gh))throw new Error(`CURVE.${a} must be positive bigint`)}let i=b6(e.p,t.Fp,r),s=b6(e.n,t.Fn,r),o=["Gx","Gy","a",n==="weierstrass"?"b":"d"];for(let a of o)if(!i.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:i,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),t5("HashToScalar-");var pg=BigInt(0),ah=BigInt(1),X0=BigInt(2);function yfe(n){return vb(n,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(H({},n))}function wfe(n){let e=yfe(n),{P:t,type:r,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");let c=o||tu,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),f=a?X0**BigInt(254):X0**BigInt(447),p=a?BigInt(8)*X0**BigInt(251)-ah:BigInt(4)*X0**BigInt(445)-ah,g=f+p+ah,m=M=>vi(M,t),y=E(d);function E(M){return wD(m(M),u)}function I(M){let v=cr("u coordinate",M,u);return a&&(v[31]&=127),m(ob(v))}function L(M){return ob(i(cr("scalar",M,u)))}function k(M,v){let b=U(I(v),L(M));if(b===pg)throw new Error("invalid private or public key received");return E(b)}function D(M){return k(M,y)}function B(M,v,b){let w=m(M*(v-b));return v=m(v-w),b=m(b+w),{x_2:v,x_3:b}}function U(M,v){zx("u",M,pg,t),zx("scalar",v,f,g);let b=v,w=M,C=ah,N=pg,F=M,S=ah,P=pg;for(let j=BigInt(l-1);j>=pg;j--){let oe=b>>j&ah;P^=oe,{x_2:C,x_3:F}=B(P,C,F),{x_2:N,x_3:S}=B(P,N,S),P=oe;let ee=C+N,Q=m(ee*ee),ae=C-N,te=m(ae*ae),be=Q-te,re=F+S,Ce=F-S,kt=m(Ce*ee),St=m(re*ae),Wt=kt+St,En=kt-St;F=m(Wt*Wt),S=m(w*m(En*En)),C=m(Q*te),N=m(be*(Q+m(h*be)))}({x_2:C,x_3:F}=B(P,C,F)),{x_2:N,x_3:S}=B(P,N,S);let V=s(N);return m(C*V)}let T={secretKey:u,publicKey:u,seed:u},$=(M=c(u))=>(Ms(M,T.seed),M);function W(M){let v=$(M);return{secretKey:v,publicKey:D(v)}}return{keygen:W,getSharedSecret:(M,v)=>k(M,v),getPublicKey:M=>D(M),scalarMult:k,scalarMultBase:D,utils:{randomSecretKey:$,randomPrivateKey:$},GuBytes:y.slice(),lengths:T}}var vfe=BigInt(1),E6=BigInt(2),bfe=BigInt(3),Efe=BigInt(5),Ife=BigInt(8),$5=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Cfe={p:$5,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Ife,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Sfe(n){let e=BigInt(10),t=BigInt(20),r=BigInt(40),i=BigInt(80),s=$5,o=n*n%s*n%s,a=Rs(o,E6,s)*o%s,c=Rs(a,vfe,s)*n%s,l=Rs(c,Efe,s)*c%s,u=Rs(l,e,s)*l%s,d=Rs(u,t,s)*u%s,h=Rs(d,r,s)*d%s,f=Rs(h,i,s)*h%s,p=Rs(f,i,s)*h%s,g=Rs(p,e,s)*l%s;return{pow_p_5_8:Rs(g,E6,s)*n%s,b2:o}}function Afe(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}var _fe=Cc(Cfe.p,{isLE:!0}),Wx=(()=>{let n=_fe.ORDER;return wfe({P:n,type:"x25519",powPminus2:e=>{let{pow_p_5_8:t,b2:r}=Sfe(e);return vi(Rs(t,bfe,n)*r,n)},adjustScalarBytes:Afe})})(),I6=(n,e)=>(n+(n>=0?e:-e)/q5)/e;function Tfe(n,e,t){let[[r,i],[s,o]]=e,a=I6(o*n,t),c=I6(-i*n,t),l=n-a*r-c*s,u=-a*i-c*o,d=l<Zo,h=u<Zo;d&&(l=-l),h&&(u=-u);let f=Sg(Math.ceil(D5(t)/2))+dh;if(l<Zo||l>=f||u<Zo||u>=f)throw new Error("splitScalar (endomorphism): failed, k="+n);return{k1neg:d,k1:l,k2neg:h,k2:u}}function Kx(n){if(!["compact","recovered","der"].includes(n))throw new Error('Signature format must be "compact", "recovered", or "der"');return n}function Tx(n,e){let t={};for(let r of Object.keys(e))t[r]=n[r]===void 0?e[r]:n[r];return sb(t.lowS,"lowS"),sb(t.prehash,"prehash"),t.format!==void 0&&Kx(t.format),t}var Qx=class extends Error{constructor(e=""){super(e)}},Yo={Err:Qx,_tlv:{encode:(n,e)=>{let{Err:t}=Yo;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");let r=e.length/2,i=Z0(r);if(i.length/2&128)throw new t("tlv.encode: long form length too big");let s=r>127?Z0(i.length/2|128):"";return Z0(n)+s+i+e},decode(n,e){let{Err:t}=Yo,r=0;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[r++]!==n)throw new t("tlv.decode: wrong tlv");let i=e[r++],s=!!(i&128),o=0;if(!s)o=i;else{let c=i&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");let l=e.subarray(r,r+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(let u of l)o=o<<8|u;if(r+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}let a=e.subarray(r,r+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(n){let{Err:e}=Yo;if(n<Zo)throw new e("integer: negative integers are not allowed");let t=Z0(n);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(n){let{Err:e}=Yo;if(n[0]&128)throw new e("invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return wb(n)}},toSig(n){let{Err:e,_int:t,_tlv:r}=Yo,i=cr("signature",n),{v:s,l:o}=r.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");let{v:a,l:c}=r.decode(2,s),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(n){let{_tlv:e,_int:t}=Yo,r=e.encode(2,t.encode(n.r)),i=e.encode(2,t.encode(n.s)),s=r+i;return e.encode(48,s)}},Zo=BigInt(0),dh=BigInt(1),q5=BigInt(2),eb=BigInt(3),xfe=BigInt(4);function ch(n,e){let{BYTES:t}=n,r;if(typeof e=="bigint")r=e;else{let i=cr("private key",e);try{r=n.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${t}, got ${typeof e}`)}}if(!n.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function Dfe(n,e={}){let t=mfe("weierstrass",n,e),{Fp:r,Fn:i}=t,s=t.CURVE,{h:o,n:a}=s;vb(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:c}=e;if(c&&(!r.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let l=G5(r,i);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(M,v,b){let{x:w,y:C}=v.toAffine(),N=r.toBytes(w);if(sb(b,"isCompressed"),b){u();let F=!r.isOdd(C);return mc(z5(F),N)}else return mc(Uint8Array.of(4),N,r.toBytes(C))}function h(M){Ql(M,void 0,"Point");let{publicKey:v,publicKeyUncompressed:b}=l,w=M.length,C=M[0],N=M.subarray(1);if(w===v&&(C===2||C===3)){let F=r.fromBytes(N);if(!r.isValid(F))throw new Error("bad point: is not on curve, wrong x");let S=g(F),P;try{P=r.sqrt(S)}catch(j){let oe=j instanceof Error?": "+j.message:"";throw new Error("bad point: is not on curve, sqrt error"+oe)}u();let V=r.isOdd(P);return(C&1)===1!==V&&(P=r.neg(P)),{x:F,y:P}}else if(w===b&&C===4){let F=r.BYTES,S=r.fromBytes(N.subarray(0,F)),P=r.fromBytes(N.subarray(F,F*2));if(!m(S,P))throw new Error("bad point: is not on curve");return{x:S,y:P}}else throw new Error(`bad point: got length ${w}, expected compressed=${v} or uncompressed=${b}`)}let f=e.toBytes||d,p=e.fromBytes||h;function g(M){let v=r.sqr(M),b=r.mul(v,M);return r.add(r.add(b,r.mul(M,s.a)),s.b)}function m(M,v){let b=r.sqr(v),w=g(M);return r.eql(b,w)}if(!m(s.Gx,s.Gy))throw new Error("bad curve params: generator point");let y=r.mul(r.pow(s.a,eb),xfe),E=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(y,E)))throw new Error("bad curve params: a or b");function I(M,v,b=!1){if(!r.isValid(v)||b&&r.is0(v))throw new Error(`bad point coordinate ${M}`);return v}function L(M){if(!(M instanceof T))throw new Error("ProjectivePoint expected")}function k(M){if(!c||!c.basises)throw new Error("no endo");return Tfe(M,c.basises,i.ORDER)}let D=g6((M,v)=>{let{X:b,Y:w,Z:C}=M;if(r.eql(C,r.ONE))return{x:b,y:w};let N=M.is0();v==null&&(v=N?r.ONE:r.inv(C));let F=r.mul(b,v),S=r.mul(w,v),P=r.mul(C,v);if(N)return{x:r.ZERO,y:r.ZERO};if(!r.eql(P,r.ONE))throw new Error("invZ was invalid");return{x:F,y:S}}),B=g6(M=>{if(M.is0()){if(e.allowInfinityPoint&&!r.is0(M.Y))return;throw new Error("bad point: ZERO")}let{x:v,y:b}=M.toAffine();if(!r.isValid(v)||!r.isValid(b))throw new Error("bad point: x or y not field elements");if(!m(v,b))throw new Error("bad point: equation left != right");if(!M.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function U(M,v,b,w,C){return b=new T(r.mul(b.X,M),b.Y,b.Z),v=ab(w,v),b=ab(C,b),v.add(b)}class T{constructor(v,b,w){this.X=I("x",v),this.Y=I("y",b,!0),this.Z=I("z",w),Object.freeze(this)}static CURVE(){return s}static fromAffine(v){let{x:b,y:w}=v||{};if(!v||!r.isValid(b)||!r.isValid(w))throw new Error("invalid affine point");if(v instanceof T)throw new Error("projective point not allowed");return r.is0(b)&&r.is0(w)?T.ZERO:new T(b,w,r.ONE)}static fromBytes(v){let b=T.fromAffine(p(Ql(v,void 0,"point")));return b.assertValidity(),b}static fromHex(v){return T.fromBytes(cr("pointHex",v))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(v=8,b=!0){return W.createCache(this,v),b||this.multiply(eb),this}assertValidity(){B(this)}hasEvenY(){let{y:v}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(v)}equals(v){L(v);let{X:b,Y:w,Z:C}=this,{X:N,Y:F,Z:S}=v,P=r.eql(r.mul(b,S),r.mul(N,C)),V=r.eql(r.mul(w,S),r.mul(F,C));return P&&V}negate(){return new T(this.X,r.neg(this.Y),this.Z)}double(){let{a:v,b}=s,w=r.mul(b,eb),{X:C,Y:N,Z:F}=this,S=r.ZERO,P=r.ZERO,V=r.ZERO,j=r.mul(C,C),oe=r.mul(N,N),ee=r.mul(F,F),Q=r.mul(C,N);return Q=r.add(Q,Q),V=r.mul(C,F),V=r.add(V,V),S=r.mul(v,V),P=r.mul(w,ee),P=r.add(S,P),S=r.sub(oe,P),P=r.add(oe,P),P=r.mul(S,P),S=r.mul(Q,S),V=r.mul(w,V),ee=r.mul(v,ee),Q=r.sub(j,ee),Q=r.mul(v,Q),Q=r.add(Q,V),V=r.add(j,j),j=r.add(V,j),j=r.add(j,ee),j=r.mul(j,Q),P=r.add(P,j),ee=r.mul(N,F),ee=r.add(ee,ee),j=r.mul(ee,Q),S=r.sub(S,j),V=r.mul(ee,oe),V=r.add(V,V),V=r.add(V,V),new T(S,P,V)}add(v){L(v);let{X:b,Y:w,Z:C}=this,{X:N,Y:F,Z:S}=v,P=r.ZERO,V=r.ZERO,j=r.ZERO,oe=s.a,ee=r.mul(s.b,eb),Q=r.mul(b,N),ae=r.mul(w,F),te=r.mul(C,S),be=r.add(b,w),re=r.add(N,F);be=r.mul(be,re),re=r.add(Q,ae),be=r.sub(be,re),re=r.add(b,C);let Ce=r.add(N,S);return re=r.mul(re,Ce),Ce=r.add(Q,te),re=r.sub(re,Ce),Ce=r.add(w,C),P=r.add(F,S),Ce=r.mul(Ce,P),P=r.add(ae,te),Ce=r.sub(Ce,P),j=r.mul(oe,re),P=r.mul(ee,te),j=r.add(P,j),P=r.sub(ae,j),j=r.add(ae,j),V=r.mul(P,j),ae=r.add(Q,Q),ae=r.add(ae,Q),te=r.mul(oe,te),re=r.mul(ee,re),ae=r.add(ae,te),te=r.sub(Q,te),te=r.mul(oe,te),re=r.add(re,te),Q=r.mul(ae,re),V=r.add(V,Q),Q=r.mul(Ce,re),P=r.mul(be,P),P=r.sub(P,Q),Q=r.mul(be,ae),j=r.mul(Ce,j),j=r.add(j,Q),new T(P,V,j)}subtract(v){return this.add(v.negate())}is0(){return this.equals(T.ZERO)}multiply(v){let{endo:b}=e;if(!i.isValidNot0(v))throw new Error("invalid scalar: out of range");let w,C,N=F=>W.cached(this,F,S=>Cx(T,S));if(b){let{k1neg:F,k1:S,k2neg:P,k2:V}=k(v),{p:j,f:oe}=N(S),{p:ee,f:Q}=N(V);C=oe.add(Q),w=U(b.beta,j,ee,F,P)}else{let{p:F,f:S}=N(v);w=F,C=S}return Cx(T,[w,C])[0]}multiplyUnsafe(v){let{endo:b}=e,w=this;if(!i.isValid(v))throw new Error("invalid scalar: out of range");if(v===Zo||w.is0())return T.ZERO;if(v===dh)return w;if(W.hasCache(this))return this.multiply(v);if(b){let{k1neg:C,k1:N,k2neg:F,k2:S}=k(v),{p1:P,p2:V}=pfe(T,w,N,S);return U(b.beta,P,V,C,F)}else return W.unsafe(w,v)}multiplyAndAddUnsafe(v,b,w){let C=this.multiplyUnsafe(b).add(v.multiplyUnsafe(w));return C.is0()?void 0:C}toAffine(v){return D(this,v)}isTorsionFree(){let{isTorsionFree:v}=e;return o===dh?!0:v?v(T,this):W.unsafe(this,a).is0()}clearCofactor(){let{clearCofactor:v}=e;return o===dh?this:v?v(T,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(v=!0){return sb(v,"isCompressed"),this.assertValidity(),f(T,this,v)}toHex(v=!0){return uh(this.toBytes(v))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(v=!0){return this.toBytes(v)}_setWindowSize(v){this.precompute(v)}static normalizeZ(v){return Cx(T,v)}static msm(v,b){return gfe(T,i,v,b)}static fromPrivateKey(v){return T.BASE.multiply(ch(i,v))}}T.BASE=new T(s.Gx,s.Gy,r.ONE),T.ZERO=new T(r.ZERO,r.ONE,r.ZERO),T.Fp=r,T.Fn=i;let $=i.BITS,W=new Gx(T,e.endo?Math.ceil($/2):$);return T.BASE.precompute(8),T}function z5(n){return Uint8Array.of(n?2:3)}function G5(n,e){return{secretKey:e.BYTES,publicKey:1+n.BYTES,publicKeyUncompressed:1+2*n.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function Nfe(n,e={}){let{Fn:t}=n,r=e.randomBytes||tu,i=Object.assign(G5(n.Fp,t),{seed:j5(t.ORDER)});function s(h){try{return!!ch(t,h)}catch{return!1}}function o(h,f){let{publicKey:p,publicKeyUncompressed:g}=i;try{let m=h.length;return f===!0&&m!==p||f===!1&&m!==g?!1:!!n.fromBytes(h)}catch{return!1}}function a(h=r(i.seed)){return dfe(Ql(h,i.seed,"seed"),t.ORDER)}function c(h,f=!0){return n.BASE.multiply(ch(t,h)).toBytes(f)}function l(h){let f=a(h);return{secretKey:f,publicKey:c(f)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof n)return!0;let{secretKey:f,publicKey:p,publicKeyUncompressed:g}=i;if(t.allowedLengths||f===p)return;let m=cr("key",h).length;return m===p||m===g}function d(h,f,p=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(f)===!1)throw new Error("second arg must be public key");let g=ch(t,h);return n.fromHex(f).multiply(g).toBytes(p)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:l,Point:n,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:h=>ch(t,h),precompute(h=8,f=n.BASE){return f.precompute(h,!1)}},lengths:i})}function Rfe(n,e,t={}){db(e),vb(t,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let r=t.randomBytes||tu,i=t.hmac||((b,...w)=>mb(e,b,mc(...w))),{Fp:s,Fn:o}=n,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:f}=Nfe(n,t),p={prehash:!1,lowS:typeof t.lowS=="boolean"?t.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function m(b){let w=a>>dh;return b>w}function y(b,w){if(!o.isValidNot0(w))throw new Error(`invalid signature ${b}: out of range 1..Point.Fn.ORDER`);return w}function E(b,w){Kx(w);let C=f.signature,N=w==="compact"?C:w==="recovered"?C+1:void 0;return Ql(b,N,`${w} signature`)}class I{constructor(w,C,N){this.r=y("r",w),this.s=y("s",C),N!=null&&(this.recovery=N),Object.freeze(this)}static fromBytes(w,C=g){E(w,C);let N;if(C==="der"){let{r:V,s:j}=Yo.toSig(Ql(w));return new I(V,j)}C==="recovered"&&(N=w[0],C="compact",w=w.subarray(1));let F=o.BYTES,S=w.subarray(0,F),P=w.subarray(F,F*2);return new I(o.fromBytes(S),o.fromBytes(P),N)}static fromHex(w,C){return this.fromBytes(nb(w),C)}addRecoveryBit(w){return new I(this.r,this.s,w)}recoverPublicKey(w){let C=s.ORDER,{r:N,s:F,recovery:S}=this;if(S==null||![0,1,2,3].includes(S))throw new Error("recovery id invalid");if(a*q5<C&&S>1)throw new Error("recovery id is ambiguous for h>1 curve");let P=S===2||S===3?N+a:N;if(!s.isValid(P))throw new Error("recovery id 2 or 3 invalid");let V=s.toBytes(P),j=n.fromBytes(mc(z5((S&1)===0),V)),oe=o.inv(P),ee=k(cr("msgHash",w)),Q=o.create(-ee*oe),ae=o.create(F*oe),te=n.BASE.multiplyUnsafe(Q).add(j.multiplyUnsafe(ae));if(te.is0())throw new Error("point at infinify");return te.assertValidity(),te}hasHighS(){return m(this.s)}toBytes(w=g){if(Kx(w),w==="der")return nb(Yo.hexFromSig(this));let C=o.toBytes(this.r),N=o.toBytes(this.s);if(w==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return mc(Uint8Array.of(this.recovery),C,N)}return mc(C,N)}toHex(w){return uh(this.toBytes(w))}assertValidity(){}static fromCompact(w){return I.fromBytes(cr("sig",w),"compact")}static fromDER(w){return I.fromBytes(cr("sig",w),"der")}normalizeS(){return this.hasHighS()?new I(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return uh(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return uh(this.toBytes("compact"))}}let L=t.bits2int||function(b){if(b.length>8192)throw new Error("input is too large");let w=wb(b),C=b.length*8-c;return C>0?w>>BigInt(C):w},k=t.bits2int_modN||function(b){return o.create(L(b))},D=Sg(c);function B(b){return zx("num < 2^"+c,b,Zo,D),o.toBytes(b)}function U(b,w){return Ql(b,void 0,"message"),w?Ql(e(b),void 0,"prehashed message"):b}function T(b,w,C){if(["recovered","canonical"].some(ae=>ae in C))throw new Error("sign() legacy options not supported");let{lowS:N,prehash:F,extraEntropy:S}=Tx(C,p);b=U(b,F);let P=k(b),V=ch(o,w),j=[B(V),B(P)];if(S!=null&&S!==!1){let ae=S===!0?r(f.secretKey):S;j.push(cr("extraEntropy",ae))}let oe=mc(...j),ee=P;function Q(ae){let te=L(ae);if(!o.isValidNot0(te))return;let be=o.inv(te),re=n.BASE.multiply(te).toAffine(),Ce=o.create(re.x);if(Ce===Zo)return;let kt=o.create(be*o.create(ee+Ce*V));if(kt===Zo)return;let St=(re.x===Ce?0:2)|Number(re.y&dh),Wt=kt;return N&&m(kt)&&(Wt=o.neg(kt),St^=1),new I(Ce,Wt,St)}return{seed:oe,k2sig:Q}}function $(b,w,C={}){b=cr("message",b);let{seed:N,k2sig:F}=T(b,w,C);return nfe(e.outputLen,o.BYTES,i)(N,F)}function W(b){let w,C=typeof b=="string"||ub(b),N=!C&&b!==null&&typeof b=="object"&&typeof b.r=="bigint"&&typeof b.s=="bigint";if(!C&&!N)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(N)w=new I(b.r,b.s);else if(C){try{w=I.fromBytes(cr("sig",b),"der")}catch(F){if(!(F instanceof Yo.Err))throw F}if(!w)try{w=I.fromBytes(cr("sig",b),"compact")}catch{return!1}}return w||!1}function M(b,w,C,N={}){let{lowS:F,prehash:S,format:P}=Tx(N,p);if(C=cr("publicKey",C),w=U(cr("message",w),S),"strict"in N)throw new Error("options.strict was renamed to lowS");let V=P===void 0?W(b):I.fromBytes(cr("sig",b),P);if(V===!1)return!1;try{let j=n.fromBytes(C);if(F&&V.hasHighS())return!1;let{r:oe,s:ee}=V,Q=k(w),ae=o.inv(ee),te=o.create(Q*ae),be=o.create(oe*ae),re=n.BASE.multiplyUnsafe(te).add(j.multiplyUnsafe(be));return re.is0()?!1:o.create(re.x)===oe}catch{return!1}}function v(b,w,C={}){let{prehash:N}=Tx(C,p);return w=U(w,N),I.fromBytes(b,"recovered").recoverPublicKey(w).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:f,Point:n,sign:$,verify:M,recoverPublicKey:v,Signature:I,hash:e})}function Ofe(n){let e={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},t=n.Fp,r=n.allowedPrivateKeyLengths?Array.from(new Set(n.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0,i=Cc(e.n,{BITS:n.nBitLength,allowedLengths:r,modFromBytes:n.wrapPrivateKey}),s={Fp:t,Fn:i,allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes};return{CURVE:e,curveOpts:s}}function Pfe(n){let{CURVE:e,curveOpts:t}=Ofe(n),r={hmac:n.hmac,randomBytes:n.randomBytes,lowS:n.lowS,bits2int:n.bits2int,bits2int_modN:n.bits2int_modN};return{CURVE:e,curveOpts:t,hash:n.hash,ecdsaOpts:r}}function Mfe(n,e){let t=e.Point;return Object.assign({},e,{ProjectivePoint:t,CURVE:Object.assign({},n,B5(t.Fn.ORDER,t.Fn.BITS))})}function kfe(n){let{CURVE:e,curveOpts:t,hash:r,ecdsaOpts:i}=Pfe(n),s=Dfe(e,t),o=Rfe(s,r,i);return Mfe(n,o)}function Yx(n,e){let t=r=>kfe(ge(H({},n),{hash:r}));return ge(H({},t(e)),{create:t})}var W5={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},K5={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Q5={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Lfe=Cc(W5.p),Ffe=Cc(K5.p),Bfe=Cc(Q5.p),Ufe=Yx(ge(H({},W5),{Fp:Lfe,lowS:!1}),hb);Yx(ge(H({},K5),{Fp:Ffe,lowS:!1}),the),Yx(ge(H({},Q5),{Fp:Bfe,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),ehe);var jfe=Ufe,bD="base10",Rr="base16",hh="base64pad",bb="base64url",yh="utf8",ED=0,wh=1,Ag=2,Vfe=0,C6=1,yg=12,ID=32;function Hfe(){let n=Wx.utils.randomPrivateKey(),e=Wx.getPublicKey(n);return{privateKey:yt.toString(n,Rr),publicKey:yt.toString(e,Rr)}}function $fe(){let n=tu(ID);return yt.toString(n,Rr)}function qfe(n,e){let t=Wx.getSharedSecret(yt.fromString(n,Rr),yt.fromString(e,Rr)),r=efe(yb,t,void 0,void 0,ID);return yt.toString(r,Rr)}function zfe(n){let e=yb(yt.fromString(n,Rr));return yt.toString(e,Rr)}function Gfe(n){let e=yb(yt.fromString(n,yh));return yt.toString(e,Rr)}function CD(n){return yt.fromString(`${n}`,bD)}function Zl(n){return Number(yt.toString(n,bD))}function Y5(n){return n.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function J5(n){let e=n.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function Wfe(n){let e=CD(typeof n.type<"u"?n.type:ED);if(Zl(e)===wh&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");let t=typeof n.senderPublicKey<"u"?yt.fromString(n.senderPublicKey,Rr):void 0,r=typeof n.iv<"u"?yt.fromString(n.iv,Rr):tu(yg),i=yt.fromString(n.symKey,Rr),s=T5(i,r).encrypt(yt.fromString(n.message,yh)),o=SD({type:e,sealed:s,iv:r,senderPublicKey:t});return n.encoding===bb?Y5(o):o}function Kfe(n){let e=yt.fromString(n.symKey,Rr),{sealed:t,iv:r}=Eb({encoded:n.encoded,encoding:n.encoding}),i=T5(e,r).decrypt(t);if(i===null)throw new Error("Failed to decrypt");return yt.toString(i,yh)}function Qfe(n,e){let t=CD(Ag),r=tu(yg),i=yt.fromString(n,yh),s=SD({type:t,sealed:i,iv:r});return e===bb?Y5(s):s}function Yfe(n,e){let{sealed:t}=Eb({encoded:n,encoding:e});return yt.toString(t,yh)}function SD(n){if(Zl(n.type)===Ag)return yt.toString(yt.concat([n.type,n.sealed]),hh);if(Zl(n.type)===wh){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return yt.toString(yt.concat([n.type,n.senderPublicKey,n.iv,n.sealed]),hh)}return yt.toString(yt.concat([n.type,n.iv,n.sealed]),hh)}function Eb(n){let e=(n.encoding||hh)===bb?J5(n.encoded):n.encoded,t=yt.fromString(e,hh),r=t.slice(Vfe,C6),i=C6;if(Zl(r)===wh){let c=i+ID,l=c+yg,u=t.slice(i,c),d=t.slice(c,l),h=t.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(Zl(r)===Ag){let c=t.slice(i),l=tu(yg);return{type:r,sealed:c,iv:l}}let s=i+yg,o=t.slice(i,s),a=t.slice(s);return{type:r,sealed:a,iv:o}}function Jfe(n,e){let t=Eb({encoded:n,encoding:e?.encoding});return Z5({type:Zl(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?yt.toString(t.senderPublicKey,Rr):void 0,receiverPublicKey:e?.receiverPublicKey})}function Z5(n){let e=n?.type||ED;if(e===wh){if(typeof n?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof n?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n?.senderPublicKey,receiverPublicKey:n?.receiverPublicKey}}function Zfe(n){return n.type===wh&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}function Xfe(n){return n.type===Ag}function X5(n){let e=Buffer.from(n.x,"base64"),t=Buffer.from(n.y,"base64");return yt.concat([new Uint8Array([4]),e,t])}function epe(n,e){let[t,r,i]=n.split("."),s=Buffer.from(J5(i),"base64");if(s.length!==64)throw new Error("Invalid signature length");let o=s.slice(0,32),a=s.slice(32,64),c=`${t}.${r}`,l=yb(c),u=X5(e);if(!jfe.verify(yt.concat([o,a]),l,u))throw new Error("Invalid signature");return Pue.decodeJWT(n).payload}var eV="irn";function tpe(n){return n?.relay||{protocol:eV}}function npe(n){let e=Mue.RELAY_JSONRPC[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var rpe=Object.defineProperty,ipe=Object.defineProperties,spe=Object.getOwnPropertyDescriptors,S6=Object.getOwnPropertySymbols,ope=Object.prototype.hasOwnProperty,ape=Object.prototype.propertyIsEnumerable,A6=(n,e,t)=>e in n?rpe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xx=(n,e)=>{for(var t in e||(e={}))ope.call(e,t)&&A6(n,t,e[t]);if(S6)for(var t of S6(e))ape.call(e,t)&&A6(n,t,e[t]);return n},cpe=(n,e)=>ipe(n,spe(e));function tV(n,e="-"){let t={},r="relay"+e;return Object.keys(n).forEach(i=>{if(i.startsWith(r)){let s=i.replace(r,""),o=n[i];t[s]=o}}),t}function lpe(n){if(!n.includes("wc:")){let l=oD(n);l!=null&&l.includes("wc:")&&(n=l)}n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;let e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,r=n.substring(0,e),i=n.substring(e+1,t).split("@"),s=typeof t<"u"?n.substring(t):"",o=new URLSearchParams(s),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:nV(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:tV(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function nV(n){return n.startsWith("//")?n.substring(2):n}function rV(n,e="-"){let t="relay",r={};return Object.keys(n).forEach(i=>{let s=i,o=t+e+s;n[s]&&(r[o]=n[s])}),r}function upe(n){let e=new URLSearchParams,t=xx(xx(cpe(xx({},rV(n.relay)),{symKey:n.symKey}),n.expiryTimestamp&&{expiryTimestamp:n.expiryTimestamp.toString()}),n.methods&&{methods:n.methods.join(",")});return Object.entries(t).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!==void 0&&e.append(r,String(i))}),`${n.protocol}:${n.topic}@${n.version}?${e}`}function dpe(n,e,t){return`${n}?wc_ev=${t}&topic=${e}`}var hpe=Object.defineProperty,fpe=Object.defineProperties,ppe=Object.getOwnPropertyDescriptors,_6=Object.getOwnPropertySymbols,gpe=Object.prototype.hasOwnProperty,mpe=Object.prototype.propertyIsEnumerable,T6=(n,e,t)=>e in n?hpe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ype=(n,e)=>{for(var t in e||(e={}))gpe.call(e,t)&&T6(n,t,e[t]);if(_6)for(var t of _6(e))mpe.call(e,t)&&T6(n,t,e[t]);return n},wpe=(n,e)=>fpe(n,ppe(e));function nu(n){let e=[];return n.forEach(t=>{let[r,i]=t.split(":");e.push(`${r}:${i}`)}),e}function iV(n){let e=[];return Object.values(n).forEach(t=>{e.push(...nu(t.accounts))}),e}function sV(n,e){let t=[];return Object.values(n).forEach(r=>{nu(r.accounts).includes(e)&&t.push(...r.methods)}),t}function oV(n,e){let t=[];return Object.values(n).forEach(r=>{nu(r.accounts).includes(e)&&t.push(...r.events)}),t}function vpe(n,e){let t=yV(n,e);if(t)throw new Error(t.message);let r={};for(let[i,s]of Object.entries(n))r[i]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return r}function bpe(n){var e;let{proposal:{requiredNamespaces:t,optionalNamespaces:r={}},supportedNamespaces:i}=n,s=bg(t),o=bg(r),a={};Object.keys(i).forEach(u=>{let d=i[u].chains,h=i[u].methods,f=i[u].events,p=i[u].accounts;d.forEach(g=>{if(!p.some(m=>m.includes(g)))throw new Error(`No accounts provided for chain ${g} in namespace ${u}`)}),a[u]={chains:d,methods:h,events:f,accounts:p}});let c=vV(t,a,"approve()");if(c)throw new Error(c.message);let l={};if(!Object.keys(t).length&&!Object.keys(r).length)return a;Object.keys(s).forEach(u=>{let d=i[u].chains.filter(g=>{var m,y;return(y=(m=s[u])==null?void 0:m.chains)==null?void 0:y.includes(g)}),h=i[u].methods.filter(g=>{var m,y;return(y=(m=s[u])==null?void 0:m.methods)==null?void 0:y.includes(g)}),f=i[u].events.filter(g=>{var m,y;return(y=(m=s[u])==null?void 0:m.events)==null?void 0:y.includes(g)}),p=d.map(g=>i[u].accounts.filter(m=>m.includes(`${g}:`))).flat();l[u]={chains:d,methods:h,events:f,accounts:p}}),Object.keys(o).forEach(u=>{var d,h,f,p,g,m;if(!i[u])return;let y=(h=(d=o[u])==null?void 0:d.chains)==null?void 0:h.filter(k=>i[u].chains.includes(k)),E=i[u].methods.filter(k=>{var D,B;return(B=(D=o[u])==null?void 0:D.methods)==null?void 0:B.includes(k)}),I=i[u].events.filter(k=>{var D,B;return(B=(D=o[u])==null?void 0:D.events)==null?void 0:B.includes(k)}),L=y?.map(k=>i[u].accounts.filter(D=>D.includes(`${k}:`))).flat();l[u]={chains:Gi((f=l[u])==null?void 0:f.chains,y),methods:Gi((p=l[u])==null?void 0:p.methods,E),events:Gi((g=l[u])==null?void 0:g.events,I),accounts:Gi((m=l[u])==null?void 0:m.accounts,L)}});for(let[u,d]of Object.entries(l))(d.accounts.length===0||((e=d?.chains)==null?void 0:e.length)===0)&&delete l[u];return l}function AD(n){return n.includes(":")}function aV(n){return AD(n)?n.split(":")[0]:n}function bg(n){var e,t,r;let i={};if(!Ib(n))return i;for(let[s,o]of Object.entries(n)){let a=AD(s)?[s]:o.chains,c=o.methods||[],l=o.events||[],u=aV(s);i[u]=wpe(ype({},i[u]),{chains:Gi(a,(e=i[u])==null?void 0:e.chains),methods:Gi(c,(t=i[u])==null?void 0:t.methods),events:Gi(l,(r=i[u])==null?void 0:r.events)})}return i}function cV(n){let e={};return n?.forEach(t=>{var r;let[i,s]=t.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[],methods:[]}),e[i].accounts.push(t),(r=e[i].chains)==null||r.push(`${i}:${s}`)}),e}function Epe(n,e){e=e.map(r=>r.replace("did:pkh:",""));let t=cV(e);for(let[r,i]of Object.entries(t))i.methods?i.methods=Gi(i.methods,n):i.methods=n,i.events=["chainChanged","accountsChanged"];return t}function Ipe(n,e){var t,r,i,s,o,a;let c=bg(n),l=bg(e),u={},d=Object.keys(c).concat(Object.keys(l));for(let h of d)u[h]={chains:Gi((t=c[h])==null?void 0:t.chains,(r=l[h])==null?void 0:r.chains),methods:Gi((i=c[h])==null?void 0:i.methods,(s=l[h])==null?void 0:s.methods),events:Gi((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}var lV={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},uV={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Jo(n,e){let{message:t,code:r}=uV[n];return{message:e?`${t} ${e}`:t,code:r}}function Xl(n,e){let{message:t,code:r}=lV[n];return{message:e?`${t} ${e}`:t,code:r}}function _g(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function Ib(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function vc(n){return typeof n>"u"}function bi(n,e){return e&&vc(n)?!0:typeof n=="string"&&!!n.trim().length}function Cb(n,e){return e&&vc(n)?!0:typeof n=="number"&&!isNaN(n)}function Cpe(n,e){let{requiredNamespaces:t}=e,r=Object.keys(n.namespaces),i=Object.keys(t),s=!0;return yc(i,r)?(r.forEach(o=>{let{accounts:a,methods:c,events:l}=n.namespaces[o],u=nu(a),d=t[o];(!yc(lb(o,d),u)||!yc(d.methods,c)||!yc(d.events,l))&&(s=!1)}),s):!1}function Eg(n){return bi(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function dV(n){if(bi(n,!1)&&n.includes(":")){let e=n.split(":");if(e.length===3){let t=e[0]+":"+e[1];return!!e[2]&&Eg(t)}}return!1}function Spe(n){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(bi(n,!1)){if(e(n))return!0;let t=oD(n);return e(t)}}catch{}return!1}function Ape(n){var e;return(e=n?.proposer)==null?void 0:e.publicKey}function _pe(n){return n?.topic}function Tpe(n,e){let t=null;return bi(n?.publicKey,!1)||(t=Jo("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Jx(n){let e=!0;return _g(n)?n.length&&(e=n.every(t=>bi(t,!1))):e=!1,e}function hV(n,e,t){let r=null;return _g(e)&&e.length?e.forEach(i=>{r||Eg(i)||(r=Xl("UNSUPPORTED_CHAINS",`${t}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):Eg(n)||(r=Xl("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function fV(n,e,t){let r=null;return Object.entries(n).forEach(([i,s])=>{if(r)return;let o=hV(i,lb(i,s),`${e} ${t}`);o&&(r=o)}),r}function pV(n,e){let t=null;return _g(n)?n.forEach(r=>{t||dV(r)||(t=Xl("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):t=Xl("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function gV(n,e){let t=null;return Object.values(n).forEach(r=>{if(t)return;let i=pV(r?.accounts,`${e} namespace`);i&&(t=i)}),t}function mV(n,e){let t=null;return Jx(n?.methods)?Jx(n?.events)||(t=Xl("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Xl("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function _D(n,e){let t=null;return Object.values(n).forEach(r=>{if(t)return;let i=mV(r,`${e}, namespace`);i&&(t=i)}),t}function xpe(n,e,t){let r=null;if(n&&Ib(n)){let i=_D(n,e);i&&(r=i);let s=fV(n,e,t);s&&(r=s)}else r=Jo("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return r}function yV(n,e){let t=null;if(n&&Ib(n)){let r=_D(n,e);r&&(t=r);let i=gV(n,e);i&&(t=i)}else t=Jo("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function wV(n){return bi(n.protocol,!0)}function Dpe(n,e){let t=!1;return e&&!n?t=!0:n&&_g(n)&&n.length&&n.forEach(r=>{t=wV(r)}),t}function Npe(n){return typeof n=="number"}function Rpe(n){return typeof n<"u"&&typeof n!==null}function Ope(n){return!(!n||typeof n!="object"||!n.code||!Cb(n.code,!1)||!n.message||!bi(n.message,!1))}function Ppe(n){return!(vc(n)||!bi(n.method,!1))}function Mpe(n){return!(vc(n)||vc(n.result)&&vc(n.error)||!Cb(n.id,!1)||!bi(n.jsonrpc,!1))}function kpe(n){return!(vc(n)||!bi(n.name,!1))}function Lpe(n,e){return!(!Eg(e)||!iV(n).includes(e))}function Fpe(n,e,t){return bi(t,!1)?sV(n,e).includes(t):!1}function Bpe(n,e,t){return bi(t,!1)?oV(n,e).includes(t):!1}function vV(n,e,t){let r=null,i=Upe(n),s=jpe(e),o=Object.keys(i),a=Object.keys(s),c=x6(Object.keys(n)),l=x6(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=Jo("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),yc(o,a)||(r=Jo("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;let h=nu(e[d].accounts);h.includes(d)||(r=Jo("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(yc(i[d].methods,s[d].methods)?yc(i[d].events,s[d].events)||(r=Jo("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${d}`)):r=Jo("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function Upe(n){let e={};return Object.keys(n).forEach(t=>{var r;t.includes(":")?e[t]=n[t]:(r=n[t].chains)==null||r.forEach(i=>{e[i]={methods:n[t].methods,events:n[t].events}})}),e}function x6(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function jpe(n){let e={};return Object.keys(n).forEach(t=>{t.includes(":")?e[t]=n[t]:nu(n[t].accounts)?.forEach(i=>{e[i]={accounts:n[t].accounts.filter(s=>s.includes(`${i}:`)),methods:n[t].methods,events:n[t].events}})}),e}function Vpe(n,e){return Cb(n,!1)&&n<=e.max&&n>=e.min}function Hpe(){let n=eu();return new Promise(e=>{switch(n){case Dr.browser:e(bV());break;case Dr.reactNative:e(EV());break;case Dr.node:e(IV());break;default:e(!0)}})}function bV(){return mh()&&navigator?.onLine}async function EV(){return Ic()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function IV(){return!0}function $pe(n){switch(eu()){case Dr.browser:CV(n);break;case Dr.reactNative:SV(n);break;case Dr.node:break}}function CV(n){!Ic()&&mh()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function SV(n){Ic()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>n(e?.isConnected))}function qpe(){var n;return mh()&&Xo.getDocument()?((n=Xo.getDocument())==null?void 0:n.visibilityState)==="visible":!0}var Dx={},Zx=class{static get(e){return Dx[e]}static set(e,t){Dx[e]=t}static delete(e){delete Dx[e]}};function AV(n){let e=Ig.default.decode(n);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function _V({publicKey:n,signature:e,payload:t}){var r;let i=Xx(t.method),s=128|parseInt(((r=t.version)==null?void 0:r.toString())||"4"),o=Gpe(t.address),a=t.era==="00"?new Uint8Array([0]):Xx(t.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");let c=parseInt(t.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${zpe(t.tip)}`),d=Kpe(u),h=new Uint8Array([0,...n,o,...e,...a,...l,...d,...i]),f=Wpe(h.length+1);return new Uint8Array([...f,s,...h])}function TV(n){let e=Xx(n),t=kue.blake2b(e,void 0,32);return"0x"+Buffer.from(t).toString("hex")}function Xx(n){return new Uint8Array(n.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function zpe(n){return n.startsWith("0x")?n.slice(2):n}function Gpe(n){let e=Ig.default.decode(n)[0];return e===42?0:e===60?2:1}function Wpe(n){if(n<64)return new Uint8Array([n<<2]);if(n<16384){let e=n<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(n<1<<30){let e=n<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function Kpe(n){if(n<BigInt(1)<<BigInt(6))return new Uint8Array([Number(n<<BigInt(2))]);if(n<BigInt(1)<<BigInt(14)){let e=n<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(n<BigInt(1)<<BigInt(30)){let e=n<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function Qpe(n){let e=Uint8Array.from(Buffer.from(n.signature,"hex")),t=AV(n.transaction.address),r=_V({publicKey:t,signature:e,payload:n.transaction}),i=Buffer.from(r).toString("hex");return TV(i)}function Ype({logger:n,name:e}){let t=typeof n=="string"?Lue.generatePlatformLogger({opts:{level:n,name:e}}).logger:n;return t.level=typeof n=="string"?n:n.level,t}O.BASE10=bD,O.BASE16=Rr,O.BASE64=hh,O.BASE64URL=bb,O.COLON=Que,O.DEFAULT_DEPTH=rD,O.EMPTY_SPACE=tb,O.ENV_MAP=Dr,O.INTERNAL_ERRORS=uV,O.LimitedSet=Ox,O.MemoryStore=Zx,O.ONE_THOUSAND=Yue,O.REACT_NATIVE_PRODUCT=M6,O.RELAYER_DEFAULT_PROTOCOL=eV,O.SDK_ERRORS=lV,O.SDK_TYPE=L6,O.SLASH=k6,O.TYPE_0=ED,O.TYPE_1=wh,O.TYPE_2=Ag,O.UTF8=yh,O.addResourceToRecap=E5,O.addSignatureToExtrinsic=_V,O.appendToQueryString=F6,O.assertType=ide,O.assignAbilityToActions=fD,O.base64Decode=v5,O.base64Encode=w5,O.buildApprovedNamespaces=bpe,O.buildAuthObject=Ehe,O.buildNamespacesFromAuth=Epe,O.buildRecapStatement=C5,O.buildSignedExtrinsicHash=Qpe,O.calcExpiry=mde,O.capitalize=ude,O.capitalizeWord=q6,O.createDelayedPromise=dde,O.createEncodedRecap=Ahe,O.createExpiringPromise=hde,O.createLogger=Ype,O.createRecap=b5,O.decodeRecap=Ec,O.decodeTypeByte=Zl,O.decodeTypeTwoEnvelope=Yfe,O.decrypt=Kfe,O.deriveExtrinsicHash=TV,O.deriveSymKey=qfe,O.deserialize=Eb,O.encodeRecap=pb,O.encodeTypeByte=CD,O.encodeTypeTwoEnvelope=Qfe,O.encrypt=Wfe,O.engineEvent=wde,O.enumify=lde,O.extractSolanaTransactionId=che,O.formatAccountId=N6,O.formatAccountWithChain=Bue,O.formatChainId=D6,O.formatDeeplinkUrl=z6,O.formatExpirerTarget=sD,O.formatIdTarget=pde,O.formatMessage=p5,O.formatMessageContext=sde,O.formatRelayParams=rV,O.formatRelayRpcUrl=nde,O.formatStatementFromRecap=gD,O.formatTopicTarget=fde,O.formatUA=V6,O.formatUri=upe,O.fromBase64=oD,O.generateKeyPair=Hfe,O.generateRandomBytes32=$fe,O.getAccountsChains=nu,O.getAccountsFromNamespaces=jue,O.getAddressFromAccount=R6,O.getAddressesFromAccounts=Uue,O.getAlgorandTransactionId=dhe,O.getAppId=Xue,O.getAppMetadata=B6,O.getBrowserOnlineStatus=bV,O.getChainFromAccount=O6,O.getChainsFromAccounts=P6,O.getChainsFromNamespace=lb,O.getChainsFromNamespaces=Vue,O.getChainsFromRecap=xhe,O.getChainsFromRequiredNamespaces=Hue,O.getCommonValuesInArrays=Rx,O.getCryptoKeyFromKeyData=X5,O.getDecodedRecapFromResources=g5,O.getDeepLink=bde,O.getDidAddress=hD,O.getDidAddressSegments=fb,O.getDidChainId=h5,O.getEnvironment=eu,O.getHttpUrl=rde,O.getInternalError=Jo,O.getJavascriptID=j6,O.getJavascriptOS=U6,O.getLastItems=$6,O.getLinkModeURL=dpe,O.getMethodsFromRecap=The,O.getNamespacedDidChainId=f5,O.getNamespacesChains=iV,O.getNamespacesEventsForChainId=oV,O.getNamespacesFromAccounts=cV,O.getNamespacesMethodsForChainId=sV,O.getNearTransactionIdFromSignedTransaction=uhe,O.getNearUint8ArrayFromBytes=u5,O.getNodeOnlineStatus=IV,O.getReCapActions=y5,O.getReactNativeOnlineStatus=EV,O.getRecapAbilitiesFromResource=She,O.getRecapFromResources=gb,O.getRecapResource=m5,O.getRelayClientMetadata=tde,O.getRelayProtocolApi=npe,O.getRelayProtocolName=tpe,O.getRequiredNamespacesFromNamespaces=vpe,O.getSdkError=Xl,O.getSearchParamFromURL=Ede,O.getSignDirectHash=hhe,O.getSuiDigest=lhe,O.getUniqueValues=nD,O.getWalletSendCallsHashes=fhe,O.handleDeeplinkRedirect=vde,O.hasOverlap=yc,O.hashEthereumMessage=uD,O.hashKey=zfe,O.hashMessage=Gfe,O.isAndroid=Jue,O.isAppVisible=qpe,O.isBrowser=mh,O.isCaipNamespace=AD,O.isConformingNamespaces=vV,O.isExpired=yde,O.isIframe=K6,O.isIos=Zue,O.isNode=iD,O.isOnline=Hpe,O.isProposalStruct=Ape,O.isReactNative=Ic,O.isRecap=pD,O.isSessionCompatible=Cpe,O.isSessionStruct=_pe,O.isTelegram=W6,O.isTestRun=Cde,O.isTypeOneEnvelope=Zfe,O.isTypeTwoEnvelope=Xfe,O.isUndefined=vc,O.isValidAccountId=dV,O.isValidAccounts=pV,O.isValidActions=mV,O.isValidArray=_g,O.isValidChainId=Eg,O.isValidChains=hV,O.isValidController=Tpe,O.isValidEip1271Signature=l5,O.isValidEip191Signature=c5,O.isValidErrorReason=Ope,O.isValidEvent=kpe,O.isValidId=Npe,O.isValidNamespaceAccounts=gV,O.isValidNamespaceActions=_D,O.isValidNamespaceChains=fV,O.isValidNamespaceMethodsOrEvents=Jx,O.isValidNamespaces=yV,O.isValidNamespacesChainId=Lpe,O.isValidNamespacesEvent=Bpe,O.isValidNamespacesRequest=Fpe,O.isValidNumber=Cb,O.isValidObject=Ib,O.isValidParams=Rpe,O.isValidRecap=so,O.isValidRelay=wV,O.isValidRelays=Dpe,O.isValidRequest=Ppe,O.isValidRequestExpiry=Vpe,O.isValidRequiredNamespaces=xpe,O.isValidResponse=Mpe,O.isValidString=bi,O.isValidUrl=Spe,O.mapEntries=cde,O.mapToObj=ode,O.mergeArrays=Gi,O.mergeEncodedRecaps=_he,O.mergeRecaps=I5,O.mergeRequiredAndOptionalNamespaces=Ipe,O.normalizeNamespaces=bg,O.objToMap=ade,O.openDeeplink=G6,O.parseAccountId=tD,O.parseChainId=eD,O.parseContextNames=H6,O.parseExpirerTarget=gde,O.parseNamespaceKey=aV,O.parseRelayParams=tV,O.parseTopic=nV,O.parseUri=lpe,O.populateAppMetadata=ede,O.populateAuthPayload=Ihe,O.recapHasResource=Che,O.serialize=SD,O.sleep=Sde,O.ss58AddressToPublicKey=AV,O.subscribeToBrowserNetworkChange=CV,O.subscribeToNetworkChange=$pe,O.subscribeToReactNativeNetworkChange=SV,O.toBase64=Q6,O.uuidv4=Ide,O.validateDecoding=Jfe,O.validateEncoding=Z5,O.validateSignedCacao=bhe,O.verifyP256Jwt=epe,O.verifySignature=a5});var HH=Bs(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});var iu=co(),su=(QN(),Fe(KN)),Jpe=(JN(),Fe(YN)),Mt=(K0(),Fe(W0)),Ls=(yx(),Fe(mx)),Re=hu(),TD=(dE(),Fe($N)),RD=($g(),Fe(Hg)),z=Sb(),Zpe=(zg(),Fe(qg)),Xpe=(Wg(),Fe(Gg)),Or=(pu(),Fe(fu)),ege=(XN(),Fe(ZN)),tge=Vg();function JD(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}function nge(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}}),e.default=n,Object.freeze(e)}var rge=JD(iu),ige=JD(Jpe),Ab=nge(RD),sge=JD(ege),ZD="wc",XD=2,Pg="core",ks=`${ZD}@2:${Pg}:`,YV={name:Pg,logger:"error"},JV={database:":memory:"},ZV="crypto",OD="client_ed25519_seed",XV=Re.ONE_DAY,eH="keychain",tH="0.3",nH="messages",rH="0.3",iH=Re.SIX_HOURS,sH="publisher",oH="irn",aH="error",eN="wss://relay.walletconnect.org",cH="relayer",fn={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},lH="_subscription",Ii={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},uH=.1,oge={database:":memory:"},_b="2.22.4",age=1e4,ru={link_mode:"link_mode",relay:"relay"},Ng={inbound:"inbound",outbound:"outbound"},dH="0.3",hH="WALLETCONNECT_CLIENT_ID",PD="WALLETCONNECT_LINK_MODE_APPS",ti={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},cge=Re.THIRTY_DAYS,fH="subscription",pH="0.3",lge=Re.FIVE_SECONDS*1e3,gH="pairing",mH="0.3",uge=Re.THIRTY_DAYS,Eh={wc_pairingDelete:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Re.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Re.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Re.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:0},res:{ttl:Re.ONE_DAY,prompt:!1,tag:0}}},Ih={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Qi={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},yH="history",wH="0.3",vH="expirer",Yi={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},bH="0.3",dge=Re.ONE_DAY,EH="verify-api",hge="https://verify.walletconnect.com",IH="https://verify.walletconnect.org",Rg=IH,CH=`${Rg}/v3`,SH=[hge,IH],AH="echo",_H="https://echo.walletconnect.com",fge="event-client",ao={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ta={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},pge={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},gge={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},mge={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},yge={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},TH=.1,xH="event-client",DH=86400,NH="https://pulse.walletconnect.org/batch";function wge(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<n.length;i++){var s=n.charAt(i),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=i}var a=n.length,c=n.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,y=0,E=p.length;y!==E&&p[y]===0;)y++,g++;for(var I=(E-y)*u+1>>>0,L=new Uint8Array(I);y!==E;){for(var k=p[y],D=0,B=I-1;(k!==0||D<m)&&B!==-1;B--,D++)k+=256*L[B]>>>0,L[B]=k%a>>>0,k=k/a>>>0;if(k!==0)throw new Error("Non-zero carry");m=D,y++}for(var U=I-m;U!==I&&L[U]===0;)U++;for(var T=c.repeat(g);U<I;++U)T+=n.charAt(L[U]);return T}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,y=0;p[g]===c;)m++,g++;for(var E=(p.length-g)*l+1>>>0,I=new Uint8Array(E);p[g];){var L=t[p.charCodeAt(g)];if(L===255)return;for(var k=0,D=E-1;(L!==0||k<y)&&D!==-1;D--,k++)L+=a*I[D]>>>0,I[D]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");y=k,g++}if(p[g]!==" "){for(var B=E-y;B!==E&&I[B]===0;)B++;for(var U=new Uint8Array(m+(E-B)),T=m;B!==E;)U[T++]=I[B++];return U}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var vge=wge,bge=vge,RH=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Ege=n=>new TextEncoder().encode(n),Ige=n=>new TextDecoder().decode(n),MD=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},kD=class{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return OH(this,e)}},LD=class{constructor(e){this.decoders=e}or(e){return OH(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},OH=(n,e)=>new LD(H(H({},n.decoders||{[n.prefix]:n}),e.decoders||{[e.prefix]:e})),FD=class{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new MD(e,t,r),this.decoder=new kD(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},jb=({name:n,prefix:e,encode:t,decode:r})=>new FD(n,e,t,r),Mg=({prefix:n,name:e,alphabet:t})=>{let{encode:r,decode:i}=bge(t,e);return jb({prefix:n,name:e,encode:r,decode:s=>RH(i(s))})},Cge=(n,e,t,r)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=n.length;for(;n[s-1]==="=";)--s;let o=new Uint8Array(s*t/8|0),a=0,c=0,l=0;for(let u=0;u<s;++u){let d=i[n[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Sge=(n,e,t)=>{let r=e[e.length-1]==="=",i=(1<<t)-1,s="",o=0,a=0;for(let c=0;c<n.length;++c)for(a=a<<8|n[c],o+=8;o>t;)o-=t,s+=e[i&a>>o];if(o&&(s+=e[i&a<<t-o]),r)for(;s.length*t&7;)s+="=";return s},qn=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>jb({prefix:e,name:n,encode(i){return Sge(i,r,t)},decode(i){return Cge(i,r,t,n)}}),Age=jb({prefix:"\0",name:"identity",encode:n=>Ige(n),decode:n=>Ege(n)}),_ge=Object.freeze({__proto__:null,identity:Age}),Tge=qn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),xge=Object.freeze({__proto__:null,base2:Tge}),Dge=qn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Nge=Object.freeze({__proto__:null,base8:Dge}),Rge=Mg({prefix:"9",name:"base10",alphabet:"0123456789"}),Oge=Object.freeze({__proto__:null,base10:Rge}),Pge=qn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mge=qn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),kge=Object.freeze({__proto__:null,base16:Pge,base16upper:Mge}),Lge=qn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Fge=qn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bge=qn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Uge=qn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),jge=qn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Vge=qn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Hge=qn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$ge=qn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qge=qn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),zge=Object.freeze({__proto__:null,base32:Lge,base32upper:Fge,base32pad:Bge,base32padupper:Uge,base32hex:jge,base32hexupper:Vge,base32hexpad:Hge,base32hexpadupper:$ge,base32z:qge}),Gge=Mg({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Wge=Mg({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Kge=Object.freeze({__proto__:null,base36:Gge,base36upper:Wge}),Qge=Mg({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Yge=Mg({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Jge=Object.freeze({__proto__:null,base58btc:Qge,base58flickr:Yge}),Zge=qn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Xge=qn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),eme=qn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tme=qn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),nme=Object.freeze({__proto__:null,base64:Zge,base64pad:Xge,base64url:eme,base64urlpad:tme}),PH=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),rme=PH.reduce((n,e,t)=>(n[t]=e,n),[]),ime=PH.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function sme(n){return n.reduce((e,t)=>(e+=rme[t],e),"")}function ome(n){let e=[];for(let t of n){let r=ime[t.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(r)}return new Uint8Array(e)}var ame=jb({prefix:"\u{1F680}",name:"base256emoji",encode:sme,decode:ome}),cme=Object.freeze({__proto__:null,base256emoji:ame}),lme=MH,xV=128,ume=127,dme=~ume,hme=Math.pow(2,31);function MH(n,e,t){e=e||[],t=t||0;for(var r=t;n>=hme;)e[t++]=n&255|xV,n/=128;for(;n&dme;)e[t++]=n&255|xV,n>>>=7;return e[t]=n|0,MH.bytes=t-r+1,e}var fme=BD,pme=128,DV=127;function BD(n,r){var t=0,r=r||0,i=0,s=r,o,a=n.length;do{if(s>=a)throw BD.bytes=0,new RangeError("Could not decode varint");o=n[s++],t+=i<28?(o&DV)<<i:(o&DV)*Math.pow(2,i),i+=7}while(o>=pme);return BD.bytes=s-r,t}var gme=Math.pow(2,7),mme=Math.pow(2,14),yme=Math.pow(2,21),wme=Math.pow(2,28),vme=Math.pow(2,35),bme=Math.pow(2,42),Eme=Math.pow(2,49),Ime=Math.pow(2,56),Cme=Math.pow(2,63),Sme=function(n){return n<gme?1:n<mme?2:n<yme?3:n<wme?4:n<vme?5:n<bme?6:n<Eme?7:n<Ime?8:n<Cme?9:10},Ame={encode:lme,decode:fme,encodingLength:Sme},kH=Ame,NV=(n,e,t=0)=>(kH.encode(n,e,t),e),RV=n=>kH.encodingLength(n),UD=(n,e)=>{let t=e.byteLength,r=RV(n),i=r+RV(t),s=new Uint8Array(i+t);return NV(n,s,0),NV(t,s,r),s.set(e,i),new jD(n,t,e,s)},jD=class{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}},LH=({name:n,code:e,encode:t})=>new VD(n,e,t),VD=class{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?UD(this.code,t):t.then(r=>UD(this.code,r))}else throw Error("Unknown type, must be binary type")}},FH=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),_me=LH({name:"sha2-256",code:18,encode:FH("SHA-256")}),Tme=LH({name:"sha2-512",code:19,encode:FH("SHA-512")}),xme=Object.freeze({__proto__:null,sha256:_me,sha512:Tme}),BH=0,Dme="identity",UH=RH,Nme=n=>UD(BH,UH(n)),Rme={code:BH,name:Dme,encode:UH,digest:Nme},Ome=Object.freeze({__proto__:null,identity:Rme});new TextEncoder,new TextDecoder;var OV=H(H(H(H(H(H(H(H(H(H({},_ge),xge),Nge),Oge),kge),zge),Kge),Jge),nme),cme);H(H({},xme),Ome);function jH(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Pme(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?jH(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function VH(n,e,t,r){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:r}}}var PV=VH("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),xD=VH("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);let e=Pme(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),Mme=H({utf8:PV,"utf-8":PV,hex:OV.base16,latin1:xD,ascii:xD,binary:xD},OV);function kme(n,e="utf8"){let t=Mme[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?jH(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}var Lme=Object.defineProperty,Fme=(n,e,t)=>e in n?Lme(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,oo=(n,e,t)=>Fme(n,typeof e!="symbol"?e+"":e,t),Tb=class{constructor(e,t){this.core=e,this.logger=t,oo(this,"keychain",new Map),oo(this,"name",eH),oo(this,"version",tH),oo(this,"initialized",!1),oo(this,"storagePrefix",ks),oo(this,"init",async()=>{if(!this.initialized){let r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),oo(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),oo(this,"set",async(r,i)=>{this.isInitialized(),this.keychain.set(r,i),await this.persist()}),oo(this,"get",r=>{this.isInitialized();let i=this.keychain.get(r);if(typeof i>"u"){let{message:s}=z.getInternalError("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(s)}return i}),oo(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=Mt.generateChildLogger(t,this.name)}get context(){return Mt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,z.mapToObj(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?z.objToMap(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},Bme=Object.defineProperty,Ume=(n,e,t)=>e in n?Bme(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Rn=(n,e,t)=>Ume(n,typeof e!="symbol"?e+"":e,t),xb=class{constructor(e,t,r){this.core=e,this.logger=t,Rn(this,"name",ZV),Rn(this,"keychain"),Rn(this,"randomSessionIdentifier",z.generateRandomBytes32()),Rn(this,"initialized",!1),Rn(this,"clientId"),Rn(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Rn(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),Rn(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;let i=await this.getClientSeed(),s=Ab.generateKeyPair(i),o=Ab.encodeIss(s.publicKey);return this.clientId=o,o}),Rn(this,"generateKeyPair",()=>{this.isInitialized();let i=z.generateKeyPair();return this.setPrivateKey(i.publicKey,i.privateKey)}),Rn(this,"signJWT",async i=>{this.isInitialized();let s=await this.getClientSeed(),o=Ab.generateKeyPair(s),a=this.randomSessionIdentifier,c=XV;return await Ab.signJWT(a,i,c,o)}),Rn(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();let a=this.getPrivateKey(i),c=z.deriveSymKey(a,s);return this.setSymKey(c,o)}),Rn(this,"setSymKey",async(i,s)=>{this.isInitialized();let o=s||z.hashKey(i);return await this.keychain.set(o,i),o}),Rn(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),Rn(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),Rn(this,"encode",async(i,s,o)=>{this.isInitialized();let a=z.validateEncoding(o),c=TD.safeJsonStringify(s);if(z.isTypeTwoEnvelope(a))return z.encodeTypeTwoEnvelope(c,o?.encoding);if(z.isTypeOneEnvelope(a)){let h=a.senderPublicKey,f=a.receiverPublicKey;i=await this.generateSharedKey(h,f)}let l=this.getSymKey(i),{type:u,senderPublicKey:d}=a;return z.encrypt({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),Rn(this,"decode",async(i,s,o)=>{this.isInitialized();let a=z.validateDecoding(s,o);if(z.isTypeTwoEnvelope(a)){let c=z.decodeTypeTwoEnvelope(s,o?.encoding);return TD.safeJsonParse(c)}if(z.isTypeOneEnvelope(a)){let c=a.receiverPublicKey,l=a.senderPublicKey;i=await this.generateSharedKey(c,l)}try{let c=this.getSymKey(i),l=z.decrypt({symKey:c,encoded:s,encoding:o?.encoding});return TD.safeJsonParse(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Rn(this,"getPayloadType",(i,s=z.BASE64)=>{let o=z.deserialize({encoded:i,encoding:s});return z.decodeTypeByte(o.type)}),Rn(this,"getPayloadSenderPublicKey",(i,s=z.BASE64)=>{let o=z.deserialize({encoded:i,encoding:s});return o.senderPublicKey?Zpe.toString(o.senderPublicKey,z.BASE16):void 0}),this.core=e,this.logger=Mt.generateChildLogger(t,this.name),this.keychain=r||new Tb(this.core,this.logger)}get context(){return Mt.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(OD)}catch{e=z.generateRandomBytes32(),await this.keychain.set(OD,e)}return kme(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},jme=Object.defineProperty,Vme=Object.defineProperties,Hme=Object.getOwnPropertyDescriptors,MV=Object.getOwnPropertySymbols,$me=Object.prototype.hasOwnProperty,qme=Object.prototype.propertyIsEnumerable,HD=(n,e,t)=>e in n?jme(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zme=(n,e)=>{for(var t in e||(e={}))$me.call(e,t)&&HD(n,t,e[t]);if(MV)for(var t of MV(e))qme.call(e,t)&&HD(n,t,e[t]);return n},Gme=(n,e)=>Vme(n,Hme(e)),Ei=(n,e,t)=>HD(n,typeof e!="symbol"?e+"":e,t),Db=class extends Ls.IMessageTracker{constructor(e,t){super(e,t),this.logger=e,this.core=t,Ei(this,"messages",new Map),Ei(this,"messagesWithoutClientAck",new Map),Ei(this,"name",nH),Ei(this,"version",rH),Ei(this,"initialized",!1),Ei(this,"storagePrefix",ks),Ei(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);let i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Ei(this,"set",async(r,i,s)=>{this.isInitialized();let o=z.hashMessage(i),a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(r,a),s===Ng.inbound){let c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,Gme(zme({},c),{[o]:i}))}return await this.persist(),o}),Ei(this,"get",r=>{this.isInitialized();let i=this.messages.get(r);return typeof i>"u"&&(i={}),i}),Ei(this,"getWithoutAck",r=>{this.isInitialized();let i={};for(let s of r){let o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),Ei(this,"has",(r,i)=>{this.isInitialized();let s=this.get(r),o=z.hashMessage(i);return typeof s[o]<"u"}),Ei(this,"ack",async(r,i)=>{this.isInitialized();let s=this.messagesWithoutClientAck.get(r);if(typeof s>"u")return;let o=z.hashMessage(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,s),await this.persist()}),Ei(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Mt.generateChildLogger(e,this.name),this.core=t}get context(){return Mt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,z.mapToObj(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,z.mapToObj(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?z.objToMap(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?z.objToMap(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},Wme=Object.defineProperty,Kme=Object.defineProperties,Qme=Object.getOwnPropertyDescriptors,kV=Object.getOwnPropertySymbols,Yme=Object.prototype.hasOwnProperty,Jme=Object.prototype.propertyIsEnumerable,$D=(n,e,t)=>e in n?Wme(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vh=(n,e)=>{for(var t in e||(e={}))Yme.call(e,t)&&$D(n,t,e[t]);if(kV)for(var t of kV(e))Jme.call(e,t)&&$D(n,t,e[t]);return n},LV=(n,e)=>Kme(n,Qme(e)),Ki=(n,e,t)=>$D(n,typeof e!="symbol"?e+"":e,t),qD=class extends Ls.IPublisher{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Ki(this,"events",new iu.EventEmitter),Ki(this,"name",sH),Ki(this,"queue",new Map),Ki(this,"publishTimeout",Re.toMiliseconds(Re.ONE_MINUTE)),Ki(this,"initialPublishTimeout",Re.toMiliseconds(Re.ONE_SECOND*15)),Ki(this,"needsTransportRestart",!1),Ki(this,"publish",async(r,i,s)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:i,opts:s}});let d=s?.ttl||iH,h=s?.prompt||!1,f=s?.tag||0,p=s?.id||Or.getBigIntRpcId().toString(),g=z.getRelayProtocolApi(z.getRelayProtocolName().protocol),m={id:p,method:s?.publishMethod||g.publish,params:vh({topic:r,message:i,ttl:d,prompt:h,tag:f,attestation:s?.attestation},s?.tvf)},y=`Failed to publish payload, please try again. id:${p} tag:${f}`;try{z.isUndefined((o=m.params)==null?void 0:o.prompt)&&((a=m.params)==null||delete a.prompt),z.isUndefined((c=m.params)==null?void 0:c.tag)&&((l=m.params)==null||delete l.tag);let E=new Promise(async I=>{let L=({id:D})=>{var B;((B=m.id)==null?void 0:B.toString())===D.toString()&&(this.removeRequestFromQueue(D),this.relayer.events.removeListener(fn.publish,L),I())};this.relayer.events.on(fn.publish,L);let k=z.createExpiringPromise(new Promise((D,B)=>{this.rpcPublish(m,s).then(D).catch(U=>{this.logger.warn(U,U?.message),B(U)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${f}`);try{await k,this.events.removeListener(fn.publish,L)}catch(D){this.queue.set(p,{request:m,opts:s,attempt:1}),this.logger.warn(D,D?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:r,message:i,opts:s}}),await z.createExpiringPromise(E,this.publishTimeout,y)}catch(E){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(E),(u=s?.internal)!=null&&u.throwOnFailedPublish)throw E}finally{this.queue.delete(p)}}),Ki(this,"publishCustom",async r=>{var i,s,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});let{payload:l,opts:u={}}=r,{attestation:d,tvf:h,publishMethod:f,prompt:p,tag:g,ttl:m=Re.FIVE_MINUTES}=u,y=u.id||Or.getBigIntRpcId().toString(),E=z.getRelayProtocolApi(z.getRelayProtocolName().protocol),I=f||E.publish,L={id:y,method:I,params:vh(LV(vh({},l),{ttl:m,prompt:p,tag:g,attestation:d}),h)},k=`Failed to publish custom payload, please try again. id:${y} tag:${g}`;try{z.isUndefined((i=L.params)==null?void 0:i.prompt)&&((s=L.params)==null||delete s.prompt),z.isUndefined((o=L.params)==null?void 0:o.tag)&&((a=L.params)==null||delete a.tag);let D=new Promise(async B=>{let U=({id:$})=>{var W;((W=L.id)==null?void 0:W.toString())===$.toString()&&(this.removeRequestFromQueue($),this.relayer.events.removeListener(fn.publish,U),B())};this.relayer.events.on(fn.publish,U);let T=z.createExpiringPromise(new Promise(($,W)=>{this.rpcPublish(L,u).then($).catch(M=>{this.logger.warn(M,M?.message),W(M)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${I} id:${y} tag:${g}`);try{await T,this.events.removeListener(fn.publish,U)}catch($){this.queue.set(y,{request:L,opts:u,attempt:1}),this.logger.warn($,$?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:y,payload:l,opts:u}}),await z.createExpiringPromise(D,this.publishTimeout,k)}catch(D){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(D),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw D}finally{this.queue.delete(y)}}),Ki(this,"on",(r,i)=>{this.events.on(r,i)}),Ki(this,"once",(r,i)=>{this.events.once(r,i)}),Ki(this,"off",(r,i)=>{this.events.off(r,i)}),Ki(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.relayer=e,this.logger=Mt.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Mt.getLoggerContext(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});let r=await this.relayer.request(e);return this.relayer.events.emit(fn.publish,vh(vh({},e),t)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var r;let i=e.attempt+1;this.queue.set(t,LV(vh({},e),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${i}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(su.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(fn.connection_stalled);return}this.checkQueue()}),this.relayer.on(fn.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}},Zme=Object.defineProperty,Xme=(n,e,t)=>e in n?Zme(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,bh=(n,e,t)=>Xme(n,typeof e!="symbol"?e+"":e,t),zD=class{constructor(){bh(this,"map",new Map),bh(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),bh(this,"get",e=>this.map.get(e)||[]),bh(this,"exists",(e,t)=>this.get(e).includes(t)),bh(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(s=>s!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),bh(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}},eye=Object.defineProperty,tye=Object.defineProperties,nye=Object.getOwnPropertyDescriptors,FV=Object.getOwnPropertySymbols,rye=Object.prototype.hasOwnProperty,iye=Object.prototype.propertyIsEnumerable,GD=(n,e,t)=>e in n?eye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Tg=(n,e)=>{for(var t in e||(e={}))rye.call(e,t)&&GD(n,t,e[t]);if(FV)for(var t of FV(e))iye.call(e,t)&&GD(n,t,e[t]);return n},DD=(n,e)=>tye(n,nye(e)),Pt=(n,e,t)=>GD(n,typeof e!="symbol"?e+"":e,t),Nb=class extends Ls.ISubscriber{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Pt(this,"subscriptions",new Map),Pt(this,"topicMap",new zD),Pt(this,"events",new iu.EventEmitter),Pt(this,"name",fH),Pt(this,"version",pH),Pt(this,"pending",new Map),Pt(this,"cached",[]),Pt(this,"initialized",!1),Pt(this,"storagePrefix",ks),Pt(this,"subscribeTimeout",Re.toMiliseconds(Re.ONE_MINUTE)),Pt(this,"initialSubscribeTimeout",Re.toMiliseconds(Re.ONE_SECOND*15)),Pt(this,"clientId"),Pt(this,"batchSubscribeTopicsLimit",500),Pt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Pt(this,"subscribe",async(r,i)=>{var s;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}});try{let o=z.getRelayProtocolName(i),a={topic:r,relay:o,transportType:i?.transportType};(s=i?.internal)!=null&&s.skipSubscribe||this.pending.set(r,a);let c=await this.rpcSubscribe(r,o,i);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Pt(this,"unsubscribe",async(r,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(r,i.id,i):await this.unsubscribeByTopic(r,i)}),Pt(this,"isSubscribed",r=>new Promise(i=>{i(this.topicMap.topics.includes(r))})),Pt(this,"isKnownTopic",r=>new Promise(i=>{i(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(s=>s.topic===r))})),Pt(this,"on",(r,i)=>{this.events.on(r,i)}),Pt(this,"once",(r,i)=>{this.events.once(r,i)}),Pt(this,"off",(r,i)=>{this.events.off(r,i)}),Pt(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),Pt(this,"start",async()=>{await this.onConnect()}),Pt(this,"stop",async()=>{await this.onDisconnect()}),Pt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Pt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;let r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}),Pt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(su.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.events.on(ti.created,async r=>{let i=ti.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(ti.deleted,async r=>{let i=ti.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}),this.relayer=e,this.logger=Mt.generateChildLogger(t,this.name),this.clientId=""}get context(){return Mt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=z.getRelayProtocolName(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let s=z.getSdkError("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,t,r){var i,s;let o=await this.getSubscriptionId(e);if((i=r?.internal)!=null&&i.skipSubscribe)return o;(!r||r?.transportType===ru.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});let a={method:z.getRelayProtocolApi(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});let c=(s=r?.internal)==null?void 0:s.throwOnFailedPublish;try{if(r?.transportType===ru.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},Re.toMiliseconds(Re.ONE_SECOND)),o;let l=new Promise(async d=>{let h=f=>{f.topic===e&&(this.events.removeListener(ti.created,h),d(f.id))};this.events.on(ti.created,h);try{let f=await z.createExpiringPromise(new Promise((p,g)=>{this.relayer.request(a).catch(m=>{this.logger.warn(m,m?.message),g(m)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(ti.created,h),d(f)}catch{}}),u=await z.createExpiringPromise(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(fn.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t=e[0].relay,r={method:z.getRelayProtocolApi(t.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await z.createExpiringPromise(new Promise(i=>{this.relayer.request(r).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(fn.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;let t=e[0].relay,r={method:z.getRelayProtocolApi(t.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let i;try{i=await await z.createExpiringPromise(new Promise((s,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(fn.connection_stalled)}return i}rpcUnsubscribe(e,t,r){let i={method:z.getRelayProtocolApi(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,DD(Tg({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Tg({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Tg({},t)),this.topicMap.set(t.topic,e),this.events.emit(ti.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:r}=z.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(ti.deleted,DD(Tg({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ti.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(ti.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(t=>{var r;return t.topic===((r=this.subscriptions.get(t.id))==null?void 0:r.topic)})){let{message:t}=z.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>DD(Tg({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await z.sleep(Re.toMiliseconds(Re.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return z.hashMessage(e+await this.getClientId())}},sye=Object.defineProperty,BV=Object.getOwnPropertySymbols,oye=Object.prototype.hasOwnProperty,aye=Object.prototype.propertyIsEnumerable,WD=(n,e,t)=>e in n?sye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,UV=(n,e)=>{for(var t in e||(e={}))oye.call(e,t)&&WD(n,t,e[t]);if(BV)for(var t of BV(e))aye.call(e,t)&&WD(n,t,e[t]);return n},ct=(n,e,t)=>WD(n,typeof e!="symbol"?e+"":e,t),Rb=class extends Ls.IRelayer{constructor(e){var t;super(e),ct(this,"protocol","wc"),ct(this,"version",2),ct(this,"core"),ct(this,"logger"),ct(this,"events",new iu.EventEmitter),ct(this,"provider"),ct(this,"messages"),ct(this,"subscriber"),ct(this,"publisher"),ct(this,"name",cH),ct(this,"transportExplicitlyClosed",!1),ct(this,"initialized",!1),ct(this,"connectionAttemptInProgress",!1),ct(this,"relayUrl"),ct(this,"projectId"),ct(this,"packageName"),ct(this,"bundleId"),ct(this,"hasExperiencedNetworkDisruption",!1),ct(this,"pingTimeout"),ct(this,"heartBeatTimeout",Re.toMiliseconds(Re.THIRTY_SECONDS+Re.FIVE_SECONDS)),ct(this,"reconnectTimeout"),ct(this,"connectPromise"),ct(this,"reconnectInProgress",!1),ct(this,"requestsInFlight",[]),ct(this,"connectTimeout",Re.toMiliseconds(Re.ONE_SECOND*15)),ct(this,"request",async r=>{var i,s;this.logger.debug("Publishing Request Payload");let o=r.id||Or.getBigIntRpcId().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");let a=`${o}:${((s=r.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(a);let c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),ct(this,"resetPingTimeout",()=>{z.isNode()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,s,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null?void 0:s.terminate)==null||o.call(s)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),ct(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),ct(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(fn.connect)}),ct(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),ct(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(fn.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ct(this,"registerProviderListeners",()=>{this.provider.on(Ii.payload,this.onPayloadHandler),this.provider.on(Ii.connect,this.onConnectHandler),this.provider.on(Ii.disconnect,this.onDisconnectHandler),this.provider.on(Ii.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=z.createLogger({logger:(t=e.logger)!=null?t:aH,name:this.name}),this.messages=new Db(this.logger,e.core),this.subscriber=new Nb(this,this.logger),this.publisher=new qD(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||eN,z.isAndroid()?this.packageName=z.getAppId():z.isIos()&&(this.bundleId=z.getAppId()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return Mt.getLoggerContext(this.logger)}get connected(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:ru.relay},Ng.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var r,i,s;this.isInitialized(),(!(t!=null&&t.transportType)||t?.transportType==="relay")&&await this.toEstablishConnection();let o=typeof((r=t?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(i=t?.internal)==null?void 0:i.throwOnFailedPublish,a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c,l=u=>{u.topic===e&&(this.subscriber.off(ti.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(ti.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,UV({internal:{throwOnFailedPublish:o}},t)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await z.createExpiringPromise(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await z.isOnline())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let t=e.sort((r,i)=>r.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(let r of t)try{await this.onMessageEvent(r)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let i=z.calcExpiry(Re.FIVE_MINUTES),s={topic:r,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,s)}this.events.emit(fn.message,e),await this.recordMessageEvent(e,Ng.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(r,i)=>{let s=()=>{i(new Error("Connection interrupted while trying to connect"))};this.provider.once(Ii.disconnect,s),await z.createExpiringPromise(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(Ii.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{let c=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Ii.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Ii.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();let i=r;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(r=>setTimeout(r,Re.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,r,i,s;if(z.isNode())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Xpe.JsonRpcProvider(new sge.default(z.formatRelayRpcUrl({sdkVersion:_b,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Or.isJsonRpcRequest(e)){if(!e.method.endsWith(lH))return;let t=e.params,{topic:r,message:i,publishedAt:s,attestation:o}=t.data,a={topic:r,message:i,publishedAt:s,transportType:ru.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(UV({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Or.isJsonRpcResponse(e)&&this.events.emit(fn.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Ng.inbound),this.events.emit(fn.message,e))}async acknowledgePayload(e){let t=Or.formatJsonRpcResult(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Ii.payload,this.onPayloadHandler),this.provider.off(Ii.connect,this.onConnectHandler),this.provider.off(Ii.disconnect,this.onDisconnectHandler),this.provider.off(Ii.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await z.isOnline();z.subscribeToNetworkChange(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(su.HEARTBEAT_EVENTS.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&z.isAppVisible())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(t){this.logger.warn(t,t?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(fn.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Re.toMiliseconds(uH)))))}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}};function cye(n,e){return n===e||Number.isNaN(n)&&Number.isNaN(e)}function jV(n){return Object.getOwnPropertySymbols(n).filter(e=>Object.prototype.propertyIsEnumerable.call(n,e))}function VV(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}var lye="[object RegExp]",uye="[object String]",dye="[object Number]",hye="[object Boolean]",HV="[object Arguments]",fye="[object Symbol]",pye="[object Date]",gye="[object Map]",mye="[object Set]",yye="[object Array]",wye="[object Function]",vye="[object ArrayBuffer]",ND="[object Object]",bye="[object Error]",Eye="[object DataView]",Iye="[object Uint8Array]",Cye="[object Uint8ClampedArray]",Sye="[object Uint16Array]",Aye="[object Uint32Array]",_ye="[object BigUint64Array]",Tye="[object Int8Array]",xye="[object Int16Array]",Dye="[object Int32Array]",Nye="[object BigInt64Array]",Rye="[object Float32Array]",Oye="[object Float64Array]";function Pye(){}function $V(n){if(!n||typeof n!="object")return!1;let e=Object.getPrototypeOf(n);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(n)==="[object Object]":!1}function Mye(n,e,t){return Dg(n,e,void 0,void 0,void 0,void 0,t)}function Dg(n,e,t,r,i,s,o){let a=o(n,e,t,r,i,s);if(a!==void 0)return a;if(typeof n==typeof e)switch(typeof n){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return n===e;case"number":return n===e||Object.is(n,e);case"function":return n===e;case"object":return Og(n,e,s,o)}return Og(n,e,s,o)}function Og(n,e,t,r){if(Object.is(n,e))return!0;let i=VV(n),s=VV(e);if(i===HV&&(i=ND),s===HV&&(s=ND),i!==s)return!1;switch(i){case uye:return n.toString()===e.toString();case dye:{let c=n.valueOf(),l=e.valueOf();return cye(c,l)}case hye:case pye:case fye:return Object.is(n.valueOf(),e.valueOf());case lye:return n.source===e.source&&n.flags===e.flags;case wye:return n===e}t=t??new Map;let o=t.get(n),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(n,e),t.set(e,n);try{switch(i){case gye:{if(n.size!==e.size)return!1;for(let[c,l]of n.entries())if(!e.has(c)||!Dg(l,e.get(c),c,n,e,t,r))return!1;return!0}case mye:{if(n.size!==e.size)return!1;let c=Array.from(n.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){let d=c[u],h=l.findIndex(f=>Dg(d,f,void 0,n,e,t,r));if(h===-1)return!1;l.splice(h,1)}return!0}case yye:case Iye:case Cye:case Sye:case Aye:case _ye:case Tye:case xye:case Dye:case Nye:case Rye:case Oye:{if(typeof Buffer<"u"&&Buffer.isBuffer(n)!==Buffer.isBuffer(e)||n.length!==e.length)return!1;for(let c=0;c<n.length;c++)if(!Dg(n[c],e[c],c,n,e,t,r))return!1;return!0}case vye:return n.byteLength!==e.byteLength?!1:Og(new Uint8Array(n),new Uint8Array(e),t,r);case Eye:return n.byteLength!==e.byteLength||n.byteOffset!==e.byteOffset?!1:Og(new Uint8Array(n),new Uint8Array(e),t,r);case bye:return n.name===e.name&&n.message===e.message;case ND:{if(!(Og(n.constructor,e.constructor,t,r)||$V(n)&&$V(e)))return!1;let c=[...Object.keys(n),...jV(n)],l=[...Object.keys(e),...jV(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){let d=c[u],h=n[d];if(!Object.hasOwn(e,d))return!1;let f=e[d];if(!Dg(h,f,d,n,e,t,r))return!1}return!0}default:return!1}}finally{t.delete(n),t.delete(e)}}function kye(n,e){return Mye(n,e,Pye)}var Lye=Object.defineProperty,qV=Object.getOwnPropertySymbols,Fye=Object.prototype.hasOwnProperty,Bye=Object.prototype.propertyIsEnumerable,KD=(n,e,t)=>e in n?Lye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zV=(n,e)=>{for(var t in e||(e={}))Fye.call(e,t)&&KD(n,t,e[t]);if(qV)for(var t of qV(e))Bye.call(e,t)&&KD(n,t,e[t]);return n},ei=(n,e,t)=>KD(n,typeof e!="symbol"?e+"":e,t),Ob=class extends Ls.IStore{constructor(e,t,r,i=ks,s=void 0){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,ei(this,"map",new Map),ei(this,"version",dH),ei(this,"cached",[]),ei(this,"initialized",!1),ei(this,"getKey"),ei(this,"storagePrefix",ks),ei(this,"recentlyDeleted",[]),ei(this,"recentlyDeletedLimit",200),ei(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!z.isUndefined(o)?this.map.set(this.getKey(o),o):z.isProposalStruct(o)?this.map.set(o.id,o):z.isSessionStruct(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),ei(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),ei(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),ei(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>kye(a[c],o[c]))):this.values)),ei(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});let c=zV(zV({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),ei(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Mt.generateChildLogger(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Mt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:i}=z.getInternalError("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}let{message:r}=z.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:t}=z.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},Uye=Object.defineProperty,jye=(n,e,t)=>e in n?Uye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Je=(n,e,t)=>jye(n,typeof e!="symbol"?e+"":e,t),Pb=class{constructor(e,t){this.core=e,this.logger=t,Je(this,"name",gH),Je(this,"version",mH),Je(this,"events",new rge.default),Je(this,"pairings"),Je(this,"initialized",!1),Je(this,"storagePrefix",ks),Je(this,"ignoredPayloadTypes",[z.TYPE_1]),Je(this,"registeredMethods",[]),Je(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Je(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Je(this,"create",async r=>{this.isInitialized();let i=z.generateRandomBytes32(),s=await this.core.crypto.setSymKey(i),o=z.calcExpiry(Re.FIVE_MINUTES),a={protocol:oH},c={topic:s,expiry:o,relay:a,active:!1,methods:r?.methods},l=z.formatUri({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(Ih.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:r?.transportType,internal:r?.internal}),{topic:s,uri:l}}),Je(this,"pair",async r=>{this.isInitialized();let i=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[ao.pairing_started]}});this.isValidPair(r,i);let{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:l}=z.parseUri(r.uri);i.props.properties.topic=s,i.addTrace(ao.pairing_uri_validation_success),i.addTrace(ao.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(s)){if(u=this.pairings.get(s),i.addTrace(ao.existing_pairing),u.active)throw i.setError(ta.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(ao.pairing_not_expired)}let d=c||z.calcExpiry(Re.FIVE_MINUTES),h={topic:s,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(s,d),await this.pairings.set(s,h),i.addTrace(ao.store_new_pairing),r.activatePairing&&await this.activate({topic:s}),this.events.emit(Ih.create,h),i.addTrace(ao.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(ao.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(ta.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(f){throw i.setError(ta.subscribe_pairing_topic_failure),f}return i.addTrace(ao.subscribe_pairing_topic_success),h}),Je(this,"activate",async({topic:r})=>{this.isInitialized();let i=z.calcExpiry(Re.FIVE_MINUTES);this.core.expirer.set(r,i),await this.pairings.update(r,{active:!0,expiry:i})}),Je(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:i}=r;if(this.pairings.keys.includes(i)){let s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=z.createDelayedPromise();this.events.once(z.engineEvent("pairing_ping",s),({error:l})=>{l?c(l):a()}),await o()}}),Je(this,"updateExpiry",async({topic:r,expiry:i})=>{this.isInitialized(),await this.pairings.update(r,{expiry:i})}),Je(this,"updateMetadata",async({topic:r,metadata:i})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:i})}),Je(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Je(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);let{topic:i}=r;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",z.getSdkError("USER_DISCONNECTED")),await this.deletePairing(i))}),Je(this,"formatUriFromPairing",r=>{this.isInitialized();let{topic:i,relay:s,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(i);return z.formatUri({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),Je(this,"sendRequest",async(r,i,s)=>{let o=Or.formatJsonRpcRequest(i,s),a=await this.core.crypto.encode(r,o),c=Eh[i].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Je(this,"sendResult",async(r,i,s)=>{let o=Or.formatJsonRpcResult(r,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,l=Eh[c].res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),Je(this,"sendError",async(r,i,s)=>{let o=Or.formatJsonRpcError(r,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,l=Eh[c]?Eh[c].res:Eh.unregistered_method.res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),Je(this,"deletePairing",async(r,i)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,z.getSdkError("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),i?Promise.resolve():this.core.expirer.del(r)])}),Je(this,"cleanup",async()=>{let r=this.pairings.getAll().filter(i=>z.isExpired(i.expiry));await Promise.all(r.map(i=>this.deletePairing(i.topic)))}),Je(this,"onRelayEventRequest",async r=>{let{topic:i,payload:s}=r;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),Je(this,"onRelayEventResponse",async r=>{let{topic:i,payload:s}=r,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),Je(this,"onPairingPingRequest",async(r,i)=>{let{id:s}=i;try{this.isValidPing({topic:r}),await this.sendResult(s,r,!0),this.events.emit(Ih.ping,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),Je(this,"onPairingPingResponse",(r,i)=>{let{id:s}=i;setTimeout(()=>{Or.isJsonRpcResult(i)?this.events.emit(z.engineEvent("pairing_ping",s),{}):Or.isJsonRpcError(i)&&this.events.emit(z.engineEvent("pairing_ping",s),{error:i.error})},500)}),Je(this,"onPairingDeleteRequest",async(r,i)=>{let{id:s}=i;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Ih.delete,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),Je(this,"onUnknownRpcMethodRequest",async(r,i)=>{let{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;let a=z.getSdkError("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,r,a),this.logger.error(a)}catch(a){await this.sendError(s,r,a),this.logger.error(a)}}),Je(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(z.getSdkError("WC_METHOD_UNSUPPORTED",r))}),Je(this,"isValidPair",(r,i)=>{var s;if(!z.isValidParams(r)){let{message:a}=z.getInternalError("MISSING_OR_INVALID",`pair() params: ${r}`);throw i.setError(ta.malformed_pairing_uri),new Error(a)}if(!z.isValidUrl(r.uri)){let{message:a}=z.getInternalError("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw i.setError(ta.malformed_pairing_uri),new Error(a)}let o=z.parseUri(r?.uri);if(!((s=o?.relay)!=null&&s.protocol)){let{message:a}=z.getInternalError("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(ta.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){let{message:a}=z.getInternalError("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(ta.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Re.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(ta.pairing_expired);let{message:a}=z.getInternalError("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Je(this,"isValidPing",async r=>{if(!z.isValidParams(r)){let{message:s}=z.getInternalError("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}let{topic:i}=r;await this.isValidPairingTopic(i)}),Je(this,"isValidDisconnect",async r=>{if(!z.isValidParams(r)){let{message:s}=z.getInternalError("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}let{topic:i}=r;await this.isValidPairingTopic(i)}),Je(this,"isValidPairingTopic",async r=>{if(!z.isValidString(r,!1)){let{message:i}=z.getInternalError("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.pairings.keys.includes(r)){let{message:i}=z.getInternalError("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(z.isExpired(this.pairings.get(r).expiry)){await this.deletePairing(r);let{message:i}=z.getInternalError("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}),this.core=e,this.logger=Mt.generateChildLogger(t,this.name),this.pairings=new Ob(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Mt.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(fn.message,async e=>{let{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==ru.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{let s=await this.core.crypto.decode(t,r);Or.isJsonRpcRequest(s)?(this.core.history.set(t,s),await this.onRelayEventRequest({topic:t,payload:s})):Or.isJsonRpcResponse(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id)),await this.core.relayer.messages.ack(t,r)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(Yi.expired,async e=>{let{topic:t}=z.parseExpirerTarget(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Ih.expire,{topic:t}))})}},Vye=Object.defineProperty,Hye=(n,e,t)=>e in n?Vye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$n=(n,e,t)=>Hye(n,typeof e!="symbol"?e+"":e,t),Mb=class extends Ls.IJsonRpcHistory{constructor(e,t){super(e,t),this.core=e,this.logger=t,$n(this,"records",new Map),$n(this,"events",new iu.EventEmitter),$n(this,"name",yH),$n(this,"version",wH),$n(this,"cached",[]),$n(this,"initialized",!1),$n(this,"storagePrefix",ks),$n(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),$n(this,"set",(r,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:i,chainId:s}),this.records.has(i.id))return;let o={id:i.id,topic:r,request:{method:i.method,params:i.params||null},chainId:s,expiry:z.calcExpiry(Re.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Qi.created,o)}),$n(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;let i=await this.getRecord(r.id);typeof i.response>"u"&&(i.response=Or.isJsonRpcError(r)?{error:r.error}:{result:r.result},this.records.set(i.id,i),this.persist(),this.events.emit(Qi.updated,i))}),$n(this,"get",async(r,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:i}),await this.getRecord(i))),$n(this,"delete",(r,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===r){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(Qi.deleted,s)}}),this.persist()}),$n(this,"exists",async(r,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===r:!1)),$n(this,"on",(r,i)=>{this.events.on(r,i)}),$n(this,"once",(r,i)=>{this.events.once(r,i)}),$n(this,"off",(r,i)=>{this.events.off(r,i)}),$n(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=Mt.generateChildLogger(t,this.name)}get context(){return Mt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;let r={topic:t.topic,request:Or.formatJsonRpcRequest(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:r}=z.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qi.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:t}=z.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Qi.created,e=>{let t=Qi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Qi.updated,e=>{let t=Qi.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Qi.deleted,e=>{let t=Qi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(su.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{Re.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Qi.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},$ye=Object.defineProperty,qye=(n,e,t)=>e in n?$ye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,lr=(n,e,t)=>qye(n,typeof e!="symbol"?e+"":e,t),kb=class extends Ls.IExpirer{constructor(e,t){super(e,t),this.core=e,this.logger=t,lr(this,"expirations",new Map),lr(this,"events",new iu.EventEmitter),lr(this,"name",vH),lr(this,"version",bH),lr(this,"cached",[]),lr(this,"initialized",!1),lr(this,"storagePrefix",ks),lr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),lr(this,"has",r=>{try{let i=this.formatTarget(r);return typeof this.getExpiration(i)<"u"}catch{return!1}}),lr(this,"set",(r,i)=>{this.isInitialized();let s=this.formatTarget(r),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(Yi.created,{target:s,expiration:o})}),lr(this,"get",r=>{this.isInitialized();let i=this.formatTarget(r);return this.getExpiration(i)}),lr(this,"del",r=>{if(this.isInitialized(),this.has(r)){let i=this.formatTarget(r),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(Yi.deleted,{target:i,expiration:s})}}),lr(this,"on",(r,i)=>{this.events.on(r,i)}),lr(this,"once",(r,i)=>{this.events.once(r,i)}),lr(this,"off",(r,i)=>{this.events.off(r,i)}),lr(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=Mt.generateChildLogger(t,this.name)}get context(){return Mt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return z.formatTopicTarget(e);if(typeof e=="number")return z.formatIdTarget(e);let{message:t}=z.getInternalError("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Yi.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:t}=z.getInternalError("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:r}=z.getInternalError("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return t}checkExpiry(e,t){let{expiry:r}=t;Re.toMiliseconds(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Yi.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(su.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Yi.created,e=>{let t=Yi.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Yi.expired,e=>{let t=Yi.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Yi.deleted,e=>{let t=Yi.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=z.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}},zye=Object.defineProperty,Gye=(n,e,t)=>e in n?zye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,hn=(n,e,t)=>Gye(n,typeof e!="symbol"?e+"":e,t),Lb=class extends Ls.IVerify{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,hn(this,"name",EH),hn(this,"abortController"),hn(this,"isDevEnv"),hn(this,"verifyUrlV3",CH),hn(this,"storagePrefix",ks),hn(this,"version",XD),hn(this,"publicKey"),hn(this,"fetchPromise"),hn(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Re.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),hn(this,"register",async i=>{if(!z.isBrowser()||this.isDevEnv)return;let s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{let l=tge.getDocument(),u=this.startAbortTimer(Re.ONE_SECOND*5),d=await new Promise((h,f)=>{let p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);let g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});let m=y=>{if(y.data&&typeof y.data=="string")try{let E=JSON.parse(y.data);if(E.type==="verify_attestation"){if(RD.decodeJWT(E.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),h(E.attestation===null?"":E.attestation)}}catch(E){this.logger.warn(E)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(l){this.logger.warn(l)}return""}),hn(this,"resolve",async i=>{if(this.isDevEnv)return"";let{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(RD.decodeJWT(s).payload.id!==a)return;let l=await this.isValidJwtAttestation(s);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;let c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),hn(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);let o=this.startAbortTimer(Re.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),hn(this,"getVerifyUrl",i=>{let s=i||Rg;return SH.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Rg}`),s=Rg),s}),hn(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let i=this.startAbortTimer(Re.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),hn(this,"persistPublicKey",async i=>{this.logger.debug(i,"persisting public key to local storage"),await this.store.setItem(this.storeKey,i),this.publicKey=i}),hn(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),hn(this,"isValidJwtAttestation",async i=>{let s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}let o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),hn(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),hn(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{let o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});let i=await this.fetchPromise;return this.fetchPromise=void 0,i}),hn(this,"validateAttestation",(i,s)=>{let o=z.verifyP256Jwt(i,s.publicKey),a={hasExpired:Re.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Mt.generateChildLogger(t,this.name),this.abortController=new AbortController,this.isDevEnv=z.isTestRun(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Mt.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Re.toMiliseconds(e))}},Wye=Object.defineProperty,Kye=(n,e,t)=>e in n?Wye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,GV=(n,e,t)=>Kye(n,typeof e!="symbol"?e+"":e,t),Fb=class extends Ls.IEchoClient{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,GV(this,"context",AH),GV(this,"registerDeviceToken",async r=>{let{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=r,c=`${_H}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=Mt.generateChildLogger(t,this.context)}},Qye=Object.defineProperty,WV=Object.getOwnPropertySymbols,Yye=Object.prototype.hasOwnProperty,Jye=Object.prototype.propertyIsEnumerable,QD=(n,e,t)=>e in n?Qye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xg=(n,e)=>{for(var t in e||(e={}))Yye.call(e,t)&&QD(n,t,e[t]);if(WV)for(var t of WV(e))Jye.call(e,t)&&QD(n,t,e[t]);return n},On=(n,e,t)=>QD(n,typeof e!="symbol"?e+"":e,t),Bb=class extends Ls.IEventClient{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,On(this,"context",xH),On(this,"storagePrefix",ks),On(this,"storageVersion",TH),On(this,"events",new Map),On(this,"shouldPersist",!1),On(this,"init",async()=>{if(!z.isTestRun())try{let i={eventId:z.uuidv4(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:z.formatUA(this.core.relayer.protocol,this.core.relayer.version,_b)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),On(this,"createEvent",i=>{let{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,l=z.uuidv4(),u=this.core.projectId||"",d=Date.now(),h=xg({eventId:l,timestamp:d,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),On(this,"getEvent",i=>{let{eventId:s,topic:o}=i;if(s)return this.events.get(s);let a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return xg(xg({},a),this.setMethods(a.eventId))}),On(this,"deleteEvent",i=>{let{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),On(this,"setEventListeners",()=>{this.core.heartbeat.on(su.HEARTBEAT_EVENTS.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{Re.fromMiliseconds(Date.now())-Re.fromMiliseconds(i.timestamp)>DH&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),On(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),On(this,"addTrace",(i,s)=>{let o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),On(this,"setError",(i,s)=>{let o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),On(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),On(this,"restore",async()=>{try{let i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,xg(xg({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),On(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;let i=[];for(let[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(let s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),On(this,"sendEvent",async i=>{let s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${NH}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${_b}${s}`,{method:"POST",body:JSON.stringify(i)})}),On(this,"getAppDomain",()=>z.getAppMetadata().url),this.logger=Mt.generateChildLogger(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}},Zye=Object.defineProperty,KV=Object.getOwnPropertySymbols,Xye=Object.prototype.hasOwnProperty,ewe=Object.prototype.propertyIsEnumerable,YD=(n,e,t)=>e in n?Zye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,QV=(n,e)=>{for(var t in e||(e={}))Xye.call(e,t)&&YD(n,t,e[t]);if(KV)for(var t of KV(e))ewe.call(e,t)&&YD(n,t,e[t]);return n},jt=(n,e,t)=>YD(n,typeof e!="symbol"?e+"":e,t),Ub=class n extends Ls.ICore{constructor(e){var t;super(e),jt(this,"protocol",ZD),jt(this,"version",XD),jt(this,"name",Pg),jt(this,"relayUrl"),jt(this,"projectId"),jt(this,"customStoragePrefix"),jt(this,"events",new iu.EventEmitter),jt(this,"logger"),jt(this,"heartbeat"),jt(this,"relayer"),jt(this,"crypto"),jt(this,"storage"),jt(this,"history"),jt(this,"expirer"),jt(this,"pairing"),jt(this,"verify"),jt(this,"echoClient"),jt(this,"linkModeSupportedApps"),jt(this,"eventClient"),jt(this,"initialized",!1),jt(this,"logChunkController"),jt(this,"on",(a,c)=>this.events.on(a,c)),jt(this,"once",(a,c)=>this.events.once(a,c)),jt(this,"off",(a,c)=>this.events.off(a,c)),jt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),jt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;let u={topic:a,message:c,publishedAt:Date.now(),transportType:ru.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});let r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||eN,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let i=Mt.getDefaultLoggerOptions({level:typeof e?.logger=="string"&&e.logger?e.logger:YV.logger,name:Pg}),{logger:s,chunkLoggerController:o}=Mt.generatePlatformLogger({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Mt.generateChildLogger(s,this.name),this.heartbeat=new su.HeartBeat,this.crypto=new xb(this,this.logger,e?.keychain),this.history=new Mb(this,this.logger),this.expirer=new kb(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new ige.default(QV(QV({},JV),e?.storageOptions)),this.relayer=new Rb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Pb(this,this.logger),this.verify=new Lb(this,this.logger,this.storage),this.echoClient=new Fb(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Bb(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){let t=new n(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem(hH,r),t}get context(){return Mt.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(PD,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(PD)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;let t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;let r=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&process.env.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}},twe=Ub;se.CORE_CONTEXT=Pg,se.CORE_DEFAULT=YV,se.CORE_PROTOCOL=ZD,se.CORE_STORAGE_OPTIONS=JV,se.CORE_STORAGE_PREFIX=ks,se.CORE_VERSION=XD,se.CRYPTO_CLIENT_SEED=OD,se.CRYPTO_CONTEXT=ZV,se.CRYPTO_JWT_TTL=XV,se.Core=twe,se.Crypto=xb,se.ECHO_CONTEXT=AH,se.ECHO_URL=_H,se.EVENTS_CLIENT_API_URL=NH,se.EVENTS_STORAGE_CLEANUP_INTERVAL=DH,se.EVENTS_STORAGE_CONTEXT=xH,se.EVENTS_STORAGE_VERSION=TH,se.EVENT_CLIENT_AUTHENTICATE_ERRORS=yge,se.EVENT_CLIENT_AUTHENTICATE_TRACES=mge,se.EVENT_CLIENT_CONTEXT=fge,se.EVENT_CLIENT_PAIRING_ERRORS=ta,se.EVENT_CLIENT_PAIRING_TRACES=ao,se.EVENT_CLIENT_SESSION_ERRORS=gge,se.EVENT_CLIENT_SESSION_TRACES=pge,se.EXPIRER_CONTEXT=vH,se.EXPIRER_DEFAULT_TTL=dge,se.EXPIRER_EVENTS=Yi,se.EXPIRER_STORAGE_VERSION=bH,se.EchoClient=Fb,se.EventClient=Bb,se.Expirer=kb,se.HISTORY_CONTEXT=yH,se.HISTORY_EVENTS=Qi,se.HISTORY_STORAGE_VERSION=wH,se.JsonRpcHistory=Mb,se.KEYCHAIN_CONTEXT=eH,se.KEYCHAIN_STORAGE_VERSION=tH,se.KeyChain=Tb,se.MESSAGES_CONTEXT=nH,se.MESSAGES_STORAGE_VERSION=rH,se.MESSAGE_DIRECTION=Ng,se.MessageTracker=Db,se.PAIRING_CONTEXT=gH,se.PAIRING_DEFAULT_TTL=uge,se.PAIRING_EVENTS=Ih,se.PAIRING_RPC_OPTS=Eh,se.PAIRING_STORAGE_VERSION=mH,se.PENDING_SUB_RESOLUTION_TIMEOUT=lge,se.PUBLISHER_CONTEXT=sH,se.PUBLISHER_DEFAULT_TTL=iH,se.Pairing=Pb,se.RELAYER_CONTEXT=cH,se.RELAYER_DEFAULT_LOGGER=aH,se.RELAYER_DEFAULT_PROTOCOL=oH,se.RELAYER_DEFAULT_RELAY_URL=eN,se.RELAYER_EVENTS=fn,se.RELAYER_PROVIDER_EVENTS=Ii,se.RELAYER_RECONNECT_TIMEOUT=uH,se.RELAYER_SDK_VERSION=_b,se.RELAYER_STORAGE_OPTIONS=oge,se.RELAYER_SUBSCRIBER_SUFFIX=lH,se.RELAYER_TRANSPORT_CUTOFF=age,se.Relayer=Rb,se.STORE_STORAGE_VERSION=dH,se.SUBSCRIBER_CONTEXT=fH,se.SUBSCRIBER_DEFAULT_TTL=cge,se.SUBSCRIBER_EVENTS=ti,se.SUBSCRIBER_STORAGE_VERSION=pH,se.Store=Ob,se.Subscriber=Nb,se.TRANSPORT_TYPES=ru,se.TRUSTED_VERIFY_URLS=SH,se.VERIFY_CONTEXT=EH,se.VERIFY_SERVER=Rg,se.VERIFY_SERVER_V3=CH,se.Verify=Lb,se.WALLETCONNECT_CLIENT_ID=hH,se.WALLETCONNECT_LINK_MODE_APPS=PD,se.default=Ub});var r$=Bs(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});var qH=co(),me=HH(),zH=(yx(),Fe(mx)),_=Sb(),nwe=(K0(),Fe(W0)),wt=hu(),He=(pu(),Fe(fu));function rwe(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var iwe=rwe(qH),hN="wc",fN=2,pN="client",zb=`${hN}@${fN}:${pN}:`,Vb={name:pN,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},swe={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire",session_authenticate:"session_authenticate",session_request_expire:"session_request_expire",session_connect:"session_connect"},owe={database:":memory:"},nN="WALLETCONNECT_DEEPLINK_CHOICE",awe={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},cwe="history",lwe="0.3",GH="proposal",uwe=wt.THIRTY_DAYS,rN="Proposal expired",WH="session",ou=wt.SEVEN_DAYS,KH="engine",Pn={wc_sessionPropose:{req:{ttl:wt.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:wt.ONE_DAY,prompt:!1,tag:1104},res:{ttl:wt.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:wt.ONE_DAY,prompt:!1,tag:1106},res:{ttl:wt.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:wt.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:wt.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:wt.ONE_DAY,prompt:!1,tag:1112},res:{ttl:wt.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:wt.ONE_DAY,prompt:!1,tag:1114},res:{ttl:wt.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:wt.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:wt.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:wt.FIVE_MINUTES,prompt:!1,tag:1119}}},Hb={min:wt.FIVE_MINUTES,max:wt.SEVEN_DAYS},Fs={idle:"IDLE",active:"ACTIVE"},QH={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},YH="request",JH=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],ZH="wc",dwe=1.5,XH="auth",e$="authKeys",t$="pairingTopics",n$="requests",Lg=`${ZH}@${1.5}:${XH}:`,kg=`${Lg}:PUB_KEY`,hwe=Object.defineProperty,fwe=Object.defineProperties,pwe=Object.getOwnPropertyDescriptors,$H=Object.getOwnPropertySymbols,gwe=Object.prototype.hasOwnProperty,mwe=Object.prototype.propertyIsEnumerable,iN=(n,e,t)=>e in n?hwe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,It=(n,e)=>{for(var t in e||(e={}))gwe.call(e,t)&&iN(n,t,e[t]);if($H)for(var t of $H(e))mwe.call(e,t)&&iN(n,t,e[t]);return n},ur=(n,e)=>fwe(n,pwe(e)),J=(n,e,t)=>iN(n,typeof e!="symbol"?e+"":e,t),sN=class extends zH.IEngine{constructor(e){super(e),J(this,"name",KH),J(this,"events",new iwe.default),J(this,"initialized",!1),J(this,"requestQueue",{state:Fs.idle,queue:[]}),J(this,"sessionRequestQueue",{state:Fs.idle,queue:[]}),J(this,"emittedSessionRequests",new _.LimitedSet({limit:500})),J(this,"requestQueueDelay",wt.ONE_SECOND),J(this,"expectedPairingMethodMap",new Map),J(this,"recentlyDeletedMap",new Map),J(this,"recentlyDeletedLimit",200),J(this,"relayMessageCache",[]),J(this,"pendingSessions",new Map),J(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Pn)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},wt.toMiliseconds(this.requestQueueDelay)))}),J(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let r=ur(It({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=_.mergeRequiredAndOptionalNamespaces(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};let{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r,u=i,d,h=!1;try{if(u){let D=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=D.active}}catch(D){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),D}if(!u||!h){let{topic:D,uri:B}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=D,d=B}if(!u){let{message:D}=_.getInternalError("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(D)}let f=await this.client.core.crypto.generateKeyPair(),p=Pn.wc_sessionPropose.req.ttl||wt.FIVE_MINUTES,g=_.calcExpiry(p),m=ur(It(It({requiredNamespaces:s,optionalNamespaces:o,relays:l??[{protocol:me.RELAYER_DEFAULT_PROTOCOL}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:He.payloadId()}),y=_.engineEvent("session_connect",m.id),{reject:E,resolve:I,done:L}=_.createDelayedPromise(p,rN),k=({id:D})=>{D===m.id&&(this.client.events.off("proposal_expire",k),this.pendingSessions.delete(m.id),this.events.emit(y,{error:{message:rN,code:0}}))};return this.client.events.on("proposal_expire",k),this.events.once(y,({error:D,session:B})=>{this.client.events.off("proposal_expire",k),D?E(D):B&&I(B)}),await this.sendProposeSession({proposal:m,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:m.id}}}),await this.setProposal(m.id,m),{uri:d,approval:L}}),J(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(r){throw this.client.logger.error("pair() failed"),r}}),J(this,"approve",async t=>{var r,i,s;let o=this.client.core.eventClient.createEvent({properties:{topic:(r=t?.id)==null?void 0:r.toString(),trace:[me.EVENT_CLIENT_SESSION_TRACES.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(T){throw o.setError(me.EVENT_CLIENT_SESSION_ERRORS.no_internet_connection),T}try{await this.isValidProposalId(t?.id)}catch(T){throw this.client.logger.error(`approve() -> proposal.get(${t?.id}) failed`),o.setError(me.EVENT_CLIENT_SESSION_ERRORS.proposal_not_found),T}try{await this.isValidApprove(t)}catch(T){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(me.EVENT_CLIENT_SESSION_ERRORS.session_approve_namespace_validation_failure),T}let{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=t,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});let{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:y}=f,E=(i=this.client.core.eventClient)==null?void 0:i.getEvent({topic:p});E||(E=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:me.EVENT_CLIENT_SESSION_TRACES.session_approve_started,properties:{topic:p,trace:[me.EVENT_CLIENT_SESSION_TRACES.session_approve_started,me.EVENT_CLIENT_SESSION_TRACES.session_namespaces_validation_success]}}));let I=await this.client.core.crypto.generateKeyPair(),L=g.publicKey,k=await this.client.core.crypto.generateSharedKey(I,L),D=It(It(It({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:I,metadata:this.client.metadata},expiry:_.calcExpiry(ou)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),B=me.TRANSPORT_TYPES.relay;E.addTrace(me.EVENT_CLIENT_SESSION_TRACES.subscribing_session_topic);try{await this.client.core.relayer.subscribe(k,{transportType:B,internal:{skipSubscribe:!0}})}catch(T){throw E.setError(me.EVENT_CLIENT_SESSION_ERRORS.subscribe_session_topic_failure),T}E.addTrace(me.EVENT_CLIENT_SESSION_TRACES.subscribe_session_topic_success);let U=ur(It({},D),{topic:k,requiredNamespaces:m,optionalNamespaces:y,pairingTopic:p,acknowledged:!1,self:D.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:I,transportType:me.TRANSPORT_TYPES.relay});await this.client.session.set(k,U),E.addTrace(me.EVENT_CLIENT_SESSION_TRACES.store_session);try{await this.sendApproveSession({sessionTopic:k,proposal:f,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:I},sessionSettleRequest:D,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),E.addTrace(me.EVENT_CLIENT_SESSION_TRACES.session_approve_publish_success)}catch(T){throw this.client.logger.error(T),this.client.session.delete(k,_.getSdkError("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(k),T}return this.client.core.eventClient.deleteEvent({eventId:E.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(k,_.calcExpiry(ou)),{topic:k,acknowledged:()=>Promise.resolve(this.client.session.get(k))}}),J(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}let{id:r,reason:i}=t,s;try{s=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}s&&await this.sendError({id:r,topic:s,error:i,rpcOpts:Pn.wc_sessionPropose.reject}),await this.deleteProposal(r)}),J(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}let{topic:r,namespaces:i}=t,{done:s,resolve:o,reject:a}=_.createDelayedPromise(),c=He.payloadId(),l=He.getBigIntRpcId().toString(),u=this.client.session.get(r).namespaces;return this.events.once(_.engineEvent("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:i}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:s}}),J(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}let{topic:r}=t,i=He.payloadId(),{done:s,resolve:o,reject:a}=_.createDelayedPromise();return this.events.once(_.engineEvent("session_extend",i),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,_.calcExpiry(ou)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:s}}),J(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}let{chainId:r,request:i,topic:s,expiry:o=Pn.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(s);a?.transportType===me.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let c=He.payloadId(),l=He.getBigIntRpcId().toString(),{done:u,resolve:d,reject:h}=_.createDelayedPromise(o,"Request expired. Please try again.");this.events.once(_.engineEvent("session_request",c),({error:m,result:y})=>{m?h(m):d(y)});let f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:f,params:{request:ur(It({},i),{expiryTimestamp:_.calcExpiry(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>h(m)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:r,id:c}),await u();let g={request:ur(It({},i),{expiryTimestamp:_.calcExpiry(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:f,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(y=>h(y)),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:r,id:c}),m()}),new Promise(async m=>{var y;if(!((y=a.sessionConfig)!=null&&y.disableDeepLink)){let E=await _.getDeepLink(this.client.core.storage,nN);await _.handleDeeplinkRedirect({id:c,topic:s,wcDeepLink:E})}m()}),u()]).then(m=>m[2])}),J(this,"respond",async t=>{var r,i;this.isInitialized();let s=this.client.core.eventClient.createEvent({properties:{topic:t?.topic||((i=(r=t?.response)==null?void 0:r.id)==null?void 0:i.toString()),trace:[me.EVENT_CLIENT_SESSION_TRACES.session_request_response_started]}});try{await this.isValidRespond(t)}catch(d){throw s.addTrace(d?.message),s.setError(me.EVENT_CLIENT_SESSION_ERRORS.session_request_response_validation_failure),d}s.addTrace(me.EVENT_CLIENT_SESSION_TRACES.session_request_response_validation_success);let{topic:o,response:a}=t,{id:c}=a,l=this.client.session.get(o);l.transportType===me.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{s.addTrace(me.EVENT_CLIENT_SESSION_TRACES.session_request_response_publish_started),He.isJsonRpcResult(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):He.isJsonRpcError(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(t)}catch(d){throw s.addTrace(d?.message),s.setError(me.EVENT_CLIENT_SESSION_ERRORS.session_request_response_publish_failure),d}}),J(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}let{topic:r}=t;if(this.client.session.keys.includes(r)){let i=He.payloadId(),s=He.getBigIntRpcId().toString(),{done:o,resolve:a,reject:c}=_.createDelayedPromise();this.events.once(_.engineEvent("session_ping",i),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),J(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);let{topic:r,event:i,chainId:s}=t,o=He.getBigIntRpcId().toString(),a=He.payloadId();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:i,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),J(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);let{topic:r}=t;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:_.getSdkError("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{let{message:i}=_.getInternalError("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(i)}}),J(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(r=>_.isSessionCompatible(r,t)))),J(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),J(this,"authenticate",async(t,r)=>{var i;this.isInitialized(),this.isValidAuthenticate(t);let s=r&&this.client.core.linkModeSupportedApps.includes(r)&&((i=this.client.metadata.redirect)==null?void 0:i.linkMode),o=s?me.TRANSPORT_TYPES.link_mode:me.TRANSPORT_TYPES.relay;o===me.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:f,nbf:p,methods:g=[],expiry:m}=t,y=[...t.resources||[]],{topic:E,uri:I}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:E,uri:I}});let L=await this.client.core.crypto.generateKeyPair(),k=_.hashKey(L);if(await Promise.all([this.client.auth.authKeys.set(kg,{responseTopic:k,publicKey:L}),this.client.auth.pairingTopics.set(k,{topic:k,pairingTopic:E})]),await this.client.core.relayer.subscribe(k,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${E}`),g.length>0){let{namespace:S}=_.parseChainId(a[0]),P=_.createEncodedRecap(S,"request",g);_.getRecapFromResources(y)&&(P=_.mergeEncodedRecaps(P,y.pop())),y.push(P)}let D=m&&m>Pn.wc_sessionAuthenticate.req.ttl?m:Pn.wc_sessionAuthenticate.req.ttl,B={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:y},requester:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:_.calcExpiry(D)},U={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},T={requiredNamespaces:{},optionalNamespaces:U,relays:[{protocol:"irn"}],pairingTopic:E,proposer:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:_.calcExpiry(Pn.wc_sessionPropose.req.ttl),id:He.payloadId()},{done:$,resolve:W,reject:M}=_.createDelayedPromise(D,"Request expired"),v=He.payloadId(),b=_.engineEvent("session_connect",T.id),w=_.engineEvent("session_request",v),C=async({error:S,session:P})=>{this.events.off(w,N),S?M(S):P&&W({session:P})},N=async S=>{var P,V,j;if(await this.deletePendingAuthRequest(v,{message:"fulfilled",code:0}),S.error){let re=_.getSdkError("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return S.error.code===re.code?void 0:(this.events.off(b,C),M(S.error.message))}await this.deleteProposal(T.id),this.events.off(b,C);let{cacaos:oe,responder:ee}=S.result,Q=[],ae=[];for(let re of oe){await _.validateSignedCacao({cacao:re,projectId:this.client.core.projectId})||(this.client.logger.error(re,"Signature verification failed"),M(_.getSdkError("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:Ce}=re,kt=_.getRecapFromResources(Ce.resources),St=[_.getNamespacedDidChainId(Ce.iss)],Wt=_.getDidAddress(Ce.iss);if(kt){let En=_.getMethodsFromRecap(kt),uu=_.getChainsFromRecap(kt);Q.push(...En),St.push(...uu)}for(let En of St)ae.push(`${En}:${Wt}`)}let te=await this.client.core.crypto.generateSharedKey(L,ee.publicKey),be;Q.length>0&&(be={topic:te,acknowledged:!0,self:{publicKey:L,metadata:this.client.metadata},peer:ee,controller:ee.publicKey,expiry:_.calcExpiry(ou),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:E,namespaces:_.buildNamespacesFromAuth([...new Set(Q)],[...new Set(ae)]),transportType:o},await this.client.core.relayer.subscribe(te,{transportType:o}),await this.client.session.set(te,be),E&&await this.client.core.pairing.updateMetadata({topic:E,metadata:ee.metadata}),be=this.client.session.get(te)),(P=this.client.metadata.redirect)!=null&&P.linkMode&&(V=ee.metadata.redirect)!=null&&V.linkMode&&(j=ee.metadata.redirect)!=null&&j.universal&&r&&(this.client.core.addLinkModeSupportedApp(ee.metadata.redirect.universal),this.client.session.update(te,{transportType:me.TRANSPORT_TYPES.link_mode})),W({auths:oe,session:be})};this.events.once(b,C),this.events.once(w,N);let F;try{if(s){let S=He.formatJsonRpcRequest("wc_sessionAuthenticate",B,v);this.client.core.history.set(E,S);let P=await this.client.core.crypto.encode("",S,{type:_.TYPE_2,encoding:_.BASE64URL});F=_.getLinkModeURL(r,E,P)}else await Promise.all([this.sendRequest({topic:E,method:"wc_sessionAuthenticate",params:B,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:v}),this.sendRequest({topic:E,method:"wc_sessionPropose",params:T,expiry:Pn.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:T.id})])}catch(S){throw this.events.off(b,C),this.events.off(w,N),S}return await this.setProposal(T.id,T),await this.setAuthRequest(v,{request:ur(It({},B),{verifyContext:{}}),pairingTopic:E,transportType:o}),{uri:F??I,response:$}}),J(this,"approveSessionAuthenticate",async t=>{let{id:r,auths:i}=t,s=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[me.EVENT_CLIENT_AUTHENTICATE_TRACES.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw s.setError(me.EVENT_CLIENT_AUTHENTICATE_ERRORS.no_internet_connection),m}let o=this.getPendingAuthRequest(r);if(!o)throw s.setError(me.EVENT_CLIENT_AUTHENTICATE_ERRORS.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);let a=o.transportType||me.TRANSPORT_TYPES.relay;a===me.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=_.hashKey(c),d={type:_.TYPE_1,receiverPublicKey:c,senderPublicKey:l},h=[],f=[];for(let m of i){if(!await _.validateSignedCacao({cacao:m,projectId:this.client.core.projectId})){s.setError(me.EVENT_CLIENT_AUTHENTICATE_ERRORS.invalid_cacao);let k=_.getSdkError("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:k,encodeOpts:d}),new Error(k.message)}s.addTrace(me.EVENT_CLIENT_AUTHENTICATE_TRACES.cacaos_verified);let{p:y}=m,E=_.getRecapFromResources(y.resources),I=[_.getNamespacedDidChainId(y.iss)],L=_.getDidAddress(y.iss);if(E){let k=_.getMethodsFromRecap(E),D=_.getChainsFromRecap(E);h.push(...k),I.push(...D)}for(let k of I)f.push(`${k}:${L}`)}let p=await this.client.core.crypto.generateSharedKey(l,c);s.addTrace(me.EVENT_CLIENT_AUTHENTICATE_TRACES.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:_.calcExpiry(ou),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:_.buildNamespacesFromAuth([...new Set(h)],[...new Set(f)]),transportType:a},s.addTrace(me.EVENT_CLIENT_AUTHENTICATE_TRACES.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw s.setError(me.EVENT_CLIENT_AUTHENTICATE_ERRORS.subscribe_authenticated_session_topic_failure),m}s.addTrace(me.EVENT_CLIENT_AUTHENTICATE_TRACES.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),s.addTrace(me.EVENT_CLIENT_AUTHENTICATE_TRACES.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(me.EVENT_CLIENT_AUTHENTICATE_TRACES.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:i,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw s.setError(me.EVENT_CLIENT_AUTHENTICATE_ERRORS.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:g}}),J(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();let{id:r,reason:i}=t,s=this.getPendingAuthRequest(r);if(!s)throw new Error(`Could not find pending auth request with id ${r}`);s.transportType===me.TRANSPORT_TYPES.relay&&await this.confirmOnlineStateOrThrow();let o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=_.hashKey(o),l={type:_.TYPE_1,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:i,encodeOpts:l,rpcOpts:Pn.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),J(this,"formatAuthMessage",t=>{this.isInitialized();let{request:r,iss:i}=t;return _.formatMessage(r,i)}),J(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{let t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),J(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{let r=this.client.core.pairing.pairings.get(t.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&s.topic&&s.topic!==r.topic});if(i.length===0)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),J(this,"deleteSession",async t=>{var r;let{topic:i,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,_.getSdkError("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i),this.client.core.storage.removeItem(nN).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===i&&this.deletePendingSessionRequest(l.id,_.getSdkError("USER_DISCONNECTED"))}),i===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=Fs.idle),o&&this.client.events.emit("session_delete",{id:a,topic:i})}),J(this,"deleteProposal",async(t,r)=>{if(r)try{let i=this.client.proposal.get(t);this.client.core.eventClient.getEvent({topic:i.pairingTopic})?.setError(me.EVENT_CLIENT_SESSION_ERRORS.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,_.getSdkError("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),J(this,"deletePendingSessionRequest",async(t,r,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,r),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==t),i&&(this.sessionRequestQueue.state=Fs.idle,this.client.events.emit("session_request_expire",{id:t}))}),J(this,"deletePendingAuthRequest",async(t,r,i=!1)=>{await Promise.all([this.client.auth.requests.delete(t,r),i?Promise.resolve():this.client.core.expirer.del(t)])}),J(this,"setExpiry",async(t,r)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,r),await this.client.session.update(t,{expiry:r}))}),J(this,"setProposal",async(t,r)=>{this.client.core.expirer.set(t,_.calcExpiry(Pn.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,r)}),J(this,"setAuthRequest",async(t,r)=>{let{request:i,pairingTopic:s,transportType:o=me.TRANSPORT_TYPES.relay}=r;this.client.core.expirer.set(t,i.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:t,pairingTopic:s,verifyContext:i.verifyContext,transportType:o})}),J(this,"setPendingSessionRequest",async t=>{let{id:r,topic:i,params:s,verifyContext:o}=t,a=s.request.expiryTimestamp||_.calcExpiry(Pn.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:i,params:s,verifyContext:o})}),J(this,"sendRequest",async t=>{let{topic:r,method:i,params:s,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:h={}}=t,f=He.formatJsonRpcRequest(i,s,c),p,g=!!u;try{let E=g?_.BASE64URL:_.BASE64;p=await this.client.core.crypto.encode(r,f,{encoding:E})}catch(E){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),E}let m;if(JH.includes(i)){let E=_.hashMessage(JSON.stringify(f)),I=_.hashMessage(p);m=await this.client.core.verify.register({id:I,decryptedId:E})}let y=It(It({},Pn[i].req),h);if(y.attestation=m,o&&(y.ttl=o),a&&(y.id=a),this.client.core.history.set(r,f),g){let E=_.getLinkModeURL(u,r,p);await global.Linking.openURL(E,this.client.name)}else y.tvf=ur(It({},d),{correlationId:f.id}),l?(y.internal=ur(It({},y.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,y)):this.client.core.relayer.publish(r,p,y).catch(E=>this.client.logger.error(E));return f.id}),J(this,"sendProposeSession",async t=>{let{proposal:r,publishOpts:i}=t,s=He.formatJsonRpcRequest("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,s);let o=await this.client.core.crypto.encode(r.pairingTopic,s,{encoding:_.BASE64}),a=_.hashMessage(JSON.stringify(s)),c=_.hashMessage(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:ur(It({},i),{publishMethod:"wc_proposeSession",attestation:l})})}),J(this,"sendApproveSession",async t=>{let{sessionTopic:r,pairingProposalResponse:i,proposal:s,sessionSettleRequest:o,publishOpts:a}=t,c=He.formatJsonRpcResult(s.id,i),l=await this.client.core.crypto.encode(s.pairingTopic,c,{encoding:_.BASE64}),u=He.formatJsonRpcRequest("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(r,u,{encoding:_.BASE64});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:s.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:ur(It({},a),{publishMethod:"wc_approveSession"})})}),J(this,"sendResult",async t=>{let{id:r,topic:i,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=He.formatJsonRpcResult(r,s),u,d=c&&typeof(global==null?void 0:global.Linking)<"u";try{let p=d?_.BASE64URL:_.BASE64;u=await this.client.core.crypto.encode(i,l,ur(It({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),p}let h,f;try{h=await this.client.core.history.get(i,r);let p=h.request;try{f=this.getTVFParams(r,p.params,s)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${r}) failed`),p}if(d){let p=_.getLinkModeURL(c,i,u);await global.Linking.openURL(p,this.client.name)}else{let p=h.request.method,g=Pn[p].res;g.tvf=ur(It({},f),{correlationId:r}),o?(g.internal=ur(It({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,u,g)):this.client.core.relayer.publish(i,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),J(this,"sendError",async t=>{let{id:r,topic:i,error:s,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=He.formatJsonRpcError(r,s),u,d=c&&typeof(global==null?void 0:global.Linking)<"u";try{let f=d?_.BASE64URL:_.BASE64;u=await this.client.core.crypto.encode(i,l,ur(It({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),f}let h;try{h=await this.client.core.history.get(i,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${i}, ${r}) failed`),f}if(d){let f=_.getLinkModeURL(c,i,u);await global.Linking.openURL(f,this.client.name)}else{let f=h.request.method,p=a||Pn[f].res;this.client.core.relayer.publish(i,u,p)}await this.client.core.history.resolve(l)}),J(this,"cleanup",async()=>{let t=[],r=[];this.client.session.getAll().forEach(i=>{let s=!1;_.isExpired(i.expiry)&&(s=!0),this.client.core.crypto.keychain.has(i.topic)||(s=!0),s&&t.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{_.isExpired(i.expiryTimestamp)&&r.push(i.id)}),await Promise.all([...t.map(i=>this.deleteSession({topic:i})),...r.map(i=>this.deleteProposal(i))])}),J(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),J(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),J(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Fs.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Fs.active;let t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=Fs.idle}),J(this,"processRequest",async t=>{let{topic:r,payload:i,attestation:s,transportType:o,encryptedId:a}=t,c=i.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:i,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,i);case"wc_sessionPing":return await this.onSessionPingRequest(r,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:i,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:i,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),J(this,"onRelayEventResponse",async t=>{let{topic:r,payload:i,transportType:s}=t,o=(await this.client.core.history.get(r,i.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(r,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,i);case"wc_sessionExtend":return this.onSessionExtendResponse(r,i);case"wc_sessionPing":return this.onSessionPingResponse(r,i);case"wc_sessionRequest":return this.onSessionRequestResponse(r,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,i);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),J(this,"onRelayEventUnknownPayload",t=>{let{topic:r}=t,{message:i}=_.getInternalError("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)}),J(this,"shouldIgnorePairingRequest",t=>{let{topic:r,requestMethod:i}=t,s=this.expectedPairingMethodMap.get(r);return!s||s.includes(i)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),J(this,"onSessionProposeRequest",async t=>{let{topic:r,payload:i,attestation:s,encryptedId:o}=t,{params:a,id:c}=i;try{let l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(me.EVENT_CLIENT_PAIRING_ERRORS.proposal_listener_not_found)),this.isValidConnect(It({},i.params));let u=a.expiryTimestamp||_.calcExpiry(Pn.wc_sessionPropose.req.ttl),d=It({id:c,pairingTopic:r,expiryTimestamp:u,attestation:s,encryptedId:o},a);await this.setProposal(c,d);let h=await this.getVerifyContext({attestationId:s,hash:_.hashMessage(JSON.stringify(i)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(me.EVENT_CLIENT_PAIRING_TRACES.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Pn.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),J(this,"onSessionProposeResponse",async(t,r,i)=>{let{id:s}=r;if(He.isJsonRpcResult(r)){let{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});let a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});let c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});let l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});let u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(s,{sessionTopic:u,pairingTopic:t,proposalId:s,publicKey:c});let d=await this.client.core.relayer.subscribe(u,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:t})}else if(He.isJsonRpcError(r)){await this.deleteProposal(s);let o=_.engineEvent("session_connect",s);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),J(this,"onSessionSettleRequest",async(t,r)=>{let{id:i,params:s}=r;try{this.isValidSessionSettleRequest(s);let{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===t);if(!f)return this.client.logger.error(`Pending session not found for topic ${t}`);let p=this.client.proposal.get(f.proposalId),g=ur(It(It(It({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:me.TRANSPORT_TYPES.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(_.engineEvent("session_connect",f.proposalId),{session:g}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:t,result:!0})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),J(this,"onSessionSettleResponse",async(t,r)=>{let{id:i}=r;He.isJsonRpcResult(r)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(_.engineEvent("session_approve",i),{})):He.isJsonRpcError(r)&&(await this.client.session.delete(t,_.getSdkError("USER_DISCONNECTED")),this.events.emit(_.engineEvent("session_approve",i),{error:r.error}))}),J(this,"onSessionUpdateRequest",async(t,r)=>{let{params:i,id:s}=r;try{let o=`${t}_session_update`,a=_.MemoryStore.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:t,error:_.getSdkError("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(It({topic:t},i));try{_.MemoryStore.set(o,s),await this.client.session.update(t,{namespaces:i.namespaces}),await this.sendResult({id:s,topic:t,result:!0})}catch(c){throw _.MemoryStore.delete(o),c}this.client.events.emit("session_update",{id:s,topic:t,params:i})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),J(this,"isRequestOutOfSync",(t,r)=>r.toString().slice(0,-3)<t.toString().slice(0,-3)),J(this,"onSessionUpdateResponse",(t,r)=>{let{id:i}=r,s=_.engineEvent("session_update",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);He.isJsonRpcResult(r)?this.events.emit(_.engineEvent("session_update",i),{}):He.isJsonRpcError(r)&&this.events.emit(_.engineEvent("session_update",i),{error:r.error})}),J(this,"onSessionExtendRequest",async(t,r)=>{let{id:i}=r;try{this.isValidExtend({topic:t}),await this.setExpiry(t,_.calcExpiry(ou)),await this.sendResult({id:i,topic:t,result:!0}),this.client.events.emit("session_extend",{id:i,topic:t})}catch(s){await this.sendError({id:i,topic:t,error:s}),this.client.logger.error(s)}}),J(this,"onSessionExtendResponse",(t,r)=>{let{id:i}=r,s=_.engineEvent("session_extend",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);He.isJsonRpcResult(r)?this.events.emit(_.engineEvent("session_extend",i),{}):He.isJsonRpcError(r)&&this.events.emit(_.engineEvent("session_extend",i),{error:r.error})}),J(this,"onSessionPingRequest",async(t,r)=>{let{id:i}=r;try{this.isValidPing({topic:t}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:t})}catch(s){await this.sendError({id:i,topic:t,error:s}),this.client.logger.error(s)}}),J(this,"onSessionPingResponse",(t,r)=>{let{id:i}=r,s=_.engineEvent("session_ping",i);setTimeout(()=>{if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners 2176`);He.isJsonRpcResult(r)?this.events.emit(_.engineEvent("session_ping",i),{}):He.isJsonRpcError(r)&&this.events.emit(_.engineEvent("session_ping",i),{error:r.error})},500)}),J(this,"onSessionDeleteRequest",async(t,r)=>{let{id:i}=r;try{this.isValidDisconnect({topic:t,reason:r.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(me.RELAYER_EVENTS.publish,async()=>{s(await this.deleteSession({topic:t,id:i}))})}),this.sendResult({id:i,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:_.getSdkError("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}}),J(this,"onSessionRequest",async t=>{var r,i,s;let{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:d,params:h}=a;try{await this.isValidRequest(It({topic:o},h));let f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:_.hashMessage(JSON.stringify(He.formatJsonRpcRequest("wc_sessionRequest",h,d))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),u===me.TRANSPORT_TYPES.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((i=f.peer.metadata.redirect)==null?void 0:i.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),J(this,"onSessionRequestResponse",(t,r)=>{let{id:i}=r,s=_.engineEvent("session_request",i);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);He.isJsonRpcResult(r)?this.events.emit(_.engineEvent("session_request",i),{result:r.result}):He.isJsonRpcError(r)&&this.events.emit(_.engineEvent("session_request",i),{error:r.error})}),J(this,"onSessionEventRequest",async(t,r)=>{let{id:i,params:s}=r;try{let o=`${t}_session_event_${s.event.name}`,a=_.MemoryStore.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.info(`Discarding out of sync request - ${i}`);return}this.isValidEmit(It({topic:t},s)),this.client.events.emit("session_event",{id:i,topic:t,params:s}),_.MemoryStore.set(o,i)}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),J(this,"onSessionAuthenticateResponse",(t,r)=>{let{id:i}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:r}),He.isJsonRpcResult(r)?this.events.emit(_.engineEvent("session_request",i),{result:r.result}):He.isJsonRpcError(r)&&this.events.emit(_.engineEvent("session_request",i),{error:r.error})}),J(this,"onSessionAuthenticateRequest",async t=>{var r;let{topic:i,payload:s,attestation:o,encryptedId:a,transportType:c}=t;try{let{requester:l,authPayload:u,expiryTimestamp:d}=s.params,h=await this.getVerifyContext({attestationId:o,hash:_.hashMessage(JSON.stringify(s)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:i,id:s.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(s.id,{request:f,pairingTopic:i,transportType:c}),c===me.TRANSPORT_TYPES.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:s.params,id:s.id,verifyContext:h})}catch(l){this.client.logger.error(l);let u=s.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(s.params.requester.metadata,c),f={type:_.TYPE_1,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:s.id,topic:i,error:l,encodeOpts:f,rpcOpts:Pn.wc_sessionAuthenticate.autoReject,appLink:h})}}),J(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),J(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Fs.idle,this.processSessionRequestQueue()},wt.toMiliseconds(this.requestQueueDelay))}),J(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:r})=>{let i=this.client.core.history.pending;i.length>0&&i.filter(s=>s.topic===t&&s.request.method==="wc_sessionRequest").forEach(s=>{let o=s.request.id,a=_.engineEvent("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(_.engineEvent("session_request",s.request.id),{error:r})})}),J(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Fs.active){this.client.logger.info("session request queue is already active.");return}let t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(t)}catch(r){this.client.logger.error(r)}}),J(this,"emitSessionRequest",t=>{if(this.emittedSessionRequests.has(t.id)){this.client.logger.warn({id:t.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${t.id}`);return}this.sessionRequestQueue.state=Fs.active,this.emittedSessionRequests.add(t.id),this.client.events.emit("session_request",t)}),J(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;let r=this.client.proposal.getAll().find(i=>i.pairingTopic===t.topic);r&&this.onSessionProposeRequest({topic:t.topic,payload:He.formatJsonRpcRequest("wc_sessionPropose",ur(It({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),J(this,"isValidConnect",async t=>{if(!_.isValidParams(t)){let{message:l}=_.getInternalError("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:o,scopedProperties:a,relays:c}=t;if(_.isUndefined(r)||await this.isValidPairingTopic(r),!_.isValidRelays(c,!0)){let{message:l}=_.getInternalError("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(i&&!_.isUndefined(i)&&_.isValidObject(i)!==0){let l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(i,"requiredNamespaces")}if(s&&!_.isUndefined(s)&&_.isValidObject(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),o&&!_.isUndefined(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!_.isUndefined(a)){this.validateSessionProps(a,"scopedProperties");let l=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),J(this,"validateNamespaces",(t,r)=>{let i=_.isValidRequiredNamespaces(t,"connect()",r);if(i)throw new Error(i.message)}),J(this,"isValidApprove",async t=>{if(!_.isValidParams(t))throw new Error(_.getInternalError("MISSING_OR_INVALID",`approve() params: ${t}`).message);let{id:r,namespaces:i,relayProtocol:s,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);let c=this.client.proposal.get(r),l=_.isValidNamespaces(i,"approve()");if(l)throw new Error(l.message);let u=_.isConformingNamespaces(c.requiredNamespaces,i,"approve()");if(u)throw new Error(u.message);if(!_.isValidString(s,!0)){let{message:d}=_.getInternalError("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(d)}if(o&&!_.isUndefined(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!_.isUndefined(a)){this.validateSessionProps(a,"scopedProperties");let d=new Set(Object.keys(i));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),J(this,"isValidReject",async t=>{if(!_.isValidParams(t)){let{message:s}=_.getInternalError("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(s)}let{id:r,reason:i}=t;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!_.isValidErrorReason(i)){let{message:s}=_.getInternalError("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}}),J(this,"isValidSessionSettleRequest",t=>{if(!_.isValidParams(t)){let{message:l}=_.getInternalError("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}let{relay:r,controller:i,namespaces:s,expiry:o}=t;if(!_.isValidRelay(r)){let{message:l}=_.getInternalError("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}let a=_.isValidController(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);let c=_.isValidNamespaces(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(_.isExpired(o)){let{message:l}=_.getInternalError("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),J(this,"isValidUpdate",async t=>{if(!_.isValidParams(t)){let{message:c}=_.getInternalError("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}let{topic:r,namespaces:i}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let s=this.client.session.get(r),o=_.isValidNamespaces(i,"update()");if(o)throw new Error(o.message);let a=_.isConformingNamespaces(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)}),J(this,"isValidExtend",async t=>{if(!_.isValidParams(t)){let{message:i}=_.getInternalError("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(i)}let{topic:r}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),J(this,"isValidRequest",async t=>{if(!_.isValidParams(t)){let{message:c}=_.getInternalError("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}let{topic:r,request:i,chainId:s,expiry:o}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:a}=this.client.session.get(r);if(!_.isValidNamespacesChainId(a,s)){let{message:c}=_.getInternalError("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!_.isValidRequest(i)){let{message:c}=_.getInternalError("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(c)}if(!_.isValidNamespacesRequest(a,s,i.method)){let{message:c}=_.getInternalError("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(c)}if(o&&!_.isValidRequestExpiry(o,Hb)){let{message:c}=_.getInternalError("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Hb.min} and ${Hb.max}`);throw new Error(c)}}),J(this,"isValidRespond",async t=>{var r;if(!_.isValidParams(t)){let{message:a}=_.getInternalError("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(a)}let{topic:i,response:s}=t;try{await this.isValidSessionTopic(i)}catch(a){throw(r=t?.response)!=null&&r.id&&this.cleanupAfterResponse(t),a}if(!_.isValidResponse(s)){let{message:a}=_.getInternalError("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}let o=this.client.pendingRequest.get(s.id);if(o.topic!==i){let{message:a}=_.getInternalError("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${s.id}, expected topic: ${o.topic}, received topic: ${i}`);throw new Error(a)}}),J(this,"isValidPing",async t=>{if(!_.isValidParams(t)){let{message:i}=_.getInternalError("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(i)}let{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),J(this,"isValidEmit",async t=>{if(!_.isValidParams(t)){let{message:a}=_.getInternalError("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}let{topic:r,event:i,chainId:s}=t;await this.isValidSessionTopic(r);let{namespaces:o}=this.client.session.get(r);if(!_.isValidNamespacesChainId(o,s)){let{message:a}=_.getInternalError("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!_.isValidEvent(i)){let{message:a}=_.getInternalError("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!_.isValidNamespacesEvent(o,s,i.name)){let{message:a}=_.getInternalError("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}}),J(this,"isValidDisconnect",async t=>{if(!_.isValidParams(t)){let{message:i}=_.getInternalError("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(i)}let{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),J(this,"isValidAuthenticate",t=>{let{chains:r,uri:i,domain:s,nonce:o}=t;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!_.isValidString(i,!1))throw new Error("uri is required parameter");if(!_.isValidString(s,!1))throw new Error("domain is required parameter");if(!_.isValidString(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>_.parseChainId(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:a}=_.parseChainId(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),J(this,"getVerifyContext",async t=>{let{attestationId:r,hash:i,encryptedId:s,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||me.VERIFY_SERVER,validation:"UNKNOWN",origin:o.url||""}};try{if(a===me.TRANSPORT_TYPES.link_mode){let u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}let l=await this.client.core.verify.resolve({attestationId:r,hash:i,encryptedId:s,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),J(this,"validateSessionProps",(t,r)=>{Object.values(t).forEach((i,s)=>{if(i==null){let{message:o}=_.getInternalError("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${i} for key ${Object.keys(t)[s]}`);throw new Error(o)}})}),J(this,"getPendingAuthRequest",t=>{let r=this.client.auth.requests.get(t);return typeof r=="object"?r:void 0}),J(this,"addToRecentlyDeleted",(t,r)=>{if(this.recentlyDeletedMap.set(t,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0,s=this.recentlyDeletedLimit/2;for(let o of this.recentlyDeletedMap.keys()){if(i++>=s)break;this.recentlyDeletedMap.delete(o)}}}),J(this,"checkRecentlyDeleted",t=>{let r=this.recentlyDeletedMap.get(t);if(r){let{message:i}=_.getInternalError("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${t}`);throw new Error(i)}}),J(this,"isLinkModeEnabled",(t,r)=>{var i,s,o,a,c,l,u,d,h;return!t||r!==me.TRANSPORT_TYPES.link_mode?!1:((s=(i=this.client.metadata)==null?void 0:i.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t?.redirect)==null?void 0:u.universal)!==void 0&&((d=t?.redirect)==null?void 0:d.universal)!==""&&((h=t?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),J(this,"getAppLinkIfEnabled",(t,r)=>{var i;return this.isLinkModeEnabled(t,r)?(i=t?.redirect)==null?void 0:i.universal:void 0}),J(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;let r=_.getSearchParamFromURL(t,"topic")||"",i=decodeURIComponent(_.getSearchParamFromURL(t,"wc_ev")||""),s=this.client.session.keys.includes(r);s&&this.client.session.update(r,{transportType:me.TRANSPORT_TYPES.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:i,sessionExists:s})}),J(this,"registerLinkModeListeners",async()=>{var t;if(_.isTestRun()||_.isReactNative()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){let r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);let i=await r.getInitialURL();i&&setTimeout(()=>{this.handleLinkModeMessage({url:i})},50)}}}),J(this,"getTVFParams",(t,r,i)=>{var s,o,a;if(!((s=r.request)!=null&&s.method))return{};let c={correlationId:t,rpcMethods:[r.request.method],chainId:r.chainId};try{let l=this.extractTxHashesFromResult(r.request,i);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),J(this,"isValidContractData",t=>{var r;if(!t)return!1;try{let i=t?.data||((r=t?.[0])==null?void 0:r.data);if(!i.startsWith("0x"))return!1;let s=i.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),J(this,"extractTxHashesFromResult",(t,r)=>{var i;try{if(!r)return[];let s=t.method,o=QH[s];if(s==="sui_signTransaction")return[_.getSuiDigest(r.transactionBytes)];if(s==="near_signTransaction")return[_.getNearTransactionIdFromSignedTransaction(r)];if(s==="near_signTransactions")return r.map(c=>_.getNearTransactionIdFromSignedTransaction(c));if(s==="xrpl_signTransactionFor"||s==="xrpl_signTransaction")return[(i=r.tx_json)==null?void 0:i.hash];if(s==="polkadot_signTransaction")return[_.buildSignedExtrinsicHash({transaction:t.params.transactionPayload,signature:r.signature})];if(s==="algo_signTxn")return _.isValidArray(r)?r.map(c=>_.getAlgorandTransactionId(c)):[_.getAlgorandTransactionId(r)];if(s==="cosmos_signDirect")return[_.getSignDirectHash(r)];if(s==="wallet_sendCalls")return _.getWalletSendCallsHashes(r);if(typeof r=="string")return[r];let a=r[o.key];if(_.isValidArray(a))return s==="solana_signAllTransactions"?a.map(c=>_.extractSolanaTransactionId(c)):a;if(typeof a=="string")return[a]}catch(s){this.client.logger.warn(s,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[r,i]of Object.entries(t))for(let s of i)try{await this.onProviderMessageEvent({topic:r,message:s,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${s}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){let{message:e}=_.getInternalError("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(me.RELAYER_EVENTS.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(kg)?this.client.auth.authKeys.get(kg):{responseTopic:void 0,publicKey:void 0};try{let a=await this.client.core.crypto.decode(t,r,{receiverPublicKey:o,encoding:s===me.TRANSPORT_TYPES.link_mode?_.BASE64URL:_.BASE64});He.isJsonRpcRequest(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:i,transportType:s,encryptedId:_.hashMessage(r)})):He.isJsonRpcResponse(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:s}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:s}),await this.client.core.relayer.messages.ack(t,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(me.EXPIRER_EVENTS.expired,async e=>{let{topic:t,id:r}=_.parseExpirerTarget(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,_.getInternalError("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,_.getInternalError("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(me.PAIRING_EVENTS.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(me.PAIRING_EVENTS.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!_.isValidString(e,!1)){let{message:t}=_.getInternalError("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=_.getInternalError("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(_.isExpired(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=_.getInternalError("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!_.isValidString(e,!1)){let{message:t}=_.getInternalError("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=_.getInternalError("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(_.isExpired(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=_.getInternalError("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=_.getInternalError("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(_.isValidString(e,!1)){let{message:t}=_.getInternalError("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{let{message:t}=_.getInternalError("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!_.isValidId(e)){let{message:t}=_.getInternalError("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=_.getInternalError("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(_.isExpired(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=_.getInternalError("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}},oN=class extends me.Store{constructor(e,t){super(e,t,GH,zb),this.core=e,this.logger=t}},$b=class extends me.Store{constructor(e,t){super(e,t,WH,zb),this.core=e,this.logger=t}},aN=class extends me.Store{constructor(e,t){super(e,t,YH,zb,r=>r.id),this.core=e,this.logger=t}},cN=class extends me.Store{constructor(e,t){super(e,t,e$,Lg,()=>kg),this.core=e,this.logger=t}},lN=class extends me.Store{constructor(e,t){super(e,t,t$,Lg),this.core=e,this.logger=t}},uN=class extends me.Store{constructor(e,t){super(e,t,n$,Lg,r=>r.id),this.core=e,this.logger=t}},ywe=Object.defineProperty,wwe=(n,e,t)=>e in n?ywe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,tN=(n,e,t)=>wwe(n,typeof e!="symbol"?e+"":e,t),dN=class{constructor(e,t){this.core=e,this.logger=t,tN(this,"authKeys"),tN(this,"pairingTopics"),tN(this,"requests"),this.authKeys=new cN(this.core,this.logger),this.pairingTopics=new lN(this.core,this.logger),this.requests=new uN(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}},vwe=Object.defineProperty,bwe=(n,e,t)=>e in n?vwe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ze=(n,e,t)=>bwe(n,typeof e!="symbol"?e+"":e,t),qb=class n extends zH.ISignClient{constructor(e){super(e),Ze(this,"protocol",hN),Ze(this,"version",fN),Ze(this,"name",Vb.name),Ze(this,"metadata"),Ze(this,"core"),Ze(this,"logger"),Ze(this,"events",new qH.EventEmitter),Ze(this,"engine"),Ze(this,"session"),Ze(this,"proposal"),Ze(this,"pendingRequest"),Ze(this,"auth"),Ze(this,"signConfig"),Ze(this,"on",(r,i)=>this.events.on(r,i)),Ze(this,"once",(r,i)=>this.events.once(r,i)),Ze(this,"off",(r,i)=>this.events.off(r,i)),Ze(this,"removeListener",(r,i)=>this.events.removeListener(r,i)),Ze(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Ze(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"update",async r=>{try{return await this.engine.update(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"request",async r=>{try{return await this.engine.request(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"find",r=>{try{return this.engine.find(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Ze(this,"authenticate",async(r,i)=>{try{return await this.engine.authenticate(r,i)}catch(s){throw this.logger.error(s.message),s}}),Ze(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(i){throw this.logger.error(i.message),i}}),Ze(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(i){throw this.logger.error(i.message),i}}),this.name=e?.name||Vb.name,this.metadata=_.populateAppMetadata(e?.metadata),this.signConfig=e?.signConfig;let t=_.createLogger({logger:e?.logger||Vb.logger,name:this.name});this.logger=t,this.core=e?.core||new me.Core(e),this.session=new $b(this.core,this.logger),this.proposal=new oN(this.core,this.logger),this.pendingRequest=new aN(this.core,this.logger),this.engine=new sN(this),this.auth=new dN(this.core,this.logger)}static async init(e){let t=new n(e);return await t.initialize(),t}get context(){return nwe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}},Ewe=$b,Iwe=qb;ze.AUTH_CONTEXT=XH,ze.AUTH_KEYS_CONTEXT=e$,ze.AUTH_PAIRING_TOPIC_CONTEXT=t$,ze.AUTH_PROTOCOL=ZH,ze.AUTH_PUBLIC_KEY_NAME=kg,ze.AUTH_REQUEST_CONTEXT=n$,ze.AUTH_STORAGE_PREFIX=Lg,ze.AUTH_VERSION=dwe,ze.ENGINE_CONTEXT=KH,ze.ENGINE_QUEUE_STATES=Fs,ze.ENGINE_RPC_OPTS=Pn,ze.HISTORY_CONTEXT=cwe,ze.HISTORY_EVENTS=awe,ze.HISTORY_STORAGE_VERSION=lwe,ze.METHODS_TO_VERIFY=JH,ze.PROPOSAL_CONTEXT=GH,ze.PROPOSAL_EXPIRY=uwe,ze.PROPOSAL_EXPIRY_MESSAGE=rN,ze.REQUEST_CONTEXT=YH,ze.SESSION_CONTEXT=WH,ze.SESSION_EXPIRY=ou,ze.SESSION_REQUEST_EXPIRY_BOUNDARIES=Hb,ze.SIGN_CLIENT_CONTEXT=pN,ze.SIGN_CLIENT_DEFAULT=Vb,ze.SIGN_CLIENT_EVENTS=swe,ze.SIGN_CLIENT_PROTOCOL=hN,ze.SIGN_CLIENT_STORAGE_OPTIONS=owe,ze.SIGN_CLIENT_STORAGE_PREFIX=zb,ze.SIGN_CLIENT_VERSION=fN,ze.SessionStore=Ewe,ze.SignClient=Iwe,ze.TVF_METHODS=QH,ze.WALLETCONNECT_DEEPLINK_CHOICE=nN,ze.default=qb});var B$=Bs(Jb=>{"use strict";Object.defineProperty(Jb,"__esModule",{value:!0});var Cwe=r$(),Ct=Sb(),TN=(pu(),Fe(fu)),C$=(Wg(),Fe(Gg)),S$=(tR(),Fe(eR)),Swe=co();function A$(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var Awe=A$(S$),_we=A$(Swe);function xN(n){return n==null||typeof n!="object"&&typeof n!="function"}function _$(n){return Object.getOwnPropertySymbols(n).filter(e=>Object.prototype.propertyIsEnumerable.call(n,e))}function T$(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}var Twe="[object RegExp]",x$="[object String]",D$="[object Number]",N$="[object Boolean]",R$="[object Arguments]",xwe="[object Symbol]",Dwe="[object Date]",Nwe="[object Map]",Rwe="[object Set]",Owe="[object Array]",Pwe="[object ArrayBuffer]",Mwe="[object Object]",kwe="[object DataView]",Lwe="[object Uint8Array]",Fwe="[object Uint8ClampedArray]",Bwe="[object Uint16Array]",Uwe="[object Uint32Array]",jwe="[object Int8Array]",Vwe="[object Int16Array]",Hwe="[object Int32Array]",$we="[object Float32Array]",qwe="[object Float64Array]";function DN(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function zwe(n,e){return Sh(n,void 0,n,new Map,e)}function Sh(n,e,t,r=new Map,i=void 0){let s=i?.(n,e,t,r);if(s!=null)return s;if(xN(n))return n;if(r.has(n))return r.get(n);if(Array.isArray(n)){let o=new Array(n.length);r.set(n,o);for(let a=0;a<n.length;a++)o[a]=Sh(n[a],a,t,r,i);return Object.hasOwn(n,"index")&&(o.index=n.index),Object.hasOwn(n,"input")&&(o.input=n.input),o}if(n instanceof Date)return new Date(n.getTime());if(n instanceof RegExp){let o=new RegExp(n.source,n.flags);return o.lastIndex=n.lastIndex,o}if(n instanceof Map){let o=new Map;r.set(n,o);for(let[a,c]of n)o.set(a,Sh(c,a,t,r,i));return o}if(n instanceof Set){let o=new Set;r.set(n,o);for(let a of n)o.add(Sh(a,void 0,t,r,i));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(n))return n.subarray();if(DN(n)){let o=new(Object.getPrototypeOf(n)).constructor(n.length);r.set(n,o);for(let a=0;a<n.length;a++)o[a]=Sh(n[a],a,t,r,i);return o}if(n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer)return n.slice(0);if(n instanceof DataView){let o=new DataView(n.buffer.slice(0),n.byteOffset,n.byteLength);return r.set(n,o),cu(o,n,t,r,i),o}if(typeof File<"u"&&n instanceof File){let o=new File([n],n.name,{type:n.type});return r.set(n,o),cu(o,n,t,r,i),o}if(n instanceof Blob){let o=new Blob([n],{type:n.type});return r.set(n,o),cu(o,n,t,r,i),o}if(n instanceof Error){let o=new n.constructor;return r.set(n,o),o.message=n.message,o.name=n.name,o.stack=n.stack,o.cause=n.cause,cu(o,n,t,r,i),o}if(typeof n=="object"&&Gwe(n)){let o=Object.create(Object.getPrototypeOf(n));return r.set(n,o),cu(o,n,t,r,i),o}return n}function cu(n,e,t=n,r,i){let s=[...Object.keys(e),..._$(e)];for(let o=0;o<s.length;o++){let a=s[o],c=Object.getOwnPropertyDescriptor(n,a);(c==null||c.writable)&&(n[a]=Sh(e[a],a,t,r,i))}}function Gwe(n){switch(T$(n)){case R$:case Owe:case Pwe:case kwe:case N$:case Dwe:case $we:case qwe:case jwe:case Vwe:case Hwe:case Nwe:case D$:case Mwe:case Twe:case Rwe:case x$:case xwe:case Lwe:case Fwe:case Bwe:case Uwe:return!0;default:return!1}}function Wwe(n,e){return zwe(n,(t,r,i,s)=>{let o=e?.(t,r,i,s);if(o!=null)return o;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case D$:case x$:case N$:{let a=new n.constructor(n?.valueOf());return cu(a,n),a}case R$:{let a={};return cu(a,n),a.length=n.length,a[Symbol.iterator]=n[Symbol.iterator],a}default:return}})}function i$(n){return Wwe(n)}function s$(n){return n!==null&&typeof n=="object"&&T$(n)==="[object Arguments]"}function o$(n){return typeof n=="object"&&n!==null}function Kwe(){}function Qwe(n){return DN(n)}function Ywe(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){let t=n[Symbol.toStringTag];return t==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${t}]`}let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e}function Jwe(n){if(xN(n))return n;if(Array.isArray(n)||DN(n)||n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer)return n.slice(0);let e=Object.getPrototypeOf(n),t=e.constructor;if(n instanceof Date||n instanceof Map||n instanceof Set)return new t(n);if(n instanceof RegExp){let r=new t(n);return r.lastIndex=n.lastIndex,r}if(n instanceof DataView)return new t(n.buffer.slice(0));if(n instanceof Error){let r=new t(n.message);return r.stack=n.stack,r.name=n.name,r.cause=n.cause,r}if(typeof File<"u"&&n instanceof File)return new t([n],n.name,{type:n.type,lastModified:n.lastModified});if(typeof n=="object"){let r=Object.create(e);return Object.assign(r,n)}return n}function Zwe(n,...e){let t=e.slice(0,-1),r=e[e.length-1],i=n;for(let s=0;s<t.length;s++){let o=t[s];i=EN(i,o,r,new Map)}return i}function EN(n,e,t,r){if(xN(n)&&(n=Object(n)),e==null||typeof e!="object")return n;if(r.has(e))return Jwe(r.get(e));if(r.set(e,n),Array.isArray(e)){e=e.slice();for(let s=0;s<e.length;s++)e[s]=e[s]??void 0}let i=[...Object.keys(e),..._$(e)];for(let s=0;s<i.length;s++){let o=i[s],a=e[o],c=n[o];if(s$(a)&&(a=H({},a)),s$(c)&&(c=H({},c)),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=i$(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){let u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){let f=d[h];u[f]=c[f]}c=u}else c=[];let l=t(c,a,o,n,e,r);l!=null?n[o]=l:Array.isArray(a)||o$(c)&&o$(a)?n[o]=EN(c,a,t,r):c==null&&Ywe(a)?n[o]=EN({},a,t,r):c==null&&Qwe(a)?n[o]=i$(a):(c===void 0||a!==void 0)&&(n[o]=a)}return n}function Xwe(n,...e){return Zwe(n,...e,Kwe)}var a$="error",eve="wss://relay.walletconnect.org",tve="wc",O$="universal_provider",Gb=`${tve}@2:${O$}:`,P$="https://rpc.walletconnect.org/v1/",M$="generic",nve=`${P$}bundler`,Ah="call_status",rve=86400,NN={DEFAULT_CHAIN_CHANGED:"default_chain_changed"},ive=Object.defineProperty,sve=Object.defineProperties,ove=Object.getOwnPropertyDescriptors,c$=Object.getOwnPropertySymbols,ave=Object.prototype.hasOwnProperty,cve=Object.prototype.propertyIsEnumerable,l$=(n,e,t)=>e in n?ive(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Wb=(n,e)=>{for(var t in e||(e={}))ave.call(e,t)&&l$(n,t,e[t]);if(c$)for(var t of c$(e))cve.call(e,t)&&l$(n,t,e[t]);return n},lve=(n,e)=>sve(n,ove(e));function k$(n,e,t){var r;let i=Ct.parseChainId(n);return((r=e.rpcMap)==null?void 0:r[i.reference])||`${P$}?chainId=${i.namespace}:${i.reference}&projectId=${t}`}function uve(n){return n.includes(":")?n.split(":")[1]:n}function L$(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function dve(n,e){let t=Object.keys(e.namespaces).filter(i=>i.includes(n));if(!t.length)return[];let r=[];return t.forEach(i=>{let s=e.namespaces[i].accounts;r.push(...s)}),r}function u$(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>{var r,i;return((r=t?.chains)==null?void 0:r.length)&&((i=t?.chains)==null?void 0:i.length)>0}))}function Kb(n={},e={}){let t=u$(d$(n)),r=u$(d$(e));return Xwe(t,r)}function d$(n){var e,t,r,i,s;let o={};if(!Ct.isValidObject(n))return o;for(let[a,c]of Object.entries(n)){let l=Ct.isCaipNamespace(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},f=Ct.parseNamespaceKey(a);o[f]=lve(Wb(Wb({},o[f]),c),{chains:Ct.mergeArrays(l,(e=o[f])==null?void 0:e.chains),methods:Ct.mergeArrays(u,(t=o[f])==null?void 0:t.methods),events:Ct.mergeArrays(d,(r=o[f])==null?void 0:r.events)}),(Ct.isValidObject(h)||Ct.isValidObject(((i=o[f])==null?void 0:i.rpcMap)||{}))&&(o[f].rpcMap=Wb(Wb({},h),(s=o[f])==null?void 0:s.rpcMap))}return o}function h$(n){return n.includes(":")?n.split(":")[2]:n}function f$(n){let e={};for(let[t,r]of Object.entries(n)){let i=r.methods||[],s=r.events||[],o=r.accounts||[],a=Ct.isCaipNamespace(t)?[t]:r.chains?r.chains:L$(r.accounts);e[t]={chains:a,methods:i,events:s,accounts:o}}return e}function gN(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):(n=n.includes(":")?n.split(":")[1]:n,isNaN(Number(n))?n:Number(n))}function hve(n){try{let e=JSON.parse(n);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}var F$={},_h=n=>F$[n],mN=(n,e)=>{F$[n]=e},fve=Object.defineProperty,p$=Object.getOwnPropertySymbols,pve=Object.prototype.hasOwnProperty,gve=Object.prototype.propertyIsEnumerable,g$=(n,e,t)=>e in n?fve(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,m$=(n,e)=>{for(var t in e||(e={}))pve.call(e,t)&&g$(n,t,e[t]);if(p$)for(var t of p$(e))gve.call(e,t)&&g$(n,t,e[t]);return n},y$="eip155",mve=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],yve=n=>n&&n.startsWith("0x")?BigInt(n).toString(10):n,yN=n=>n&&n.startsWith("0x")?n:`0x${BigInt(n).toString(16)}`,w$=n=>Object.keys(n).filter(e=>mve.includes(e)).reduce((e,t)=>(e[t]=wve(n[t]),e),{}),wve=n=>typeof n=="string"&&hve(n)?JSON.parse(n):n,vve=(n,e,t)=>{let{sessionProperties:r={},scopedProperties:i={}}=n,s={};if(!Ct.isValidObject(i)&&!Ct.isValidObject(r))return;let o=w$(r);for(let a of t){let c=yve(a);if(!c)continue;s[yN(c)]=o;let l=i?.[`${y$}:${c}`];if(l){let u=l?.[`${y$}:${c}:${e}`];s[yN(c)]=m$(m$({},s[yN(c)]),w$(u||l))}}for(let[a,c]of Object.entries(s))Object.keys(c).length===0&&delete s[a];return Object.keys(s).length>0?s:void 0},bve=Object.defineProperty,Eve=(n,e,t)=>e in n?bve(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ive=(n,e,t)=>Eve(n,typeof e!="symbol"?e+"":e,t),wN,IN=class n{constructor(e){Ive(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,t){return await this.storage.setItem(e,t)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return wN||(wN=new n(e)),wN}},Cve=Object.defineProperty,Sve=Object.defineProperties,Ave=Object.getOwnPropertyDescriptors,v$=Object.getOwnPropertySymbols,_ve=Object.prototype.hasOwnProperty,Tve=Object.prototype.propertyIsEnumerable,b$=(n,e,t)=>e in n?Cve(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xve=(n,e)=>{for(var t in e||(e={}))_ve.call(e,t)&&b$(n,t,e[t]);if(v$)for(var t of v$(e))Tve.call(e,t)&&b$(n,t,e[t]);return n},Dve=(n,e)=>Sve(n,Ave(e));async function Nve(n,e){let t=Ct.parseChainId(n.result.capabilities.caip345.caip2),r=n.result.capabilities.caip345.transactionHashes,i=await Promise.allSettled(r.map(d=>Rve(t.reference,d,e))),s=i.filter(d=>d.status==="fulfilled").map(d=>d.value).filter(d=>d);i.filter(d=>d.status==="rejected").forEach(d=>console.warn("Failed to fetch transaction receipt:",d.reason));let o=!s.length||s.some(d=>!d),a=s.every(d=>d?.status==="0x1"),c=s.every(d=>d?.status==="0x0"),l=s.some(d=>d?.status==="0x0"),u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:n.result.id,version:n.request.version,atomic:n.request.atomicRequired,chainId:n.request.chainId,capabilities:n.result.capabilities,receipts:s,status:u}}async function Rve(n,e,t){return await t(parseInt(n)).request(TN.formatJsonRpcRequest("eth_getTransactionReceipt",[e]))}async function Ove({sendCalls:n,storage:e}){let t=await e.getItem(Ah);await e.setItem(Ah,Dve(xve({},t),{[n.result.id]:{request:n.request,result:n.result,expiry:Ct.calcExpiry(rve)}}))}async function Pve({resultId:n,storage:e}){let t=await e.getItem(Ah);if(t){delete t[n],await e.setItem(Ah,t);for(let r in t)Ct.isExpired(t[r].expiry)&&delete t[r];await e.setItem(Ah,t)}}async function Mve({resultId:n,storage:e}){let t=await e.getItem(Ah),r=t?.[n];if(r&&!Ct.isExpired(r.expiry))return r;await Pve({resultId:n,storage:e})}var kve=Object.defineProperty,Lve=Object.defineProperties,Fve=Object.getOwnPropertyDescriptors,E$=Object.getOwnPropertySymbols,Bve=Object.prototype.hasOwnProperty,Uve=Object.prototype.propertyIsEnumerable,CN=(n,e,t)=>e in n?kve(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vN=(n,e)=>{for(var t in e||(e={}))Bve.call(e,t)&&CN(n,t,e[t]);if(E$)for(var t of E$(e))Uve.call(e,t)&&CN(n,t,e[t]);return n},bN=(n,e)=>Lve(n,Fve(e)),au=(n,e,t)=>CN(n,typeof e!="symbol"?e+"":e,t),SN=class{constructor(e){au(this,"name","eip155"),au(this,"client"),au(this,"chainId"),au(this,"namespace"),au(this,"httpProviders"),au(this,"events"),au(this,"storage"),this.namespace=e.namespace,this.events=_h("events"),this.client=_h("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=IN.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t);let r=this.chainId;this.chainId=parseInt(e),this.events.emit(NN.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let r=t||k$(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new C$.JsonRpcProvider(new S$.HttpConnection(r,_h("disableProviderPing")))}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=parseInt(uve(t));e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(e){let t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=bN(vN({},this.httpProviders),{[t]:this.createHttpProvider(t)}),this.httpProviders[t])}async handleSwitchChain(e){var t,r;let i=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;let s=parseInt(i,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${s}`);else throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,i,s,o;let a=(r=(t=e.request)==null?void 0:t.params)==null?void 0:r[0],c=((s=(i=e.request)==null?void 0:i.params)==null?void 0:s[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");let l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let f;try{f=vve(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(f)return f;let p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:bN(vN({},l.sessionProperties||{}),{capabilities:bN(vN({},u||{}),{[d]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var t,r,i;let s=this.client.session.get(e.topic),o=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(o){let l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}let a=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}let c=await Mve({resultId:(i=e.request.params)==null?void 0:i[0],storage:this.storage});if(c)try{return await Nve(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;let i=new URL(e),s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(TN.formatJsonRpcRequest("eth_getUserOperationReceipt",[(r=t.request.params)==null?void 0:r[0]]))});if(!s.ok)throw new Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${nve}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}async sendCalls(e){var t,r,i;let s=await this.client.request(e),o=(t=e.request.params)==null?void 0:t[0],a=s?.id,c=s?.capabilities||{},l=(r=c?.caip345)==null?void 0:r.caip2,u=(i=c?.caip345)==null?void 0:i.transactionHashes;return!a||!l||!(u!=null&&u.length)||await Ove({sendCalls:{request:o,result:s},storage:this.storage}),s}},jve=Object.defineProperty,Vve=(n,e,t)=>e in n?jve(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ch=(n,e,t)=>Vve(n,typeof e!="symbol"?e+"":e,t),AN=class{constructor(e){Ch(this,"name",M$),Ch(this,"client"),Ch(this,"httpProviders"),Ch(this,"events"),Ch(this,"namespace"),Ch(this,"chainId"),this.namespace=e.namespace,this.events=_h("events"),this.client=_h("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t);let r=this.chainId;this.chainId=e,this.events.emit(NN.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return Ct.parseChainId(e).namespace}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;let r={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(i=>{var s,o;let a=Ct.parseChainId(i),c=(o=(s=this.namespace)==null?void 0:s.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];r[a.reference]=this.createHttpProvider(i,c)}),r}getHttpProvider(e){let t=Ct.parseChainId(e).reference,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||k$(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new C$.JsonRpcProvider(new Awe.default(r,_h("disableProviderPing")))}},Hve=Object.defineProperty,$ve=Object.defineProperties,qve=Object.getOwnPropertyDescriptors,I$=Object.getOwnPropertySymbols,zve=Object.prototype.hasOwnProperty,Gve=Object.prototype.propertyIsEnumerable,_N=(n,e,t)=>e in n?Hve(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Fg=(n,e)=>{for(var t in e||(e={}))zve.call(e,t)&&_N(n,t,e[t]);if(I$)for(var t of I$(e))Gve.call(e,t)&&_N(n,t,e[t]);return n},Qb=(n,e)=>$ve(n,qve(e)),Ji=(n,e,t)=>_N(n,typeof e!="symbol"?e+"":e,t),Yb=class n{constructor(e){Ji(this,"client"),Ji(this,"namespaces"),Ji(this,"optionalNamespaces"),Ji(this,"sessionProperties"),Ji(this,"scopedProperties"),Ji(this,"events",new _we.default),Ji(this,"rpcProviders",{}),Ji(this,"session"),Ji(this,"providerOpts"),Ji(this,"logger"),Ji(this,"uri"),Ji(this,"disableProviderPing",!1);var t,r;this.providerOpts=e,this.logger=Ct.createLogger({logger:(t=e.logger)!=null?t:a$,name:(r=this.providerOpts.name)!=null?r:O$}),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new n(e);return await t.initialize(),t}async request(e,t,r){let[i,s]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Fg({},e),chainId:`${i}:${s}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){let s=new Date().getTime();this.request(e,r,i).then(o=>t(null,TN.formatJsonRpcResult(s,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ct.getSdkError("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));let s=await i();if(this.session=s.session,this.session){let o=f$(this.session.namespaces);this.namespaces=Kb(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let i=await r();this.session=i;let s=f$(i.namespaces);return this.namespaces=Kb(this.namespaces,s),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[r,i]=this.validateChain(e);this.getProvider(r).setDefaultChain(i,t)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(!Ct.isValidArray(t))return;for(let r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}catch(t){this.logger.warn(t,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await Cwe.SignClient.init({core:this.providerOpts.core,logger:this.providerOpts.logger||a$,relayUrl:this.providerOpts.relayUrl||eve,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error(r,"Failed to get session"),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{let r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(t=>Ct.parseNamespaceKey(t)))];mN("client",this.client),mN("events",this.events),mN("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;let r=dve(t,this.session);if(r?.length===0)return;let i=L$(r),s=Kb(this.namespaces,this.optionalNamespaces),o=Qb(Fg({},s[t]),{accounts:r,chains:i});switch(t){case"eip155":this.rpcProviders[t]=new SN({namespace:o});break;default:this.rpcProviders[t]=new AN({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:r}=e;r===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:r,topic:i}=e;if(i!==((t=this.session)==null?void 0:t.topic))return;let{event:s}=r;if(s.name==="accountsChanged"){let o=s.data;o&&Ct.isValidArray(o)&&this.events.emit("accountsChanged",o.map(h$))}else if(s.name==="chainChanged"){let o=r.chainId,a=r.event.data,c=Ct.parseNamespaceKey(o),l=gN(o)!==gN(a)?`${c}:${gN(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,i;if(e!==((r=this.session)==null?void 0:r.topic))return;let{namespaces:s}=t,o=(i=this.client)==null?void 0:i.session.get(e);this.session=Qb(Fg({},o),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Qb(Fg({},Ct.getSdkError("USER_DISCONNECTED")),{data:e.topic})))}),this.on(NN.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(Qb(Fg({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[M$]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t={},optionalNamespaces:r={},sessionProperties:i,scopedProperties:s}=e;this.optionalNamespaces=Kb(t,r),this.sessionProperties=i,this.scopedProperties=s}validateChain(e){let[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(o=>Ct.parseNamespaceKey(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];let i=Ct.parseNamespaceKey(Object.keys(this.namespaces)[0]),s=this.rpcProviders[i].getDefaultChain();return[i,s]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:t,internal:r=!1}){if(!this.namespaces)return;let[i,s]=this.validateChain(e);s&&(this.updateNamespaceChain(i,s),r?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:i,currentCaipChainId:e,previousCaipChainId:t})):this.getProvider(i).setDefaultChain(s),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:t,previousCaipChainId:r}){var i,s;try{if(r===t)return;let o=(s=(i=this.session)==null?void 0:i.namespaces[e])==null?void 0:s.accounts;if(!o)return;let a=o.filter(c=>c.includes(`${t}:`)).map(h$);if(!Ct.isValidArray(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,t){if(!this.namespaces)return;let r=this.namespaces[e]?e:`${e}:${t}`,i={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=i}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;let i=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Gb}/${e}${i}`,t)}async getFromStore(e){var t;let r=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Gb}/${e}${r}`)}async deleteFromStore(e){var t;let r=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Gb}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;let t=await this.client.core.storage.getKeys();for(let r of t)r.startsWith(Gb)&&await this.client.core.storage.removeItem(r)}catch(t){this.logger.warn(t,"Failed to cleanup storage")}}},Wve=Yb;Jb.UniversalProvider=Wve,Jb.default=Yb});var U$=ni(()=>{"use strict";mq();pq();gq()});function Kve(n){if(n.length>=255)throw new TypeError("Alphabet too long");let e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<n.length;l++){let u=n.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}let t=n.length,r=n.charAt(0),i=Math.log(t)/Math.log(256),s=Math.log(256)/Math.log(t);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0,f=l.length;for(;h!==f&&l[h]===0;)h++,u++;let p=(f-h)*s+1>>>0,g=new Uint8Array(p);for(;h!==f;){let E=l[h],I=0;for(let L=p-1;(E!==0||I<d)&&L!==-1;L--,I++)E+=256*g[L]>>>0,g[L]=E%t>>>0,E=E/t>>>0;if(E!==0)throw new Error("Non-zero carry");d=I,h++}let m=p-d;for(;m!==p&&g[m]===0;)m++;let y=r.repeat(u);for(;m<p;++m)y+=n.charAt(g[m]);return y}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;let f=(l.length-u)*i+1>>>0,p=new Uint8Array(f);for(;u<l.length;){let E=l.charCodeAt(u);if(E>255)return;let I=e[E];if(I===255)return;let L=0;for(let k=f-1;(I!==0||L<h)&&k!==-1;k--,L++)I+=t*p[k]>>>0,p[k]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");h=L,u++}let g=f-h;for(;g!==f&&p[g]===0;)g++;let m=new Uint8Array(d+(f-g)),y=d;for(;g!==f;)m[y++]=p[g++];return m}function c(l){let u=a(l);if(u)return u;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var j$,V$=ni(()=>{"use strict";j$=Kve});var Qve,H$,$$=ni(()=>{"use strict";V$();Qve="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",H$=j$(Qve)});var Bg,q$=ni(()=>{"use strict";Bg={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603}});var Zb,z$=ni(()=>{"use strict";$$();fq();rR();Rh();Rh();q$();Zb=class extends lR{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new uR({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){let r=this.provider?.session?.namespaces?.[e]?.accounts?.map(i=>{let[,,s]=i.split(":");return s}).filter((i,s,o)=>o.indexOf(i)===s)||[];return Promise.resolve({accounts:r.map(i=>dr.createAccount(e,i,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&en.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};let r=K.getAccountData();if(r?.balanceLoading&&e.chainId===K.state.activeCaipNetwork?.id)return{balance:r?.balance||"0.00",symbol:r?.balanceSymbol||""};let s=(await K.fetchTokenBalance()).find(o=>o.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&o.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:s?.quantity.numeric||"0.00",symbol:s?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){let{provider:t,message:r,address:i}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let s="";return K.state.activeCaipNetwork?.chainNamespace===lt.CHAIN.SOLANA?s=(await t.request({method:"solana_signMessage",params:{message:H$.encode(new TextEncoder().encode(r)),pubkey:i}},K.state.activeCaipNetwork?.caipNetworkId)).signature:s=await t.request({method:"personal_sign",params:[r,i]},K.state.activeCaipNetwork?.caipNetworkId),{signature:s}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){let{caipNetwork:t}=e,r=this.getWalletConnectConnector();if(t.chainNamespace===lt.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:hE(t.id)}]})}catch(i){if(i.code===Bg.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||i.code===Bg.ERROR_INVALID_CHAIN_ID||i.code===Bg.ERROR_CODE_DEFAULT||i?.data?.originalError?.code===Bg.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:hE(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}});var Yve,Xb,G$,W$=ni(()=>{"use strict";Rh();fR();Yve=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],Xb={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!n?.config)return!1;let e=n.config;return!!n.isEnabled&&e.includes("email")},processFallback:n=>n===void 0?en.DEFAULT_REMOTE_FEATURES.email:!!n},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!n?.config)return!1;let e=n.config;return n.isEnabled&&e.length>0?e.filter(t=>t!=="email"):!1},processFallback:n=>n===void 0?en.DEFAULT_REMOTE_FEATURES.socials:typeof n=="boolean"?n?en.DEFAULT_REMOTE_FEATURES.socials:!1:n},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!n?.config)return!1;let e=n.config;return n.isEnabled&&e.length>0?e:!1},processFallback:n=>n===void 0?en.DEFAULT_REMOTE_FEATURES.swaps:typeof n=="boolean"?n?en.DEFAULT_REMOTE_FEATURES.swaps:!1:n},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>{if(!n?.config)return!1;let e=n.config;return n.isEnabled&&e.length>0?e:!1},processFallback:n=>n===void 0?en.DEFAULT_REMOTE_FEATURES.onramp:typeof n=="boolean"?n?en.DEFAULT_REMOTE_FEATURES.onramp:!1:n},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:n=>n===void 0?en.DEFAULT_REMOTE_FEATURES.activity:!!n},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:n=>n===void 0?en.DEFAULT_REMOTE_FEATURES.reownBranding:!!n},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>n.isEnabled&&(n.config??[]),processFallback:n=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:()=>en.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:()=>en.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:()=>en.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:n=>!!n.isEnabled,processFallback:n=>typeof n>"u"?en.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!n}},G$={localSettingsOverridden:new Set,getApiConfig(n,e){return e?.find(t=>t.id===n)},addWarning(n,e){if(n!==void 0){let t=Xb[e],r=t.isLegacy?`"features.${t.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(n,e,t,r,i){let s=Xb[n],o=e[s.localFeatureName];if(i&&!s.isAvailableOnBasic)return!1;if(r){let a=this.getApiConfig(s.apiFeatureName,t);return a?.config===null?this.processFallbackFeature(n,o):a?.config?(o!==void 0&&this.addWarning(o,n),this.processApiFeature(n,a)):!1}return this.processFallbackFeature(n,o)},processApiFeature(n,e){return Xb[n].processApi(e)},processFallbackFeature(n,e){return Xb[n].processFallback(e)},async fetchRemoteFeatures(n){let e=n.basic??!1,t=n.features||{};this.localSettingsOverridden.clear();let r=null,i=!1;try{r=await gu.fetchProjectConfig(),i=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}let s=i&&!e?en.DEFAULT_REMOTE_FEATURES:en.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(let o of Yve){let a=this.processFeature(o,t,r,i,e);Object.assign(s,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),en.DEFAULT_REMOTE_FEATURES}if(i&&this.localSettingsOverridden.size>0){let o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;hr.open({debugMessage:Mr.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return s}}});var K$,eE,Q$=ni(()=>{"use strict";K$=du(B$(),1);rR();Rh();U$();yq();fR();z$();W$();eE=class{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(t,r)=>{if(t){let i=K.getCaipNetworks(t)?.find(a=>a.id===r);if(i)return i;let s=K.getNetworkData(t)?.caipNetwork;return s||K.getRequestedCaipNetworks(t).filter(a=>a.chainNamespace===t)?.[0]}return K.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{let t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>K.getCaipNetworks(t),this.getActiveChainNamespace=()=>K.state.activeChain,this.setRequestedCaipNetworks=(t,r)=>{K.setRequestedCaipNetworks(t,r)},this.getApprovedCaipNetworkIds=()=>K.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>K.state.activeChain===t||!t?K.state.activeCaipAddress:K.state.chains.get(t)?.accountState?.caipAddress,this.setClientId=t=>{pE.setClientId(t)},this.getProvider=t=>Kt.getProvider(t),this.getProviderType=t=>Kt.getProviderId(t),this.getPreferredAccountType=t=>gE(t),this.setCaipAddress=(t,r,i=!1)=>{K.setAccountProp("caipAddress",t,r,i),K.setAccountProp("address",dr.getPlainAddress(t),r,i)},this.setBalance=(t,r,i)=>{K.setAccountProp("balance",t,i),K.setAccountProp("balanceSymbol",r,i)},this.setProfileName=(t,r)=>{K.setAccountProp("profileName",t,r)},this.setProfileImage=(t,r)=>{K.setAccountProp("profileImage",t,r)},this.setUser=(t,r)=>{K.setAccountProp("user",t,r)},this.resetAccount=t=>{K.resetAccount(t)},this.setCaipNetwork=t=>{K.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,r)=>{K.setChainNetworkData(r,{caipNetwork:t})},this.setStatus=(t,r)=>{K.setAccountProp("status",t,r),At.isConnected()?Ht.setConnectionStatus("connected"):Ht.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>K.getAccountData(t)?.address,this.setConnectors=t=>{let r=[...At.state.allConnectors,...t];At.setConnectors(r)},this.setConnections=(t,r)=>{Ht.setConnections(t,r),zt.setConnections(t,r)},this.fetchIdentity=t=>pE.fetchIdentity(t),this.getReownName=t=>cR.getNamesForAddress(t),this.getConnectors=()=>At.getConnectors(),this.getConnectorImage=t=>iR.getConnectorImage(t),this.getConnections=t=>this.remoteFeatures.multiWallet?mE.getConnectionsData(t).connections:(hr.open(lt.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=t=>this.remoteFeatures.multiWallet?mE.getConnectionsData(t).recentConnections:(hr.open(lt.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async t=>{if(!this.remoteFeatures.multiWallet){hr.open(lt.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await zt.switchConnection(t)},this.deleteConnection=t=>{if(!this.remoteFeatures.multiWallet){hr.open(lt.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}Ht.deleteAddressFromConnection(t),zt.syncStorageConnections()},this.setConnectedWalletInfo=(t,r)=>{let i=Kt.getProviderId(r),s=t?ge(H({},t),{type:i}):void 0;K.setAccountProp("connectedWalletInfo",s,r)},this.getIsConnectedState=()=>!!K.state.activeCaipAddress,this.addAddressLabel=(t,r,i)=>{let s=K.getAccountData(i)?.addressLabels||{};K.setAccountProp("addressLabels",ge(H({},s),{[t]:r}),i)},this.removeAddressLabel=(t,r)=>{let i=K.getAccountData(r)?.addressLabels||{};K.setAccountProp("addressLabels",ge(H({},i),{[t]:void 0}),r)},this.getAddress=t=>{let r=t||K.state.activeChain;return K.getAccountData(r)?.address},this.resetNetwork=t=>{K.resetNetwork(t)},this.addConnector=t=>{At.addConnector(t)},this.resetWcConnection=()=>{zt.resetWcConnection()},this.setAddressExplorerUrl=(t,r)=>{K.setAccountProp("addressExplorerUrl",t,r)},this.setSmartAccountDeployed=(t,r)=>{K.setAccountProp("smartAccountDeployed",t,r)},this.setPreferredAccountType=(t,r)=>{K.setAccountProp("preferredAccountType",t,r)},this.setEIP6963Enabled=t=>{de.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){let r=e?.map(s=>s.namespace).filter(s=>!!s);if(r?.length)return[...new Set(r)];let i=t?.map(s=>s.chainNamespace);return[...new Set(i)]}async initialize(e){if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),de.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await G$.fetchRemoteFeatures(e),await gu.fetchUsage(),de.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&oR.setOnrampProviders(this.remoteFeatures.onramp),(de.state.remoteFeatures?.email||Array.isArray(de.state.remoteFeatures?.socials)&&de.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),de.state.features?.reownAuthentication||de.state.remoteFeatures?.reownAuthentication){let{ReownAuthentication:t}=await import("./chunk-56SKK657.js"),r=de.state.siwx;r instanceof t||(r&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),de.setSIWX(new t))}}async openSend(e){let t=e.namespace||K.state.activeChain,r=this.getCaipAddress(t),i=this.getCaipNetwork(t)?.id;if(!r)throw new Error("openSend: caipAddress not found");if(i?.toString()!==e.chainId.toString()){let s=K.getCaipNetworkById(e.chainId,t);if(!s)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(s,{throwOnFailure:!0})}try{let s=dR.getTokenSymbolByAddress(e.assetAddress);s&&await gu.fetchTokenImages([s])}catch{}return await lo.open({view:"WalletSend",data:{send:e}}),new Promise((s,o)=>{let a=wE.subscribeKey("hash",u=>{u&&(l(),s({hash:u}))}),c=lo.subscribe(u=>{u.open||(l(),o(new Error("Modal closed")))}),l=this.createCleanupHandler([a,c])})}toModalOptions(){function e(r){return r?.view==="Swap"}function t(r){return r?.view==="WalletSend"}return{isSwap:e,isSend:t}}async checkAllowedOrigins(){try{let e=await gu.fetchAllowedOrigins();if(!dr.isClient())return;let t=window.location.origin;Kg.isOriginAllowed(t,e,lt.DEFAULT_ALLOWED_ANCESTORS)||hr.open(Mr.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":hr.open(Mr.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{let t=e.cause instanceof Error?e.cause:e;hr.open({displayMessage:Mr.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:Mr.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(t.message)},"error");break}default:break}}}createCleanupHandler(e){return()=>{e.forEach(t=>{try{t()}catch{}})}}sendInitializeEvent(e){let t=MN(e,[]);delete t.adapters,delete t.universalProvider,na.sendEvent({type:"track",event:"INITIALIZE",properties:ge(H({},t),{networks:e.networks.map(r=>r.id),siweConfig:{options:e.siweConfig?.options||{}}})})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initAdapterController(){sR.initialize(this.chainAdapters)}initializeThemeController(e){e.themeMode&&Us.setThemeMode(e.themeMode),e.themeVariables&&Us.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient)throw new Error("ConnectionControllerClient must be set");K.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient});let t=this.getDefaultNetwork();t&&K.setActiveCaipNetwork(t)}initializeConnectionController(e){zt.initialize(e.adapters??[]),zt.setWcBasic(e.basic??!1)}initializeConnectorController(){At.initialize(this.chainNamespaces)}initializeProjectSettings(e){de.setProjectId(e.projectId),de.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){de.setDebug(e.debug!==!1),de.setEnableWalletGuide(e.enableWalletGuide!==!1),de.setEnableWallets(e.enableWallets!==!1),de.setEIP6963Enabled(e.enableEIP6963!==!1),de.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),de.setEnableReconnect(e.enableReconnect!==!1),de.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),de.setCoinbasePreference(e.coinbasePreference),de.setEnableAuthLogger(e.enableAuthLogger!==!1),de.setCustomRpcUrls(e.customRpcUrls),de.setEnableEmbedded(e.enableEmbedded),de.setAllWallets(e.allWallets),de.setIncludeWalletIds(e.includeWalletIds),de.setExcludeWalletIds(e.excludeWalletIds),de.setFeaturedWalletIds(e.featuredWalletIds),de.setTokens(e.tokens),de.setTermsConditionsUrl(e.termsConditionsUrl),de.setPrivacyPolicyUrl(e.privacyPolicyUrl),de.setCustomWallets(e.customWallets),de.setFeatures(e.features),de.setAllowUnsupportedChain(e.allowUnsupportedChain),de.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),de.setPreferUniversalLinks(e.experimental_preferUniversalLinks),de.setDefaultAccountTypes(e.defaultAccountTypes);let t=this.getDefaultMetaData();if(!e.metadata&&t&&(e.metadata=t),de.setMetadata(e.metadata),de.setDisableAppend(e.disableAppend),de.setEnableEmbedded(e.enableEmbedded),de.setSIWX(e.siwx),this.features=de.state.features??{},!e.projectId){hr.open(Mr.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(i=>i.namespace===lt.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");de.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return dr.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){let t=this.getActiveChainNamespace();if(t){let r=mu.getUnsupportedNetwork(`${t}:${e}`);K.setActiveCaipNetwork(r)}}getDefaultNetwork(){return mu.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return mu.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return mu.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){let t=e.networks.find(i=>i.id===e.defaultNetwork?.id);return t?mu.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,t){try{this.setLoading(!0,e);let r={connections:[]},i=this.getAdapter(e);return(K.state.chains.get(e)?.accountState?.caipAddress||!de.state.enableReconnect)&&i?.disconnect&&(r=await i.disconnect({id:t})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{let e=K.state.activeChain,t=this.getAdapter(e),r=this.getCaipNetwork(e)?.id,i=zt.getConnections(e),s=this.remoteFeatures.multiWallet,o=i.length>0;if(!t)throw new Error("Adapter not found");let a=await t.connectWalletConnect(r);(!o||!s)&&this.close(),this.setClientId(a?.clientId||null),Ht.setConnectedNamespaces([...K.state.chains.keys()]),await this.syncWalletConnectAccount(),await Qg.initializeIfEnabled()},connectExternal:async e=>{let t=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,t),t?{address:t.address}:void 0},reconnectExternal:async({id:e,info:t,type:r,provider:i})=>{let s=K.state.activeChain,o=this.getAdapter(s);if(!s)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:t,type:r,provider:i,chainId:this.getCaipNetwork()?.id}),Ht.addConnectedNamespace(s),this.syncConnectedWalletInfo(s))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{let{id:t,chainNamespace:r,initialDisconnect:i}=e||{},s=r||K.state.activeChain,o=At.getConnectorId(s),a=t===lt.CONNECTOR_ID.AUTH||o===lt.CONNECTOR_ID.AUTH,c=t===lt.CONNECTOR_ID.WALLET_CONNECT||o===lt.CONNECTOR_ID.WALLET_CONNECT;try{let l=Array.from(K.state.chains.keys()),u=r?[r]:l;(c||a)&&(u=l);let d=u.map(async p=>{let g=At.getConnectorId(p),m=t||g,y=await this.disconnectConnector(p,m);y&&(a&&Ht.deleteConnectedSocialProvider(),y.connections.forEach(E=>{Ht.addDisconnectedConnectorId(E.connectorId,p)})),i&&this.onDisconnectNamespace({chainNamespace:p,closeModal:!1})}),h=await Promise.allSettled(d);wE.resetSend(),zt.resetWcConnection(),Qg.getSIWX()?.signOutOnDisconnect&&await Qg.clearSessions(),At.setFilterByNamespace(void 0),zt.syncStorageConnections();let f=h.filter(p=>p.status==="rejected");if(f.length>0)throw new Error(f.map(p=>p.reason.message).join(", "));na.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(t=>!!window.ethereum?.[String(t)]):!!window.ethereum,signMessage:async e=>{let t=K.state.activeChain,r=this.getAdapter(K.state.activeChain);if(!t)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");let i=this.getAddress(t);if(!i)throw new Error("signMessage: address not found");return(await r?.signMessage({message:e,address:i,provider:Kt.getProvider(t)}))?.signature||""},sendTransaction:async e=>{let t=e.chainNamespace;if(!t)throw new Error("sendTransaction: namespace not found");if(en.SEND_SUPPORTED_NAMESPACES.includes(t)){let r=this.getAdapter(t);if(!r)throw new Error("sendTransaction: adapter not found");let i=Kt.getProvider(t);return(await r?.sendTransaction(ge(H({},e),{caipNetwork:this.getCaipNetwork(),provider:i})))?.hash||""}return""},estimateGas:async e=>{let t=e.chainNamespace;if(t===lt.CHAIN.EVM){let r=this.getAdapter(t);if(!r)throw new Error("estimateGas: adapter is required but got undefined");let i=Kt.getProvider(t),s=this.getCaipNetwork();if(!s)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas(ge(H({},e),{provider:i,caipNetwork:s})))?.gas||0n}return 0n},getEnsAvatar:async()=>{let e=K.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");let t=this.getAddress(e);if(!t)throw new Error("getEnsAvatar: address not found");return await this.syncIdentity({address:t,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),K.getAccountData()?.profileImage||!1},getEnsAddress:async e=>await Kg.resolveReownName(e),writeContract:async e=>{let t=K.state.activeChain,r=this.getAdapter(t);if(!t)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");let i=this.getCaipNetwork(),s=this.getCaipAddress(),o=Kt.getProvider(t);if(!i||!s)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract(ge(H({},e),{caipNetwork:i,provider:o,caipAddress:s})))?.hash},parseUnits:(e,t)=>{let r=this.getAdapter(K.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{let r=this.getAdapter(K.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{let t=this.getAdapter(K.state.activeChain);if(!t)throw new Error("getCapabilities: adapter is required but got undefined");return await t?.getCapabilities(e)},grantPermissions:async e=>{let t=this.getAdapter(K.state.activeChain);if(!t)throw new Error("grantPermissions: adapter is required but got undefined");return await t?.grantPermissions(e)},revokePermissions:async e=>{let t=this.getAdapter(K.state.activeChain);if(!t)throw new Error("revokePermissions: adapter is required but got undefined");return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{let t=this.getAdapter(K.state.activeChain);if(!t)throw new Error("walletGetAssets: adapter is required but got undefined");return await t?.walletGetAssets(e)??{}},updateBalance:e=>{let t=this.getAddress(e),r=this.getCaipNetwork(e);!r||!t||this.updateNativeBalance(t,r?.id,e)}},zt.setClient(this.connectionControllerClient)}async onConnectExternal(e){let t=K.state.activeChain,r=e.chain||t,i=this.getAdapter(r),s=!0;if(e.type===uo.CONNECTOR_TYPE_AUTH&&lt.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(d=>At.getConnectorId(d)===lt.CONNECTOR_ID.AUTH)&&e.chain!==t&&(s=!1),e.chain&&e.chain!==t&&!e.caipNetwork){let l=this.getCaipNetworks().find(u=>u.chainNamespace===e.chain);l&&s&&this.setCaipNetwork(l)}if(!r)throw new Error("connectExternal: namespace not found");if(!i)throw new Error("connectExternal: adapter not found");let o=this.getCaipNetwork(r),a=e.caipNetwork||o,c=await i.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||o?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||o?.rpcUrls?.default?.http?.[0]});if(c)return Ht.addConnectedNamespace(r),this.syncProvider(ge(H({},c),{chainNamespace:r})),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),Ht.removeDisconnectedConnectorId(e.id,r),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,t){let r=e.type===uo.CONNECTOR_TYPE_AUTH,i=vE.getOtherAuthNamespaces(t?.connectedCaipNetwork?.chainNamespace),s=K.state.activeCaipNetwork,o=this.getAdapter(s?.chainNamespace);r&&(await Promise.all(i.map(async a=>{try{let c=Kt.getProvider(a),l=this.getCaipNetwork(a);await this.getAdapter(a)?.connect(ge(H({},e),{provider:c,socialUri:void 0,chainId:l?.id,rpcUrl:l?.rpcUrls?.default?.http?.[0]}))&&(Ht.addConnectedNamespace(a),Ht.removeDisconnectedConnectorId(e.id,a),this.setStatus("connected",a),this.syncConnectedWalletInfo(a))}catch(c){hr.warn(Mr.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,Mr.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(a,c instanceof Error?c.message:void 0),Mr.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),s&&await o?.switchNetwork({caipNetwork:s}))}getApprovedCaipNetworksData(){if(Kt.getProviderId(K.state.activeChain)===uo.CONNECTOR_TYPE_WALLET_CONNECT){let t=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(t)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){let t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){let i=Kt.getProviderId(t);if(e.chainNamespace===K.state.activeChain)await this.getAdapter(t)?.switchNetwork({caipNetwork:e});else if(this.setCaipNetwork(e),i===uo.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{let s=this.getAddressByChainNamespace(t);s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{let r=t.chains||[],i=t.accounts.map(s=>{let{chainId:o,chainNamespace:a}=Ac.parseCaipAddress(s);return`${a}:${o}`});return Array.from(new Set([...r,...i]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,r)=>{let i=e?.find(s=>s.namespace===r);return i?(i.construct({namespace:r,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:s})=>s===r)}),t[r]=i):t[r]=new Zb({namespace:r,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e);let t=this.getAdapter(e);if(!t)throw new Error("adapter not found");await t.syncConnectors(),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)})),this.initAdapterController()}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){let t=this.getAdapter(e);if(!t)return;let r=Ht.getConnectionStatus();de.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(Ht.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),t.on("switchNetwork",({address:i,chainId:s})=>{let o=this.getCaipNetworks().find(l=>l.id.toString()===s.toString()||l.caipNetworkId.toString()===s.toString()),a=K.state.activeChain===e,c=K.state.chains.get(e)?.accountState?.address;if(o){let l=a&&i?i:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(s)}),t.on("disconnect",()=>{let i=this.remoteFeatures.multiWallet,s=Array.from(zt.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!i||s.length===0})}),t.on("connections",i=>{this.setConnections(i,e)}),t.on("pendingTransactions",()=>{let i=this.getAddress(e),s=K.state.activeCaipNetwork;!i||!s?.id||this.updateNativeBalance(i,s.id,s.chainNamespace)}),t.on("accountChanged",({address:i,chainId:s,connector:o})=>{this.handlePreviousConnectorConnection(o);let a=K.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o?.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));let c=K.getNetworkData(e)?.caipNetwork?.id,l=s||c;a&&l?this.syncAccount({address:i,chainId:l,chainNamespace:e}):!a&&l?(this.syncAccountInfo(i,l,e),this.syncBalance({address:i,chainId:l,chainNamespace:e})):this.syncAccountInfo(i,s,e),Ht.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){let t=e?.chain,r=e?.id,i=At.getConnectorId(t),s=de.state.remoteFeatures?.multiWallet,a=t&&r&&i&&i!==r&&!s;try{a&&await zt.disconnect({id:i,namespace:t})}catch(c){console.warn("Error disconnecting previous connector",c)}}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>zt.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();let e=this.getAddress();this.getCaipAddress()||Ht.deleteRecentWallet();let t=Ht.getRecentWallet();na.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:dr.isMobile()?"mobile":"qrcode",name:t?.name||"Unknown",reconnect:!0,view:_c.state.view,walletRank:t?.order}})}async syncNamespaceConnection(e){try{e===lt.CHAIN.EVM&&dr.isSafeApp()&&At.setConnectorId(lt.CONNECTOR_ID.SAFE,e);let t=At.getConnectorId(e);switch(this.setStatus("connecting",e),t){case lt.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case lt.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){let{chainNamespace:t,closeModal:r}=e||{};K.resetAccount(t),K.resetNetwork(t),Ht.removeConnectedNamespace(t);let i=Array.from(K.state.chains.keys());(t?[t]:i).forEach(o=>Ht.addDisconnectedConnectorId(At.getConnectorId(o)||"",o)),At.removeConnectorId(t),Kt.resetChain(t),this.setUser(null,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(null,t),r!==!1&&lo.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{let t=this.getAdapter(e),r=this.getCaipAddress(e),i=this.getCaipNetwork(e);return t?.syncConnections({connectToFirstConnector:!r,caipNetwork:i})}))}async syncAdapterConnection(e){let t=this.getAdapter(e),r=this.getCaipNetwork(e),i=At.getConnectorId(e),o=At.getConnectors(e).find(a=>a.id===i);try{if(!t||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!r?.id)throw new Error("CaipNetwork not found");let a=await t?.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:r?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider(ge(H({},a),{chainNamespace:e})),await this.syncAccount(ge(H({},a),{chainNamespace:e})),this.setStatus("connected",e),na.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:a.address,properties:{method:"browser",name:o.info?.name||o.name||"Unknown",reconnect:!0,view:_c.state.view,walletRank:void 0}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){let e=Object.keys(this.universalProvider?.session?.namespaces||{}),t=this.chainNamespaces.map(async r=>{let i=this.getAdapter(r);if(!i)return;let s=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=K.state.activeCaipNetwork?.id,a=s.find(l=>{let{chainId:u}=Ac.parseCaipAddress(l);return u===o?.toString()})||s[0];if(a){let l=Ac.validateCaipAddress(a),{chainId:u,address:d}=Ac.parseCaipAddress(l);if(Kt.setProviderId(r,uo.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&K.state.activeCaipNetwork&&i.namespace!==lt.CHAIN.EVM){let h=i.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:K.state.activeCaipNetwork});Kt.setProvider(r,h)}else Kt.setProvider(r,this.universalProvider);At.setConnectorId(lt.CONNECTOR_ID.WALLET_CONNECT,r),Ht.addConnectedNamespace(r),await this.syncAccount({address:d,chainId:u,chainNamespace:r})}else e.includes(r)&&this.setStatus("disconnected",r);let c=this.getApprovedCaipNetworksData();this.syncConnectedWalletInfo(r),K.setApprovedCaipNetworksData(r,{approvedCaipNetworkIds:c.approvedCaipNetworkIds,supportsAllNetworks:c.supportsAllNetworks})});await Promise.all(t)}syncProvider({type:e,provider:t,id:r,chainNamespace:i}){Kt.setProviderId(i,e),Kt.setProvider(i,t),At.setConnectorId(r,i)}async syncAccount(e){let t=e.chainNamespace===K.state.activeChain,r=K.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:i,chainId:s,chainNamespace:o}=e,{chainId:a}=Ht.getActiveNetworkProps(),c=r?.id||a,l=K.state.activeCaipNetwork?.name===lt.UNSUPPORTED_NETWORK_NAME,u=K.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(g=>g.id.toString()===c.toString()),h=this.getCaipNetworks().find(g=>g.chainNamespace===o);if(!u&&!d&&!h){let g=this.getApprovedCaipNetworkIds()||[],m=g.find(E=>Ac.parseCaipNetworkId(E)?.chainId===c.toString()),y=g.find(E=>Ac.parseCaipNetworkId(E)?.chainNamespace===o);d=this.getCaipNetworks().find(E=>E.caipNetworkId===m),h=this.getCaipNetworks().find(E=>E.caipNetworkId===y||"deprecatedCaipNetworkId"in E&&E.deprecatedCaipNetworkId===y)}let f=d||h;f?.chainNamespace===K.state.activeChain?de.state.enableNetworkSwitch&&!de.state.allowUnsupportedChain&&K.state.activeCaipNetwork?.name===lt.UNSUPPORTED_NETWORK_NAME?K.showUnsupportedChainUI():this.setCaipNetwork(f):t||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);let p=this.getAddress(o);vE.isLowerCaseMatch(i,p)||this.syncAccountInfo(i,f?.id,o),t?await this.syncBalance({address:i,chainId:f?.id,chainNamespace:o}):await this.syncBalance({address:i,chainId:r?.id,chainNamespace:o}),this.syncIdentity({address:i,chainId:s,chainNamespace:o})}}async syncAccountInfo(e,t,r){let i=this.getCaipAddress(r),s=t||i?.split(":")[1];if(!s)return;let o=`${r}:${s}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:s,chainNamespace:r})}async syncReownName(e,t){try{let r=await this.getReownName(e);if(r[0]){let i=r[0];this.setProfileName(i.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){let t=At.getConnectorId(e),r=Kt.getProviderId(e);if(r===uo.CONNECTOR_TYPE_ANNOUNCED||r===uo.CONNECTOR_TYPE_INJECTED){if(t){let s=this.getConnectors().find(o=>{let a=o.id===t,c=o.info?.rdns===t,l=o.connectors?.some(u=>u.id===t||u.info?.rdns===t);return a||c||!!l});if(s){let{info:o,name:a,imageUrl:c}=s,l=c||this.getConnectorImage(s);this.setConnectedWalletInfo(H({name:a,icon:l},o),e)}}}else if(r===uo.CONNECTOR_TYPE_WALLET_CONNECT){let i=Kt.getProvider(e);i?.session&&this.setConnectedWalletInfo(ge(H({},i.session.peer.metadata),{name:i.session.peer.metadata.name,icon:i.session.peer.metadata.icons?.[0]}),e)}else if(t&&(t===lt.CONNECTOR_ID.COINBASE_SDK||t===lt.CONNECTOR_ID.COINBASE)){let i=this.getConnectors().find(c=>c.id===t),s=i?.name||"Coinbase Wallet",o=i?.imageUrl||this.getConnectorImage(i),a=i?.info;this.setConnectedWalletInfo(ge(H({},a),{name:s,icon:o}),e)}}async syncBalance(e){!nR.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>r.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,r){let i=this.getAdapter(r),s=K.getCaipNetworkByNamespace(r,t);if(i){let o=await i.getBalance({address:e,chainId:t,caipNetwork:s,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){let e=hR.createLogger((r,...i)=>{r&&this.handleAlertError(r),console.error(...i)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};de.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await K$.default.init(t),de.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Kg.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:t=>{zt.setUri(t)},onConnect:t=>{let{address:r}=dr.getAccount(t[0]);zt.finalizeWcConnection(r)},onDisconnect:()=>{K.state.noAdapters&&this.resetAccount(e),zt.resetWcConnection()},onChainChanged:t=>{let r=K.state.activeChain,i=r&&At.state.activeConnectorIds[r]===lt.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(K.state.noAdapters||i)){let s=this.getCaipNetworks().find(a=>a.id.toString()===t.toString()||a.caipNetworkId.toString()===t.toString()),o=this.getCaipNetwork();if(!s){this.setUnsupportedNetwork(t);return}o?.id.toString()!==s?.id.toString()&&o?.chainNamespace===s?.chainNamespace&&this.setCaipNetwork(s)}},onAccountsChanged:t=>{let r=K.state.activeChain,i=r&&At.state.activeConnectorIds[r]===lt.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(K.state.noAdapters||i)){let s=t?.[0];s&&this.syncAccount({address:s.address,chainId:s.chainId,chainNamespace:s.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&dr.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){na.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}getDisabledCaipNetworks(){let e=K.getAllApprovedCaipNetworkIds(),t=K.getAllRequestedCaipNetworks();return dr.sortRequestedNetworks(e,t).filter(i=>K.isCaipNetworkDisabled(i))}handleAlertError(e){let t=Object.entries(Mr.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,i]=t??[],{message:s,alertErrorKey:o}=i??{};if(r&&s&&!this.reportedAlertErrors[r]){let a=Mr.ALERT_ERRORS[o];a&&(hr.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;let t=e.namespace;if(!t)return;this.createClients();let r=e;r.namespace=t,r.construct({namespace:t,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:i})=>i===t)}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=r)}async open(e){await this.injectModalUi(),e?.uri&&zt.setUri(e.uri);let{isSwap:t,isSend:r}=this.toModalOptions();return t(e)?lo.open(ge(H({},e),{data:{swap:e.arguments}})):r(e)&&e.arguments?this.openSend(e.arguments):lo.open(e)}async close(){await this.injectModalUi(),lo.close()}setLoading(e,t){lo.setLoading(e,t)}async disconnect(e){await zt.disconnect({namespace:e})}getSIWX(){return de.state.siwx}getError(){return""}getChainId(){return K.state.activeCaipNetwork?.id}async switchNetwork(e,{throwOnFailure:t=!1}={}){let r=this.getCaipNetworks().find(i=>i.id===e.id);if(!r){hr.open(Mr.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await K.switchActiveNetwork(r,{throwOnFailure:t})}getWalletProvider(){return K.state.activeChain?Kt.state.providers[K.state.activeChain]:null}getWalletProviderType(){return Kt.getProviderId(K.state.activeChain)}subscribeProviders(e){return Kt.subscribeProviders(e)}getThemeMode(){return Us.state.themeMode}getThemeVariables(){return Us.state.themeVariables}setThemeMode(e){Us.setThemeMode(e),gR(Us.state.themeMode)}setTermsConditionsUrl(e){de.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){de.setPrivacyPolicyUrl(e)}setThemeVariables(e){Us.setThemeVariables(e),mR(Us.state.themeVariables)}subscribeTheme(e){return Us.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?zt.subscribe(e):(hr.open(lt.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?K.state.chains.get(e)?.accountState?.connectedWalletInfo:K.getAccountData()?.connectedWalletInfo}getAccount(e){let t=e||K.state.activeChain,r=At.getAuthConnector(t),i=K.getAccountData(t),s=Ht.getConnectedConnectorId(K.state.activeChain),o=zt.getConnections(t);if(!t)throw new Error("AppKit:getAccount - namespace is required");let a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>dr.createAccount(t,l,u||"eoa",d)));if(i)return{allAccounts:a,caipAddress:i.caipAddress,address:dr.getPlainAddress(i.caipAddress),isConnected:!!i.caipAddress,status:i.status,embeddedWalletInfo:r&&s===lt.CONNECTOR_ID.AUTH?{user:i.user?ge(H({},i.user),{username:Ht.getConnectedSocialUsername()}):void 0,authProvider:i.socialProvider||"email",accountType:gE(t),isSmartAccountDeployed:!!i.smartAccountDeployed}:void 0}}subscribeAccount(e,t){let r=()=>{let i=this.getAccount(t);i&&e(i)};t?K.subscribeChainProp("accountState",r,t):K.subscribe(r),At.subscribe(r)}subscribeNetwork(e){return K.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e,t){return t?K.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo),t):K.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){K.subscribeChainProp("accountState",t=>e(t?.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){K.subscribeKey("activeCaipNetwork",e)}getState(){return yE.state}getRemoteFeatures(){return de.state.remoteFeatures}subscribeState(e){return yE.subscribe(e)}subscribeRemoteFeatures(e){return de.subscribeKey("remoteFeatures",e)}showErrorMessage(e){fE.showError(e)}showSuccessMessage(e){fE.showSuccess(e)}getEvent(){return H({},na.state)}subscribeEvents(e){return na.subscribe(e)}replace(e){_c.replace(e)}redirect(e){_c.push(e)}popTransactionStack(e){_c.popTransactionStack(e)}isOpen(){return lo.state.open}isTransactionStackEmpty(){return _c.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){de.setFeatures(e)}updateRemoteFeatures(e){de.setRemoteFeatures(e)}updateOptions(e){let t=de.state||{},r=H(H({},t),e);de.setOptions(r)}setConnectMethodsOrder(e){de.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){de.setWalletFeaturesOrder(e)}setCollapseWallets(e){de.setCollapseWallets(e)}setSocialsOrder(e){de.setSocialsOrder(e)}getConnectMethodsOrder(){return pR.getConnectOrderMethod(de.state.features,At.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);let r=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(i=>i.id===r.id)||K.addNetwork(r)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(i=>i.id===t)&&K.removeNetwork(e,t)}}});var Y$,Ug,J$=ni(()=>{"use strict";Rh();Q$();Y$=!1,Ug=class extends eE{async open(e){At.isConnected()||await super.open(e)}async close(){if(await super.close(),this.options.manualWCControl){let e=K.getAccountData(this.activeChainNamespace)?.address;zt.finalizeWcConnection(e)}}async syncIdentity(e){return Promise.resolve()}async syncBalance(e){return Promise.resolve()}async injectModalUi(){if(!Y$&&dr.isClient()){if(await import("./chunk-KJKMARVB.js"),await import("./chunk-SSH6VHQK.js"),!document.querySelector("w3m-modal")){let t=document.createElement("w3m-modal");!de.state.disableAppend&&!de.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",t)}Y$=!0}}}});var Z$,X$=ni(()=>{"use strict";Z$="1.8.11"});var eq={};Nh(eq,{AppKit:()=>Ug,createAppKit:()=>Jve});function Jve(n){return new Ug(ge(H({},n),{basic:!0,sdkVersion:`html-core-${Z$}`}))}var tq=ni(()=>{"use strict";J$();X$()});var lq=Bs(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});var Zve=co(),Th=eg(),Xve=F4();function e0e(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}}),e.default=n,Object.freeze(e)}var t0e="wc",n0e="ethereum_provider",r0e=`${t0e}@2:${n0e}:`,i0e="https://rpc.walletconnect.org/v1/",nE=["eth_sendTransaction","personal_sign"],sq=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],rE=["chainChanged","accountsChanged"],oq=["chainChanged","accountsChanged","message","disconnect","connect"],s0e=async()=>{let{createAppKit:n}=await Promise.resolve().then(function(){return e0e((tq(),Fe(eq)))});return n},o0e=Object.defineProperty,a0e=Object.defineProperties,c0e=Object.getOwnPropertyDescriptors,nq=Object.getOwnPropertySymbols,l0e=Object.prototype.hasOwnProperty,u0e=Object.prototype.propertyIsEnumerable,RN=(n,e,t)=>e in n?o0e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,lu=(n,e)=>{for(var t in e||(e={}))l0e.call(e,t)&&RN(n,t,e[t]);if(nq)for(var t of nq(e))u0e.call(e,t)&&RN(n,t,e[t]);return n},jg=(n,e)=>a0e(n,c0e(e)),Ci=(n,e,t)=>RN(n,typeof e!="symbol"?e+"":e,t);function iE(n){return Number(n[0].split(":")[1])}function tE(n){return`0x${n.toString(16)}`}function d0e(n){let{chains:e,optionalChains:t,methods:r,optionalMethods:i,events:s,optionalEvents:o,rpcMap:a}=n;if(!Th.isValidArray(e))throw new Error("Invalid chains");let c={chains:e,methods:r||nE,events:s||rE,rpcMap:lu({},e.length?{[iE(e)]:a[iE(e)]}:{})},l=s?.filter(f=>!rE.includes(f)),u=r?.filter(f=>!nE.includes(f));if(!t&&!o&&!i&&!(l!=null&&l.length)&&!(u!=null&&u.length))return{required:e.length?c:void 0};let d=l?.length&&u?.length||!t,h={chains:[...new Set(d?c.chains.concat(t||[]):t)],methods:[...new Set(c.methods.concat(i!=null&&i.length?i:sq))],events:[...new Set(c.events.concat(o!=null&&o.length?o:oq))],rpcMap:a};return{required:e.length?c:void 0,optional:t.length?h:void 0}}var sE=class n{constructor(){Ci(this,"events",new Zve.EventEmitter),Ci(this,"namespace","eip155"),Ci(this,"accounts",[]),Ci(this,"signer"),Ci(this,"chainId",1),Ci(this,"modal"),Ci(this,"rpc"),Ci(this,"STORAGE_KEY",r0e),Ci(this,"on",(e,t)=>(this.events.on(e,t),this)),Ci(this,"once",(e,t)=>(this.events.once(e,t),this)),Ci(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),Ci(this,"off",(e,t)=>(this.events.off(e,t),this)),Ci(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){let t=new n;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,r){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),r)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){var t;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);let{required:r,optional:i}=d0e(this.rpc);try{let s=await new Promise(async(a,c)=>{var l,u;this.rpc.showQrModal&&((l=this.modal)==null||l.open(),(u=this.modal)==null||u.subscribeState(h=>{!h.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))}));let d=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(jg(lu({namespaces:lu({},r&&{[this.namespace]:r})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e?.pairingTopic,scopedProperties:d})).then(h=>{a(h)}).catch(h=>{var f;(f=this.modal)==null||f.showErrorMessage("Unable to connect"),c(new Error(h.message))})});if(!s)return;let o=Th.getAccountsFromNamespaces(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:tE(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{(t=this.modal)==null||t.close()}}async authenticate(e,t){var r;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e?.chains});try{let i=await new Promise(async(o,a)=>{var c,l;this.rpc.showQrModal&&((c=this.modal)==null||c.open(),(l=this.modal)==null||l.subscribeState(u=>{!u.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(jg(lu({},e),{chains:this.rpc.chains}),t).then(u=>{o(u)}).catch(u=>{var d;(d=this.modal)==null||d.showErrorMessage("Unable to connect"),a(new Error(u.message))})}),s=i.session;if(s){let o=Th.getAccountsFromNamespaces(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:tE(this.chainId)})}return i}catch(i){throw this.signer.logger.error(i),i}finally{(r=this.modal)==null||r.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{let{params:t}=e,{event:r}=t;r.name==="accountsChanged"?(this.accounts=this.parseAccounts(r.data),this.events.emit("accountsChanged",this.accounts)):r.name==="chainChanged"?this.setChainId(this.formatChainId(r.data)):this.events.emit(r.name,r.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{let t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",tE(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",jg(lu({},Th.getSdkError("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){let t=e.filter(r=>this.isCompatibleChainId(r)).map(r=>this.parseChainId(r));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",tE(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){let t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){let[t,r,i]=e.split(":");return{chainId:`${t}:${r}`,address:i}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,r;let i=(t=e?.chains)!=null?t:[],s=(r=e?.optionalChains)!=null?r:[],o=i.concat(s);if(!o.length)throw new Error("No chains specified in either `chains` or `optionalChains`");let a=i.length?e?.methods||nE:[],c=i.length?e?.events||rE:[],l=e?.optionalMethods||[],u=e?.optionalEvents||[],d=e?.rpcMap||this.buildRpcMap(o,e.projectId),h=e?.qrModalOptions||void 0;return{chains:i?.map(f=>this.formatChainId(f)),optionalChains:s.map(f=>this.formatChainId(f)),methods:a,events:c,optionalMethods:l,optionalEvents:u,rpcMap:d,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:h,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){let r={};return e.forEach(i=>{r[i]=this.getRpcUrl(i,t)}),r}async initialize(e){var t;if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?iE(this.rpc.chains):iE(this.rpc.optionalChains),this.signer=await Xve.UniversalProvider.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{let i=await s0e(),{convertWCMToAppKitOptions:s}=await Promise.resolve().then(function(){return I0e}),o=s(jg(lu({},this.rpc.qrModalOptions),{chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId}));if(!o.networks.length)throw new Error("No networks found for WalletConnect");r=i(jg(lu({},o),{universalProvider:this.signer,manualWCControl:!0,enableMobileFullScreen:((t=this.rpc.qrModalOptions)==null?void 0:t.enableMobileFullScreen)===!0}))}catch(i){throw console.warn(i),new Error("To use QR modal, please install @reown/appkit package")}if(r)try{this.modal=r}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;let{chains:t,optionalChains:r,rpcMap:i}=e;t&&Th.isValidArray(t)&&(this.rpc.chains=t.map(s=>this.formatChainId(s)),t.forEach(s=>{this.rpc.rpcMap[s]=i?.[s]||this.getRpcUrl(s)})),r&&Th.isValidArray(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=r?.map(s=>this.formatChainId(s)),r.forEach(s=>{this.rpc.rpcMap[s]=i?.[s]||this.getRpcUrl(s)}))}getRpcUrl(e,t){var r;return((r=this.rpc.rpcMap)==null?void 0:r[e])||`${i0e}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{let e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t?.accounts),this.setAccounts(t?.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}},h0e=sE,f0e=Object.defineProperty,p0e=Object.defineProperties,g0e=Object.getOwnPropertyDescriptors,rq=Object.getOwnPropertySymbols,m0e=Object.prototype.hasOwnProperty,y0e=Object.prototype.propertyIsEnumerable,iq=(n,e,t)=>e in n?f0e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,aq=(n,e)=>{for(var t in e||(e={}))m0e.call(e,t)&&iq(n,t,e[t]);if(rq)for(var t of rq(e))y0e.call(e,t)&&iq(n,t,e[t]);return n},w0e=(n,e)=>p0e(n,g0e(e));function v0e(n){if(n)return{"--w3m-font-family":n["--wcm-font-family"],"--w3m-accent":n["--wcm-accent-color"],"--w3m-color-mix":n["--wcm-background-color"],"--w3m-z-index":n["--wcm-z-index"]?Number(n["--wcm-z-index"]):void 0,"--w3m-qr-color":n["--wcm-accent-color"],"--w3m-font-size-master":n["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":n["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}var b0e=n=>{let[e,t]=n.split(":");return cq({id:t,caipNetworkId:n,chainNamespace:e,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function E0e(n){var e,t,r,i,s,o,a;let c=(e=n.chains)==null?void 0:e.map(b0e).filter(Boolean);if(c.length===0)throw new Error("At least one chain must be specified");let l=c.find(d=>{var h;return d.id===((h=n.defaultChain)==null?void 0:h.id)}),u={projectId:n.projectId,networks:c,themeMode:n.themeMode,themeVariables:v0e(n.themeVariables),chainImages:n.chainImages,connectorImages:n.walletImages,defaultNetwork:l,metadata:w0e(aq({},n.metadata),{name:((t=n.metadata)==null?void 0:t.name)||"WalletConnect",description:((r=n.metadata)==null?void 0:r.description)||"Connect to WalletConnect-compatible wallets",url:((i=n.metadata)==null?void 0:i.url)||"https://walletconnect.org",icons:((s=n.metadata)==null?void 0:s.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:n.explorerRecommendedWalletIds==="NONE"?[]:Array.isArray(n.explorerRecommendedWalletIds)?n.explorerRecommendedWalletIds:[],excludeWalletIds:n.explorerExcludedWalletIds==="ALL"?[]:Array.isArray(n.explorerExcludedWalletIds)?n.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if((o=n.mobileWallets)!=null&&o.length||(a=n.desktopWallets)!=null&&a.length){let d=[...(n.mobileWallets||[]).map(p=>({id:p.id,name:p.name,links:p.links})),...(n.desktopWallets||[]).map(p=>({id:p.id,name:p.name,links:{native:p.links.native,universal:p.links.universal}}))],h=[...u.featuredWalletIds||[],...u.excludeWalletIds||[]],f=d.filter(p=>!h.includes(p.id));f.length&&(u.customWallets=f)}return u}function cq(n){return aq({formatters:void 0,fees:void 0,serializers:void 0},n)}var I0e=Object.freeze({__proto__:null,convertWCMToAppKitOptions:E0e,defineChain:cq});Sc.EthereumProvider=h0e,Sc.OPTIONAL_EVENTS=oq,Sc.OPTIONAL_METHODS=sq,Sc.REQUIRED_EVENTS=rE,Sc.REQUIRED_METHODS=nE,Sc.default=sE});var zn=null,Yg=!1,EE=1,wq=null,Si=Symbol("SIGNAL");function _e(n){let e=zn;return zn=n,e}function Jg(){return zn}var Oh={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Zg(n){if(Yg)throw new Error("");if(zn===null)return;zn.consumerOnSignalRead(n);let e=zn.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=zn.recomputing;if(r&&(t=e!==void 0?e.nextProducer:zn.producers,t!==void 0&&t.producer===n)){zn.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===zn&&(!r||bq(i,zn)))return;let s=yu(zn),o={producer:n,consumer:zn,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};zn.producersTail=o,e!==void 0?e.nextProducer=o:zn.producers=o,s&&ER(n,o)}function yR(){EE++}function wR(n){if(!(yu(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===EE)){if(!n.producerMustRecompute(n)&&!Mh(n)){bE(n);return}n.producerRecomputeValue(n),bE(n)}}function IE(n){if(n.consumers===void 0)return;let e=Yg;Yg=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||vq(r)}}finally{Yg=e}}function CE(){return zn?.consumerAllowSignalWrites!==!1}function vq(n){n.dirty=!0,IE(n),n.consumerMarkedDirty?.(n)}function bE(n){n.dirty=!1,n.lastCleanEpoch=EE}function Ph(n){return n&&vR(n),_e(n)}function vR(n){n.producersTail=void 0,n.recomputing=!0}function Xg(n,e){_e(e),n&&bR(n)}function bR(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(yu(n))do t=SE(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Mh(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(wR(t),r!==t.version))return!0}return!1}function Tc(n){if(yu(n)){let e=n.producers;for(;e!==void 0;)e=SE(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function ER(n,e){let t=n.consumersTail,r=yu(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)ER(i.producer,i)}function SE(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!yu(e)){let s=e.producers;for(;s!==void 0;)s=SE(s)}return t}function yu(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function IR(n){wq?.(n)}function bq(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function CR(n,e){return Object.is(n,e)}function Eq(){throw new Error}var SR=Eq;function AR(n){SR(n)}function AE(n){SR=n}var Iq=null;function _E(n,e){let t=Object.create(em);t.value=n,e!==void 0&&(t.equal=e);let r=()=>_R(t);return r[Si]=t,IR(t),[r,o=>kh(t,o),o=>TR(t,o)]}function _R(n){return Zg(n),n.value}function kh(n,e){CE()||AR(n),n.equal(n.value,e)||(n.value=e,Cq(n))}function TR(n,e){CE()||AR(n),kh(n,e(n.value))}var em=ge(H({},Oh),{equal:CR,value:void 0,kind:"signal"});function Cq(n){n.version++,yR(),IE(n),Iq?.(n)}function TE(n){let e=_e(null);try{return n()}finally{_e(e)}}var xE=ge(H({},Oh),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function DE(n){if(n.dirty=!1,n.version>0&&!Mh(n))return;n.version++;let e=Ph(n);try{n.cleanup(),n.fn()}finally{Xg(n,e)}}function Le(n){return typeof n=="function"}function wu(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var tm=wu(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Lh(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Mn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Le(r))try{r()}catch(s){e=s instanceof tm?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{xR(s)}catch(o){e=e??[],o instanceof tm?e=[...e,...o.errors]:e.push(o)}}if(e)throw new tm(e)}}add(e){var t;if(e&&e!==this)if(this.closed)xR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Lh(t,e)}remove(e){let{_finalizers:t}=this;t&&Lh(t,e),e instanceof n&&e._removeParent(this)}};Mn.EMPTY=(()=>{let n=new Mn;return n.closed=!0,n})();var NE=Mn.EMPTY;function nm(n){return n instanceof Mn||n&&"closed"in n&&Le(n.remove)&&Le(n.add)&&Le(n.unsubscribe)}function xR(n){Le(n)?n():n.unsubscribe()}var Xi={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var vu={setTimeout(n,e,...t){let{delegate:r}=vu;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=vu;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function rm(n){vu.setTimeout(()=>{let{onUnhandledError:e}=Xi;if(e)e(n);else throw n})}function Fh(){}var DR=RE("C",void 0,void 0);function NR(n){return RE("E",void 0,n)}function RR(n){return RE("N",n,void 0)}function RE(n,e,t){return{kind:n,value:e,error:t}}var xc=null;function bu(n){if(Xi.useDeprecatedSynchronousErrorHandling){let e=!xc;if(e&&(xc={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=xc;if(xc=null,t)throw r}}else n()}function OR(n){Xi.useDeprecatedSynchronousErrorHandling&&xc&&(xc.errorThrown=!0,xc.error=n)}var Dc=class extends Mn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,nm(e)&&e.add(this)):this.destination=_q}static create(e,t,r){return new Eu(e,t,r)}next(e){this.isStopped?PE(RR(e),this):this._next(e)}error(e){this.isStopped?PE(NR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?PE(DR,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Sq=Function.prototype.bind;function OE(n,e){return Sq.call(n,e)}var ME=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){im(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){im(r)}else im(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){im(t)}}},Eu=class extends Dc{constructor(e,t,r){super();let i;if(Le(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Xi.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&OE(e.next,s),error:e.error&&OE(e.error,s),complete:e.complete&&OE(e.complete,s)}):i=e}this.destination=new ME(i)}};function im(n){Xi.useDeprecatedSynchronousErrorHandling?OR(n):rm(n)}function Aq(n){throw n}function PE(n,e){let{onStoppedNotification:t}=Xi;t&&vu.setTimeout(()=>t(n,e))}var _q={closed:!0,next:Fh,error:Aq,complete:Fh};var Iu=typeof Symbol=="function"&&Symbol.observable||"@@observable";function es(n){return n}function kE(...n){return LE(n)}function LE(n){return n.length===0?es:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ut=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=xq(t)?t:new Eu(t,r,i);return bu(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=PR(r),new r((i,s)=>{let o=new Eu({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Iu](){return this}pipe(...t){return LE(t)(this)}toPromise(t){return t=PR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function PR(n){var e;return(e=n??Xi.Promise)!==null&&e!==void 0?e:Promise}function Tq(n){return n&&Le(n.next)&&Le(n.error)&&Le(n.complete)}function xq(n){return n&&n instanceof Dc||Tq(n)&&nm(n)}function Dq(n){return Le(n?.lift)}function ft(n){return e=>{if(Dq(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function _t(n,e,t,r,i){return new FE(n,e,t,r,i)}var FE=class extends Dc{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var MR=wu(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Gn=(()=>{class n extends ut{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new sm(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new MR}next(t){bu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){bu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){bu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?NE:(this.currentObservers=null,s.push(t),new Mn(()=>{this.currentObservers=null,Lh(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new ut;return t.source=this,t}}return n.create=(e,t)=>new sm(e,t),n})(),sm=class extends Gn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:NE}};var kn=class extends Gn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var kr=new ut(n=>n.complete());function kR(n){return n&&Le(n.schedule)}function LR(n){return n[n.length-1]}function FR(n){return Le(LR(n))?n.pop():void 0}function ra(n){return kR(LR(n))?n.pop():void 0}function UR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function BR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nc(n){return this instanceof Nc?(this.v=n,this):new Nc(n)}function jR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){r[f]&&(i[f]=function(g){return new Promise(function(m,y){s.push([f,g,m,y])>1||c(f,g)})},p&&(i[f]=p(i[f])))}function c(f,p){try{l(r[f](p))}catch(g){h(s[0][3],g)}}function l(f){f.value instanceof Nc?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}function VR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof BR=="function"?BR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var om=n=>n&&typeof n.length=="number"&&typeof n!="function";function am(n){return Le(n?.then)}function cm(n){return Le(n[Iu])}function lm(n){return Symbol.asyncIterator&&Le(n?.[Symbol.asyncIterator])}function um(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Nq(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var dm=Nq();function hm(n){return Le(n?.[dm])}function fm(n){return jR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Nc(t.read());if(i)return yield Nc(void 0);yield yield Nc(r)}}finally{t.releaseLock()}})}function pm(n){return Le(n?.getReader)}function In(n){if(n instanceof ut)return n;if(n!=null){if(cm(n))return Rq(n);if(om(n))return Oq(n);if(am(n))return Pq(n);if(lm(n))return HR(n);if(hm(n))return Mq(n);if(pm(n))return kq(n)}throw um(n)}function Rq(n){return new ut(e=>{let t=n[Iu]();if(Le(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Oq(n){return new ut(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Pq(n){return new ut(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,rm)})}function Mq(n){return new ut(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function HR(n){return new ut(e=>{Lq(n,e).catch(t=>e.error(t))})}function kq(n){return HR(fm(n))}function Lq(n,e){var t,r,i,s;return UR(this,void 0,void 0,function*(){try{for(t=VR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function Lr(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function gm(n,e=0){return ft((t,r)=>{t.subscribe(_t(r,i=>Lr(r,n,()=>r.next(i),e),()=>Lr(r,n,()=>r.complete(),e),i=>Lr(r,n,()=>r.error(i),e)))})}function mm(n,e=0){return ft((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function $R(n,e){return In(n).pipe(mm(e),gm(e))}function qR(n,e){return In(n).pipe(mm(e),gm(e))}function zR(n,e){return new ut(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function GR(n,e){return new ut(t=>{let r;return Lr(t,e,()=>{r=n[dm](),Lr(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>Le(r?.return)&&r.return()})}function ym(n,e){if(!n)throw new Error("Iterable cannot be null");return new ut(t=>{Lr(t,e,()=>{let r=n[Symbol.asyncIterator]();Lr(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function WR(n,e){return ym(fm(n),e)}function KR(n,e){if(n!=null){if(cm(n))return $R(n,e);if(om(n))return zR(n,e);if(am(n))return qR(n,e);if(lm(n))return ym(n,e);if(hm(n))return GR(n,e);if(pm(n))return WR(n,e)}throw um(n)}function Cn(n,e){return e?KR(n,e):In(n)}function Ge(...n){let e=ra(n);return Cn(n,e)}function BE(n,e){let t=Le(n)?n:()=>n,r=i=>i.error(t());return new ut(e?i=>e.schedule(r,0,i):r)}function wm(n){return!!n&&(n instanceof ut||Le(n.lift)&&Le(n.subscribe))}var Rc=wu(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function $t(n,e){return ft((t,r)=>{let i=0;t.subscribe(_t(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:Fq}=Array;function Bq(n,e){return Fq(e)?n(...e):n(e)}function QR(n){return $t(e=>Bq(n,e))}var{isArray:Uq}=Array,{getPrototypeOf:jq,prototype:Vq,keys:Hq}=Object;function YR(n){if(n.length===1){let e=n[0];if(Uq(e))return{args:e,keys:null};if($q(e)){let t=Hq(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function $q(n){return n&&typeof n=="object"&&jq(n)===Vq}function JR(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function UE(...n){let e=ra(n),t=FR(n),{args:r,keys:i}=YR(n);if(r.length===0)return Cn([],e);let s=new ut(qq(r,e,i?o=>JR(i,o):es));return t?s.pipe(QR(t)):s}function qq(n,e,t=es){return r=>{ZR(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)ZR(e,()=>{let l=Cn(n[c],e),u=!1;l.subscribe(_t(r,d=>{s[c]=d,u||(u=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function ZR(n,e,t){n?Lr(t,n,e):e()}function XR(n,e,t,r,i,s,o,a){let c=[],l=0,u=0,d=!1,h=()=>{d&&!c.length&&!l&&e.complete()},f=g=>l<r?p(g):c.push(g),p=g=>{s&&e.next(g),l++;let m=!1;In(t(g,u++)).subscribe(_t(e,y=>{i?.(y),s?f(y):e.next(y)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<r;){let y=c.shift();o?Lr(e,o,()=>p(y)):p(y)}h()}catch(y){e.error(y)}}))};return n.subscribe(_t(e,f,()=>{d=!0,h()})),()=>{a?.()}}function fr(n,e,t=1/0){return Le(e)?fr((r,i)=>$t((s,o)=>e(r,s,i,o))(In(n(r,i))),t):(typeof e=="number"&&(t=e),ft((r,i)=>XR(r,i,n,t)))}function eO(n=1/0){return fr(es,n)}function tO(){return eO(1)}function Cu(...n){return tO()(Cn(n,ra(n)))}function Bh(n){return new ut(e=>{In(n()).subscribe(e)})}function js(n,e){return ft((t,r)=>{let i=0;t.subscribe(_t(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Uh(n){return ft((e,t)=>{let r=null,i=!1,s;r=e.subscribe(_t(t,void 0,void 0,o=>{s=In(n(o,Uh(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function vm(n,e){return Le(e)?fr(n,e,1):fr(n,1)}function jE(n){return ft((e,t)=>{let r=!1;e.subscribe(_t(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function ho(n){return n<=0?()=>kr:ft((e,t)=>{let r=0;e.subscribe(_t(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function nO(n=zq){return ft((e,t)=>{let r=!1;e.subscribe(_t(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function zq(){return new Rc}function VE(n){return ft((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function fo(n,e){let t=arguments.length>=2;return r=>r.pipe(n?js((i,s)=>n(i,s,r)):es,ho(1),t?jE(e):nO(()=>new Rc))}function bm(n){return n<=0?()=>kr:ft((e,t)=>{let r=[];e.subscribe(_t(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function HE(...n){let e=ra(n);return ft((t,r)=>{(e?Cu(n,t,e):Cu(n,t)).subscribe(r)})}function Vs(n,e){return ft((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(_t(r,c=>{i?.unsubscribe();let l=0,u=s++;In(n(c,u)).subscribe(i=_t(r,d=>r.next(e?e(c,d,u,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function jh(n){return ft((e,t)=>{In(n).subscribe(_t(t,()=>t.complete(),Fh)),!t.closed&&e.subscribe(t)})}function pr(n,e,t){let r=Le(n)||e||t?{next:n,error:e,complete:t}:n;return r?ft((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(_t(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):es}var $E;function Em(){return $E}function Hs(n){let e=$E;return $E=n,e}var rO=Symbol("NotFound");function Su(n){return n===rO||n?.name==="\u0275NotFound"}var nI="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",he=class extends Error{code;constructor(e,t){super(_u(e,t)),this.code=e}};function Wq(n){return`NG0${Math.abs(n)}`}function _u(n,e){return`${Wq(n)}${e?": "+e:""}`}var Lc=globalThis;function pt(n){for(let e in n)if(n[e]===pt)return e;throw Error("")}function go(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(go).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function rI(n,e){return n?e?`${n} ${e}`:n:e||""}var Kq=pt({__forward_ref__:pt});function xm(n){return n.__forward_ref__=xm,n.toString=function(){return go(this())},n}function Fr(n){return iI(n)?n():n}function iI(n){return typeof n=="function"&&n.hasOwnProperty(Kq)&&n.__forward_ref__===xm}function Se(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Tu(n){return{providers:n.providers||[],imports:n.imports||[]}}function Kh(n){return Qq(n,Dm)}function sI(n){return Kh(n)!==null}function Qq(n,e){return n.hasOwnProperty(e)&&n[e]||null}function Yq(n){let e=n?.[Dm]??null;return e||null}function zE(n){return n&&n.hasOwnProperty(Cm)?n[Cm]:null}var Dm=pt({\u0275prov:pt}),Cm=pt({\u0275inj:pt}),Te=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Se({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function oI(n){return n&&!!n.\u0275providers}var aI=pt({\u0275cmp:pt}),cI=pt({\u0275dir:pt}),lI=pt({\u0275pipe:pt}),uI=pt({\u0275mod:pt}),Hh=pt({\u0275fac:pt}),Fc=pt({__NG_ELEMENT_ID__:pt}),iO=pt({__NG_ENV_ID__:pt});function Qh(n){return typeof n=="string"?n:n==null?"":String(n)}function cO(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Qh(n)}var lO=pt({ngErrorCode:pt}),Jq=pt({ngErrorMessage:pt}),Zq=pt({ngTokenPath:pt});function dI(n,e){return uO("",-200,e)}function Nm(n,e){throw new he(-201,!1)}function uO(n,e,t){let r=new he(e,n);return r[lO]=e,r[Jq]=n,t&&(r[Zq]=t),r}function Xq(n){return n[lO]}var GE;function dO(){return GE}function gr(n){let e=GE;return GE=n,e}function hI(n,e,t){let r=Kh(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;Nm(n,"Injector")}var e9={},Oc=e9,t9="__NG_DI_FLAG__",WE=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=Pc(t)||0;try{return this.injector.get(e,r&8?null:Oc,r)}catch(i){if(Su(i))return i;throw i}}};function n9(n,e=0){let t=Em();if(t===void 0)throw new he(-203,!1);if(t===null)return hI(n,void 0,e);{let r=r9(e),i=t.retrieve(n,r);if(Su(i)){if(r.optional)return null;throw i}return i}}function Ue(n,e=0){return(dO()||n9)(Fr(n),e)}function X(n,e){return Ue(n,Pc(e))}function Pc(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function r9(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function KE(n){let e=[];for(let t=0;t<n.length;t++){let r=Fr(n[t]);if(Array.isArray(r)){if(r.length===0)throw new he(900,!1);let i,s=0;for(let o=0;o<r.length;o++){let a=r[o],c=i9(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(Ue(i,s))}else e.push(Ue(r))}return e}function i9(n){return n[t9]}function ia(n,e){let t=n.hasOwnProperty(Hh);return t?n[Hh]:null}function Rm(n,e){n.forEach(t=>Array.isArray(t)?Rm(t,e):e(t))}function fI(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Yh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function hO(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function fO(n,e,t){let r=xu(n,e);return r>=0?n[r|1]=t:(r=~r,hO(n,r,e,t)),r}function Om(n,e){let t=xu(n,e);if(t>=0)return n[t|1]}function xu(n,e){return s9(n,e,1)}function s9(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var Bc={},Ai=[],Uc=new Te(""),pI=new Te("",-1),gI=new Te(""),$h=class{get(e,t=Oc){if(t===Oc){let i=uO("",-201);throw i.name="\u0275NotFound",i}return t}};function mI(n){return n[uI]||null}function aa(n){return n[aI]||null}function yI(n){return n[cI]||null}function pO(n){return n[lI]||null}function jc(n){return{\u0275providers:n}}function gO(n){return jc([{provide:Uc,multi:!0,useValue:n}])}function mO(...n){return{\u0275providers:wI(!0,n),\u0275fromNgModule:!0}}function wI(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Rm(e,o=>{let a=o;Sm(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&yO(i,s),t}function yO(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];vI(i,s=>{e(s,r)})}}function Sm(n,e,t,r){if(n=Fr(n),!n)return!1;let i=null,s=zE(n),o=!s&&aa(n);if(!s&&!o){let c=n.ngModule;if(s=zE(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Sm(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Rm(s.imports,u=>{Sm(u,e,t,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&yO(l,e)}if(!a){let l=ia(i)||(()=>new i);e({provide:i,useFactory:l,deps:Ai},i),e({provide:gI,useValue:i,multi:!0},i),e({provide:Uc,useValue:()=>Ue(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;vI(c,u=>{e(u,l)})}}else return!1;return i!==n&&n.providers!==void 0}function vI(n,e){for(let t of n)oI(t)&&(t=t.\u0275providers),Array.isArray(t)?vI(t,e):e(t)}var o9=pt({provide:String,useValue:pt});function wO(n){return n!==null&&typeof n=="object"&&o9 in n}function a9(n){return!!(n&&n.useExisting)}function c9(n){return!!(n&&n.useFactory)}function Am(n){return typeof n=="function"}var Jh=new Te(""),Im={},sO={},qE;function Zh(){return qE===void 0&&(qE=new $h),qE}var Wn=class{},Mc=class extends Wn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,YE(e,o=>this.processProvider(o)),this.records.set(pI,Au(void 0,this)),i.has("environment")&&this.records.set(Wn,Au(void 0,this));let s=this.records.get(Jh);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(gI,Ai,{self:!0}))}retrieve(e,t){let r=Pc(t)||0;try{return this.get(e,Oc,r)}catch(i){if(Su(i))return i;throw i}}destroy(){Vh(this),this._destroyed=!0;let e=_e(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),_e(e)}}onDestroy(e){return Vh(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Vh(this);let t=Hs(this),r=gr(void 0),i;try{return e()}finally{Hs(t),gr(r)}}get(e,t=Oc,r){if(Vh(this),e.hasOwnProperty(iO))return e[iO](this);let i=Pc(r),s,o=Hs(this),a=gr(void 0);try{if(!(i&4)){let l=this.records.get(e);if(l===void 0){let u=f9(e)&&Kh(e);u&&this.injectableDefInScope(u)?l=Au(QE(e),Im):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,i)}let c=i&2?Zh():this.parent;return t=i&8&&t===Oc?null:t,c.get(e,t)}catch(c){let l=Xq(c);throw l===-200||l===-201?new he(l,null):c}finally{gr(a),Hs(o)}}resolveInjectorInitializers(){let e=_e(null),t=Hs(this),r=gr(void 0),i;try{let s=this.get(Uc,Ai,{self:!0});for(let o of s)o()}finally{Hs(t),gr(r),_e(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(go(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Fr(e);let t=Am(e)?e:Fr(e&&e.provide),r=u9(e);if(!Am(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Au(void 0,Im,!0),i.factory=()=>KE(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=_e(null);try{if(t.value===sO)throw dI(go(e));return t.value===Im&&(t.value=sO,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&h9(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{_e(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Fr(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function QE(n){let e=Kh(n),t=e!==null?e.factory:ia(n);if(t!==null)return t;if(n instanceof Te)throw new he(204,!1);if(n instanceof Function)return l9(n);throw new he(204,!1)}function l9(n){if(n.length>0)throw new he(204,!1);let t=Yq(n);return t!==null?()=>t.factory(n):()=>new n}function u9(n){if(wO(n))return Au(void 0,n.useValue);{let e=vO(n);return Au(e,Im)}}function vO(n,e,t){let r;if(Am(n)){let i=Fr(n);return ia(i)||QE(i)}else if(wO(n))r=()=>Fr(n.useValue);else if(c9(n))r=()=>n.useFactory(...KE(n.deps||[]));else if(a9(n))r=(i,s)=>Ue(Fr(n.useExisting),s!==void 0&&s&8?8:void 0);else{let i=Fr(n&&(n.useClass||n.provide));if(d9(n))r=()=>new i(...KE(n.deps));else return ia(i)||QE(i)}return r}function Vh(n){if(n.destroyed)throw new he(205,!1)}function Au(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function d9(n){return!!n.deps}function h9(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function f9(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function YE(n,e){for(let t of n)Array.isArray(t)?YE(t,e):t&&oI(t)?YE(t.\u0275providers,e):e(t)}function yr(n,e){let t;n instanceof Mc?(Vh(n),t=n):t=new WE(n);let r,i=Hs(t),s=gr(void 0);try{return e()}finally{Hs(i),gr(s)}}function bO(){return dO()!==void 0||Em()!=null}var ns=0,xe=1,Oe=2,Sn=3,_i=4,Ti=5,Du=6,Nu=7,tn=8,yo=9,wo=10,Qt=11,Ru=12,bI=13,Vc=14,ii=15,Hc=16,$c=17,qc=18,Xh=19,EI=20,po=21,Pm=22,sa=23,si=24,Mm=25,zc=26,nn=27,EO=1,II=6,ca=7,ef=8,tf=9,rn=10;function vo(n){return Array.isArray(n)&&typeof n[EO]=="object"}function rs(n){return Array.isArray(n)&&n[EO]===!0}function CI(n){return(n.flags&4)!==0}function la(n){return n.componentOffset>-1}function Ou(n){return(n.flags&1)===1}function Gc(n){return!!n.template}function Pu(n){return(n[Oe]&512)!==0}function Wc(n){return(n[Oe]&256)===256}var SI="svg",IO="math";function xi(n){for(;Array.isArray(n);)n=n[ns];return n}function AI(n,e){return xi(e[n])}function $s(n,e){return xi(e[n.index])}function nf(n,e){return n.data[e]}function CO(n,e){return n[e]}function _I(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function is(n,e){let t=e[n];return vo(t)?t:t[ns]}function km(n){return(n[Oe]&128)===128}function SO(n){return rs(n[Sn])}function Di(n,e){return e==null?null:n[e]}function TI(n){n[$c]=0}function xI(n){n[Oe]&1024||(n[Oe]|=1024,km(n)&&Mu(n))}function AO(n,e){for(;n>0;)e=e[Vc],n--;return e}function rf(n){return!!(n[Oe]&9216||n[si]?.dirty)}function Lm(n){n[wo].changeDetectionScheduler?.notify(8),n[Oe]&64&&(n[Oe]|=1024),rf(n)&&Mu(n)}function Mu(n){n[wo].changeDetectionScheduler?.notify(0);let e=oa(n);for(;e!==null&&!(e[Oe]&8192||(e[Oe]|=8192,!km(e)));)e=oa(e)}function DI(n,e){if(Wc(n))throw new he(911,!1);n[po]===null&&(n[po]=[]),n[po].push(e)}function _O(n,e){if(n[po]===null)return;let t=n[po].indexOf(e);t!==-1&&n[po].splice(t,1)}function oa(n){let e=n[Sn];return rs(e)?e[Sn]:e}function TO(n){return n[Nu]??=[]}function xO(n){return n.cleanup??=[]}var je={lFrame:HO(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var JE=!1;function DO(){return je.lFrame.elementDepthCount}function NO(){je.lFrame.elementDepthCount++}function NI(){je.lFrame.elementDepthCount--}function Fm(){return je.bindingsEnabled}function RO(){return je.skipHydrationRootTNode!==null}function RI(n){return je.skipHydrationRootTNode===n}function OI(){je.skipHydrationRootTNode=null}function Xe(){return je.lFrame.lView}function wr(){return je.lFrame.tView}function pn(n){return je.lFrame.contextLView=n,n[tn]}function gn(n){return je.lFrame.contextLView=null,n}function Br(){let n=PI();for(;n!==null&&n.type===64;)n=n.parent;return n}function PI(){return je.lFrame.currentTNode}function OO(){let n=je.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ku(n,e){let t=je.lFrame;t.currentTNode=n,t.isParent=e}function MI(){return je.lFrame.isParent}function PO(){je.lFrame.isParent=!1}function kI(){return JE}function qh(n){let e=JE;return JE=n,e}function MO(){let n=je.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function kO(){return je.lFrame.bindingIndex}function LO(n){return je.lFrame.bindingIndex=n}function Lu(){return je.lFrame.bindingIndex++}function LI(n){let e=je.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function FO(){return je.lFrame.inI18n}function BO(n,e){let t=je.lFrame;t.bindingIndex=t.bindingRootIndex=n,Bm(e)}function UO(){return je.lFrame.currentDirectiveIndex}function Bm(n){je.lFrame.currentDirectiveIndex=n}function jO(n){let e=je.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function FI(n){je.lFrame.currentQueryIndex=n}function p9(n){let e=n[xe];return e.type===2?e.declTNode:e.type===1?n[Ti]:null}function BI(n,e,t){if(t&4){let i=e,s=n;for(;i=i.parent,i===null&&!(t&1);)if(i=p9(s),i===null||(s=s[Vc],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=je.lFrame=VO();return r.currentTNode=e,r.lView=n,!0}function Um(n){let e=VO(),t=n[xe];je.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function VO(){let n=je.lFrame,e=n===null?null:n.child;return e===null?HO(n):e}function HO(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function $O(){let n=je.lFrame;return je.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var UI=$O;function jm(){let n=$O();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function qO(n){return(je.lFrame.contextLView=AO(n,je.lFrame.contextLView))[tn]}function bo(){return je.lFrame.selectedIndex}function ua(n){je.lFrame.selectedIndex=n}function jI(){let n=je.lFrame;return nf(n.tView,n.selectedIndex)}function ss(){je.lFrame.currentNamespace=SI}function qs(){g9()}function g9(){je.lFrame.currentNamespace=null}function zO(){return je.lFrame.currentNamespace}var GO=!0;function Vm(){return GO}function sf(n){GO=n}function ZE(n,e=null,t=null,r){let i=VI(n,e,t,r);return i.resolveInjectorInitializers(),i}function VI(n,e=null,t=null,r,i=new Set){let s=[t||Ai,mO(n)];return r=r||(typeof n=="object"?void 0:go(n)),new Mc(s,e||Zh(),r||null,i)}var ts=class n{static THROW_IF_NOT_FOUND=Oc;static NULL=new $h;static create(e,t){if(Array.isArray(e))return ZE({name:""},t,e,"");{let r=e.name??"";return ZE({name:r},e.parent,e.providers,r)}}static \u0275prov=Se({token:n,providedIn:"any",factory:()=>Ue(pI)});static __NG_ELEMENT_ID__=-1},Kn=new Te(""),da=(()=>{class n{static __NG_ELEMENT_ID__=m9;static __NG_ENV_ID__=t=>t}return n})(),_m=class extends da{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Wc(this._lView)}onDestroy(e){let t=this._lView;return DI(t,e),()=>_O(t,e)}};function m9(){return new _m(Xe())}var WO=!1,ha=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new kn(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new ut(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Se({token:n,providedIn:"root",factory:()=>new n})}return n})(),XE=class extends Gn{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,bO()&&(this.destroyRef=X(da,{optional:!0})??void 0,this.pendingTasks=X(ha,{optional:!0})??void 0)}emit(e){let t=_e(null);try{super.next(e)}finally{_e(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Mn&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},mr=XE;function zh(...n){}function HI(n){let e,t;function r(){n=zh;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function $I(n){return queueMicrotask(()=>n()),()=>{n=zh}}var qI="isAngularZone",Gh=qI+"_ID",y9=0,ri=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new mr(!1);onMicrotaskEmpty=new mr(!1);onStable=new mr(!1);onError=new mr(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=WO}=e;if(typeof Zone>"u")throw new he(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,b9(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(qI)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new he(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new he(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,w9,zh,zh);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},w9={};function zI(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function v9(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){HI(()=>{n.callbackScheduled=!1,eI(n),n.isCheckStableRunning=!0,zI(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),eI(n)}function b9(n){let e=()=>{v9(n)},t=y9++;n._inner=n._inner.fork({name:"angular",properties:{[qI]:!0,[Gh]:t,[Gh+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(E9(c))return r.invokeTask(s,o,a,c);try{return oO(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),aO(n)}},onInvoke:(r,i,s,o,a,c,l)=>{try{return oO(n),r.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!I9(c)&&e(),aO(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,eI(n),zI(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function eI(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function oO(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function aO(n){n._nesting--,zI(n)}var Wh=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new mr;onMicrotaskEmpty=new mr;onStable=new mr;onError=new mr;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function E9(n){return KO(n,"__ignore_ng_zone__")}function I9(n){return KO(n,"__scheduler_tick__")}function KO(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var mo=class{_console=console;handleError(e){this._console.error("ERROR",e)}},os=new Te("",{factory:()=>{let n=X(ri),e=X(Wn),t;return r=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw r}):(t??=e.get(mo),t.handleError(r))})}}}),QO={provide:Uc,useValue:()=>{let n=X(mo,{optional:!0})},multi:!0},C9=new Te("",{factory:()=>{let n=X(Kn).defaultView;if(!n)return;let e=X(os),t=s=>{e(s.reason),s.preventDefault()},r=s=>{s.error?e(s.error):e(new Error(s.message,{cause:s})),s.preventDefault()},i=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",r)};typeof Zone<"u"?Zone.root.run(i):i(),X(da).onDestroy(()=>{n.removeEventListener("error",r),n.removeEventListener("unhandledrejection",t)})}});function GI(){return jc([gO(()=>void X(C9))])}function gt(n,e){let[t,r,i]=_E(n,e?.equal),s=t,o=s[Si];return s.set=r,s.update=i,s.asReadonly=YO.bind(s),s}function YO(){let n=this[Si];if(n.readonlyFn===void 0){let e=()=>this();e[Si]=n,n.readonlyFn=e}return n.readonlyFn}var Hm=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=S9}return n})();function S9(){return new Hm(Xe(),Br())}var kc=class{},of=new Te("",{factory:()=>!0});var WI=new Te("");var $m=(()=>{class n{static \u0275prov=Se({token:n,providedIn:"root",factory:()=>new tI})}return n})(),tI=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},Tm=class{[Si];constructor(e){this[Si]=e}destroy(){this[Si].destroy()}};function Kc(n,e){let t=e?.injector??X(ts),r=e?.manualCleanup!==!0?t.get(da):null,i,s=t.get(Hm,null,{optional:!0}),o=t.get(kc);return s!==null?(i=T9(s.view,o,n),r instanceof _m&&r._lView===s.view&&(r=null)):i=x9(n,t.get($m),o),i.injector=t,r!==null&&(i.onDestroyFn=r.onDestroy(()=>i.destroy())),new Tm(i)}var JO=ge(H({},xE),{cleanupFns:void 0,zone:null,onDestroyFn:zh,run(){let n=qh(!1);try{DE(this)}finally{qh(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=_e(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],_e(n)}}}),A9=ge(H({},JO),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){Tc(this),this.onDestroyFn(),this.cleanup(),this.scheduler.remove(this)}}),_9=ge(H({},JO),{consumerMarkedDirty(){this.view[Oe]|=8192,Mu(this.view),this.notifier.notify(13)},destroy(){Tc(this),this.onDestroyFn(),this.cleanup(),this.view[sa]?.delete(this)}});function T9(n,e,t){let r=Object.create(_9);return r.view=n,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=ZO(r,t),n[sa]??=new Set,n[sa].add(r),r.consumerMarkedDirty(r),r}function x9(n,e,t){let r=Object.create(A9);return r.fn=ZO(r,n),r.scheduler=e,r.notifier=t,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}function ZO(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}function zs(n){return TE(n)}function mf(n){return{toString:n}.toString()}function k9(n){return typeof n=="function"}function _P(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Qm=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}},uy=(()=>{let n=()=>TP;return n.ngInherit=!0,n})();function TP(n){return n.type.prototype.ngOnChanges&&(n.setInput=F9),L9}function L9(){let n=DP(this),e=n?.current;if(e){let t=n.previous;if(t===Bc)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function F9(n,e,t,r,i){let s=this.declaredInputs[r],o=DP(n)||B9(n,{previous:Bc,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Qm(l&&l.currentValue,t,c===Bc),_P(n,e,i,t)}var xP="__ngSimpleChanges__";function DP(n){return n[xP]||null}function B9(n,e){return n[xP]=e}var XO=[];var Dt=function(n,e=null,t){for(let r=0;r<XO.length;r++){let i=XO[r];i(n,e,t)}};function U9(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=TP(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function NP(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),u!=null&&(n.destroyHooks??=[]).push(t,u)}}function zm(n,e,t){RP(n,e,3,t)}function Gm(n,e,t,r){(n[Oe]&3)===t&&RP(n,e,t,r)}function KI(n,e){let t=n[Oe];(t&3)===e&&(t&=16383,t+=1,n[Oe]=t)}function RP(n,e,t,r){let i=r!==void 0?n[$c]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[$c]+=65536),(a<s||s==-1)&&(j9(n,t,e,c),n[$c]=(n[$c]&4294901760)+c+2),c++}function eP(n,e){Dt(4,n,e);let t=_e(null);try{e.call(n)}finally{_e(t),Dt(5,n,e)}}function j9(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[Oe]>>14<n[$c]>>16&&(n[Oe]&3)===e&&(n[Oe]+=16384,eP(a,s)):eP(a,s)}var Bu=-1,uf=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function V9(n){return(n.flags&8)!==0}function H9(n){return(n.flags&16)!==0}function $9(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];z9(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function q9(n){return n===3||n===4||n===6}function z9(n){return n.charCodeAt(0)===64}function dy(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?tP(n,t,i,null,e[++r]):tP(n,t,i,null,null))}}return n}function tP(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){i!==null&&(n[s+1]=i);return}s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),i!==null&&n.splice(s++,0,i)}function OP(n){return n!==Bu}function Ym(n){return n&32767}function G9(n){return n>>16}function Jm(n,e){let t=G9(n),r=e;for(;t>0;)r=r[Vc],t--;return r}var nC=!0;function Zm(n){let e=nC;return nC=n,e}var W9=256,PP=W9-1,MP=5,K9=0,Gs={};function Q9(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Fc)&&(r=t[Fc]),r==null&&(r=t[Fc]=K9++);let i=r&PP,s=1<<i;e.data[n+(i>>MP)]|=s}function kP(n,e){let t=LP(n,e);if(t!==-1)return t;let r=e[xe];r.firstCreatePass&&(n.injectorIndex=e.length,QI(r.data,n),QI(e,null),QI(r.blueprint,null));let i=SC(n,e),s=n.injectorIndex;if(OP(i)){let o=Ym(i),a=Jm(i,e),c=a[xe].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function QI(n,e){n.push(0,0,0,0,0,0,0,0,e)}function LP(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function SC(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=VP(i),r===null)return Bu;if(t++,i=i[Vc],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Bu}function Y9(n,e,t){Q9(n,e,t)}function FP(n,e,t){if(t&8||n!==void 0)return n;Nm(e,"NodeInjector")}function BP(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[yo],s=gr(void 0);try{return i?i.get(e,r,t&8):hI(e,r,t&8)}finally{gr(s)}}return FP(r,e,t)}function UP(n,e,t,r=0,i){if(n!==null){if(e[Oe]&2048&&!(r&2)){let o=tz(n,e,t,r,Gs);if(o!==Gs)return o}let s=jP(n,e,t,r,Gs);if(s!==Gs)return s}return BP(e,t,r,i)}function jP(n,e,t,r,i){let s=X9(t);if(typeof s=="function"){if(!BI(e,n,r))return r&1?FP(i,t,r):BP(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&8))Nm(t);else return o}finally{UI()}}else if(typeof s=="number"){let o=null,a=LP(n,e),c=Bu,l=r&1?e[ii][Ti]:null;for((a===-1||r&4)&&(c=a===-1?SC(n,e):e[a+8],c===Bu||!rP(r,!1)?a=-1:(o=e[xe],a=Ym(c),e=Jm(c,e)));a!==-1;){let u=e[xe];if(nP(s,a,u.data)){let d=J9(a,e,t,o,r,l);if(d!==Gs)return d}c=e[a+8],c!==Bu&&rP(r,e[xe].data[a+8]===l)&&nP(s,a,e)?(o=u,a=Ym(c),e=Jm(c,e)):a=-1}}return i}function J9(n,e,t,r,i,s){let o=e[xe],a=o.data[n+8],c=r==null?la(a)&&nC:r!=o&&(a.type&3)!==0,l=i&1&&s===a,u=Z9(a,o,t,c,l);return u!==null?rC(e,o,u,a,i):Gs}function Z9(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,u=s>>20,d=r?a:a+u,h=i?a+u:l;for(let f=d;f<h;f++){let p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(i){let f=o[c];if(f&&Gc(f)&&f.type===t)return c}return null}function rC(n,e,t,r,i){let s=n[t],o=e.data;if(s instanceof uf){let a=s;if(a.resolving){let f=cO(o[t]);throw dI(f)}let c=Zm(a.canSeeViewProviders);a.resolving=!0;let l=o[t].type||o[t],u,d=a.injectImpl?gr(a.injectImpl):null,h=BI(n,r,0);try{s=n[t]=a.factory(void 0,i,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&U9(t,o[t],e)}finally{d!==null&&gr(d),Zm(c),a.resolving=!1,UI()}}return s}function X9(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Fc)?n[Fc]:void 0;return typeof e=="number"?e>=0?e&PP:ez:e}function nP(n,e,t){let r=1<<n;return!!(t[e+(n>>MP)]&r)}function rP(n,e){return!(n&2)&&!(n&1&&e)}var Qc=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return UP(this._tNode,this._lView,e,Pc(r),t)}};function ez(){return new Qc(Br(),Xe())}function hy(n){return mf(()=>{let e=n.prototype.constructor,t=e[Hh]||iC(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Hh]||iC(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function iC(n){return iI(n)?()=>{let e=iC(Fr(n));return e&&e()}:ia(n)}function tz(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[Oe]&2048&&!Pu(o);){let a=jP(s,o,t,r|2,Gs);if(a!==Gs)return a;let c=s.parent;if(!c){let l=o[EI];if(l){let u=l.get(t,Gs,r);if(u!==Gs)return u}c=VP(o),o=o[Vc]}s=c}return i}function VP(n){let e=n[xe],t=e.type;return t===2?e.declTNode:t===1?n[Ti]:null}function nz(){return fy(Br(),Xe())}function fy(n,e){return new AC($s(n,e))}var AC=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=nz}return n})();function HP(n){return(n.flags&128)===128}var _C=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(_C||{}),$P=new Map,rz=0;function iz(){return rz++}function sz(n){$P.set(n[Xh],n)}function sC(n){$P.delete(n[Xh])}var iP="__ngContext__";function Uu(n,e){vo(e)?(n[iP]=e[Xh],sz(e)):n[iP]=e}function qP(n){return GP(n[Ru])}function zP(n){return GP(n[_i])}function GP(n){for(;n!==null&&!rs(n);)n=n[_i];return n}var oC;function TC(n){oC=n}function WP(){if(oC!==void 0)return oC;if(typeof document<"u")return document;throw new he(210,!1)}var py=new Te("",{factory:()=>oz}),oz="ng";var gy=new Te(""),yf=new Te("",{providedIn:"platform",factory:()=>"unknown"});var my=new Te("",{factory:()=>WP().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var KP="r";var QP="di";var YP=!1,JP=new Te("",{factory:()=>YP});var az=(n,e,t,r)=>{};function cz(n,e,t,r){az(n,e,t,r)}function xC(n){return(n.flags&32)===32}var lz=()=>null;function ZP(n,e,t=!1){return lz(n,e,t)}function XP(n,e){let t=n.contentQueries;if(t!==null){let r=_e(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];FI(s),a.contentQueries(2,e[o],o)}}}finally{_e(r)}}}function aC(n,e,t){FI(0);let r=_e(null);try{e(n,t)}finally{_e(r)}}function DC(n,e,t){if(CI(e)){let r=_e(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{_e(r)}}}var cs=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(cs||{});var cC=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${nI})`}};function eM(n){return n instanceof cC?n.changingThisBreaksApplicationSecurity:n}var uz=/^>|^->|<!--|-->|--!>|<!-$/g,dz=/(<|>)/g,hz="\u200B$1\u200B";function fz(n){return n.replace(uz,e=>e.replace(dz,hz))}function tM(n){return n instanceof Function?n():n}function pz(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}var nM="ng-template";function gz(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&pz(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(NC(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function NC(n){return n.type===4&&n.value!==nM}function mz(n,e,t){let r=n.type===4&&!t?nM:n.value;return e===r}function yz(n,e,t){let r=4,i=n.attrs,s=i!==null?bz(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!as(r)&&!as(c))return!1;if(o&&as(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!mz(n,c,t)||c===""&&e.length===1){if(as(r))return!1;o=!0}}else if(r&8){if(i===null||!gz(n,i,c,t)){if(as(r))return!1;o=!0}}else{let l=e[++a],u=wz(c,i,NC(n),t);if(u===-1){if(as(r))return!1;o=!0;continue}if(l!==""){let d;if(u>s?d="":d=i[u+1].toLowerCase(),r&2&&l!==d){if(as(r))return!1;o=!0}}}}return as(r)||o}function as(n){return(n&1)===0}function wz(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return Ez(e,n)}function vz(n,e,t=!1){for(let r=0;r<e.length;r++)if(yz(n,e[r],t))return!0;return!1}function bz(n){for(let e=0;e<n.length;e++){let t=n[e];if(q9(t))return e}return n.length}function Ez(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function sP(n,e){return n?":not("+e.trim()+")":e}function Iz(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!as(o)&&(e+=sP(s,i),i=""),r=o,s=s||!as(r);t++}return i!==""&&(e+=sP(s,i)),e}function Cz(n){return n.map(Iz).join(",")}function Sz(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!as(i))break;i=s}r++}return t.length&&e.push(1,...t),e}var Ni={};function Az(n,e){return n.createText(e)}function _z(n,e,t){n.setValue(e,t)}function Tz(n,e){return n.createComment(fz(e))}function rM(n,e,t){return n.createElement(e,t)}function Xm(n,e,t,r,i){n.insertBefore(e,t,r,i)}function iM(n,e,t){n.appendChild(e,t)}function oP(n,e,t,r,i){r!==null?Xm(n,e,t,r,i):iM(n,e,t)}function sM(n,e,t,r){n.removeChild(null,e,t,r)}function xz(n,e,t){n.setAttribute(e,"style",t)}function Dz(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function oM(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&$9(n,e,r),i!==null&&Dz(n,e,i),s!==null&&xz(n,e,s)}function RC(n,e,t,r,i,s,o,a,c,l,u){let d=nn+r,h=d+i,f=Nz(d,h),p=typeof l=="function"?l():l;return f[xe]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function Nz(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Ni);return t}function Rz(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=RC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function OC(n,e,t,r,i,s,o,a,c,l,u){let d=e.blueprint.slice();return d[ns]=i,d[Oe]=r|4|128|8|64|1024,(l!==null||n&&n[Oe]&2048)&&(d[Oe]|=2048),TI(d),d[Sn]=d[Vc]=n,d[tn]=t,d[wo]=o||n&&n[wo],d[Qt]=a||n&&n[Qt],d[yo]=c||n&&n[yo]||null,d[Ti]=s,d[Xh]=iz(),d[Du]=u,d[EI]=l,d[ii]=e.type==2?n[ii]:d,d}function Oz(n,e,t){let r=$s(e,n),i=Rz(t),s=n[wo].rendererFactory,o=PC(n,OC(n,i,null,aM(t),r,e,null,s.createRenderer(r,t),null,null,null));return n[e.index]=o}function aM(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function cM(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function PC(n,e){return n[Ru]?n[bI][_i]=e:n[Ru]=e,n[bI]=e,e}function we(n=1){lM(wr(),Xe(),bo()+n,!1)}function lM(n,e,t,r){if(!r)if((e[Oe]&3)===3){let s=n.preOrderCheckHooks;s!==null&&zm(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Gm(e,s,0,t)}ua(t)}var yy=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(yy||{});function lC(n,e,t,r){let i=_e(null);try{let[s,o,a]=n.inputs[t],c=null;(o&yy.SignalBased)!==0&&(c=e[s][Si]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,s):_P(e,c,s,r)}finally{_e(i)}}var Ws=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Ws||{}),Pz;function MC(n,e){return Pz(n,e)}var Yc=new Set,kC=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(kC||{}),wf=new Te(""),aP=new Set;function el(n){aP.has(n)||(aP.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var uM=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Se({token:n,providedIn:"root",factory:()=>new n})}return n})();var dM=new Te("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function hM(n,e,t){let r=n.get(dM);if(Array.isArray(e))for(let i of e)r.queue.add(i),t?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function Mz(n,e){let t=n.get(dM);if(e.detachedLeaveAnimationFns){for(let r of e.detachedLeaveAnimationFns)t.queue.delete(r);e.detachedLeaveAnimationFns=void 0}}function kz(n,e){for(let[t,r]of e)hM(n,r.animateFns)}function cP(n,e,t,r){let i=n?.[zc]?.enter;e!==null&&i&&i.has(t.index)&&kz(r,i)}function Fu(n,e,t,r,i,s,o,a){if(i!=null){let c,l=!1;rs(i)?c=i:vo(i)&&(l=!0,i=i[ns]);let u=xi(i);n===0&&r!==null?(cP(a,r,s,t),o==null?iM(e,r,u):Xm(e,r,u,o||null,!0)):n===1&&r!==null?(cP(a,r,s,t),Xm(e,r,u,o||null,!0)):n===2?lP(a,s,t,d=>{sM(e,u,l,d)}):n===3&&lP(a,s,t,()=>{e.destroyNode(u)}),c!=null&&Kz(e,n,t,c,s,r,o)}}function Lz(n,e){fM(n,e),e[ns]=null,e[Ti]=null}function Fz(n,e,t,r,i,s){r[ns]=i,r[Ti]=e,vy(n,r,t,1,i,s)}function fM(n,e){e[wo].changeDetectionScheduler?.notify(9),vy(n,e,e[Qt],2,null,null)}function Bz(n){let e=n[Ru];if(!e)return YI(n[xe],n);for(;e;){let t=null;if(vo(e))t=e[Ru];else{let r=e[rn];r&&(t=r)}if(!t){for(;e&&!e[_i]&&e!==n;)vo(e)&&YI(e[xe],e),e=e[Sn];e===null&&(e=n),vo(e)&&YI(e[xe],e),t=e&&e[_i]}e=t}}function LC(n,e){let t=n[tf],r=t.indexOf(e);t.splice(r,1)}function wy(n,e){if(Wc(e))return;let t=e[Qt];t.destroyNode&&vy(n,e,t,3,null,null),Bz(e)}function YI(n,e){if(Wc(e))return;let t=_e(null);try{e[Oe]&=-129,e[Oe]|=256,e[si]&&Tc(e[si]),Vz(n,e),jz(n,e),e[xe].type===1&&e[Qt].destroy();let r=e[Hc];if(r!==null&&rs(e[Sn])){r!==e[Sn]&&LC(r,e);let i=e[qc];i!==null&&i.detachView(n)}sC(e)}finally{_e(t)}}function lP(n,e,t,r){let i=n?.[zc];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);n&&Yc.add(n),hM(t,()=>{if(i.leave&&i.leave.has(e.index)){let o=i.leave.get(e.index),a=[];if(o){for(let c=0;c<o.animateFns.length;c++){let l=o.animateFns[c],{promise:u}=l();a.push(u)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(a),Uz(n,r)}else n&&Yc.delete(n),r(!1)},i)}function Uz(n,e){let t=n[zc]?.running;if(t){t.then(()=>{n[zc].running=void 0,Yc.delete(n),e(!0)});return}e(!1)}function jz(n,e){let t=n.cleanup,r=e[Nu];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let a=t[o+3];a>=0?r[a]():r[-a].unsubscribe(),o+=2}else{let a=r[t[o+1]];t[o].call(a)}r!==null&&(e[Nu]=null);let i=e[po];if(i!==null){e[po]=null;for(let o=0;o<i.length;o++){let a=i[o];a()}}let s=e[sa];if(s!==null){e[sa]=null;for(let o of s)o.destroy()}}function Vz(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof uf)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Dt(4,a,c);try{c.call(a)}finally{Dt(5,a,c)}}else{Dt(4,i,s);try{s.call(i)}finally{Dt(5,i,s)}}}}}function Hz(n,e,t){return $z(n,e.parent,t)}function $z(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[ns];if(la(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===cs.None||i===cs.Emulated)return null}return $s(r,t)}function qz(n,e,t){return Gz(n,e,t)}function zz(n,e,t){return n.type&40?$s(n,t):null}var Gz=zz,uP;function FC(n,e,t,r){let i=Hz(n,r,e),s=e[Qt],o=r.parent||e[Ti],a=qz(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)oP(s,i,t[c],a,!1);else oP(s,i,t,a,!1);uP!==void 0&&uP(s,r,e,t,i)}function cf(n,e){if(e!==null){let t=e.type;if(t&3)return $s(e,n);if(t&4)return uC(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return cf(n,r);{let i=n[e.index];return rs(i)?uC(-1,i):xi(i)}}else{if(t&128)return cf(n,e.next);if(t&32)return MC(e,n)()||xi(n[e.index]);{let r=pM(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=oa(n[ii]);return cf(i,r)}else return cf(n,e.next)}}}return null}function pM(n,e){if(e!==null){let r=n[ii][Ti],i=e.projection;return r.projection[i]}return null}function uC(n,e){let t=rn+n+1;if(t<e.length){let r=e[t],i=r[xe].firstChild;if(i!==null)return cf(r,i)}return e[ca]}function BC(n,e,t,r,i,s,o){for(;t!=null;){let a=r[yo];if(t.type===128){t=t.next;continue}let c=r[t.index],l=t.type;if(o&&e===0&&(c&&Uu(xi(c),r),t.flags|=2),!xC(t))if(l&8)BC(n,e,t.child,r,i,s,!1),Fu(e,n,a,i,c,t,s,r);else if(l&32){let u=MC(t,r),d;for(;d=u();)Fu(e,n,a,i,d,t,s,r);Fu(e,n,a,i,c,t,s,r)}else l&16?Wz(n,e,r,t,i,s):Fu(e,n,a,i,c,t,s,r);t=o?t.projectionNext:t.next}}function vy(n,e,t,r,i,s){BC(t,r,n.firstChild,e,i,s,!1)}function Wz(n,e,t,r,i,s){let o=t[ii],c=o[Ti].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Fu(e,n,t[yo],i,u,r,s,t)}else{let l=c,u=o[Sn];HP(r)&&(l.flags|=128),BC(n,e,l,u,i,s,!0)}}function Kz(n,e,t,r,i,s,o){let a=r[ca],c=xi(r);a!==c&&Fu(e,n,t,s,a,i,o);for(let l=rn;l<r.length;l++){let u=r[l];vy(u[xe],u,n,e,s,a)}}function Qz(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Ws.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Ws.Important),n.setStyle(t,r,i,s))}}function gM(n,e,t,r,i){let s=bo(),o=r&2;try{ua(-1),o&&e.length>nn&&lM(n,e,nn,!1),Dt(o?2:0,i,t),t(r,i)}finally{ua(s),Dt(o?3:1,i,t)}}function by(n,e,t){n7(n,e,t),(t.flags&64)===64&&r7(n,e,t)}function vf(n,e,t=$s){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function Yz(n,e,t,r){let s=r.get(JP,YP)||t===cs.ShadowDom||t===cs.ExperimentalIsolatedShadowDom,o=n.selectRootElement(e,s);return Jz(o),o}function Jz(n){Zz(n)}var Zz=()=>null;function Xz(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function e7(n,e,t,r,i,s){let o=e[xe];if(HC(n,o,e,t,r)){la(n)&&t7(e,n.index);return}n.type&3&&(t=Xz(t)),mM(n,e,t,r,i,s)}function mM(n,e,t,r,i,s){if(n.type&3){let o=$s(n,e);r=s!=null?s(r,n.value||"",t):r,i.setProperty(o,t,r)}else n.type&12}function t7(n,e){let t=is(e,n);t[Oe]&16||(t[Oe]|=64)}function n7(n,e,t){let r=t.directiveStart,i=t.directiveEnd;la(t)&&Oz(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||kP(t,e);let s=t.initialInputs;for(let o=r;o<i;o++){let a=n.data[o],c=rC(e,n,o,t);if(Uu(c,e),s!==null&&s7(e,o-r,c,a,t,s),Gc(a)){let l=is(t.index,e);l[tn]=rC(e,n,o,t)}}}function r7(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=UO();try{ua(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];Bm(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&i7(c,l)}}finally{ua(-1),Bm(o)}}function i7(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function UC(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let s=t[i];vz(e,s.selectors,!1)&&(r??=[],Gc(s)?r.unshift(s):r.push(s))}return r}function s7(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;a+=2){let c=o[a],l=o[a+1];lC(r,t,c,l)}}function jC(n,e,t,r,i){let s=nn+t,o=e[xe],a=i(o,e,n,r,t);e[s]=a,ku(n,!0);let c=n.type===2;return c?(oM(e[Qt],a,n),(DO()===0||Ou(n))&&Uu(a,e),NO()):Uu(a,e),Vm()&&(!c||!xC(n))&&FC(o,e,a,n),n}function VC(n){let e=n;return MI()?PO():(e=e.parent,ku(e,!1)),e}function o7(n,e){let t=n[yo];if(!t)return;let r;try{r=t.get(os,null)}catch{r=null}r?.(e)}function HC(n,e,t,r,i){let s=n.inputs?.[r],o=n.hostDirectiveInputs?.[r],a=!1;if(o)for(let c=0;c<o.length;c+=2){let l=o[c],u=o[c+1],d=e.data[l];lC(d,t[l],u,i),a=!0}if(s)for(let c of s){let l=t[c],u=e.data[c];lC(u,l,r,i),a=!0}return a}function a7(n,e){let t=is(e,n),r=t[xe];c7(r,t);let i=t[ns];i!==null&&t[Du]===null&&(t[Du]=ZP(i,t[yo])),Dt(18),$C(r,t,t[tn]),Dt(19,t[tn])}function c7(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function $C(n,e,t){Um(e);try{let r=n.viewQuery;r!==null&&aC(1,r,t);let i=n.template;i!==null&&gM(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[qc]?.finishViewCreation(n),n.staticContentQueries&&XP(n,e),n.staticViewQueries&&aC(2,n.viewQuery,t);let s=n.components;s!==null&&l7(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[Oe]&=-5,jm()}}function l7(n,e){for(let t=0;t<e.length;t++)a7(n,e[t])}function Ey(n,e,t,r){let i=_e(null);try{let s=e.tView,a=n[Oe]&4096?4096:16,c=OC(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Hc]=l;let u=n[qc];return u!==null&&(c[qc]=u.createEmbeddedView(s)),$C(s,c,t),c}finally{_e(i)}}function df(n,e){return!e||e.firstChild===null||HP(n)}function hf(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(xi(s)),rs(s)&&yM(s,r);let o=t.type;if(o&8)hf(n,e,t.child,r);else if(o&32){let a=MC(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=pM(e,t);if(Array.isArray(a))r.push(...a);else{let c=oa(e[ii]);hf(c[xe],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function yM(n,e){for(let t=rn;t<n.length;t++){let r=n[t],i=r[xe].firstChild;i!==null&&hf(r[xe],r,i,e)}n[ca]!==n[ns]&&e.push(n[ca])}function wM(n){if(n[Mm]!==null){for(let e of n[Mm])e.impl.addSequence(e);n[Mm].length=0}}var vM=[];function u7(n){return n[si]??d7(n)}function d7(n){let e=vM.pop()??Object.create(f7);return e.lView=n,e}function h7(n){n.lView[si]!==n&&(n.lView=null,vM.push(n))}var f7=ge(H({},Oh),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Mu(n.lView)},consumerOnSignalRead(){this.lView[si]=this}});function p7(n){let e=n[si]??Object.create(g7);return e.lView=n,e}var g7=ge(H({},Oh),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=oa(n.lView);for(;e&&!bM(e[xe]);)e=oa(e);e&&xI(e)},consumerOnSignalRead(){this.lView[si]=this}});function bM(n){return n.type!==2}function EM(n){if(n[sa]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[sa])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[Oe]&8192)}}var m7=100;function IM(n,e=0){let r=n[wo].rendererFactory,i=!1;i||r.begin?.();try{y7(n,e)}finally{i||r.end?.()}}function y7(n,e){let t=kI();try{qh(!0),dC(n,e);let r=0;for(;rf(n);){if(r===m7)throw new he(103,!1);r++,dC(n,1)}}finally{qh(t)}}function w7(n,e,t,r){if(Wc(e))return;let i=e[Oe],s=!1,o=!1;Um(e);let a=!0,c=null,l=null;s||(bM(n)?(l=u7(e),c=Ph(l)):Jg()===null?(a=!1,l=p7(e),c=Ph(l)):e[si]&&(Tc(e[si]),e[si]=null));try{TI(e),LO(n.bindingStartIndex),t!==null&&gM(n,e,t,2,r);let u=(i&3)===3;if(!s)if(u){let f=n.preOrderCheckHooks;f!==null&&zm(e,f,null)}else{let f=n.preOrderHooks;f!==null&&Gm(e,f,0,null),KI(e,0)}if(o||v7(e),EM(e),CM(e,0),n.contentQueries!==null&&XP(n,e),!s)if(u){let f=n.contentCheckHooks;f!==null&&zm(e,f)}else{let f=n.contentHooks;f!==null&&Gm(e,f,1),KI(e,1)}E7(n,e);let d=n.components;d!==null&&AM(e,d,0);let h=n.viewQuery;if(h!==null&&aC(2,h,r),!s)if(u){let f=n.viewCheckHooks;f!==null&&zm(e,f)}else{let f=n.viewHooks;f!==null&&Gm(e,f,2),KI(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Pm]){for(let f of e[Pm])f();e[Pm]=null}s||(wM(e),e[Oe]&=-73)}catch(u){throw s||Mu(e),u}finally{l!==null&&(Xg(l,c),a&&h7(l)),jm()}}function CM(n,e){for(let t=qP(n);t!==null;t=zP(t))for(let r=rn;r<t.length;r++){let i=t[r];SM(i,e)}}function v7(n){for(let e=qP(n);e!==null;e=zP(e)){if(!(e[Oe]&2))continue;let t=e[tf];for(let r=0;r<t.length;r++){let i=t[r];xI(i)}}}function b7(n,e,t){Dt(18);let r=is(e,n);SM(r,t),Dt(19,r[tn])}function SM(n,e){km(n)&&dC(n,e)}function dC(n,e){let r=n[xe],i=n[Oe],s=n[si],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Mh(s)),o||=!1,s&&(s.dirty=!1),n[Oe]&=-9217,o)w7(r,n,r.template,n[tn]);else if(i&8192){let a=_e(null);try{EM(n),CM(n,1);let c=r.components;c!==null&&AM(n,c,1),wM(n)}finally{_e(a)}}}function AM(n,e,t){for(let r=0;r<e.length;r++)b7(n,e[r],t)}function E7(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ua(~i);else{let s=i,o=t[++r],a=t[++r];BO(o,s);let c=e[s];Dt(24,c),a(2,c),Dt(25,c)}}}finally{ua(-1)}}function qC(n,e){let t=kI()?64:1088;for(n[wo].changeDetectionScheduler?.notify(e);n;){n[Oe]|=t;let r=oa(n);if(Pu(n)&&!r)return n;n=r}return null}function _M(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function TM(n,e){let t=rn+e;if(t<n.length)return n[t]}function Iy(n,e,t,r=!0){let i=e[xe];if(I7(i,e,n,t),r){let o=uC(t,n),a=e[Qt],c=a.parentNode(n[ca]);c!==null&&Fz(i,n[Ti],a,e,c,o)}let s=e[Du];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function xM(n,e){let t=ff(n,e);return t!==void 0&&wy(t[xe],t),t}function ff(n,e){if(n.length<=rn)return;let t=rn+e,r=n[t];if(r){let i=r[Hc];i!==null&&i!==n&&LC(i,r),e>0&&(n[t-1][_i]=r[_i]);let s=Yh(n,rn+e);Lz(r[xe],r);let o=s[qc];o!==null&&o.detachView(s[xe]),r[Sn]=null,r[_i]=null,r[Oe]&=-129}return r}function I7(n,e,t,r){let i=rn+r,s=t.length;r>0&&(t[i-1][_i]=e),r<s-rn?(e[_i]=t[i],fI(t,rn+r,e)):(t.push(e),e[_i]=null),e[Sn]=t;let o=e[Hc];o!==null&&t!==o&&DM(o,e);let a=e[qc];a!==null&&a.insertView(n),Lm(e),e[Oe]|=128}function DM(n,e){let t=n[tf],r=e[Sn];if(vo(r))n[Oe]|=2;else{let i=r[Sn][ii];e[ii]!==i&&(n[Oe]|=2)}t===null?n[tf]=[e]:t.push(e)}var fa=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[xe];return hf(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[tn]}set context(e){this._lView[tn]=e}get destroyed(){return Wc(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Sn];if(rs(e)){let t=e[ef],r=t?t.indexOf(this):-1;r>-1&&(ff(e,r),Yh(t,r))}this._attachedToViewContainer=!1}wy(this._lView[xe],this._lView)}onDestroy(e){DI(this._lView,e)}markForCheck(){qC(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Oe]&=-129}reattach(){Lm(this._lView),this._lView[Oe]|=128}detectChanges(){this._lView[Oe]|=1024,IM(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new he(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Pu(this._lView),t=this._lView[Hc];t!==null&&!e&&LC(t,this._lView),fM(this._lView[xe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new he(902,!1);this._appRef=e;let t=Pu(this._lView),r=this._lView[Hc];r!==null&&!t&&DM(r,this._lView),Lm(this._lView)}};var bf=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=C7;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let s=Ey(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new fa(s)}}return n})();function C7(){return S7(Br(),Xe())}function S7(n,e){return n.type&4?new bf(e,n,fy(n,e)):null}function Ef(n,e,t,r,i){let s=n.data[e];if(s===null)s=A7(n,e,t,r,i),FO()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=OO();s.injectorIndex=o===null?-1:o.injectorIndex}return ku(s,!0),s}function A7(n,e,t,r,i){let s=PI(),o=MI(),a=o?s:s&&s.parent,c=n.data[e]=T7(n,a,t,e,r,i);return _7(n,c,s,o),c}function _7(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function T7(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return RO()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function x7(n){let e=n[II]??[],r=n[Sn][Qt],i=[];for(let s of e)s.data[QP]!==void 0?i.push(s):D7(s,r);n[II]=i}function D7(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[KP];for(;t<i;){let s=r.nextSibling;sM(e,r,!1),r=s,t++}}}var N7=()=>null,R7=()=>null;function hC(n,e){return N7(n,e)}function NM(n,e,t){return R7(n,e,t)}var RM=class{},Cy=class{},fC=class{resolveComponentFactory(e){throw new he(917,!1)}},If=class{static NULL=new fC},Jc=class{};var OM=(()=>{class n{static \u0275prov=Se({token:n,providedIn:"root",factory:()=>null})}return n})();var Wm={},pC=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,Wm,r);return i!==Wm||t===Wm?i:this.parentInjector.get(e,t,r)}};function ey(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=rI(i,a);else if(s==2){let c=a,l=e[++o];r=rI(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function oi(n,e=0){let t=Xe();if(t===null)return Ue(n,e);let r=Br();return UP(r,t,Fr(n),e)}function PM(n,e,t,r,i){let s=r===null?null:{"":-1},o=i(n,t);if(o!==null){let a=o,c=null,l=null;for(let u of o)if(u.resolveHostDirectives!==null){[a,c,l]=u.resolveHostDirectives(o);break}M7(n,e,t,a,s,c,l)}s!==null&&r!==null&&O7(t,r,s)}function O7(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new he(-301,!1);r.push(e[i],s)}}function P7(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function M7(n,e,t,r,i,s,o){let a=r.length,c=!1;for(let h=0;h<a;h++){let f=r[h];!c&&Gc(f)&&(c=!0,P7(n,t,h)),Y9(kP(t,e),n,f.type)}j7(t,n.data.length,a);for(let h=0;h<a;h++){let f=r[h];f.providersResolver&&f.providersResolver(f)}let l=!1,u=!1,d=cM(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let h=0;h<a;h++){let f=r[h];if(t.mergedAttrs=dy(t.mergedAttrs,f.hostAttrs),L7(n,t,e,d,f),U7(d,f,i),o!==null&&o.has(f)){let[g,m]=o.get(f);t.directiveToIndex.set(f.type,[d,g+t.directiveStart,m+t.directiveStart])}else(s===null||!s.has(f))&&t.directiveToIndex.set(f.type,d);f.contentQueries!==null&&(t.flags|=4),(f.hostBindings!==null||f.hostAttrs!==null||f.hostVars!==0)&&(t.flags|=64);let p=f.type.prototype;!l&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!u&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),d++}k7(n,t,s)}function k7(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))dP(0,e,i,r),dP(1,e,i,r),fP(e,r,!1);else{let s=t.get(i);hP(0,e,s,r),hP(1,e,s,r),fP(e,r,!0)}}}function dP(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o;n===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(r),MM(e,s)}}function hP(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o=i[s],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(r,s),MM(e,o)}}function MM(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function fP(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:s}=n;if(r===null||!t&&i===null||t&&s===null||NC(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let o=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let l=i[c];for(let u of l)if(u===e){o??=[],o.push(c,r[a+1]);break}}else if(t&&s.hasOwnProperty(c)){let l=s[c];for(let u=0;u<l.length;u+=2)if(l[u]===e){o??=[],o.push(l[u+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(o)}function L7(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=ia(i.type,!0)),o=new uf(s,Gc(i),oi,null);n.blueprint[r]=o,t[r]=o,F7(n,e,r,cM(n,t,i.hostVars,Ni),i)}function F7(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;B7(o)!=a&&o.push(a),o.push(t,r,s)}}function B7(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function U7(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Gc(e)&&(t[""]=n)}}function j7(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function zC(n,e,t,r,i,s,o,a){let c=e[xe],l=c.consts,u=Di(l,o),d=Ef(c,n,t,r,u);return s&&PM(c,e,d,Di(l,a),i),d.mergedAttrs=dy(d.mergedAttrs,d.attrs),d.attrs!==null&&ey(d,d.attrs,!1),d.mergedAttrs!==null&&ey(d,d.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,d),d}function GC(n,e){NP(n,e),CI(e)&&n.queries.elementEnd(e)}function V7(n,e,t,r,i,s){let o=e.consts,a=Di(o,i),c=Ef(e,n,t,r,a);if(c.mergedAttrs=dy(c.mergedAttrs,c.attrs),s!=null){let l=Di(o,s);c.localNames=[];for(let u=0;u<l.length;u+=2)c.localNames.push(l[u],-1)}return c.attrs!==null&&ey(c,c.attrs,!1),c.mergedAttrs!==null&&ey(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function WC(n){return LM(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function kM(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function LM(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function H7(n,e,t){return n[e]=t}function pa(n,e,t){if(t===Ni)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function FM(n,e,t,r){let i=pa(n,e,t);return pa(n,e+1,r)||i}function Km(n,e,t){return function r(i){let s=la(n)?is(n.index,e):e;qC(s,5);let o=e[tn],a=pP(e,o,t,i),c=r.__ngNextListenerFn__;for(;c;)a=pP(e,o,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function pP(n,e,t,r){let i=_e(null);try{return Dt(6,e,t),t(r)!==!1}catch(s){return o7(n,s),!1}finally{Dt(7,e,t),_e(i)}}function BM(n,e,t,r,i,s,o,a){let c=Ou(n),l=!1,u=null;if(!r&&c&&(u=q7(e,t,s,n.index)),u!==null){let d=u.__ngLastListenerFn__||u;d.__ngNextListenerFn__=o,u.__ngLastListenerFn__=o,l=!0}else{let d=$s(n,t),h=r?r(d):d;cz(t,h,s,a);let f=i.listen(h,s,a);if(!$7(s)){let p=r?g=>r(xi(g[n.index])):n.index;UM(p,e,t,s,a,f,!1)}}return l}function $7(n){return n.startsWith("animation")||n.startsWith("transition")}function q7(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Nu],c=i[s+2];return a&&a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function UM(n,e,t,r,i,s,o){let a=e.firstCreatePass?xO(e):null,c=TO(t),l=c.length;c.push(i,s),a&&a.push(r,n,l,(l+1)*(o?-1:1))}function gP(n,e,t,r,i,s){let o=e[t],a=e[xe],l=a.data[t].outputs[r],d=o[l].subscribe(s);UM(n.index,a,e,i,s,d,!0)}var gC=Symbol("BINDING");var ty=class extends If{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=aa(e);return new ju(t,this.ngModule)}};function z7(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],s={propName:t,templateName:e,isSignal:(r&yy.SignalBased)!==0};return i&&(s.transform=i),s})}function G7(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function W7(n,e,t){let r=e instanceof Wn?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new pC(t,r):t}function K7(n){let e=n.get(Jc,null);if(e===null)throw new he(407,!1);let t=n.get(OM,null),r=n.get(kc,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function Q7(n,e){let t=jM(n);return rM(e,t,t==="svg"?SI:t==="math"?IO:null)}function jM(n){return(n.selectors[0][0]||"div").toLowerCase()}var ju=class extends Cy{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=z7(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=G7(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Cz(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,s,o){Dt(22);let a=_e(null);try{let c=this.componentDef,l=Y7(r,c,o,s),u=W7(c,i||this.ngModule,e),d=K7(u),h=d.rendererFactory.createRenderer(null,c),f=r?Yz(h,r,c.encapsulation,u):Q7(c,h),p=o?.some(mP)||s?.some(y=>typeof y!="function"&&y.bindings.some(mP)),g=OC(null,l,null,512|aM(c),null,null,d,h,u,null,ZP(f,u,!0));g[nn]=f,Um(g);let m=null;try{let y=zC(nn,g,2,"#host",()=>l.directiveRegistry,!0,0);oM(h,f,y),Uu(f,g),by(l,g,y),DC(l,y,g),GC(l,y),t!==void 0&&Z7(y,this.ngContentSelectors,t),m=is(y.index,g),g[tn]=m[tn],$C(l,g,null)}catch(y){throw m!==null&&sC(m),sC(g),y}finally{Dt(23),jm()}return new ny(this.componentType,g,!!p)}finally{_e(a)}}};function Y7(n,e,t,r){let i=n?["ng-version","21.0.0"]:Sz(e.selectors[0]),s=null,o=null,a=0;if(t)for(let u of t)a+=u[gC].requiredVars,u.create&&(u.targetIdx=0,(s??=[]).push(u)),u.update&&(u.targetIdx=0,(o??=[]).push(u));if(r)for(let u=0;u<r.length;u++){let d=r[u];if(typeof d!="function")for(let h of d.bindings){a+=h[gC].requiredVars;let f=u+1;h.create&&(h.targetIdx=f,(s??=[]).push(h)),h.update&&(h.targetIdx=f,(o??=[]).push(h))}}let c=[e];if(r)for(let u of r){let d=typeof u=="function"?u:u.type,h=yI(d);c.push(h)}return RC(0,null,J7(s,o),1,a,c,null,null,null,[i],null)}function J7(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function mP(n){let e=n[gC].kind;return e==="input"||e==="twoWay"}var ny=class extends RM{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=nf(t[xe],nn),this.location=fy(this._tNode,t),this.instance=is(this._tNode.index,t)[tn],this.hostView=this.changeDetectorRef=new fa(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,s=HC(r,i[xe],i,e,t);this.previousInputValues.set(e,t);let o=is(r.index,i);qC(o,1)}get injector(){return new Qc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function Z7(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null&&s.length?Array.from(s):null)}}var tl=(()=>{class n{static __NG_ELEMENT_ID__=X7}return n})();function X7(){let n=Br();return tG(n,Xe())}var eG=tl,VM=class extends eG{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return fy(this._hostTNode,this._hostLView)}get injector(){return new Qc(this._hostTNode,this._hostLView)}get parentInjector(){let e=SC(this._hostTNode,this._hostLView);if(OP(e)){let t=Jm(e,this._hostLView),r=Ym(e),i=t[xe].data[r+8];return new Qc(i,t)}else return new Qc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=yP(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-rn}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=hC(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,df(this._hostTNode,o)),a}createComponent(e,t,r,i,s,o,a){let c=e&&!k9(e),l;if(c)l=t;else{let m=t||{};l=m.index,r=m.injector,i=m.projectableNodes,s=m.environmentInjector||m.ngModuleRef,o=m.directives,a=m.bindings}let u=c?e:new ju(aa(e)),d=r||this.parentInjector;if(!s&&u.ngModule==null){let y=(c?d:this.parentInjector).get(Wn,null);y&&(s=y)}let h=aa(u.componentType??{}),f=hC(this._lContainer,h?.id??null),p=f?.firstChild??null,g=u.create(d,i,p,s,o,a);return this.insertImpl(g.hostView,l,df(this._hostTNode,f)),g}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(SO(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Sn],l=new VM(c,c[Ti],c[Sn]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return Iy(o,i,s,r),e.attachToViewContainerRef(),fI(JI(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=yP(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=ff(this._lContainer,t);r&&(Yh(JI(this._lContainer),t),wy(r[xe],r))}detach(e){let t=this._adjustIndex(e,-1),r=ff(this._lContainer,t);return r&&Yh(JI(this._lContainer),t)!=null?new fa(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function yP(n){return n[ef]}function JI(n){return n[ef]||(n[ef]=[])}function tG(n,e){let t,r=e[n.index];return rs(r)?t=r:(t=_M(r,e,null,n),e[n.index]=t,PC(e,t)),rG(t,e,n,r),new VM(t,n,e)}function nG(n,e){let t=n[Qt],r=t.createComment(""),i=$s(e,n),s=t.parentNode(i);return Xm(t,s,r,t.nextSibling(i),!1),r}var rG=oG,iG=()=>!1;function sG(n,e,t){return iG(n,e,t)}function oG(n,e,t,r){if(n[ca])return;let i;t.type&8?i=xi(r):i=nG(e,t),n[ca]=i}var Zc=class{},Sy=class{};var ry=class extends Zc{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new ty(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let s=mI(e);this._bootstrapComponents=tM(s.bootstrap),this._r3Injector=VI(e,t,[{provide:Zc,useValue:this},{provide:If,useValue:this.componentFactoryResolver},...r],go(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},iy=class extends Sy{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new ry(this.moduleType,e,[])}};var pf=class extends Zc{injector;componentFactoryResolver=new ty(this);instance=null;constructor(e){super();let t=new Mc([...e.providers,{provide:Zc,useValue:this},{provide:If,useValue:this.componentFactoryResolver}],e.parent||Zh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Cf(n,e,t=null){return new pf({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var aG=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=wI(!1,t.type),i=r.length>0?Cf([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Se({token:n,providedIn:"environment",factory:()=>new n(Ue(Wn))})}return n})();function ls(n){return mf(()=>{let e=HM(n),t=ge(H({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===_C.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(aG).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||cs.Emulated,styles:n.styles||Ai,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&el("NgStandalone"),$M(t);let r=n.dependencies;return t.directiveDefs=wP(r,cG),t.pipeDefs=wP(r,pO),t.id=dG(t),t})}function cG(n){return aa(n)||yI(n)}function Sf(n){return mf(()=>({type:n.type,bootstrap:n.bootstrap||Ai,declarations:n.declarations||Ai,imports:n.imports||Ai,exports:n.exports||Ai,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function lG(n,e){if(n==null)return Bc;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a,c;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s,c=i[3]||null):(s=i,o=i,a=yy.None,c=null),t[s]=[r,a,c],e[s]=o}return t}function uG(n){if(n==null)return Bc;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Hu(n){return mf(()=>{let e=HM(n);return $M(e),e})}function Ay(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function HM(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Bc,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Ai,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:lG(n.inputs,e),outputs:uG(n.outputs),debugInfo:null}}function $M(n){n.features?.forEach(e=>e(n))}function wP(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let s=e(i);s!==null&&r.push(s)}return r}:null}function dG(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function qM(n,e,t,r,i,s,o,a){if(t.firstCreatePass){n.mergedAttrs=dy(n.mergedAttrs,n.attrs);let u=n.tView=RC(2,n,i,s,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),u.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),ku(n,!1);let c=fG(t,e,n,r);Vm()&&FC(t,e,c,n),Uu(c,e);let l=_M(c,e,c,n);e[r+nn]=l,PC(e,l),sG(l,n,e)}function hG(n,e,t,r,i,s,o,a,c,l,u){let d=t+nn,h;return e.firstCreatePass?(h=Ef(e,d,4,o||null,a||null),Fm()&&PM(e,n,h,Di(e.consts,l),UC),NP(e,h)):h=e.data[d],qM(h,n,e,t,r,i,s,c),Ou(h)&&by(e,n,h),l!=null&&vf(n,h,u),h}function sy(n,e,t,r,i,s,o,a,c,l,u){let d=t+nn,h;if(e.firstCreatePass){if(h=Ef(e,d,4,o||null,a||null),l!=null){let f=Di(e.consts,l);h.localNames=[];for(let p=0;p<f.length;p+=2)h.localNames.push(f[p],-1)}}else h=e.data[d];return qM(h,n,e,t,r,i,s,c),l!=null&&vf(n,h,u),h}function vr(n,e,t,r,i,s,o,a){let c=Xe(),l=wr(),u=Di(l.consts,s);return hG(c,l,n,e,t,r,i,u,void 0,o,a),vr}var fG=pG;function pG(n,e,t,r){return sf(!0),e[Qt].createComment("")}var KC=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var QC=new Te("");function $u(n){return!!n&&typeof n.then=="function"}function YC(n){return!!n&&typeof n.subscribe=="function"}var zM=new Te("");var JC=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=X(zM,{optional:!0})??[];injector=X(ts);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=yr(this.injector,i);if($u(s))t.push(s);else if(YC(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_y=new Te("");function GM(){AE(()=>{let n="";throw new he(600,n)})}function WM(n){return n.isBoundToModule}var gG=10;var qu=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=X(os);afterRenderManager=X(uM);zonelessEnabled=X(of);rootEffectScheduler=X($m);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Gn;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=X(ha);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe($t(t=>!t))}constructor(){X(wf,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=X(Wn);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=ts.NULL){return this._injector.get(ri).run(()=>{Dt(10);let o=t instanceof Cy;if(!this._injector.get(JC).done){let p="";throw new he(405,p)}let c;o?c=t:c=this._injector.get(If).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let l=WM(c)?void 0:this._injector.get(Zc),u=r||c.selector,d=c.create(i,[],u,l),h=d.location.nativeElement,f=d.injector.get(QC,null);return f?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),lf(this.components,d),f?.unregisterApplication(h)}),this._loadComponent(d),Dt(11,d),d})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Dt(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(kC.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new he(101,!1);let t=_e(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,_e(t),this.afterTick.next(),Dt(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Jc,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<gG;)Dt(14),this.synchronizeOnce(),Dt(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!rf(i))continue;let s=r&&!this.zonelessEnabled?0:1;IM(i,s),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>rf(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;lf(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(_y,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>lf(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new he(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var z_e=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var mC=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),s=this.detach(i);if(i-r>1){let o=this.detach(r);this.attach(r,s),this.attach(i,o)}else this.attach(r,s)}move(e,t){this.attach(t,this.detach(e))}};function ZI(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function mG(n,e,t,r){let i,s,o=0,a=n.length-1,c=void 0;if(Array.isArray(e)){_e(r);let l=e.length-1;for(_e(null);o<=a&&o<=l;){let u=n.at(o),d=e[o],h=ZI(o,u,o,d,t);if(h!==0){h<0&&n.updateValue(o,d),o++;continue}let f=n.at(a),p=e[l],g=ZI(a,f,l,p,t);if(g!==0){g<0&&n.updateValue(a,p),a--,l--;continue}let m=t(o,u),y=t(a,f),E=t(o,d);if(Object.is(E,y)){let I=t(l,p);Object.is(I,m)?(n.swap(o,a),n.updateValue(a,p),l--,a--):n.move(a,o),n.updateValue(o,d),o++;continue}if(i??=new oy,s??=bP(n,o,a,t),yC(n,i,o,E))n.updateValue(o,d),o++,a++;else if(s.has(E))i.set(m,n.detach(o)),a--;else{let I=n.create(o,e[o]);n.attach(o,I),o++,a++}}for(;o<=l;)vP(n,i,t,o,e[o]),o++}else if(e!=null){_e(r);let l=e[Symbol.iterator]();_e(null);let u=l.next();for(;!u.done&&o<=a;){let d=n.at(o),h=u.value,f=ZI(o,d,o,h,t);if(f!==0)f<0&&n.updateValue(o,h),o++,u=l.next();else{i??=new oy,s??=bP(n,o,a,t);let p=t(o,h);if(yC(n,i,o,p))n.updateValue(o,h),o++,a++,u=l.next();else if(!s.has(p))n.attach(o,n.create(o,h)),o++,a++,u=l.next();else{let g=t(o,d);i.set(g,n.detach(o)),a--}}}for(;!u.done;)vP(n,i,t,n.length,u.value),u=l.next()}for(;o<=a;)n.destroy(n.detach(a--));i?.forEach(l=>{n.destroy(l)})}function yC(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function vP(n,e,t,r,i){if(yC(n,e,r,t(r,i)))n.updateValue(r,i);else{let s=n.create(r,i);n.attach(r,s)}}function bP(n,e,t,r){let i=new Set;for(let s=e;s<=t;s++)i.add(r(s,n.at(s)));return i}var oy=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function Eo(n,e,t,r,i,s,o,a){el("NgControlFlow");let c=Xe(),l=wr(),u=Di(l.consts,s);return sy(c,l,n,e,t,r,i,u,256,o,a),ZC}function ZC(n,e,t,r,i,s,o,a){el("NgControlFlow");let c=Xe(),l=wr(),u=Di(l.consts,s);return sy(c,l,n,e,t,r,i,u,512,o,a),ZC}function Io(n,e){el("NgControlFlow");let t=Xe(),r=Lu(),i=t[r]!==Ni?t[r]:-1,s=i!==-1?ay(t,nn+i):void 0,o=0;if(pa(t,r,n)){let a=_e(null);try{if(s!==void 0&&xM(s,o),n!==-1){let c=nn+n,l=ay(t,c),u=EC(t[xe],c),d=NM(l,u,t),h=Ey(t,u,e,{dehydratedView:d});Iy(l,h,o,df(u,d))}}finally{_e(a)}}else if(s!==void 0){let a=TM(s,o);a!==void 0&&(a[tn]=e)}}var wC=class{lContainer;$implicit;$index;constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-rn}};function XC(n,e){return e}var vC=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function zu(n,e,t,r,i,s,o,a,c,l,u,d,h){el("NgControlFlow");let f=Xe(),p=wr(),g=c!==void 0,m=Xe(),y=a?o.bind(m[ii][tn]):o,E=new vC(g,y);m[nn+n]=E,sy(f,p,n+1,e,t,r,i,Di(p.consts,s),256),g&&sy(f,p,n+2,c,l,u,d,Di(p.consts,h),512)}var bC=class extends mC{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r}get length(){return this.lContainer.length-rn}at(e){return this.getLView(e)[tn].$implicit}attach(e,t){let r=t[Du];this.needsIndexUpdate||=e!==this.length,Iy(this.lContainer,t,e,df(this.templateTNode,r)),yG(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,wG(this.lContainer,e),vG(this.lContainer,e)}create(e,t){let r=hC(this.lContainer,this.templateTNode.tView.ssrId),i=Ey(this.hostLView,this.templateTNode,new wC(this.lContainer,t,e),{dehydratedView:r});return this.operationsCounter?.recordCreate(),i}destroy(e){wy(e[xe],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[tn].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[tn].$index=e}getLView(e){return bG(this.lContainer,e)}};function Gu(n){let e=_e(null),t=bo();try{let r=Xe(),i=r[xe],s=r[t],o=t+1,a=ay(r,o);if(s.liveCollection===void 0){let l=EC(i,o);s.liveCollection=new bC(a,r,l)}else s.liveCollection.reset();let c=s.liveCollection;if(mG(c,n,s.trackByFn,e),c.updateIndexes(),s.hasEmptyBlock){let l=Lu(),u=c.length===0;if(pa(r,l,u)){let d=t+2,h=ay(r,d);if(u){let f=EC(i,d),p=NM(h,f,r),g=Ey(r,f,void 0,{dehydratedView:p});Iy(h,g,0,df(f,p))}else i.firstUpdatePass&&x7(h),xM(h,0)}}}finally{_e(e)}}function ay(n,e){return n[e]}function yG(n,e){if(n.length<=rn)return;let t=rn+e,r=n[t],i=r?r[zc]:void 0;if(r&&i&&i.detachedLeaveAnimationFns&&i.detachedLeaveAnimationFns.length>0){let s=r[yo];Mz(s,i),Yc.delete(r),i.detachedLeaveAnimationFns=void 0}}function wG(n,e){if(n.length<=rn)return;let t=rn+e,r=n[t],i=r?r[zc]:void 0;i&&i.leave&&i.leave.size>0&&(i.detachedLeaveAnimationFns=[])}function vG(n,e){return ff(n,e)}function bG(n,e){return TM(n,e)}function EC(n,e){return nf(n,e)}function qt(n,e,t){let r=Xe(),i=Lu();if(pa(r,i,e)){let s=wr(),o=jI();e7(o,r,n,e,r[Qt],t)}return qt}function EP(n,e,t,r,i){HC(e,n,t,i?"class":"style",r)}function Ee(n,e,t,r){let i=Xe(),s=i[xe],o=n+nn,a=s.firstCreatePass?zC(o,i,2,e,UC,Fm(),t,r):s.data[o];if(jC(a,i,n,e,KM),Ou(a)){let c=i[xe];by(c,i,a),DC(c,a,i)}return r!=null&&vf(i,a),Ee}function Pe(){let n=wr(),e=Br(),t=VC(e);return n.firstCreatePass&&GC(n,t),RI(t)&&OI(),NI(),t.classesWithoutHost!=null&&V9(t)&&EP(n,t,Xe(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&H9(t)&&EP(n,t,Xe(),t.stylesWithoutHost,!1),Pe}function br(n,e,t,r){return Ee(n,e,t,r),Pe(),br}function Ae(n,e,t,r){let i=Xe(),s=i[xe],o=n+nn,a=s.firstCreatePass?V7(o,s,2,e,t,r):s.data[o];return jC(a,i,n,e,KM),r!=null&&vf(i,a),Ae}function De(){let n=Br(),e=VC(n);return RI(e)&&OI(),NI(),De}function Co(n,e,t,r){return Ae(n,e,t,r),De(),Co}var KM=(n,e,t,r,i)=>(sf(!0),rM(e[Qt],r,zO()));function Af(n,e,t){let r=Xe(),i=r[xe],s=n+nn,o=i.firstCreatePass?zC(s,r,8,"ng-container",UC,Fm(),e,t):i.data[s];if(jC(o,r,n,"ng-container",EG),Ou(o)){let a=r[xe];by(a,r,o),DC(a,o,r)}return t!=null&&vf(r,o),Af}function _f(){let n=wr(),e=Br(),t=VC(e);return n.firstCreatePass&&GC(n,t),_f}var EG=(n,e,t,r,i)=>(sf(!0),Tz(e[Qt],""));function Er(){return Xe()}function nl(n,e,t){let r=Xe(),i=Lu();if(pa(r,i,e)){let s=wr(),o=jI();mM(o,r,n,e,r[Qt],t)}return nl}var af=void 0;function IG(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var CG=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],af,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],af,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",af,af,af],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",IG],XI={};function Ur(n){let e=SG(n),t=IP(e);if(t)return t;let r=e.split("-")[0];if(t=IP(r),t)return t;if(r==="en")return CG;throw new he(701,!1)}function IP(n){return n in XI||(XI[n]=Lc.ng&&Lc.ng.common&&Lc.ng.common.locales&&Lc.ng.common.locales[n]),XI[n]}var Yt=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(Yt||{});function SG(n){return n.toLowerCase().replace(/_/g,"-")}var Tf="en-US";var AG=Tf;function QM(n){typeof n=="string"&&(AG=n.toLowerCase().replace(/_/g,"-"))}function Ri(n,e,t){let r=Xe(),i=wr(),s=Br();return _G(i,r,r[Qt],s,n,e,t),Ri}function Oi(n,e,t){let r=Xe(),i=wr(),s=Br();return(s.type&3||t)&&BM(s,i,r,t,r[Qt],n,e,Km(s,r,e)),Oi}function _G(n,e,t,r,i,s,o){let a=!0,c=null;if((r.type&3||o)&&(c??=Km(r,e,s),BM(r,n,e,o,t,i,s,c)&&(a=!1)),a){let l=r.outputs?.[i],u=r.hostDirectiveOutputs?.[i];if(u&&u.length)for(let d=0;d<u.length;d+=2){let h=u[d],f=u[d+1];c??=Km(r,e,s),gP(r,e,h,f,i,c)}if(l&&l.length)for(let d of l)c??=Km(r,e,s),gP(r,e,d,i,i,c)}}function et(n=1){return qO(n)}function qm(n,e){return n<<17|e<<2}function Xc(n){return n>>17&32767}function TG(n){return(n&2)==2}function xG(n,e){return n&131071|e<<17}function IC(n){return n|2}function Vu(n){return(n&131068)>>2}function eC(n,e){return n&-131069|e<<2}function DG(n){return(n&1)===1}function CC(n){return n|1}function NG(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Xc(o),c=Vu(o);n[r]=t;let l=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||xu(d,u)>0)&&(l=!0)}else u=t;if(i)if(c!==0){let h=Xc(n[a+1]);n[r+1]=qm(h,a),h!==0&&(n[h+1]=eC(n[h+1],r)),n[a+1]=xG(n[a+1],r)}else n[r+1]=qm(a,0),a!==0&&(n[a+1]=eC(n[a+1],r)),a=r;else n[r+1]=qm(c,0),a===0?a=r:n[c+1]=eC(n[c+1],r),c=r;l&&(n[r+1]=IC(n[r+1])),CP(n,u,r,!0),CP(n,u,r,!1),RG(e,u,n,r,s),o=qm(a,c),s?e.classBindings=o:e.styleBindings=o}function RG(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&xu(s,e)>=0&&(t[r+1]=CC(t[r+1]))}function CP(n,e,t,r){let i=n[t+1],s=e===null,o=r?Xc(i):Vu(i),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],l=n[o+1];OG(c,e)&&(a=!0,n[o+1]=r?CC(l):IC(l)),o=r?Xc(l):Vu(l)}a&&(n[t+1]=r?IC(i):CC(i))}function OG(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?xu(n,e)>=0:!1}function ga(n,e){return PG(n,e,null,!0),ga}function PG(n,e,t,r){let i=Xe(),s=wr(),o=LI(2);if(s.firstUpdatePass&&kG(s,n,o,r),e!==Ni&&pa(i,o,e)){let a=s.data[bo()];jG(s,a,i,i[Qt],n,i[o+1]=VG(e,t),r,o)}}function MG(n,e){return e>=n.expandoStartIndex}function kG(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[bo()],o=MG(n,t);HG(s,r)&&e===null&&!o&&(e=!1),e=LG(i,s,e,r),NG(i,s,e,t,o,r)}}function LG(n,e,t,r){let i=jO(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=tC(null,n,e,t,r),t=gf(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=tC(i,n,e,t,r),s===null){let c=FG(n,e,r);c!==void 0&&Array.isArray(c)&&(c=tC(null,n,e,c[1],r),c=gf(c,e.attrs,r),BG(n,e,r,c))}else s=UG(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function FG(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Vu(r)!==0)return n[Xc(r)]}function BG(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Xc(i)]=r}function UG(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=gf(r,o,t)}return gf(r,e.attrs,t)}function tC(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=gf(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function gf(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),fO(n,o,t?!0:e[++s]))}return n===void 0?null:n}function jG(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let c=n.data,l=c[a+1],u=DG(l)?SP(c,e,t,i,Vu(l),o):void 0;if(!cy(u)){cy(s)||TG(l)&&(s=SP(c,null,t,i,a,o));let d=AI(bo(),t);Qz(r,o,d,i,s)}}function SP(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let c=n[i],l=Array.isArray(c),u=l?c[1]:c,d=u===null,h=t[i+1];h===Ni&&(h=d?Ai:void 0);let f=d?Om(h,r):u===r?h:void 0;if(l&&!cy(f)&&(f=Om(c,r)),cy(f)&&(a=f,o))return a;let p=n[i+1];i=o?Xc(p):Vu(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=Om(c,r))}return a}function cy(n){return n!==void 0}function VG(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=go(eM(n)))),n}function HG(n,e){return(n.flags&(e?8:16))!==0}function fe(n,e=""){let t=Xe(),r=wr(),i=n+nn,s=r.firstCreatePass?Ef(r,i,1,e,null):r.data[i],o=$G(r,t,s,e,n);t[i]=o,Vm()&&FC(r,t,o,s),ku(s,!1)}var $G=(n,e,t,r,i)=>(sf(!0),Az(e[Qt],r));function qG(n,e,t,r=""){return pa(n,Lu(),t)?e+Qh(t)+r:Ni}function zG(n,e,t,r,i,s=""){let o=kO(),a=FM(n,o,t,i);return LI(2),a?e+Qh(t)+r+Qh(i)+s:Ni}function jr(n){return An("",n),jr}function An(n,e,t){let r=Xe(),i=qG(r,n,e,t);return i!==Ni&&YM(r,bo(),i),An}function Ty(n,e,t,r,i){let s=Xe(),o=zG(s,n,e,t,r,i);return o!==Ni&&YM(s,bo(),o),Ty}function YM(n,e,t){let r=AI(e,n);_z(n[Qt],r,t)}function GG(n,e){let t=n[e];return t===Ni?void 0:t}function WG(n,e,t,r,i,s,o){let a=e+t;return FM(n,a,i,s)?H7(n,a+2,o?r.call(o,i,s):r(i,s)):GG(n,a+2)}function Vr(n,e){let t=wr(),r,i=n+nn;t.firstCreatePass?(r=KG(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=ia(r.type,!0)),o,a=gr(oi);try{let c=Zm(!1),l=s();return Zm(c),_I(t,Xe(),i,l),l}finally{gr(a)}}function KG(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function Hr(n,e,t,r){let i=n+nn,s=Xe(),o=CO(s,i);return QG(s,i)?WG(s,MO(),e,o.transform,t,r,o):o.transform(t,r)}function QG(n,e){return n[xe].data[e].pure}var ly=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},eS=(()=>{class n{compileModuleSync(t){return new iy(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=mI(t),s=tM(i.declarations).reduce((o,a)=>{let c=aa(a);return c&&o.push(new ju(c)),o},[]);return new ly(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var JM=(()=>{class n{applicationErrorHandler=X(os);appRef=X(qu);taskService=X(ha);ngZone=X(ri);zonelessEnabled=X(of);tracing=X(wf,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Mn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Gh):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(X(WI,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?$I:HI;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Gh+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,$I(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ZM(){return[{provide:kc,useExisting:JM},{provide:ri,useClass:Wh},{provide:of,useValue:!0}]}function YG(){return typeof $localize<"u"&&$localize.locale||Tf}var Wu=new Te("",{factory:()=>X(Wu,{optional:!0,skipSelf:!0})||YG()});var nk=Symbol("InputSignalNode#UNSET"),dW=ge(H({},em),{transformFn:void 0,applyValueToInputSignal(n,e){kh(n,e)}});function rk(n,e){let t=Object.create(dW);t.value=n,t.transformFn=e?.transform;function r(){if(Zg(t),t.value===nk){let i=null;throw new he(-950,i)}return t.value}return r[Si]=t,r}function XM(n,e){return rk(n,e)}function hW(n){return rk(nk,n)}var ik=(XM.required=hW,XM);var tS=new Te(""),fW=new Te("");function xf(n){return!n.moduleRef}function pW(n){let e=xf(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ri);return t.run(()=>{xf(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(os),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),xf(n)){let s=()=>e.destroy(),o=n.platformInjector.get(tS);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(tS);o.add(s),n.moduleRef.onDestroy(()=>{lf(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return mW(r,t,()=>{let s=e.get(ha),o=s.add(),a=e.get(JC);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(Wu,Tf);if(QM(c||Tf),!e.get(fW,!0))return xf(n)?e.get(qu):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(xf(n)){let u=e.get(qu);return n.rootComponent!==void 0&&u.bootstrap(n.rootComponent),u}else return gW?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void s.remove(o))})})}var gW;function mW(n,e,t){try{let r=t();return $u(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var xy=null;function yW(n=[],e){return ts.create({name:e,providers:[{provide:Jh,useValue:"platform"},{provide:tS,useValue:new Set([()=>xy=null])},...n]})}function wW(n=[]){if(xy)return xy;let e=yW(n);return xy=e,GM(),vW(e),e}function vW(n){let e=n.get(gy,null);yr(n,()=>{e?.forEach(t=>t())})}var oS=(()=>{class n{static __NG_ELEMENT_ID__=bW}return n})();function bW(n){return EW(Br(),Xe(),(n&16)===16)}function EW(n,e,t){if(la(n)&&!t){let r=is(n.index,e);return new fa(r,r)}else if(n.type&175){let r=e[ii];return new fa(r,e)}return null}var nS=class{constructor(){}supports(e){return WC(e)}create(e){return new rS(e)}},IW=(n,e)=>e,rS=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||IW}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<ek(r,i,s)?t:r,a=ek(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,u=c-i;if(l!=u){for(let h=0;h<l;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}let d=o.previousIndex;s[d]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!WC(e))throw new he(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,kM(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new iS(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Dy),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Dy),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},iS=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},sS=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Dy=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new sS,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function ek(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function tk(){return new aS([new nS])}var aS=(()=>{class n{factories;static \u0275prov=Se({token:n,providedIn:"root",factory:tk});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=X(n,{optional:!0,skipSelf:!0});return n.create(t,r||tk())}}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new he(901,!1)}}return n})();function sk(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;Dt(8);try{let s=i?.injector??wW(r),o=[ZM(),QO,...t||[]],a=new pf({providers:o,parent:s,debugName:"",runEnvironmentInitializers:!1});return pW({r3Injector:a.injector,platformInjector:s,rootComponent:e})}catch(s){return Promise.reject(s)}finally{Dt(9)}}var ck=null;function So(){return ck}function cS(n){ck??=n}var Df=class{},lS=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>X(lk),providedIn:"platform"})}return n})();var lk=(()=>{class n extends lS{_location;_history;_doc=X(Kn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return So().getBaseHref(this._doc)}onPopState(t){let r=So().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=So().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function uk(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function ok(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ma(n){return n&&n[0]!=="?"?`?${n}`:n}var Ry=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>X(hk),providedIn:"root"})}return n})(),dk=new Te(""),hk=(()=>{class n extends Ry{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??X(Kn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return uk(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+ma(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+ma(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+ma(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(Ue(lS),Ue(dk,8))};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ku=(()=>{class n{_subject=new Gn;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=AW(ok(ak(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+ma(r))}normalize(t){return n.stripTrailingSlash(SW(this._basePath,ak(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ma(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ma(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=ma;static joinWithSlash=uk;static stripTrailingSlash=ok;static \u0275fac=function(r){return new(r||n)(Ue(Ry))};static \u0275prov=Se({token:n,factory:()=>CW(),providedIn:"root"})}return n})();function CW(){return new Ku(Ue(Ry))}function SW(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function ak(n){return n.replace(/\/index.html$/,"")}function AW(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var gS=(function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n})(gS||{});var Qn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Qn||{}),Tt=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(Tt||{}),$r=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})($r||{}),qr={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function yk(n){return Ur(n)[Yt.LocaleId]}function wk(n,e,t){let r=Ur(n),i=[r[Yt.DayPeriodsFormat],r[Yt.DayPeriodsStandalone]],s=Mi(i,e);return Mi(s,t)}function vk(n,e,t){let r=Ur(n),i=[r[Yt.DaysFormat],r[Yt.DaysStandalone]],s=Mi(i,e);return Mi(s,t)}function bk(n,e,t){let r=Ur(n),i=[r[Yt.MonthsFormat],r[Yt.MonthsStandalone]],s=Mi(i,e);return Mi(s,t)}function Ek(n,e){let r=Ur(n)[Yt.Eras];return Mi(r,e)}function Nf(n,e){let t=Ur(n);return Mi(t[Yt.DateFormat],e)}function Rf(n,e){let t=Ur(n);return Mi(t[Yt.TimeFormat],e)}function Of(n,e){let r=Ur(n)[Yt.DateTimeFormat];return Mi(r,e)}function Ks(n,e){let t=Ur(n),r=t[Yt.NumberSymbols][e];if(typeof r>"u"){if(e===qr.CurrencyDecimal)return t[Yt.NumberSymbols][qr.Decimal];if(e===qr.CurrencyGroup)return t[Yt.NumberSymbols][qr.Group]}return r}function Ik(n,e){return Ur(n)[Yt.NumberFormats][e]}function Ck(n){if(!n[Yt.ExtraData])throw new he(2303,!1)}function Sk(n){let e=Ur(n);return Ck(e),(e[Yt.ExtraData][2]||[]).map(r=>typeof r=="string"?uS(r):[uS(r[0]),uS(r[1])])}function Ak(n,e,t){let r=Ur(n);Ck(r);let i=[r[Yt.ExtraData][0],r[Yt.ExtraData][1]],s=Mi(i,e)||[];return Mi(s,t)||[]}function Mi(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new he(2304,!1)}function uS(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var _W=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Oy={},TW=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function _k(n,e,t,r){let i=LW(n);e=Ao(t,e)||e;let o=[],a;for(;e;)if(a=TW.exec(e),a){o=o.concat(a.slice(1));let u=o.pop();if(!u)break;e=u}else{o.push(e);break}let c=i.getTimezoneOffset();r&&(c=xk(r,c),i=kW(i,r));let l="";return o.forEach(u=>{let d=PW(u);l+=d?d(i,t,c):u==="''"?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Fy(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function Ao(n,e){let t=yk(n);if(Oy[t]??={},Oy[t][e])return Oy[t][e];let r="";switch(e){case"shortDate":r=Nf(n,$r.Short);break;case"mediumDate":r=Nf(n,$r.Medium);break;case"longDate":r=Nf(n,$r.Long);break;case"fullDate":r=Nf(n,$r.Full);break;case"shortTime":r=Rf(n,$r.Short);break;case"mediumTime":r=Rf(n,$r.Medium);break;case"longTime":r=Rf(n,$r.Long);break;case"fullTime":r=Rf(n,$r.Full);break;case"short":let i=Ao(n,"shortTime"),s=Ao(n,"shortDate");r=Py(Of(n,$r.Short),[i,s]);break;case"medium":let o=Ao(n,"mediumTime"),a=Ao(n,"mediumDate");r=Py(Of(n,$r.Medium),[o,a]);break;case"long":let c=Ao(n,"longTime"),l=Ao(n,"longDate");r=Py(Of(n,$r.Long),[c,l]);break;case"full":let u=Ao(n,"fullTime"),d=Ao(n,"fullDate");r=Py(Of(n,$r.Full),[u,d]);break}return r&&(Oy[t][e]=r),r}function Py(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function us(n,e,t="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function xW(n,e){return us(n,3).substring(0,e)}function on(n,e,t=0,r=!1,i=!1){return function(s,o){let a=DW(n,s);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return xW(a,e);let c=Ks(o,qr.MinusSign);return us(a,e,c,r,i)}}function DW(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new he(2301,!1)}}function Lt(n,e,t=Qn.Format,r=!1){return function(i,s){return NW(i,s,n,e,t,r)}}function NW(n,e,t,r,i,s){switch(t){case 2:return bk(e,i,r)[n.getMonth()];case 1:return vk(e,i,r)[n.getDay()];case 0:let o=n.getHours(),a=n.getMinutes();if(s){let l=Sk(e),u=Ak(e,i,r),d=l.findIndex(h=>{if(Array.isArray(h)){let[f,p]=h,g=o>=f.hours&&a>=f.minutes,m=o<p.hours||o===p.hours&&a<p.minutes;if(f.hours<p.hours){if(g&&m)return!0}else if(g||m)return!0}else if(h.hours===o&&h.minutes===a)return!0;return!1});if(d!==-1)return u[d]}return wk(e,i,r)[o<12?0:1];case 3:return Ek(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new he(2302,!1)}}function My(n){return function(e,t,r){let i=-1*r,s=Ks(t,qr.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+us(o,2,s)+us(Math.abs(i%60),2,s);case 1:return"GMT"+(i>=0?"+":"")+us(o,1,s);case 2:return"GMT"+(i>=0?"+":"")+us(o,2,s)+":"+us(Math.abs(i%60),2,s);case 3:return r===0?"Z":(i>=0?"+":"")+us(o,2,s)+":"+us(Math.abs(i%60),2,s);default:throw new he(2310,!1)}}}var RW=0,Ly=4;function OW(n){let e=Fy(n,RW,1).getDay();return Fy(n,0,1+(e<=Ly?Ly:Ly+7)-e)}function Tk(n){let e=n.getDay(),t=e===0?-3:Ly-e;return Fy(n.getFullYear(),n.getMonth(),n.getDate()+t)}function dS(n,e=!1){return function(t,r){let i;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{let s=Tk(t),o=OW(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return us(i,n,Ks(r,qr.MinusSign))}}function ky(n,e=!1){return function(t,r){let s=Tk(t).getFullYear();return us(s,n,Ks(r,qr.MinusSign),e)}}var hS={};function PW(n){if(hS[n])return hS[n];let e;switch(n){case"G":case"GG":case"GGG":e=Lt(3,Tt.Abbreviated);break;case"GGGG":e=Lt(3,Tt.Wide);break;case"GGGGG":e=Lt(3,Tt.Narrow);break;case"y":e=on(0,1,0,!1,!0);break;case"yy":e=on(0,2,0,!0,!0);break;case"yyy":e=on(0,3,0,!1,!0);break;case"yyyy":e=on(0,4,0,!1,!0);break;case"Y":e=ky(1);break;case"YY":e=ky(2,!0);break;case"YYY":e=ky(3);break;case"YYYY":e=ky(4);break;case"M":case"L":e=on(1,1,1);break;case"MM":case"LL":e=on(1,2,1);break;case"MMM":e=Lt(2,Tt.Abbreviated);break;case"MMMM":e=Lt(2,Tt.Wide);break;case"MMMMM":e=Lt(2,Tt.Narrow);break;case"LLL":e=Lt(2,Tt.Abbreviated,Qn.Standalone);break;case"LLLL":e=Lt(2,Tt.Wide,Qn.Standalone);break;case"LLLLL":e=Lt(2,Tt.Narrow,Qn.Standalone);break;case"w":e=dS(1);break;case"ww":e=dS(2);break;case"W":e=dS(1,!0);break;case"d":e=on(2,1);break;case"dd":e=on(2,2);break;case"c":case"cc":e=on(7,1);break;case"ccc":e=Lt(1,Tt.Abbreviated,Qn.Standalone);break;case"cccc":e=Lt(1,Tt.Wide,Qn.Standalone);break;case"ccccc":e=Lt(1,Tt.Narrow,Qn.Standalone);break;case"cccccc":e=Lt(1,Tt.Short,Qn.Standalone);break;case"E":case"EE":case"EEE":e=Lt(1,Tt.Abbreviated);break;case"EEEE":e=Lt(1,Tt.Wide);break;case"EEEEE":e=Lt(1,Tt.Narrow);break;case"EEEEEE":e=Lt(1,Tt.Short);break;case"a":case"aa":case"aaa":e=Lt(0,Tt.Abbreviated);break;case"aaaa":e=Lt(0,Tt.Wide);break;case"aaaaa":e=Lt(0,Tt.Narrow);break;case"b":case"bb":case"bbb":e=Lt(0,Tt.Abbreviated,Qn.Standalone,!0);break;case"bbbb":e=Lt(0,Tt.Wide,Qn.Standalone,!0);break;case"bbbbb":e=Lt(0,Tt.Narrow,Qn.Standalone,!0);break;case"B":case"BB":case"BBB":e=Lt(0,Tt.Abbreviated,Qn.Format,!0);break;case"BBBB":e=Lt(0,Tt.Wide,Qn.Format,!0);break;case"BBBBB":e=Lt(0,Tt.Narrow,Qn.Format,!0);break;case"h":e=on(3,1,-12);break;case"hh":e=on(3,2,-12);break;case"H":e=on(3,1);break;case"HH":e=on(3,2);break;case"m":e=on(4,1);break;case"mm":e=on(4,2);break;case"s":e=on(5,1);break;case"ss":e=on(5,2);break;case"S":e=on(6,1);break;case"SS":e=on(6,2);break;case"SSS":e=on(6,3);break;case"Z":case"ZZ":case"ZZZ":e=My(0);break;case"ZZZZZ":e=My(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=My(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=My(2);break;default:return null}return hS[n]=e,e}function xk(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function MW(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function kW(n,e,t){let i=n.getTimezoneOffset(),s=xk(e,i);return MW(n,-1*(s-i))}function LW(n){if(fk(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,o=1]=n.split("-").map(a=>+a);return Fy(i,s-1,o)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(_W))return FW(r)}let e=new Date(n);if(!fk(e))throw new he(2311,!1);return e}function FW(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let o=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),l=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,o,a,c,l),e}function fk(n){return n instanceof Date&&!isNaN(n.valueOf())}var BW=/^(\d+)?\.((\d+)(-(\d+))?)?$/,pk=22,By=".",Pf="0",UW=";",jW=",",fS="#";function VW(n,e,t,r,i,s,o=!1){let a="",c=!1;if(!isFinite(n))a=Ks(t,qr.Infinity);else{let l=qW(n);o&&(l=$W(l));let u=e.minInt,d=e.minFrac,h=e.maxFrac;if(s){let E=s.match(BW);if(E===null)throw new he(2306,!1);let I=E[1],L=E[3],k=E[5];I!=null&&(u=pS(I)),L!=null&&(d=pS(L)),k!=null?h=pS(k):L!=null&&d>h&&(h=d)}zW(l,d,h);let f=l.digits,p=l.integerLen,g=l.exponent,m=[];for(c=f.every(E=>!E);p<u;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?m=f.splice(p,f.length):(m=f,f=[0]);let y=[];for(f.length>=e.lgSize&&y.unshift(f.splice(-e.lgSize,f.length).join(""));f.length>e.gSize;)y.unshift(f.splice(-e.gSize,f.length).join(""));f.length&&y.unshift(f.join("")),a=y.join(Ks(t,r)),m.length&&(a+=Ks(t,i)+m.join("")),g&&(a+=Ks(t,qr.Exponential)+"+"+g)}return n<0&&!c?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function Dk(n,e,t){let r=Ik(e,gS.Decimal),i=HW(r,Ks(e,qr.MinusSign));return VW(n,i,e,qr.Group,qr.Decimal,t)}function HW(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(UW),i=r[0],s=r[1],o=i.indexOf(By)!==-1?i.split(By):[i.substring(0,i.lastIndexOf(Pf)+1),i.substring(i.lastIndexOf(Pf)+1)],a=o[0],c=o[1]||"";t.posPre=a.substring(0,a.indexOf(fS));for(let u=0;u<c.length;u++){let d=c.charAt(u);d===Pf?t.minFrac=t.maxFrac=u+1:d===fS?t.maxFrac=u+1:t.posSuf+=d}let l=a.split(jW);if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,s){let u=i.length-t.posPre.length-t.posSuf.length,d=s.indexOf(fS);t.negPre=s.substring(0,d).replace(/'/g,""),t.negSuf=s.slice(d+u).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function $W(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function qW(n){let e=Math.abs(n)+"",t=0,r,i,s,o,a;for((i=e.indexOf(By))>-1&&(e=e.replace(By,"")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;e.charAt(s)===Pf;s++);if(s===(a=e.length))r=[0],i=1;else{for(a--;e.charAt(a)===Pf;)a--;for(i-=s,r=[],o=0;s<=a;s++,o++)r[o]=Number(e.charAt(s))}return i>pk&&(r=r.splice(0,pk-1),t=i-1,i=1),{digits:r,exponent:t,integerLen:i}}function zW(n,e,t){if(e>t)throw new he(2307,!1);let r=n.digits,i=r.length-n.integerLen,s=Math.min(Math.max(e,i),t),o=s+n.integerLen,a=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let d=o;d<r.length;d++)r[d]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,o=s+1),r[0]=0;for(let d=1;d<o;d++)r[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;i<Math.max(0,s);i++)r.push(0);let c=s!==0,l=e+n.integerLen,u=r.reduceRight(function(d,h,f,p){return h=h+d,p[f]=h<10?h:h-10,c&&(p[f]===0&&f>=l?p.pop():c=!1),h>=10?1:0},0);u&&(r.unshift(u),n.integerLen++)}function pS(n){let e=parseInt(n);if(isNaN(e))throw new he(2305,!1);return e}var Uy=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Qu=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Uy(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),gk(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);gk(s,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(oi(tl),oi(bf),oi(aS))};static \u0275dir=Hu({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function gk(n,e){n.context.$implicit=e.item}var Mf=(()=>{class n{_viewContainer;_context=new jy;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){mk(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){mk(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(oi(tl),oi(bf))};static \u0275dir=Hu({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),jy=class{$implicit=null;ngIf=null};function mk(n,e){if(n&&!n.createEmbeddedView)throw new he(2020,!1)}function Nk(n,e){return new he(2100,!1)}var GW="mediumDate",Rk=new Te(""),Ok=new Te(""),mS=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,s){if(t==null||t===""||t!==t)return null;try{let o=r??this.defaultOptions?.dateFormat??GW,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return _k(t,o,s||this.locale,a)}catch(o){throw Nk(n,o.message)}}static \u0275fac=function(r){return new(r||n)(oi(Wu,16),oi(Rk,24),oi(Ok,24))};static \u0275pipe=Ay({name:"date",type:n,pure:!0})}return n})();var kf=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,r,i){if(!WW(t))return null;i||=this._locale;try{let s=KW(t);return Dk(s,i,r)}catch(s){throw Nk(n,s.message)}}static \u0275fac=function(r){return new(r||n)(oi(Wu,16))};static \u0275pipe=Ay({name:"number",type:n,pure:!0})}return n})();function WW(n){return!(n==null||n===""||n!==n)}function KW(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new he(2309,!1);return n}var Qs=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Sf({type:n});static \u0275inj=Tu({})}return n})();function yS(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Lf=class{};var Pk="browser";var Ff=class{_doc;constructor(e){this._doc=e}manager},Vy=(()=>{class n extends Ff{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(Ue(Kn))};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),qy=new Te(""),IS=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(o=>{o.manager=this});let i=t.filter(o=>!(o instanceof Vy));this._plugins=i.slice().reverse();let s=t.find(o=>o instanceof Vy);s&&this._plugins.push(s)}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new he(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(Ue(qy),Ue(ri))};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),vS="ng-app-id";function Mk(n){for(let e of n)e.remove()}function kk(n,e){let t=e.createElement("style");return t.textContent=n,t}function QW(n,e,t,r){let i=n.head?.querySelectorAll(`style[${vS}="${e}"],link[${vS}="${e}"]`);if(i)for(let s of i)s.removeAttribute(vS),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function ES(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var CS=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,QW(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,kk);r?.forEach(i=>this.addUsage(i,this.external,ES))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(Mk(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Mk(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,kk(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,ES(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(Ue(Kn),Ue(py),Ue(my,8),Ue(yf))};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),bS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},SS=/%COMP%/g;var Fk="%COMP%",YW=`_nghost-${Fk}`,JW=`_ngcontent-${Fk}`,ZW=!0,XW=new Te("",{factory:()=>ZW});function eK(n){return JW.replace(SS,n)}function tK(n){return YW.replace(SS,n)}function Bk(n,e){return e.map(t=>t.replace(SS,n))}var AS=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,a,c=null,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=a,this.nonce=c,this.tracingService=l,this.platformIsServer=!1,this.defaultRenderer=new Bf(t,o,a,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof $y?i.applyToHost(t):i instanceof Uf&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,h=this.tracingService;switch(r.encapsulation){case cs.Emulated:s=new $y(c,l,r,this.appId,u,o,a,d,h);break;case cs.ShadowDom:return new Hy(c,t,r,o,a,this.nonce,d,h,l);case cs.ExperimentalIsolatedShadowDom:return new Hy(c,t,r,o,a,this.nonce,d,h);default:s=new Uf(c,l,r,u,o,a,d,h);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(Ue(IS),Ue(CS),Ue(py),Ue(XW),Ue(Kn),Ue(ri),Ue(my),Ue(wf,8))};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),Bf=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(bS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Lk(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Lk(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new he(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=bS[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=bS[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ws.DashCase|Ws.Important)?e.style.setProperty(t,r,i&Ws.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ws.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=So().getGlobalEventTarget(this.doc,e),!e))throw new he(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function Lk(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Hy=class extends Bf{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,s,o,a,c,l){super(e,i,s,a,c),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let u=r.styles;u=Bk(r.id,u);for(let h of u){let f=document.createElement("style");o&&f.setAttribute("nonce",o),f.textContent=h,this.shadowRoot.appendChild(f)}let d=r.getExternalStyles?.();if(d)for(let h of d){let f=ES(h,i);o&&f.setAttribute("nonce",o),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Uf=class extends Bf{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,a,c,l){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let u=r.styles;this.styles=l?Bk(l,u):u,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Yc.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},$y=class extends Uf{contentAttr;hostAttr;constructor(e,t,r,i,s,o,a,c,l){let u=i+"-"+r.id;super(e,t,r,s,o,a,c,l,u),this.contentAttr=eK(u),this.hostAttr=tK(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var zy=class n extends Df{supportsDOMEvents=!0;static makeCurrent(){cS(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=nK();return t==null?null:rK(t)}resetBaseElement(){jf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return yS(document.cookie,e)}},jf=null;function nK(){return jf=jf||document.head.querySelector("base"),jf?jf.getAttribute("href"):null}function rK(n){return new URL(n,document.baseURI).pathname}var iK=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),Uk=["alt","control","meta","shift"],sK={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},oK={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},jk=(()=>{class n extends Ff{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>So().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),Uk.forEach(l=>{let u=r.indexOf(l);u>-1&&(r.splice(u,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=sK[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Uk.forEach(o=>{if(o!==i){let a=oK[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(Ue(Kn))};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();function _S(n,e,t){let r=H({rootComponent:n,platformRef:t?.platformRef},aK(e));return sk(r)}function aK(n){return{appProviders:[...hK,...n?.providers??[]],platformProviders:dK}}function cK(){zy.makeCurrent()}function lK(){return new mo}function uK(){return TC(document),document}var dK=[{provide:yf,useValue:Pk},{provide:gy,useValue:cK,multi:!0},{provide:Kn,useFactory:uK}];var hK=[{provide:Jh,useValue:"root"},{provide:mo,useFactory:lK},{provide:qy,useClass:Vy,multi:!0},{provide:qy,useClass:jk,multi:!0},AS,CS,IS,{provide:Jc,useExisting:AS},{provide:Lf,useClass:iK},[]];var Vk=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(Ue(Kn))};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Me="primary",Xf=Symbol("RouteTitle"),RS=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ol(n){return new RS(n)}function Yk(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Jy(n){return new Promise((e,t)=>{n.pipe(fo()).subscribe({next:r=>e(r),error:r=>t(r)})})}function pK(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ys(n[t],e[t]))return!1;return!0}function Ys(n,e){let t=n?OS(n):void 0,r=e?OS(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Jk(n[i],e[i]))return!1;return!0}function OS(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Jk(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Zk(n){return n.length>0?n[n.length-1]:null}function cl(n){return wm(n)?n:$u(n)?Cn(Promise.resolve(n)):Ge(n)}function Xk(n){return wm(n)?Jy(n):Promise.resolve(n)}var gK={exact:t2,subset:n2},e2={exact:mK,subset:yK,ignored:()=>!0};function Hk(n,e,t){return gK[t.paths](n.root,e.root,t.matrixParams)&&e2[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function mK(n,e){return Ys(n,e)}function t2(n,e,t){if(!il(n.segments,e.segments)||!Ky(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!t2(n.children[r],e.children[r],t))return!1;return!0}function yK(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Jk(n[t],e[t]))}function n2(n,e,t){return r2(n,e,e.segments,t)}function r2(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!il(i,t)||e.hasChildren()||!Ky(i,t,r))}else if(n.segments.length===t.length){if(!il(n.segments,t)||!Ky(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!n2(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!il(n.segments,i)||!Ky(n.segments,i,r)||!n.children[Me]?!1:r2(n.children[Me],e,s,r)}}function Ky(n,e,t){return e.every((r,i)=>e2[t](n[i].parameters,r.parameters))}var hs=class{root;queryParams;fragment;_queryParamMap;constructor(e=new dt([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ol(this.queryParams),this._queryParamMap}toString(){return bK.serialize(this)}},dt=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Qy(this)}},ya=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ol(this.parameters),this._parameterMap}toString(){return s2(this)}};function wK(n,e){return il(n,e)&&n.every((t,r)=>Ys(t.parameters,e[r].parameters))}function il(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function vK(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Me&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Me&&(t=t.concat(e(i,r)))}),t}var ep=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>new wa,providedIn:"root"})}return n})(),wa=class{parse(e){let t=new MS(e);return new hs(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Vf(e.root,!0)}`,r=CK(e.queryParams),i=typeof e.fragment=="string"?`#${EK(e.fragment)}`:"";return`${t}${r}${i}`}},bK=new wa;function Qy(n){return n.segments.map(e=>s2(e)).join("/")}function Vf(n,e){if(!n.hasChildren())return Qy(n);if(e){let t=n.children[Me]?Vf(n.children[Me],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==Me&&r.push(`${i}:${Vf(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=vK(n,(r,i)=>i===Me?[Vf(n.children[Me],!1)]:[`${i}:${Vf(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Me]!=null?`${Qy(n)}/${t[0]}`:`${Qy(n)}/(${t.join("//")})`}}function i2(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Gy(n){return i2(n).replace(/%3B/gi,";")}function EK(n){return encodeURI(n)}function PS(n){return i2(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Yy(n){return decodeURIComponent(n)}function $k(n){return Yy(n.replace(/\+/g,"%20"))}function s2(n){return`${PS(n.path)}${IK(n.parameters)}`}function IK(n){return Object.entries(n).map(([e,t])=>`;${PS(e)}=${PS(t)}`).join("")}function CK(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Gy(t)}=${Gy(i)}`).join("&"):`${Gy(t)}=${Gy(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var SK=/^[^\/()?;#]+/;function TS(n){let e=n.match(SK);return e?e[0]:""}var AK=/^[^\/()?;=#]+/;function _K(n){let e=n.match(AK);return e?e[0]:""}var TK=/^[^=?&#]+/;function xK(n){let e=n.match(TK);return e?e[0]:""}var DK=/^[^&#]+/;function NK(n){let e=n.match(DK);return e?e[0]:""}var MS=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new dt([],{}):new dt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Me]=new dt(e,t)),r}parseSegment(){let e=TS(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new he(4009,!1);return this.capture(e),new ya(Yy(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=_K(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=TS(this.remaining);i&&(r=i,this.capture(r))}e[Yy(t)]=Yy(r)}parseQueryParam(e){let t=xK(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=NK(this.remaining);o&&(r=o,this.capture(r))}let i=$k(t),s=$k(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=TS(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new he(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Me);let o=this.parseChildren();t[s??Me]=Object.keys(o).length===1&&o[Me]?o[Me]:new dt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new he(4011,!1)}};function o2(n){return n.segments.length>0?new dt([],{[Me]:n}):n}function a2(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=a2(i);if(r===Me&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new dt(n.segments,e);return RK(t)}function RK(n){if(n.numberOfChildren===1&&n.children[Me]){let e=n.children[Me];return new dt(n.segments.concat(e.segments),e.children)}return n}function Xu(n){return n instanceof hs}function c2(n,e,t=null,r=null,i=new wa){let s=l2(n);return u2(s,e,t,r,i)}function l2(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new dt(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=o2(r);return e??i}function u2(n,e,t,r,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return xS(s,s,s,t,r,i);let o=OK(e);if(o.toRoot())return xS(s,s,new dt([],{}),t,r,i);let a=PK(o,s,n),c=a.processChildren?$f(a.segmentGroup,a.index,o.commands):h2(a.segmentGroup,a.index,o.commands);return xS(s,a.segmentGroup,c,t,r,i)}function Zy(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Gf(n){return typeof n=="object"&&n!=null&&n.outlets}function qk(n,e,t){n||="\u0275";let r=new hs;return r.queryParams={[n]:e},t.parse(t.serialize(r)).queryParams[n]}function xS(n,e,t,r,i,s){let o={};for(let[l,u]of Object.entries(r??{}))o[l]=Array.isArray(u)?u.map(d=>qk(l,d,s)):qk(l,u,s);let a;n===e?a=t:a=d2(n,e,t);let c=o2(a2(a));return new hs(c,o,i)}function d2(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=d2(s,e,t)}),new dt(n.segments,r)}var Xy=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Zy(r[0]))throw new he(4003,!1);let i=r.find(Gf);if(i&&i!==Zk(r))throw new he(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function OK(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Xy(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Xy(t,e,r)}var Ju=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function PK(n,e,t){if(n.isAbsolute)return new Ju(e,!0,0);if(!t)return new Ju(e,!1,NaN);if(t.parent===null)return new Ju(t,!0,0);let r=Zy(n.commands[0])?0:1,i=t.segments.length-1+r;return MK(t,i,n.numberOfDoubleDots)}function MK(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new he(4005,!1);i=r.segments.length}return new Ju(r,!1,i-s)}function kK(n){return Gf(n[0])?n[0].outlets:{[Me]:n}}function h2(n,e,t){if(n??=new dt([],{}),n.segments.length===0&&n.hasChildren())return $f(n,e,t);let r=LK(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new dt(n.segments.slice(0,r.pathIndex),{});return s.children[Me]=new dt(n.segments.slice(r.pathIndex),n.children),$f(s,0,i)}else return r.match&&i.length===0?new dt(n.segments,{}):r.match&&!n.hasChildren()?kS(n,e,t):r.match?$f(n,0,i):kS(n,e,t)}function $f(n,e,t){if(t.length===0)return new dt(n.segments,{});{let r=kK(t),i={};if(Object.keys(r).some(s=>s!==Me)&&n.children[Me]&&n.numberOfChildren===1&&n.children[Me].segments.length===0){let s=$f(n.children[Me],e,t);return new dt(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=h2(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new dt(n.segments,i)}}function LK(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Gf(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!Gk(c,l,o))return s;r+=2}else{if(!Gk(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function kS(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Gf(s)){let c=FK(s.outlets);return new dt(r,c)}if(i===0&&Zy(t[0])){let c=n.segments[e];r.push(new ya(c.path,zk(t[0]))),i++;continue}let o=Gf(s)?s.outlets[Me]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Zy(a)?(r.push(new ya(o,zk(a))),i+=2):(r.push(new ya(o,{})),i++)}return new dt(r,{})}function FK(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=kS(new dt([],{}),0,r))}),e}function zk(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Gk(n,e,t){return n==t.path&&Ys(e,t.parameters)}var qf="imperative",_n=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(_n||{}),ci=class{id;url;constructor(e,t){this.id=e,this.url=t}},al=class extends ci{type=_n.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},_o=class extends ci{urlAfterRedirects;type=_n.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Ir=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Ir||{}),Wf=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Wf||{}),Js=class extends ci{reason;code;type=_n.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},To=class extends ci{reason;code;type=_n.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},ed=class extends ci{error;target;type=_n.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Kf=class extends ci{urlAfterRedirects;state;type=_n.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ew=class extends ci{urlAfterRedirects;state;type=_n.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},tw=class extends ci{urlAfterRedirects;state;shouldActivate;type=_n.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},nw=class extends ci{urlAfterRedirects;state;type=_n.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rw=class extends ci{urlAfterRedirects;state;type=_n.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},iw=class{route;type=_n.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},sw=class{route;type=_n.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ow=class{snapshot;type=_n.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},aw=class{snapshot;type=_n.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},cw=class{snapshot;type=_n.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lw=class{snapshot;type=_n.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Qf=class{},td=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function BK(n){return!(n instanceof Qf)&&!(n instanceof td)}function UK(n,e){return n.providers&&!n._injector&&(n._injector=Cf(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ds(n){return n.outlet||Me}function jK(n,e){let t=n.filter(r=>ds(r)===e);return t.push(...n.filter(r=>ds(r)!==e)),t}function id(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var uw=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return id(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new sd(this.rootInjector)}},sd=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new uw(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(Ue(Wn))};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),dw=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=LS(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=LS(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=FS(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return FS(e,this._root).map(t=>t.value)}};function LS(n,e){if(n===e.value)return e;for(let t of e.children){let r=LS(n,t);if(r)return r}return null}function FS(n,e){if(n===e.value)return[e];for(let t of e.children){let r=FS(n,t);if(r.length)return r.unshift(e),r}return[]}var ai=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Yu(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Yf=class extends dw{snapshot;constructor(e,t){super(e),this.snapshot=t,$S(this,e)}toString(){return this.snapshot.toString()}};function f2(n){let e=VK(n),t=new kn([new ya("",{})]),r=new kn({}),i=new kn({}),s=new kn({}),o=new kn(""),a=new va(t,r,s,o,i,Me,n,e.root);return a.snapshot=e.root,new Yf(new ai(a,[]),e)}function VK(n){let e={},t={},r={},s=new sl([],e,r,"",t,Me,n,null,{});return new Jf("",new ai(s,[]))}var va=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe($t(l=>l[Xf]))??Ge(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe($t(e=>ol(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe($t(e=>ol(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function hw(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:H(H({},e.params),n.params),data:H(H({},e.data),n.data),resolve:H(H(H(H({},n.data),e.data),i?.data),n._resolvedData)}:r={params:H({},n.params),data:H({},n.data),resolve:H(H({},n.data),n._resolvedData??{})},i&&g2(i)&&(r.resolve[Xf]=i.title),r}var sl=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Xf]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ol(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ol(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Jf=class extends dw{url;constructor(e,t){super(t),this.url=e,$S(this,t)}toString(){return p2(this._root)}};function $S(n,e){e.value._routerState=n,e.children.forEach(t=>$S(n,t))}function p2(n){let e=n.children.length>0?` { ${n.children.map(p2).join(", ")} } `:"";return`${n.value}${e}`}function DS(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ys(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ys(e.params,t.params)||n.paramsSubject.next(t.params),pK(e.url,t.url)||n.urlSubject.next(t.url),Ys(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function BS(n,e){let t=Ys(n.params,e.params)&&wK(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||BS(n.parent,e.parent))}function g2(n){return typeof n.title=="string"||n.title===null}var m2=new Te(""),tp=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Me;activateEvents=new mr;deactivateEvents=new mr;attachEvents=new mr;detachEvents=new mr;routerOutletData=ik();parentContexts=X(sd);location=X(tl);changeDetector=X(oS);inputBinder=X(mw,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new he(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new he(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new he(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new he(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new US(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Hu({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[uy]})}return n})(),US=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===va?this.route:e===sd?this.childContexts:e===m2?this.outletData:this.parent.get(e,t)}},mw=new Te("");var qS=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ls({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&br(0,"router-outlet")},dependencies:[tp],encapsulation:2})}return n})();function zS(n){let e=n.children&&n.children.map(zS),t=e?ge(H({},n),{children:e}):H({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Me&&(t.component=qS),t}function HK(n,e,t){let r=Zf(n,e._root,t?t._root:void 0);return new Yf(r,e)}function Zf(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=$K(n,e,t);return new ai(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Zf(n,a)),o}}let r=qK(e.value),i=e.children.map(s=>Zf(n,s));return new ai(r,i)}}function $K(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Zf(n,r,i);return Zf(n,r)})}function qK(n){return new va(new kn(n.url),new kn(n.params),new kn(n.queryParams),new kn(n.fragment),new kn(n.data),n.outlet,n.component,n)}var nd=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},y2="ngNavigationCancelingError";function fw(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Xu(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=w2(!1,Ir.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function w2(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[y2]=!0,t.cancellationCode=e,t}function zK(n){return v2(n)&&Xu(n.url)}function v2(n){return!!n&&n[y2]}var GK=(n,e,t,r)=>$t(i=>(new jS(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),jS=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),DS(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Yu(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Yu(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Yu(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Yu(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new lw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new aw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(DS(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),DS(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},pw=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Zu=class{component;route;constructor(e,t){this.component=e,this.route=t}};function WK(n,e,t){let r=n._root,i=e?e._root:null;return Hf(r,i,t,[r.value])}function KK(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function od(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!sI(n)?n:e.get(n):r}function Hf(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Yu(e);return n.children.forEach(o=>{QK(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>zf(a,t.getContext(o),i)),i}function QK(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=YK(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new pw(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Hf(n,e,a?a.children:null,r,i):Hf(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Zu(a.outlet.component,o))}else o&&zf(e,a,i),i.canActivateChecks.push(new pw(r)),s.component?Hf(n,null,a?a.children:null,r,i):Hf(n,null,t,r,i);return i}function YK(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!il(n.url,e.url);case"pathParamsOrQueryParamsChange":return!il(n.url,e.url)||!Ys(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!BS(n,e)||!Ys(n.queryParams,e.queryParams);case"paramsChange":default:return!BS(n,e)}}function zf(n,e,t){let r=Yu(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?zf(o,e.children.getContext(s),t):zf(o,null,t):zf(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Zu(e.outlet.component,i)):t.canDeactivateChecks.push(new Zu(null,i)):t.canDeactivateChecks.push(new Zu(null,i))}function np(n){return typeof n=="function"}function JK(n){return typeof n=="boolean"}function ZK(n){return n&&np(n.canLoad)}function XK(n){return n&&np(n.canActivate)}function eQ(n){return n&&np(n.canActivateChild)}function tQ(n){return n&&np(n.canDeactivate)}function nQ(n){return n&&np(n.canMatch)}function b2(n){return n instanceof Rc||n?.name==="EmptyError"}var Wy=Symbol("INITIAL_VALUE");function rd(){return Vs(n=>UE(n.map(e=>e.pipe(ho(1),HE(Wy)))).pipe($t(e=>{for(let t of e)if(t!==!0){if(t===Wy)return Wy;if(t===!1||rQ(t))return t}return!0}),js(e=>e!==Wy),ho(1)))}function rQ(n){return Xu(n)||n instanceof nd}function E2(n){return n.aborted?Ge(void 0).pipe(ho(1)):new ut(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function I2(n){return jh(E2(n))}function iQ(n,e){return fr(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?Ge(ge(H({},t),{guardsResult:!0})):sQ(o,r,i,n).pipe(fr(a=>a&&JK(a)?oQ(r,s,n,e):Ge(a)),$t(a=>ge(H({},t),{guardsResult:a})))})}function sQ(n,e,t,r){return Cn(n).pipe(fr(i=>dQ(i.component,i.route,t,e,r)),fo(i=>i!==!0,!0))}function oQ(n,e,t,r){return Cn(e).pipe(vm(i=>Cu(cQ(i.route.parent,r),aQ(i.route,r),uQ(n,i.path,t),lQ(n,i.route,t))),fo(i=>i!==!0,!0))}function aQ(n,e){return n!==null&&e&&e(new cw(n)),Ge(!0)}function cQ(n,e){return n!==null&&e&&e(new ow(n)),Ge(!0)}function lQ(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Ge(!0);let i=r.map(s=>Bh(()=>{let o=id(e)??t,a=od(s,o),c=XK(a)?a.canActivate(e,n):yr(o,()=>a(e,n));return cl(c).pipe(fo())}));return Ge(i).pipe(rd())}function uQ(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>KK(o)).filter(o=>o!==null).map(o=>Bh(()=>{let a=o.guards.map(c=>{let l=id(o.node)??t,u=od(c,l),d=eQ(u)?u.canActivateChild(r,n):yr(l,()=>u(r,n));return cl(d).pipe(fo())});return Ge(a).pipe(rd())}));return Ge(s).pipe(rd())}function dQ(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Ge(!0);let o=s.map(a=>{let c=id(e)??i,l=od(a,c),u=tQ(l)?l.canDeactivate(n,e,t,r):yr(c,()=>l(n,e,t,r));return cl(u).pipe(fo())});return Ge(o).pipe(rd())}function hQ(n,e,t,r,i){let s=e.canLoad;if(s===void 0||s.length===0)return Ge(!0);let o=s.map(a=>{let c=od(a,n),l=ZK(c)?c.canLoad(e,t):yr(n,()=>c(e,t)),u=cl(l);return i?u.pipe(I2(i)):u});return Ge(o).pipe(rd(),C2(r))}function C2(n){return kE(pr(e=>{if(typeof e!="boolean")throw fw(n,e)}),$t(e=>e===!0))}function fQ(n,e,t,r,i){let s=e.canMatch;if(!s||s.length===0)return Ge(!0);let o=s.map(a=>{let c=od(a,n),l=nQ(c)?c.canMatch(e,t):yr(n,()=>c(e,t)),u=cl(l);return i?u.pipe(I2(i)):u});return Ge(o).pipe(rd(),C2(r))}var rl=class S2 extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,S2.prototype)}},VS=class A2 extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,A2.prototype)}};function pQ(n){throw new he(4e3,!1)}function gQ(n){throw w2(!1,Ir.GuardRejected)}var mQ=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return r;if(i.numberOfChildren>1||!i.children[Me])throw pQ(`${e.redirectTo}`);i=i.children[Me]}}async applyRedirectCommands(e,t,r,i,s){let o=await yQ(t,i,s);if(o instanceof hs)throw new VS(o);let a=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,r);if(o[0]==="/")throw new VS(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new hs(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new dt(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new he(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function yQ(n,e,t){if(typeof n=="string")return Promise.resolve(n);let r=n,{queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,params:l,data:u,title:d}=e;return Jy(cl(yr(t,()=>r({params:l,data:u,queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,title:d}))))}var HS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function wQ(n,e,t,r,i,s){let o=_2(n,e,t);return o.matched?(r=UK(e,r),fQ(r,e,t,i,s).pipe($t(a=>a===!0?o:H({},HS)))):Ge(o)}function _2(n,e,t){if(e.path==="**")return vQ(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?H({},HS):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Yk)(t,n,e);if(!i)return H({},HS);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?H(H({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function vQ(n){return{matched:!0,parameters:n.length>0?Zk(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Wk(n,e,t,r){return t.length>0&&IQ(n,t,r)?{segmentGroup:new dt(e,EQ(r,new dt(t,n.children))),slicedSegments:[]}:t.length===0&&CQ(n,t,r)?{segmentGroup:new dt(n.segments,bQ(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new dt(n.segments,n.children),slicedSegments:t}}function bQ(n,e,t,r){let i={};for(let s of t)if(yw(n,e,s)&&!r[ds(s)]){let o=new dt([],{});i[ds(s)]=o}return H(H({},r),i)}function EQ(n,e){let t={};t[Me]=e;for(let r of n)if(r.path===""&&ds(r)!==Me){let i=new dt([],{});t[ds(r)]=i}return t}function IQ(n,e,t){return t.some(r=>yw(n,e,r)&&ds(r)!==Me)}function CQ(n,e,t){return t.some(r=>yw(n,e,r))}function yw(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function SQ(n,e,t){return e.length===0&&!n.children[t]}var AQ=class{};async function _Q(n,e,t,r,i,s,o="emptyOnly",a){return new xQ(n,e,t,r,i,o,s,a).recognize()}var TQ=31,xQ=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.abortSignal=c,this.applyRedirects=new mQ(this.urlSerializer,this.urlTree)}noMatchError(e){return new he(4002,`'${e.segmentGroup}'`)}async recognize(){let e=Wk(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(e),i=new ai(r,t),s=new Jf("",i),o=c2(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}async match(e){let t=new sl([],Object.freeze({}),Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Me,this.rootComponentType,null,{});try{return{children:await this.processSegmentGroup(this.injector,this.config,e,Me,t),rootSnapshot:t}}catch(r){if(r instanceof VS)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof rl?this.noMatchError(r):r}}async processSegmentGroup(e,t,r,i,s){if(r.segments.length===0&&r.hasChildren())return this.processChildren(e,t,r,s);let o=await this.processSegment(e,t,r,r.segments,i,!0,s);return o instanceof ai?[o]:[]}async processChildren(e,t,r,i){let s=[];for(let c of Object.keys(r.children))c==="primary"?s.unshift(c):s.push(c);let o=[];for(let c of s){let l=r.children[c],u=jK(t,c),d=await this.processSegmentGroup(e,u,l,c,i);o.push(...d)}let a=T2(o);return DQ(a),a}async processSegment(e,t,r,i,s,o,a){for(let c of t)try{return await this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a)}catch(l){if(l instanceof rl||b2(l))continue;throw l}if(SQ(r,i,s))return new AQ;throw new rl(r)}async processSegmentAgainstRoute(e,t,r,i,s,o,a,c){if(ds(r)!==o&&(o===Me||!yw(i,s,r)))throw new rl(i);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,i,r,s,o,c);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c);throw new rl(i)}async expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=_2(t,i,s);if(!c)throw new rl(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>TQ&&(this.allowRedirects=!1));let f=new sl(s,l,Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,Kk(i),ds(i),i.component??i._loadedComponent??null,i,Qk(i)),p=hw(f,a,this.paramsInheritanceStrategy);if(f.params=Object.freeze(p.params),f.data=Object.freeze(p.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let g=await this.applyRedirects.applyRedirectCommands(u,i.redirectTo,d,f,e),m=await this.applyRedirects.lineralizeSegments(i,g);return this.processSegment(e,r,t,m.concat(h),o,!1,a)}async matchSegmentAgainstRoute(e,t,r,i,s,o){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await Jy(wQ(t,r,i,e,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!a?.matched)throw new rl(t);e=r._injector??e;let{routes:c}=await this.getChildConfig(e,r,i),l=r._loadedInjector??e,{parameters:u,consumedSegments:d,remainingSegments:h}=a,f=new sl(d,u,Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,Kk(r),ds(r),r.component??r._loadedComponent??null,r,Qk(r)),p=hw(f,o,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);let{segmentGroup:g,slicedSegments:m}=Wk(t,d,h,c);if(m.length===0&&g.hasChildren()){let I=await this.processChildren(l,c,g,f);return new ai(f,I)}if(c.length===0&&m.length===0)return new ai(f,[]);let y=ds(r)===s,E=await this.processSegment(l,c,g,m,y?Me:s,!0,f);return new ai(f,E instanceof ai?[E]:[])}async getChildConfig(e,t,r){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0)return{routes:t._loadedRoutes,injector:t._loadedInjector};if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await Jy(hQ(e,t,r,this.urlSerializer,this.abortSignal))){let s=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=s.routes,t._loadedInjector=s.injector,s}throw gQ(t)}return{routes:[],injector:e}}};function DQ(n){n.sort((e,t)=>e.value.outlet===Me?-1:t.value.outlet===Me?1:e.value.outlet.localeCompare(t.value.outlet))}function NQ(n){let e=n.value.routeConfig;return e&&e.path===""}function T2(n){let e=[],t=new Set;for(let r of n){if(!NQ(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=T2(r.children);e.push(new ai(r.value,i))}return e.filter(r=>!t.has(r))}function Kk(n){return n.data||{}}function Qk(n){return n.resolve||{}}var RQ=new Te("",{factory:()=>_Q});function OQ(n,e,t,r,i,s,o){let a=n.get(RQ);return fr(c=>Ge(c).pipe(Vs(l=>a(n,e,t,r,l.extractedUrl,i,s,o)),$t(({state:l,tree:u})=>ge(H({},c),{targetSnapshot:l,urlAfterRedirects:u}))))}function PQ(n,e){return fr(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Ge(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of x2(c))o.add(l);let a=0;return Cn(o).pipe(vm(c=>s.has(c)?MQ(c,r,n,e):(c.data=hw(c,c.parent,n).resolve,Ge(void 0))),pr(()=>a++),bm(1),fr(c=>a===o.size?Ge(t):kr))})}function x2(n){let e=n.children.map(t=>x2(t)).flat();return[n,...e]}function MQ(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!g2(i)&&(s[Xf]=i.title),Bh(()=>(n.data=hw(n,n.parent,t).resolve,kQ(s,n,e,r).pipe($t(o=>(n._resolvedData=o,n.data=H(H({},n.data),o),null)))))}function kQ(n,e,t,r){let i=OS(n);if(i.length===0)return Ge({});let s={};return Cn(i).pipe(fr(o=>LQ(n[o],e,t,r).pipe(fo(),pr(a=>{if(a instanceof nd)throw fw(new wa,a);s[o]=a}))),bm(1),$t(()=>s),Uh(o=>b2(o)?kr:BE(o)))}function LQ(n,e,t,r){let i=id(e)??r,s=od(n,i),o=s.resolve?s.resolve(e,t):yr(i,()=>s(e,t));return cl(o)}function NS(n){return Vs(e=>{let t=n(e);return t?Cn(t).pipe($t(()=>e)):Ge(e)})}var GS=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===Me);return r}getResolvedTitleForRoute(t){return t.data[Xf]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>X(D2),providedIn:"root"})}return n})(),D2=(()=>{class n extends GS{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(Ue(Vk))};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),rp=new Te("",{factory:()=>({})}),ip=new Te(""),N2=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=X(eS);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await Xk(yr(t,()=>r.loadComponent())),o=await P2(O2(s));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o,o}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await R2(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=s.routes,r._loadedInjector=s.injector,s}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function R2(n,e,t,r){let i=await Xk(yr(t,()=>n.loadChildren())),s=await P2(O2(i)),o;s instanceof Sy||Array.isArray(s)?o=s:o=await e.compileModuleAsync(s),r&&r(n);let a,c,l=!1;return Array.isArray(o)?(c=o,l=!0):(a=o.create(t).injector,c=a.get(ip,[],{optional:!0,self:!0}).flat()),{routes:c.map(zS),injector:a}}function FQ(n){return n&&typeof n=="object"&&"default"in n}function O2(n){return FQ(n)?n.default:n}async function P2(n){return n}var ww=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>X(BQ),providedIn:"root"})}return n})(),BQ=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),M2=new Te("");var UQ=()=>{},k2=new Te(""),L2=(()=>{class n{currentNavigation=gt(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=gt(null);events=new Gn;transitionAbortWithErrorSubject=new Gn;configLoader=X(N2);environmentInjector=X(Wn);destroyRef=X(da);urlSerializer=X(ep);rootContexts=X(sd);location=X(Ku);inputBindingEnabled=X(mw,{optional:!0})!==null;titleStrategy=X(GS);options=X(rp,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=X(ww);createViewTransition=X(M2,{optional:!0});navigationErrorHandler=X(k2,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>Ge(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new iw(i)),r=i=>this.events.next(new sw(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;zs(()=>{this.transitions?.next(ge(H({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new kn(null),this.transitions.pipe(js(r=>r!==null),Vs(r=>{let i=!1,s=new AbortController;return Ge(r).pipe(Vs(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Ir.SupersededByNewNavigation),kr;this.currentTransition=r;let a=this.lastSuccessfulNavigation();this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:a?ge(H({},a),{previousNavigation:null}):null,abort:()=>s.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),l=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&l!=="reload")return this.events.next(new To(o.id,this.urlSerializer.serialize(o.rawUrl),"",Wf.IgnoredSameUrlNavigation)),o.resolve(!1),kr;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return Ge(o).pipe(Vs(u=>(this.events.next(new al(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?kr:Promise.resolve(u))),OQ(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,s.signal),pr(u=>{r.targetSnapshot=u.targetSnapshot,r.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation.update(h=>(h.finalUrl=u.urlAfterRedirects,h));let d=new Kf(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:u,extractedUrl:d,source:h,restoredState:f,extras:p}=o,g=new al(u,this.urlSerializer.serialize(d),h,f);this.events.next(g);let m=f2(this.rootComponentType).snapshot;return this.currentTransition=r=ge(H({},o),{targetSnapshot:m,urlAfterRedirects:d,extras:ge(H({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(y=>(y.finalUrl=d,y)),Ge(r)}else return this.events.next(new To(o.id,this.urlSerializer.serialize(o.extractedUrl),"",Wf.IgnoredByUrlHandlingStrategy)),o.resolve(!1),kr}),pr(o=>{let a=new ew(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),$t(o=>(this.currentTransition=r=ge(H({},o),{guards:WK(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),iQ(this.environmentInjector,o=>this.events.next(o)),pr(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw fw(this.urlSerializer,o.guardsResult);let a=new tw(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),js(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",Ir.GuardRejected),!1)),NS(o=>{if(o.guards.canActivateChecks.length!==0)return Ge(o).pipe(pr(a=>{let c=new nw(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Vs(a=>{let c=!1;return Ge(a).pipe(PQ(this.paramsInheritanceStrategy,this.environmentInjector),pr({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",Ir.NoDataFromResolver)}}))}),pr(a=>{let c=new rw(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),NS(o=>{let a=l=>{let u=[];if(l.routeConfig?._loadedComponent)l.component=l.routeConfig?._loadedComponent;else if(l.routeConfig?.loadComponent){let d=id(l)??this.environmentInjector;u.push(this.configLoader.loadComponent(d,l.routeConfig).then(h=>{l.component=h}))}for(let d of l.children)u.push(...a(d));return u},c=a(o.targetSnapshot.root);return c.length===0?Ge(o):Cn(Promise.all(c).then(()=>o))}),NS(()=>this.afterPreactivation()),Vs(()=>{let{currentSnapshot:o,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return c?Cn(c).pipe($t(()=>r)):Ge(r)}),$t(o=>{let a=HK(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=ge(H({},o),{targetRouterState:a}),this.currentNavigation.update(c=>(c.targetRouterState=a,c)),r}),pr(()=>{this.events.next(new Qf)}),GK(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),ho(1),jh(E2(s.signal).pipe(js(()=>!i&&!r.targetRouterState),pr(()=>{this.cancelNavigationTransition(r,s.signal.reason+"",Ir.Aborted)}))),pr({next:o=>{i=!0,this.currentNavigation.update(a=>(a.abort=UQ,a)),this.lastSuccessfulNavigation.set(zs(this.currentNavigation)),this.events.next(new _o(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),jh(this.transitionAbortWithErrorSubject.pipe(pr(o=>{throw o}))),VE(()=>{s.abort(),i||this.cancelNavigationTransition(r,"",Ir.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Uh(o=>{if(this.destroyed)return r.resolve(!1),kr;if(i=!0,v2(o))this.events.next(new Js(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),zK(o)?this.events.next(new td(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let a=new ed(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=yr(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof nd){let{message:l,cancellationCode:u}=fw(this.urlSerializer,c);this.events.next(new Js(r.id,this.urlSerializer.serialize(r.extractedUrl),l,u)),this.events.next(new td(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return kr}))}))}cancelNavigationTransition(t,r,i){let s=new Js(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=zs(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jQ(n){return n!==qf}var F2=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>X(VQ),providedIn:"root"})}return n})(),gw=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},VQ=(()=>{class n extends gw{static \u0275fac=(()=>{let t;return function(i){return(t||(t=hy(n)))(i||n)}})();static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),WS=(()=>{class n{urlSerializer=X(ep);options=X(rp,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=X(Ku);urlHandlingStrategy=X(ww);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new hs;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof hs?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=f2(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:()=>X(B2),providedIn:"root"})}return n})(),B2=(()=>{class n extends WS{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof al?this.updateStateMemento():t instanceof To?this.commitTransition(r):t instanceof Kf?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Qf?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Js&&t.code!==Ir.SupersededByNewNavigation&&t.code!==Ir.Redirect?this.restoreHistory(r):t instanceof ed?this.restoreHistory(r,!0):t instanceof _o&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let a=this.browserPageId,c=H(H({},o),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=H(H({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=hy(n)))(i||n)}})();static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function KS(n,e){n.events.pipe(js(t=>t instanceof _o||t instanceof Js||t instanceof ed||t instanceof To),$t(t=>t instanceof _o||t instanceof To?0:(t instanceof Js?t.code===Ir.Redirect||t.code===Ir.SupersededByNewNavigation:!1)?2:1),js(t=>t!==2),ho(1)).subscribe(()=>{e()})}var HQ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},$Q={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ki=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=X(KC);stateManager=X(WS);options=X(rp,{optional:!0})||{};pendingTasks=X(ha);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=X(L2);urlSerializer=X(ep);location=X(Ku);urlHandlingStrategy=X(ww);injector=X(Wn);_events=new Gn;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=X(F2);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=X(ip,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!X(mw,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Mn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=zs(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Js&&r.code!==Ir.Redirect&&r.code!==Ir.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof _o)this.navigated=!0;else if(r instanceof td){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=H({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||jQ(i.source)},o);this.scheduleNavigation(a,qf,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}BK(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),qf,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=H({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s).catch(c=>{this.disposed||this.injector.get(os)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return zs(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(zS),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=H(H({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let h=i?i.snapshot:this.routerState.snapshot.root;d=l2(h)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),d=this.currentUrlTree.root}return u2(d,t,u,l??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Xu(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,qf,null,r)}navigate(t,r={skipLocationChange:!1}){return qQ(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(_u(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=H({},HQ):r===!1?i=H({},$Q):i=r,Xu(t))return Hk(this.currentUrlTree,t,i);let s=this.parseUrl(t);return Hk(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((d,h)=>{a=d,c=h});let u=this.pendingTasks.add();return KS(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qQ(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new he(4008,!1)}var GQ=new Te("");function QS(n,...e){return jc([{provide:ip,multi:!0,useValue:n},[],{provide:va,useFactory:WQ},{provide:_y,multi:!0,useFactory:KQ},e.map(t=>t.\u0275providers)])}function WQ(){return X(ki).routerState.root}function KQ(){let n=X(ts);return e=>{let t=n.get(qu);if(e!==t.components[0])return;let r=n.get(ki),i=n.get(QQ);n.get(YQ)===1&&r.initialNavigation(),n.get(JQ,null,{optional:!0})?.setUpPreloading(),n.get(GQ,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var QQ=new Te("",{factory:()=>new Gn}),YQ=new Te("",{factory:()=>1});var JQ=new Te("");var U2="6.15.0";function XQ(n,e,t){let r=e.split("|").map(s=>s.trim());for(let s=0;s<r.length;s++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof n===e)return}let i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${t}`,i.value=n,i}async function Jt(n){let e=Object.keys(n);return(await Promise.all(e.map(r=>Promise.resolve(n[r])))).reduce((r,i,s)=>(r[e[s]]=i,r),{})}function ce(n,e,t){for(let r in e){let i=e[r],s=t?t[r]:null;s&&XQ(i,s,r),Object.defineProperty(n,r,{enumerable:!0,value:i,writable:!1})}}function ad(n,e){if(n==null)return"null";if(e==null&&(e=new Set),typeof n=="object"){if(e.has(n))return"[Circular]";e.add(n)}if(Array.isArray(n))return"[ "+n.map(t=>ad(t,e)).join(", ")+" ]";if(n instanceof Uint8Array){let t="0123456789abcdef",r="0x";for(let i=0;i<n.length;i++)r+=t[n[i]>>4],r+=t[n[i]&15];return r}if(typeof n=="object"&&typeof n.toJSON=="function")return ad(n.toJSON(),e);switch(typeof n){case"boolean":case"number":case"symbol":return n.toString();case"bigint":return BigInt(n).toString();case"string":return JSON.stringify(n);case"object":{let t=Object.keys(n);return t.sort(),"{ "+t.map(r=>`${ad(r,e)}: ${ad(n[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Ft(n,e){return n&&n.code===e}function ll(n){return Ft(n,"CALL_EXCEPTION")}function tt(n,e,t){let r=n;{let s=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${ad(t)}`);for(let o in t){if(o==="shortMessage")continue;let a=t[o];s.push(o+"="+ad(a))}}s.push(`code=${e}`),s.push(`version=${U2}`),s.length&&(n+=" ("+s.join(", ")+")")}let i;switch(e){case"INVALID_ARGUMENT":i=new TypeError(n);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":i=new RangeError(n);break;default:i=new Error(n)}return ce(i,{code:e}),t&&Object.assign(i,t),i.shortMessage==null&&ce(i,{shortMessage:r}),i}function G(n,e,t,r){if(!n)throw tt(e,t,r)}function x(n,e,t,r){G(n,e,"INVALID_ARGUMENT",{argument:t,value:r})}function cd(n,e,t){t==null&&(t=""),t&&(t=": "+t),G(n>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:n,expectedCount:e}),G(n<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:n,expectedCount:e})}var eY=["NFD","NFC","NFKD","NFKC"].reduce((n,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"\xE9".normalize("NFD")!=="e\u0301")throw new Error("broken");n.push(e)}catch{}return n},[]);function vw(n){G(eY.indexOf(n)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:n}})}function fs(n,e,t){if(t==null&&(t=""),n!==e){let r=t,i="new";t&&(r+=".",i+=" "+t),G(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:i})}}function V2(n,e,t){if(n instanceof Uint8Array)return t?new Uint8Array(n):n;if(typeof n=="string"&&n.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){let r=new Uint8Array((n.length-2)/2),i=2;for(let s=0;s<r.length;s++)r[s]=parseInt(n.substring(i,i+2),16),i+=2;return r}x(!1,"invalid BytesLike value",e||"value",n)}function ve(n,e){return V2(n,e,!1)}function Zt(n,e){return V2(n,e,!0)}function $e(n,e){return!(typeof n!="string"||!n.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&n.length!==2+2*e||e===!0&&n.length%2!==0)}function ba(n){return $e(n,!0)||n instanceof Uint8Array}var j2="0123456789abcdef";function Z(n){let e=ve(n),t="0x";for(let r=0;r<e.length;r++){let i=e[r];t+=j2[(i&240)>>4]+j2[i&15]}return t}function nt(n){return"0x"+n.map(e=>Z(e).substring(2)).join("")}function ps(n){return $e(n,!0)?(n.length-2)/2:ve(n).length}function Nt(n,e,t){let r=ve(n);return t!=null&&t>r.length&&G(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:t}),Z(r.slice(e??0,t??r.length))}function H2(n,e,t){let r=ve(n);G(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});let i=new Uint8Array(e);return i.fill(0),t?i.set(r,e-r.length):i.set(r,0),Z(i)}function Yn(n,e){return H2(n,e,!0)}function bw(n,e){return H2(n,e,!1)}var Ew=BigInt(0),gs=BigInt(1),ld=9007199254740991;function Ea(n,e){let t=dd(n,"value"),r=BigInt(Ie(e,"width"));if(G(t>>r===Ew,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:n}),t>>r-gs){let i=(gs<<r)-gs;return-((~t&i)+gs)}return t}function ud(n,e){let t=ne(n,"value"),r=BigInt(Ie(e,"width")),i=gs<<r-gs;if(t<Ew){t=-t,G(t<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});let s=(gs<<r)-gs;return(~t&s)+gs}else G(t<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});return t}function Li(n,e){let t=dd(n,"value"),r=BigInt(Ie(e,"bits"));return t&(gs<<r)-gs}function ne(n,e){switch(typeof n){case"bigint":return n;case"number":return x(Number.isInteger(n),"underflow",e||"value",n),x(n>=-ld&&n<=ld,"overflow",e||"value",n),BigInt(n);case"string":try{if(n==="")throw new Error("empty string");return n[0]==="-"&&n[1]!=="-"?-BigInt(n.substring(1)):BigInt(n)}catch(t){x(!1,`invalid BigNumberish string: ${t.message}`,e||"value",n)}}x(!1,"invalid BigNumberish value",e||"value",n)}function dd(n,e){let t=ne(n,e);return G(t>=Ew,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:n}),t}var $2="0123456789abcdef";function xo(n){if(n instanceof Uint8Array){let e="0x0";for(let t of n)e+=$2[t>>4],e+=$2[t&15];return BigInt(e)}return ne(n)}function Ie(n,e){switch(typeof n){case"bigint":return x(n>=-ld&&n<=ld,"overflow",e||"value",n),Number(n);case"number":return x(Number.isInteger(n),"underflow",e||"value",n),x(n>=-ld&&n<=ld,"overflow",e||"value",n),n;case"string":try{if(n==="")throw new Error("empty string");return Ie(BigInt(n),e)}catch(t){x(!1,`invalid numeric string: ${t.message}`,e||"value",n)}}x(!1,"invalid numeric value",e||"value",n)}function Iw(n){return Ie(xo(n))}function Cr(n,e){let r=dd(n,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{let i=Ie(e,"width");for(G(i*2>=r.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:n});r.length<i*2;)r="0"+r}return"0x"+r}function Vt(n){let e=dd(n,"value");if(e===Ew)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);let r=new Uint8Array(t.length/2);for(let i=0;i<r.length;i++){let s=i*2;r[i]=parseInt(t.substring(s,s+2),16)}return r}function Jn(n){let e=Z(ba(n)?n:Vt(n)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}var q2="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var vke=BigInt(0),z2=BigInt(58);function Cw(n){let e=ve(n),t=xo(e),r="";for(;t;)r=q2[Number(t%z2)]+r,t/=z2;for(let i=0;i<e.length&&!e[i];i++)r=q2[0]+r;return r}function YS(n){n=atob(n);let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return ve(e)}function JS(n){let e=ve(n),t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}var Ia=class{filter;emitter;#e;constructor(e,t,r){this.#e=t,ce(this,{emitter:e,filter:r})}async removeListener(){this.#e!=null&&await this.emitter.off(this.filter,this.#e)}};function tY(n,e,t,r,i){x(!1,`invalid codepoint at offset ${e}; ${n}`,"bytes",t)}function G2(n,e,t,r,i){if(n==="BAD_PREFIX"||n==="UNEXPECTED_CONTINUE"){let s=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)s++;return s}return n==="OVERRUN"?t.length-e-1:0}function nY(n,e,t,r,i){return n==="OVERLONG"?(x(typeof i=="number","invalid bad code point for replacement","badCodepoint",i),r.push(i),0):(r.push(65533),G2(n,e,t,r,i))}var ZS=Object.freeze({error:tY,ignore:G2,replace:nY});function rY(n,e){e==null&&(e=ZS.error);let t=ve(n,"bytes"),r=[],i=0;for(;i<t.length;){let s=t[i++];if(s>>7===0){r.push(s);continue}let o=null,a=null;if((s&224)===192)o=1,a=127;else if((s&240)===224)o=2,a=2047;else if((s&248)===240)o=3,a=65535;else{(s&192)===128?i+=e("UNEXPECTED_CONTINUE",i-1,t,r):i+=e("BAD_PREFIX",i-1,t,r);continue}if(i-1+o>=t.length){i+=e("OVERRUN",i-1,t,r);continue}let c=s&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=t[i];if((u&192)!=128){i+=e("MISSING_CONTINUE",i,t,r),c=null;break}c=c<<6|u&63,i++}if(c!==null){if(c>1114111){i+=e("OUT_OF_RANGE",i-1-o,t,r,c);continue}if(c>=55296&&c<=57343){i+=e("UTF16_SURROGATE",i-1-o,t,r,c);continue}if(c<=a){i+=e("OVERLONG",i-1-o,t,r,c);continue}r.push(c)}}return r}function Zn(n,e){x(typeof n=="string","invalid string value","str",n),e!=null&&(vw(e),n=n.normalize(e));let t=[];for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192),t.push(i&63|128);else if((i&64512)==55296){r++;let s=n.charCodeAt(r);x(r<n.length&&(s&64512)===56320,"invalid surrogate pair","str",n);let o=65536+((i&1023)<<10)+(s&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(i>>12|224),t.push(i>>6&63|128),t.push(i&63|128)}return new Uint8Array(t)}function iY(n){return n.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function Do(n,e){return iY(rY(n,e))}function Sw(n){async function e(t,r){G(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");let i=t.url.split(":")[0].toLowerCase();G(i==="http"||i==="https",`unsupported protocol ${i}`,"UNSUPPORTED_OPERATION",{info:{protocol:i},operation:"request"}),G(i==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let s=null,o=new AbortController,a=setTimeout(()=>{s=tt("request timeout","TIMEOUT"),o.abort()},t.timeout);r&&r.addListener(()=>{s=tt("request cancelled","CANCELLED"),o.abort()});let c=Object.assign({},n,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal}),l;try{l=await fetch(t.url,c)}catch(f){throw clearTimeout(a),s||f}clearTimeout(a);let u={};l.headers.forEach((f,p)=>{u[p.toLowerCase()]=f});let d=await l.arrayBuffer(),h=d==null?null:new Uint8Array(d);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:h}}return e}var Dke=Sw({});var sY=12,oY=250,W2=Sw(),aY=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),cY=new RegExp("^ipfs://(ipfs/)?(.*)$","i"),XS=!1;async function Q2(n,e){try{let t=n.match(aY);if(!t)throw new Error("invalid data");return new Zs(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?YS(t[3]):lY(t[3]))}catch{return new Zs(599,"BAD REQUEST (invalid data: URI)",{},null,new zr(n))}}function Y2(n){async function e(t,r){try{let i=t.match(cY);if(!i)throw new Error("invalid link");return new zr(`${n}${i[2]}`)}catch{return new Zs(599,"BAD REQUEST (invalid IPFS URI)",{},null,new zr(t))}}return e}var Aw={data:Q2,ipfs:Y2("https://gateway.ipfs.io/ipfs/")},J2=new WeakMap,sp=class{#e;#t;constructor(e){this.#e=[],this.#t=!1,J2.set(e,()=>{if(!this.#t){this.#t=!0;for(let t of this.#e)setTimeout(()=>{t()},0);this.#e=[]}})}addListener(e){G(!this.#t,"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),this.#e.push(e)}get cancelled(){return this.#t}checkSignal(){G(!this.cancelled,"cancelled","CANCELLED",{})}};function _w(n){if(n==null)throw new Error("missing signal; should not happen");return n.checkSignal(),n}var zr=class n{#e;#t;#n;#r;#i;#o;#s;#a;#d;#l;#p;#g;#c;#u;#h;get url(){return this.#o}set url(e){this.#o=String(e)}get body(){return this.#s==null?null:new Uint8Array(this.#s)}set body(e){if(e==null)this.#s=void 0,this.#a=void 0;else if(typeof e=="string")this.#s=Zn(e),this.#a="text/plain";else if(e instanceof Uint8Array)this.#s=e,this.#a="application/octet-stream";else if(typeof e=="object")this.#s=Zn(JSON.stringify(e)),this.#a="application/json";else throw new Error("invalid body")}hasBody(){return this.#s!=null}get method(){return this.#r?this.#r:this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),this.#r=String(e).toUpperCase()}get headers(){let e=Object.assign({},this.#n);return this.#d&&(e.authorization=`Basic ${JS(Zn(this.#d))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&this.#a&&(e["content-type"]=this.#a),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){this.#n[String(e).toLowerCase()]=String(t)}clearHeaders(){this.#n={}}[Symbol.iterator](){let e=this.headers,t=Object.keys(e),r=0;return{next:()=>{if(r<t.length){let i=t[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return this.#d||null}setCredentials(e,t){x(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),this.#d=`${e}:${t}`}get allowGzip(){return this.#t}set allowGzip(e){this.#t=!!e}get allowInsecureAuthentication(){return!!this.#e}set allowInsecureAuthentication(e){this.#e=!!e}get timeout(){return this.#i}set timeout(e){x(e>=0,"timeout must be non-zero","timeout",e),this.#i=e}get preflightFunc(){return this.#l||null}set preflightFunc(e){this.#l=e}get processFunc(){return this.#p||null}set processFunc(e){this.#p=e}get retryFunc(){return this.#g||null}set retryFunc(e){this.#g=e}get getUrlFunc(){return this.#h||W2}set getUrlFunc(e){this.#h=e}constructor(e){this.#o=String(e),this.#e=!1,this.#t=!0,this.#n={},this.#r="",this.#i=3e5,this.#u={slotInterval:oY,maxAttempts:sY},this.#h=null}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${this.#s?Z(this.#s):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(this.#u.slotInterval=e.slotInterval),e.maxAttempts!=null&&(this.#u.maxAttempts=e.maxAttempts)}async#f(e,t,r,i,s){if(e>=this.#u.maxAttempts)return s.makeServerError("exceeded maximum retry limit");G(K2()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:i}),r>0&&await uY(r);let o=this.clone(),a=(o.url.split(":")[0]||"").toLowerCase();if(a in Aw){let u=await Aw[a](o.url,_w(i.#c));if(u instanceof Zs){let d=u;if(this.processFunc){_w(i.#c);try{d=await this.processFunc(o,d)}catch(h){(h.throttle==null||typeof h.stall!="number")&&d.makeServerError("error in post-processing function",h).assertOk()}}return d}o=u}this.preflightFunc&&(o=await this.preflightFunc(o));let c=await this.getUrlFunc(o,_w(i.#c)),l=new Zs(c.statusCode,c.statusMessage,c.headers,c.body,i);if(l.statusCode===301||l.statusCode===302){try{let u=l.headers.location||"";return o.redirect(u).#f(e+1,t,0,i,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){let u=l.headers["retry-after"],d=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof u=="string"&&u.match(/^[1-9][0-9]*$/)&&(d=parseInt(u)),o.clone().#f(e+1,t,d,i,l)}if(this.processFunc){_w(i.#c);try{l=await this.processFunc(o,l)}catch(u){(u.throttle==null||typeof u.stall!="number")&&l.makeServerError("error in post-processing function",u).assertOk();let d=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return u.stall>=0&&(d=u.stall),o.clone().#f(e+1,t,d,i,l)}}return l}send(){return G(this.#c==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),this.#c=new sp(this),this.#f(0,K2()+this.timeout,0,this,new Zs(0,"",{},null,this))}cancel(){G(this.#c!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});let e=J2.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){let t=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();G(this.method==="GET"&&(t!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});let i=new n(e);return i.method="GET",i.allowGzip=this.allowGzip,i.timeout=this.timeout,i.#n=Object.assign({},this.#n),this.#s&&(i.#s=new Uint8Array(this.#s)),i.#a=this.#a,i}clone(){let e=new n(this.url);return e.#r=this.#r,this.#s&&(e.#s=this.#s),e.#a=this.#a,e.#n=Object.assign({},this.#n),e.#d=this.#d,this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),e.#l=this.#l,e.#p=this.#p,e.#g=this.#g,e.#u=Object.assign({},this.#u),e.#h=this.#h,e}static lockConfig(){XS=!0}static getGateway(e){return Aw[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(XS)throw new Error("gateways locked");Aw[e]=t}static registerGetUrl(e){if(XS)throw new Error("gateways locked");W2=e}static createGetUrlFunc(e){return Sw(e)}static createDataGateway(){return Q2}static createIpfsGatewayFunc(e){return Y2(e)}},Zs=class n{#e;#t;#n;#r;#i;#o;toString(){return`<FetchResponse status=${this.statusCode} body=${this.#r?Z(this.#r):"null"}>`}get statusCode(){return this.#e}get statusMessage(){return this.#t}get headers(){return Object.assign({},this.#n)}get body(){return this.#r==null?null:new Uint8Array(this.#r)}get bodyText(){try{return this.#r==null?"":Do(this.#r)}catch{G(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{G(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){let e=this.headers,t=Object.keys(e),r=0;return{next:()=>{if(r<t.length){let i=t[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}constructor(e,t,r,i,s){this.#e=e,this.#t=t,this.#n=Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{}),this.#r=i==null?null:new Uint8Array(i),this.#i=s||null,this.#o={message:""}}makeServerError(e,t){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);let i=new n(599,r,this.headers,this.body,this.#i||void 0);return i.#o={message:e,error:t},i}throwThrottleError(e,t){t==null?t=-1:x(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);let r=new Error(e||"throttling requests");throw ce(r,{stall:t,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return this.#r!=null}get request(){return this.#i}ok(){return this.#o.message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=this.#o;e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let i=null;try{this.#r&&(i=Do(this.#r))}catch{}G(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:r,responseBody:i,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};function K2(){return new Date().getTime()}function lY(n){return Zn(n.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function uY(n){return new Promise(e=>setTimeout(e,n))}var dY=BigInt(-1),ms=BigInt(0),fd=BigInt(1),hY=BigInt(5),hd={},pd="0000";for(;pd.length<80;)pd+=pd;function ul(n){let e=pd;for(;e.length<n;)e+=e;return BigInt("1"+e.substring(0,n))}function op(n,e,t){let r=BigInt(e.width);if(e.signed){let i=fd<<r-fd;G(t==null||n>=-i&&n<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n>ms?n=Ea(Li(n,r),r):n=-Ea(Li(-n,r),r)}else{let i=fd<<r;G(t==null||n>=0&&n<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n=(n%i+i)%i&i-fd}return n}function eA(n){typeof n=="number"&&(n=`fixed128x${n}`);let e=!0,t=128,r=18;if(typeof n=="string"){if(n!=="fixed")if(n==="ufixed")e=!1;else{let s=n.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);x(s,"invalid fixed format","format",n),e=s[1]!=="u",t=parseInt(s[2]),r=parseInt(s[3])}}else if(n){let s=n,o=(a,c,l)=>s[a]==null?l:(x(typeof s[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,s[a]),s[a]);e=o("signed","boolean",e),t=o("width","number",t),r=o("decimals","number",r)}x(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),x(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);let i=(e?"":"u")+"fixed"+String(t)+"x"+String(r);return{signed:e,width:t,decimals:r,name:i}}function fY(n,e){let t="";n<ms&&(t="-",n*=dY);let r=n.toString();if(e===0)return t+r;for(;r.length<=e;)r=pd+r;let i=r.length-e;for(r=r.substring(0,i)+"."+r.substring(i);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return t+r}var ap=class n{format;#e;#t;#n;_value;constructor(e,t,r){fs(e,hd,"FixedNumber"),this.#t=t,this.#e=r;let i=fY(t,r.decimals);ce(this,{format:r.name,_value:i}),this.#n=ul(r.decimals)}get signed(){return this.#e.signed}get width(){return this.#e.width}get decimals(){return this.#e.decimals}get value(){return this.#t}#r(e){x(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)}#i(e,t){return e=op(e,this.#e,t),new n(hd,e,this.#e)}#o(e,t){return this.#r(e),this.#i(this.#t+e.#t,t)}addUnsafe(e){return this.#o(e)}add(e){return this.#o(e,"add")}#s(e,t){return this.#r(e),this.#i(this.#t-e.#t,t)}subUnsafe(e){return this.#s(e)}sub(e){return this.#s(e,"sub")}#a(e,t){return this.#r(e),this.#i(this.#t*e.#t/this.#n,t)}mulUnsafe(e){return this.#a(e)}mul(e){return this.#a(e,"mul")}mulSignal(e){this.#r(e);let t=this.#t*e.#t;return G(t%this.#n===ms,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#i(t/this.#n,"mulSignal")}#d(e,t){return G(e.#t!==ms,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#r(e),this.#i(this.#t*this.#n/e.#t,t)}divUnsafe(e){return this.#d(e)}div(e){return this.#d(e,"div")}divSignal(e){G(e.#t!==ms,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#r(e);let t=this.#t*this.#n;return G(t%e.#t===ms,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#i(t/e.#t,"divSignal")}cmp(e){let t=this.value,r=e.value,i=this.decimals-e.decimals;return i>0?r*=ul(i):i<0&&(t*=ul(-i)),t<r?-1:t>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=this.#t;return this.#t<ms&&(e-=this.#n-fd),e=this.#t/this.#n*this.#n,this.#i(e,"floor")}ceiling(){let e=this.#t;return this.#t>ms&&(e+=this.#n-fd),e=this.#t/this.#n*this.#n,this.#i(e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;let t=this.decimals-e,r=hY*ul(t-1),i=this.value+r,s=ul(t);return i=i/s*s,op(i,this.#e,"round"),new n(hd,i,this.#e)}isZero(){return this.#t===ms}isNegative(){return this.#t<ms}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return n.fromString(this.toString(),e)}static fromValue(e,t,r){let i=t==null?0:Ie(t),s=eA(r),o=ne(e,"value"),a=i-s.decimals;if(a>0){let c=ul(a);G(o%c===ms,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=ul(-a));return op(o,s,"fromValue"),new n(hd,o,s)}static fromString(e,t){let r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);x(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);let i=eA(t),s=r[2]||"0",o=r[3]||"";for(;o.length<i.decimals;)o+=pd;G(o.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,i.decimals);let a=BigInt(r[1]+s+o);return op(a,i,"fromString"),new n(hd,a,i)}static fromBytes(e,t){let r=xo(ve(e,"value")),i=eA(t);return i.signed&&(r=Ea(r,i.width)),op(r,i,"fromBytes"),new n(hd,r,i)}};function pY(n){let e=n.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function Z2(n,e,t){let r=0;for(let i=0;i<t;i++)r=r*256+n[e+i];return r}function X2(n,e,t,r){let i=[];for(;t<e+1+r;){let s=eL(n,t);i.push(s.result),t+=s.consumed,G(t<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:n,length:r,offset:e})}return{consumed:1+r,result:i}}function eL(n,e){G(n.length!==0,"data too short","BUFFER_OVERRUN",{buffer:n,length:0,offset:1});let t=r=>{G(r<=n.length,"data short segment too short","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r})};if(n[e]>=248){let r=n[e]-247;t(e+1+r);let i=Z2(n,e+1,r);return t(e+1+r+i),X2(n,e,e+1+r,r+i)}else if(n[e]>=192){let r=n[e]-192;return t(e+1+r),X2(n,e,e+1,r)}else if(n[e]>=184){let r=n[e]-183;t(e+1+r);let i=Z2(n,e+1,r);t(e+1+r+i);let s=Z(n.slice(e+1+r,e+1+r+i));return{consumed:1+r+i,result:s}}else if(n[e]>=128){let r=n[e]-128;t(e+1+r);let i=Z(n.slice(e+1,e+1+r));return{consumed:1+r,result:i}}return{consumed:1,result:pY(n[e])}}function Ca(n){let e=ve(n,"data"),t=eL(e,0);return x(t.consumed===e.length,"unexpected junk after rlp payload","data",n),t.result}function tL(n){let e=[];for(;n;)e.unshift(n&255),n>>=8;return e}function rL(n){if(Array.isArray(n)){let r=[];if(n.forEach(function(s){r=r.concat(rL(s))}),r.length<=55)return r.unshift(192+r.length),r;let i=tL(r.length);return i.unshift(247+i.length),i.concat(r)}let e=Array.prototype.slice.call(ve(n,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;let t=tL(e.length);return t.unshift(183+t.length),t.concat(e)}var nL="0123456789abcdef";function Fi(n){let e="0x";for(let t of rL(n))e+=nL[t>>4],e+=nL[t&15];return e}var gY=["wei","kwei","mwei","gwei","szabo","finney","ether"];function Bi(n,e){let t=18;if(typeof e=="string"){let r=gY.indexOf(e);x(r>=0,"invalid unit","unit",e),t=3*r}else e!=null&&(t=Ie(e,"unit"));return ap.fromValue(n,t,{decimals:t,width:512}).toString()}function Tw(n){return Bi(n,18)}var Ln=32,tA=new Uint8Array(Ln),EY=["then"],xw={},oL=new WeakMap;function dl(n){return oL.get(n)}function iL(n,e){oL.set(n,e)}function cp(n,e){let t=new Error(`deferred error during ABI decoding triggered accessing ${n}`);throw t.error=e,t}function nA(n,e,t){return n.indexOf(null)>=0?e.map((r,i)=>r instanceof No?nA(dl(r),r,t):r):n.reduce((r,i,s)=>{let o=e.getValue(i);return i in r||(t&&o instanceof No&&(o=nA(dl(o),o,t)),r[i]=o),r},{})}var No=class n extends Array{#e;constructor(...e){let t=e[0],r=e[1],i=(e[2]||[]).slice(),s=!0;t!==xw&&(r=e,i=[],s=!1),super(r.length),r.forEach((c,l)=>{this[l]=c});let o=i.reduce((c,l)=>(typeof l=="string"&&c.set(l,(c.get(l)||0)+1),c),new Map);if(iL(this,Object.freeze(r.map((c,l)=>{let u=i[l];return u!=null&&o.get(u)===1?u:null}))),this.#e=[],this.#e==null&&this.#e,!s)return;Object.freeze(this);let a=new Proxy(this,{get:(c,l,u)=>{if(typeof l=="string"){if(l.match(/^[0-9]+$/)){let h=Ie(l,"%index");if(h<0||h>=this.length)throw new RangeError("out of result range");let f=c[h];return f instanceof Error&&cp(`index ${h}`,f),f}if(EY.indexOf(l)>=0)return Reflect.get(c,l,u);let d=c[l];if(d instanceof Function)return function(...h){return d.apply(this===u?c:this,h)};if(!(l in c))return c.getValue.apply(this===u?c:this,[l])}return Reflect.get(c,l,u)}});return iL(a,dl(this)),a}toArray(e){let t=[];return this.forEach((r,i)=>{r instanceof Error&&cp(`index ${i}`,r),e&&r instanceof n&&(r=r.toArray(e)),t.push(r)}),t}toObject(e){let t=dl(this);return t.reduce((r,i,s)=>(G(i!=null,`value at index ${s} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),nA(t,this,e)),{})}slice(e,t){e==null&&(e=0),e<0&&(e+=this.length,e<0&&(e=0)),t==null&&(t=this.length),t<0&&(t+=this.length,t<0&&(t=0)),t>this.length&&(t=this.length);let r=dl(this),i=[],s=[];for(let o=e;o<t;o++)i.push(this[o]),s.push(r[o]);return new n(xw,i,s)}filter(e,t){let r=dl(this),i=[],s=[];for(let o=0;o<this.length;o++){let a=this[o];a instanceof Error&&cp(`index ${o}`,a),e.call(t,a,o,this)&&(i.push(a),s.push(r[o]))}return new n(xw,i,s)}map(e,t){let r=[];for(let i=0;i<this.length;i++){let s=this[i];s instanceof Error&&cp(`index ${i}`,s),r.push(e.call(t,s,i,this))}return r}getValue(e){let t=dl(this).indexOf(e);if(t===-1)return;let r=this[t];return r instanceof Error&&cp(`property ${JSON.stringify(e)}`,r.error),r}static fromItems(e,t){return new n(xw,e,t)}};function sL(n){let e=Vt(n);return G(e.length<=Ln,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Ln,offset:e.length}),e.length!==Ln&&(e=Zt(nt([tA.slice(e.length%Ln),e]))),e}var an=class{name;type;localName;dynamic;constructor(e,t,r,i){ce(this,{name:e,type:t,localName:r,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){x(!1,e,this.localName,t)}},hl=class{#e;#t;constructor(){this.#e=[],this.#t=0}get data(){return nt(this.#e)}get length(){return this.#t}#n(e){return this.#e.push(e),this.#t+=e.length,e.length}appendWriter(e){return this.#n(Zt(e.data))}writeBytes(e){let t=Zt(e),r=t.length%Ln;return r&&(t=Zt(nt([t,tA.slice(r)]))),this.#n(t)}writeValue(e){return this.#n(sL(e))}writeUpdatableValue(){let e=this.#e.length;return this.#e.push(tA),this.#t+=Ln,t=>{this.#e[e]=sL(t)}}},Dw=class n{allowLoose;#e;#t;#n;#r;#i;constructor(e,t,r){ce(this,{allowLoose:!!t}),this.#e=Zt(e),this.#n=0,this.#r=null,this.#i=r??1024,this.#t=0}get data(){return Z(this.#e)}get dataLength(){return this.#e.length}get consumed(){return this.#t}get bytes(){return new Uint8Array(this.#e)}#o(e){if(this.#r)return this.#r.#o(e);this.#n+=e,G(this.#i<1||this.#n<=this.#i*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#i} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Zt(this.#e),offset:this.#t,length:e,info:{bytesRead:this.#n,dataLength:this.dataLength}})}#s(e,t,r){let i=Math.ceil(t/Ln)*Ln;return this.#t+i>this.#e.length&&(this.allowLoose&&r&&this.#t+t<=this.#e.length?i=t:G(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Zt(this.#e),length:this.#e.length,offset:this.#t+i})),this.#e.slice(this.#t,this.#t+i)}subReader(e){let t=new n(this.#e.slice(this.#t+e),this.allowLoose,this.#i);return t.#r=this,t}readBytes(e,t){let r=this.#s(0,e,!!t);return this.#o(e),this.#t+=r.length,r.slice(0,e)}readValue(){return xo(this.readBytes(Ln))}readIndex(){return Iw(this.readBytes(Ln))}};function lp(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function up(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function aL(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");lp(n.outputLen),lp(n.blockLen)}function Ro(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Nw(n,e){up(n);let t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var Rw=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var cL=n=>n instanceof Uint8Array;var lL=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),Ow=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),ys=(n,e)=>n<<32-e|n>>>e,IY=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!IY)throw new Error("Non little-endian hardware is not supported");function CY(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function Aa(n){if(typeof n=="string"&&(n=CY(n)),!cL(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function uL(...n){let e=new Uint8Array(n.reduce((r,i)=>r+i.length,0)),t=0;return n.forEach(r=>{if(!cL(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}var Sa=class{clone(){return this._cloneInto()}},m2e={}.toString;function gd(n){let e=r=>n().update(Aa(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function dL(n){let e=(r,i)=>n(i).update(Aa(r)).digest(),t=n({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}function hL(n=32){if(Rw&&typeof Rw.getRandomValues=="function")return Rw.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}var Pw=class extends Sa{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,aL(e);let r=Aa(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return Ro(this),this.iHash.update(e),this}digestInto(e){Ro(this),up(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},rA=(n,e,t)=>new Pw(n,e).update(t).digest();rA.create=(n,e)=>new Pw(n,e);function SY(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),c=r?4:0,l=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+l,a,r)}var md=class extends Sa{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ow(this.buffer)}update(e){Ro(this);let{view:t,buffer:r,blockLen:i}=this;e=Aa(e);let s=e.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=Ow(e);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ro(this),Nw(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)t[d]=0;SY(r,i-8,BigInt(this.length*8),s),this.process(r,0);let a=Ow(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%t&&e.buffer.set(r),e}};var AY=(n,e,t)=>n&e^~n&t,_Y=(n,e,t)=>n&e^n&t^e&t,TY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ta=new Uint32Array(64),iA=class extends md{constructor(){super(64,32,8,!1),this.A=_a[0]|0,this.B=_a[1]|0,this.C=_a[2]|0,this.D=_a[3]|0,this.E=_a[4]|0,this.F=_a[5]|0,this.G=_a[6]|0,this.H=_a[7]|0}get(){let{A:e,B:t,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[e,t,r,i,s,o,a,c]}set(e,t,r,i,s,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let d=0;d<16;d++,t+=4)Ta[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){let h=Ta[d-15],f=Ta[d-2],p=ys(h,7)^ys(h,18)^h>>>3,g=ys(f,17)^ys(f,19)^f>>>10;Ta[d]=g+Ta[d-7]+p+Ta[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){let h=ys(a,6)^ys(a,11)^ys(a,25),f=u+h+AY(a,c,l)+TY[d]+Ta[d]|0,g=(ys(r,2)^ys(r,13)^ys(r,22))+_Y(r,i,s)|0;u=l,l=c,c=a,a=o+f|0,o=s,s=i,i=r,r=f+g|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,l,u)}roundClean(){Ta.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Mw=gd(()=>new iA);var kw=BigInt(4294967295),sA=BigInt(32);function fL(n,e=!1){return e?{h:Number(n&kw),l:Number(n>>sA&kw)}:{h:Number(n>>sA&kw)|0,l:Number(n&kw)|0}}function oA(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){let{h:s,l:o}=fL(n[i],e);[t[i],r[i]]=[s,o]}return[t,r]}var xY=(n,e)=>BigInt(n>>>0)<<sA|BigInt(e>>>0),DY=(n,e,t)=>n>>>t,NY=(n,e,t)=>n<<32-t|e>>>t,RY=(n,e,t)=>n>>>t|e<<32-t,OY=(n,e,t)=>n<<32-t|e>>>t,PY=(n,e,t)=>n<<64-t|e>>>t-32,MY=(n,e,t)=>n>>>t-32|e<<64-t,kY=(n,e)=>e,LY=(n,e)=>n,aA=(n,e,t)=>n<<t|e>>>32-t,cA=(n,e,t)=>e<<t|n>>>32-t,lA=(n,e,t)=>e<<t-32|n>>>64-t,uA=(n,e,t)=>n<<t-32|e>>>64-t;function FY(n,e,t,r){let i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}var BY=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),UY=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,jY=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),VY=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,HY=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),$Y=(n,e,t,r,i,s)=>e+t+r+i+s+(n/2**32|0)|0;var qY={fromBig:fL,split:oA,toBig:xY,shrSH:DY,shrSL:NY,rotrSH:RY,rotrSL:OY,rotrBH:PY,rotrBL:MY,rotr32H:kY,rotr32L:LY,rotlSH:aA,rotlSL:cA,rotlBH:lA,rotlBL:uA,add:FY,add3L:BY,add3H:UY,add4L:jY,add4H:VY,add5H:$Y,add5L:HY},Be=qY;var[zY,GY]=Be.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),xa=new Uint32Array(80),Da=new Uint32Array(80),dA=class extends md{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m]}set(e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let I=0;I<16;I++,t+=4)xa[I]=e.getUint32(t),Da[I]=e.getUint32(t+=4);for(let I=16;I<80;I++){let L=xa[I-15]|0,k=Da[I-15]|0,D=Be.rotrSH(L,k,1)^Be.rotrSH(L,k,8)^Be.shrSH(L,k,7),B=Be.rotrSL(L,k,1)^Be.rotrSL(L,k,8)^Be.shrSL(L,k,7),U=xa[I-2]|0,T=Da[I-2]|0,$=Be.rotrSH(U,T,19)^Be.rotrBH(U,T,61)^Be.shrSH(U,T,6),W=Be.rotrSL(U,T,19)^Be.rotrBL(U,T,61)^Be.shrSL(U,T,6),M=Be.add4L(B,W,Da[I-7],Da[I-16]),v=Be.add4H(M,D,$,xa[I-7],xa[I-16]);xa[I]=v|0,Da[I]=M|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:y,Hl:E}=this;for(let I=0;I<80;I++){let L=Be.rotrSH(d,h,14)^Be.rotrSH(d,h,18)^Be.rotrBH(d,h,41),k=Be.rotrSL(d,h,14)^Be.rotrSL(d,h,18)^Be.rotrBL(d,h,41),D=d&f^~d&g,B=h&p^~h&m,U=Be.add5L(E,k,B,GY[I],Da[I]),T=Be.add5H(U,y,L,D,zY[I],xa[I]),$=U|0,W=Be.rotrSH(r,i,28)^Be.rotrBH(r,i,34)^Be.rotrBH(r,i,39),M=Be.rotrSL(r,i,28)^Be.rotrBL(r,i,34)^Be.rotrBL(r,i,39),v=r&s^r&a^s&a,b=i&o^i&c^o&c;y=g|0,E=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Be.add(l|0,u|0,T|0,$|0),l=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;let w=Be.add3L($,M,b);r=Be.add3H(w,T,W,v),i=w|0}({h:r,l:i}=Be.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Be.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Be.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Be.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Be.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Be.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Be.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:E}=Be.add(this.Hh|0,this.Hl|0,y|0,E|0),this.set(r,i,s,o,a,c,l,u,d,h,f,p,g,m,y,E)}roundClean(){xa.fill(0),Da.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var pL=gd(()=>new dA);function WY(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}var gL=WY(),k2e=gL.crypto||gL.msCrypto;function hA(n){switch(n){case"sha256":return Mw.create();case"sha512":return pL.create()}x(!1,"invalid hashing algorithm name","algorithm",n)}var[wL,vL,bL]=[[],[],[]],KY=BigInt(0),dp=BigInt(1),QY=BigInt(2),YY=BigInt(7),JY=BigInt(256),ZY=BigInt(113);for(let n=0,e=dp,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],wL.push(2*(5*r+t)),vL.push((n+1)*(n+2)/2%64);let i=KY;for(let s=0;s<7;s++)e=(e<<dp^(e>>YY)*ZY)%JY,e&QY&&(i^=dp<<(dp<<BigInt(s))-dp);bL.push(i)}var[XY,eJ]=oA(bL,!0),mL=(n,e,t)=>t>32?lA(n,e,t):aA(n,e,t),yL=(n,e,t)=>t>32?uA(n,e,t):cA(n,e,t);function tJ(n,e=24){let t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=mL(l,u,1)^t[a],h=yL(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)n[o+f]^=d,n[o+f+1]^=h}let i=n[2],s=n[3];for(let o=0;o<24;o++){let a=vL[o],c=mL(i,s,a),l=yL(i,s,a),u=wL[o];i=n[u],s=n[u+1],n[u]=c,n[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=XY[r],n[1]^=eJ[r]}t.fill(0)}var Lw=class n extends Sa{constructor(e,t,r,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,lp(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=lL(this.state)}keccak(){tJ(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Ro(this);let{blockLen:t,state:r}=this;e=Aa(e);let i=e.length;for(let s=0;s<i;){let o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(t&128)!==0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Ro(this,!1),up(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let o=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return lp(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Nw(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new n(t,r,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}},Na=(n,e,t)=>gd(()=>new Lw(e,n,t)),j2e=Na(6,144,224/8),V2e=Na(6,136,256/8),H2e=Na(6,104,384/8),$2e=Na(6,72,512/8),q2e=Na(1,144,224/8),EL=Na(1,136,256/8),z2e=Na(1,104,384/8),G2e=Na(1,72,512/8),IL=(n,e,t)=>dL((r={})=>new Lw(e,n,r.dkLen===void 0?t:r.dkLen,!0)),W2e=IL(31,168,128/8),K2e=IL(31,136,256/8);var CL=!1,SL=function(n){return EL(n)},AL=SL;function bt(n){let e=ve(n,"data");return Z(AL(e))}bt._=SL;bt.lock=function(){CL=!0};bt.register=function(n){if(CL)throw new TypeError("keccak256 is locked");AL=n};Object.freeze(bt);var _L=function(n){return hA("sha256").update(n).digest()},TL=function(n){return hA("sha512").update(n).digest()},xL=_L,DL=TL,NL=!1,RL=!1;function Ra(n){let e=ve(n,"data");return Z(xL(e))}Ra._=_L;Ra.lock=function(){NL=!0};Ra.register=function(n){if(NL)throw new Error("sha256 is locked");xL=n};Object.freeze(Ra);function Fw(n){let e=ve(n,"data");return Z(DL(e))}Fw._=TL;Fw.lock=function(){RL=!0};Fw.register=function(n){if(RL)throw new Error("sha512 is locked");DL=n};Object.freeze(Ra);var mA={};Nh(mA,{bitGet:()=>cJ,bitLen:()=>aJ,bitMask:()=>hp,bitSet:()=>lJ,bytesToHex:()=>fl,bytesToNumberBE:()=>Oo,bytesToNumberLE:()=>jw,concatBytes:()=>yd,createHmacDrbg:()=>gA,ensureBytes:()=>li,equalBytes:()=>sJ,hexToBytes:()=>pl,hexToNumber:()=>pA,numberToBytesBE:()=>Oa,numberToBytesLE:()=>Vw,numberToHexUnpadded:()=>ML,numberToVarBytesBE:()=>iJ,utf8ToBytes:()=>oJ,validateObject:()=>Pa});var PL=BigInt(0),Bw=BigInt(1),nJ=BigInt(2),Uw=n=>n instanceof Uint8Array,rJ=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function fl(n){if(!Uw(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=rJ[n[t]];return e}function ML(n){let e=n.toString(16);return e.length&1?`0${e}`:e}function pA(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function pl(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);let e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let t=new Uint8Array(e/2);for(let r=0;r<t.length;r++){let i=r*2,s=n.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function Oo(n){return pA(fl(n))}function jw(n){if(!Uw(n))throw new Error("Uint8Array expected");return pA(fl(Uint8Array.from(n).reverse()))}function Oa(n,e){return pl(n.toString(16).padStart(e*2,"0"))}function Vw(n,e){return Oa(n,e).reverse()}function iJ(n){return pl(ML(n))}function li(n,e,t){let r;if(typeof e=="string")try{r=pl(e)}catch(s){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Uw(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);let i=r.length;if(typeof t=="number"&&i!==t)throw new Error(`${n} expected ${t} bytes, got ${i}`);return r}function yd(...n){let e=new Uint8Array(n.reduce((r,i)=>r+i.length,0)),t=0;return n.forEach(r=>{if(!Uw(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}function sJ(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function oJ(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function aJ(n){let e;for(e=0;n>PL;n>>=Bw,e+=1);return e}function cJ(n,e){return n>>BigInt(e)&Bw}var lJ=(n,e,t)=>n|(t?Bw:PL)<<BigInt(e),hp=n=>(nJ<<BigInt(n-1))-Bw,fA=n=>new Uint8Array(n),OL=n=>Uint8Array.from(n);function gA(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=fA(n),i=fA(n),s=0,o=()=>{r.fill(1),i.fill(0),s=0},a=(...d)=>t(i,r,...d),c=(d=fA())=>{i=a(OL([0]),d),r=a(),d.length!==0&&(i=a(OL([1]),d),r=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let d=0,h=[];for(;d<e;){r=a();let f=r.slice();h.push(f),d+=r.length}return yd(...h)};return(d,h)=>{o(),c(d);let f;for(;!(f=h(l()));)c();return o(),f}}var uJ={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||n instanceof Uint8Array,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function Pa(n,e,t={}){let r=(i,s,o)=>{let a=uJ[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=n[i];if(!(o&&c===void 0)&&!a(c,n))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(e))r(i,s,!1);for(let[i,s]of Object.entries(t))r(i,s,!0);return n}var mn=BigInt(0),Xt=BigInt(1),gl=BigInt(2),dJ=BigInt(3),yA=BigInt(4),kL=BigInt(5),LL=BigInt(8),hJ=BigInt(9),fJ=BigInt(16);function Xn(n,e){let t=n%e;return t>=mn?t:e+t}function pJ(n,e,t){if(t<=mn||e<mn)throw new Error("Expected power/modulo > 0");if(t===Xt)return mn;let r=Xt;for(;e>mn;)e&Xt&&(r=r*n%t),n=n*n%t,e>>=Xt;return r}function ui(n,e,t){let r=n;for(;e-- >mn;)r*=r,r%=t;return r}function Hw(n,e){if(n===mn||e<=mn)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=Xn(n,e),r=e,i=mn,s=Xt,o=Xt,a=mn;for(;t!==mn;){let l=r/t,u=r%t,d=i-o*l,h=s-a*l;r=t,t=u,i=o,s=a,o=d,a=h}if(r!==Xt)throw new Error("invert: does not exist");return Xn(i,e)}function gJ(n){let e=(n-Xt)/gl,t,r,i;for(t=n-Xt,r=0;t%gl===mn;t/=gl,r++);for(i=gl;i<n&&pJ(i,e,n)!==n-Xt;i++);if(r===1){let o=(n+Xt)/yA;return function(c,l){let u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}let s=(t+Xt)/gl;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,u=a.pow(a.mul(a.ONE,i),t),d=a.pow(c,s),h=a.pow(c,t);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let g=a.sqr(h);f<l&&!a.eql(g,a.ONE);f++)g=a.sqr(g);let p=a.pow(u,Xt<<BigInt(l-f-1));u=a.sqr(p),d=a.mul(d,p),h=a.mul(h,u),l=f}return d}}function mJ(n){if(n%yA===dJ){let e=(n+Xt)/yA;return function(r,i){let s=r.pow(i,e);if(!r.eql(r.sqr(s),i))throw new Error("Cannot find square root");return s}}if(n%LL===kL){let e=(n-kL)/LL;return function(r,i){let s=r.mul(i,gl),o=r.pow(s,e),a=r.mul(i,o),c=r.mul(r.mul(a,gl),o),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),i))throw new Error("Cannot find square root");return l}}return n%fJ,gJ(n)}var yJ=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function wA(n){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=yJ.reduce((r,i)=>(r[i]="function",r),e);return Pa(n,t)}function wJ(n,e,t){if(t<mn)throw new Error("Expected power > 0");if(t===mn)return n.ONE;if(t===Xt)return e;let r=n.ONE,i=e;for(;t>mn;)t&Xt&&(r=n.mul(r,i)),i=n.sqr(i),t>>=Xt;return r}function vJ(n,e){let t=new Array(e.length),r=e.reduce((s,o,a)=>n.is0(o)?s:(t[a]=s,n.mul(s,o)),n.ONE),i=n.inv(r);return e.reduceRight((s,o,a)=>n.is0(o)?s:(t[a]=n.mul(s,t[a]),n.mul(s,o)),i),t}function vA(n,e){let t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function FL(n,e,t=!1,r={}){if(n<=mn)throw new Error(`Expected Field ORDER > 0, got ${n}`);let{nBitLength:i,nByteLength:s}=vA(n,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=mJ(n),a=Object.freeze({ORDER:n,BITS:i,BYTES:s,MASK:hp(i),ZERO:mn,ONE:Xt,create:c=>Xn(c,n),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return mn<=c&&c<n},is0:c=>c===mn,isOdd:c=>(c&Xt)===Xt,neg:c=>Xn(-c,n),eql:(c,l)=>c===l,sqr:c=>Xn(c*c,n),add:(c,l)=>Xn(c+l,n),sub:(c,l)=>Xn(c-l,n),mul:(c,l)=>Xn(c*l,n),pow:(c,l)=>wJ(a,c,l),div:(c,l)=>Xn(c*Hw(l,n),n),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Hw(c,n),sqrt:r.sqrt||(c=>o(a,c)),invertBatch:c=>vJ(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Vw(c,s):Oa(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return t?jw(c):Oo(c)}});return Object.freeze(a)}function BL(n){if(typeof n!="bigint")throw new Error("field order must be bigint");let e=n.toString(2).length;return Math.ceil(e/8)}function bA(n){let e=BL(n);return e+Math.ceil(e/2)}function UL(n,e,t=!1){let r=n.length,i=BL(e),s=bA(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);let o=t?Oo(n):jw(n),a=Xn(o,e-Xt)+Xt;return t?Vw(a,i):Oa(a,i)}var EJ=BigInt(0),EA=BigInt(1);function jL(n,e){let t=(i,s)=>{let o=s.negate();return i?o:s},r=i=>{let s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:t,unsafeLadder(i,s){let o=n.ZERO,a=i;for(;s>EJ;)s&EA&&(o=o.add(a)),a=a.double(),s>>=EA;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=r(s),c=[],l=i,u=l;for(let d=0;d<o;d++){u=l,c.push(u);for(let h=1;h<a;h++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(i,s,o){let{windows:a,windowSize:c}=r(i),l=n.ZERO,u=n.BASE,d=BigInt(2**i-1),h=2**i,f=BigInt(i);for(let p=0;p<a;p++){let g=p*c,m=Number(o&d);o>>=f,m>c&&(m-=h,o+=EA);let y=g,E=g+Math.abs(m)-1,I=p%2!==0,L=m<0;m===0?u=u.add(t(I,s[y])):l=l.add(t(L,s[E]))}return{p:l,f:u}},wNAFCached(i,s,o,a){let c=i._WINDOW_SIZE||1,l=s.get(i);return l||(l=this.precomputeWindow(i,c),c!==1&&s.set(i,a(l))),this.wNAF(c,l,o)}}}function IA(n){return wA(n.Fp),Pa(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(ge(H(H({},vA(n.n,n.nBitLength)),n),{p:n.Fp.ORDER}))}function IJ(n){let e=IA(n);Pa(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze(H({},e))}var{bytesToNumberBE:CJ,hexToBytes:SJ}=mA,ml={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){let{Err:e}=ml;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");let t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:CJ(r),l:n.subarray(t+2)}},toSig(n){let{Err:e}=ml,t=typeof n=="string"?SJ(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");let{d:i,l:s}=ml._parseInt(t.subarray(2)),{d:o,l:a}=ml._parseInt(s);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(n){let e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,t=l=>{let u=l.toString(16);return u.length&1?`0${u}`:u},r=e(t(n.s)),i=e(t(n.r)),s=r.length/2,o=i.length/2,a=t(s),c=t(o);return`30${t(o+s+4)}02${c}${i}02${a}${r}`}},Po=BigInt(0),Ui=BigInt(1),uLe=BigInt(2),VL=BigInt(3),dLe=BigInt(4);function AJ(n){let e=IJ(n),{Fp:t}=e,r=e.toBytes||((p,g,m)=>{let y=g.toAffine();return yd(Uint8Array.from([4]),t.toBytes(y.x),t.toBytes(y.y))}),i=e.fromBytes||(p=>{let g=p.subarray(1),m=t.fromBytes(g.subarray(0,t.BYTES)),y=t.fromBytes(g.subarray(t.BYTES,2*t.BYTES));return{x:m,y}});function s(p){let{a:g,b:m}=e,y=t.sqr(p),E=t.mul(y,p);return t.add(t.add(E,t.mul(p,g)),m)}if(!t.eql(t.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Po<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){let{allowedPrivateKeyLengths:g,nByteLength:m,wrapPrivateKey:y,n:E}=e;if(g&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=fl(p)),typeof p!="string"||!g.includes(p.length))throw new Error("Invalid key");p=p.padStart(m*2,"0")}let I;try{I=typeof p=="bigint"?p:Oo(li("private key",p,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof p}`)}return y&&(I=Xn(I,E)),a(I),I}let l=new Map;function u(p){if(!(p instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(g,m,y){if(this.px=g,this.py=m,this.pz=y,g==null||!t.isValid(g))throw new Error("x required");if(m==null||!t.isValid(m))throw new Error("y required");if(y==null||!t.isValid(y))throw new Error("z required")}static fromAffine(g){let{x:m,y}=g||{};if(!g||!t.isValid(m)||!t.isValid(y))throw new Error("invalid affine point");if(g instanceof d)throw new Error("projective point not allowed");let E=I=>t.eql(I,t.ZERO);return E(m)&&E(y)?d.ZERO:new d(m,y,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){let m=t.invertBatch(g.map(y=>y.pz));return g.map((y,E)=>y.toAffine(m[E])).map(d.fromAffine)}static fromHex(g){let m=d.fromAffine(i(li("pointHex",g)));return m.assertValidity(),m}static fromPrivateKey(g){return d.BASE.multiply(c(g))}_setWindowSize(g){this._WINDOW_SIZE=g,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:g,y:m}=this.toAffine();if(!t.isValid(g)||!t.isValid(m))throw new Error("bad point: x or y not FE");let y=t.sqr(m),E=s(g);if(!t.eql(y,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:g}=this.toAffine();if(t.isOdd)return!t.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){u(g);let{px:m,py:y,pz:E}=this,{px:I,py:L,pz:k}=g,D=t.eql(t.mul(m,k),t.mul(I,E)),B=t.eql(t.mul(y,k),t.mul(L,E));return D&&B}negate(){return new d(this.px,t.neg(this.py),this.pz)}double(){let{a:g,b:m}=e,y=t.mul(m,VL),{px:E,py:I,pz:L}=this,k=t.ZERO,D=t.ZERO,B=t.ZERO,U=t.mul(E,E),T=t.mul(I,I),$=t.mul(L,L),W=t.mul(E,I);return W=t.add(W,W),B=t.mul(E,L),B=t.add(B,B),k=t.mul(g,B),D=t.mul(y,$),D=t.add(k,D),k=t.sub(T,D),D=t.add(T,D),D=t.mul(k,D),k=t.mul(W,k),B=t.mul(y,B),$=t.mul(g,$),W=t.sub(U,$),W=t.mul(g,W),W=t.add(W,B),B=t.add(U,U),U=t.add(B,U),U=t.add(U,$),U=t.mul(U,W),D=t.add(D,U),$=t.mul(I,L),$=t.add($,$),U=t.mul($,W),k=t.sub(k,U),B=t.mul($,T),B=t.add(B,B),B=t.add(B,B),new d(k,D,B)}add(g){u(g);let{px:m,py:y,pz:E}=this,{px:I,py:L,pz:k}=g,D=t.ZERO,B=t.ZERO,U=t.ZERO,T=e.a,$=t.mul(e.b,VL),W=t.mul(m,I),M=t.mul(y,L),v=t.mul(E,k),b=t.add(m,y),w=t.add(I,L);b=t.mul(b,w),w=t.add(W,M),b=t.sub(b,w),w=t.add(m,E);let C=t.add(I,k);return w=t.mul(w,C),C=t.add(W,v),w=t.sub(w,C),C=t.add(y,E),D=t.add(L,k),C=t.mul(C,D),D=t.add(M,v),C=t.sub(C,D),U=t.mul(T,w),D=t.mul($,v),U=t.add(D,U),D=t.sub(M,U),U=t.add(M,U),B=t.mul(D,U),M=t.add(W,W),M=t.add(M,W),v=t.mul(T,v),w=t.mul($,w),M=t.add(M,v),v=t.sub(W,v),v=t.mul(T,v),w=t.add(w,v),W=t.mul(M,w),B=t.add(B,W),W=t.mul(C,w),D=t.mul(b,D),D=t.sub(D,W),W=t.mul(b,M),U=t.mul(C,U),U=t.add(U,W),new d(D,B,U)}subtract(g){return this.add(g.negate())}is0(){return this.equals(d.ZERO)}wNAF(g){return f.wNAFCached(this,l,g,m=>{let y=t.invertBatch(m.map(E=>E.pz));return m.map((E,I)=>E.toAffine(y[I])).map(d.fromAffine)})}multiplyUnsafe(g){let m=d.ZERO;if(g===Po)return m;if(a(g),g===Ui)return this;let{endo:y}=e;if(!y)return f.unsafeLadder(this,g);let{k1neg:E,k1:I,k2neg:L,k2:k}=y.splitScalar(g),D=m,B=m,U=this;for(;I>Po||k>Po;)I&Ui&&(D=D.add(U)),k&Ui&&(B=B.add(U)),U=U.double(),I>>=Ui,k>>=Ui;return E&&(D=D.negate()),L&&(B=B.negate()),B=new d(t.mul(B.px,y.beta),B.py,B.pz),D.add(B)}multiply(g){a(g);let m=g,y,E,{endo:I}=e;if(I){let{k1neg:L,k1:k,k2neg:D,k2:B}=I.splitScalar(m),{p:U,f:T}=this.wNAF(k),{p:$,f:W}=this.wNAF(B);U=f.constTimeNegate(L,U),$=f.constTimeNegate(D,$),$=new d(t.mul($.px,I.beta),$.py,$.pz),y=U.add($),E=T.add(W)}else{let{p:L,f:k}=this.wNAF(m);y=L,E=k}return d.normalizeZ([y,E])[0]}multiplyAndAddUnsafe(g,m,y){let E=d.BASE,I=(k,D)=>D===Po||D===Ui||!k.equals(E)?k.multiplyUnsafe(D):k.multiply(D),L=I(this,m).add(I(g,y));return L.is0()?void 0:L}toAffine(g){let{px:m,py:y,pz:E}=this,I=this.is0();g==null&&(g=I?t.ONE:t.inv(E));let L=t.mul(m,g),k=t.mul(y,g),D=t.mul(E,g);if(I)return{x:t.ZERO,y:t.ZERO};if(!t.eql(D,t.ONE))throw new Error("invZ was invalid");return{x:L,y:k}}isTorsionFree(){let{h:g,isTorsionFree:m}=e;if(g===Ui)return!0;if(m)return m(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:g,clearCofactor:m}=e;return g===Ui?this:m?m(d,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),r(d,this,g)}toHex(g=!0){return fl(this.toRawBytes(g))}}d.BASE=new d(e.Gx,e.Gy,t.ONE),d.ZERO=new d(t.ZERO,t.ONE,t.ZERO);let h=e.nBitLength,f=jL(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}function _J(n){let e=IA(n);return Pa(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(H({lowS:!0},e))}function HL(n){let e=_J(n),{Fp:t,n:r}=e,i=t.BYTES+1,s=2*t.BYTES+1;function o(w){return Po<w&&w<t.ORDER}function a(w){return Xn(w,r)}function c(w){return Hw(w,r)}let{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:h}=AJ(ge(H({},e),{toBytes(w,C,N){let F=C.toAffine(),S=t.toBytes(F.x),P=yd;return N?P(Uint8Array.from([C.hasEvenY()?2:3]),S):P(Uint8Array.from([4]),S,t.toBytes(F.y))},fromBytes(w){let C=w.length,N=w[0],F=w.subarray(1);if(C===i&&(N===2||N===3)){let S=Oo(F);if(!o(S))throw new Error("Point is not on curve");let P=d(S),V=t.sqrt(P),j=(V&Ui)===Ui;return(N&1)===1!==j&&(V=t.neg(V)),{x:S,y:V}}else if(C===s&&N===4){let S=t.fromBytes(F.subarray(0,t.BYTES)),P=t.fromBytes(F.subarray(t.BYTES,2*t.BYTES));return{x:S,y:P}}else throw new Error(`Point of length ${C} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}})),f=w=>fl(Oa(w,e.nByteLength));function p(w){let C=r>>Ui;return w>C}function g(w){return p(w)?a(-w):w}let m=(w,C,N)=>Oo(w.slice(C,N));class y{constructor(C,N,F){this.r=C,this.s=N,this.recovery=F,this.assertValidity()}static fromCompact(C){let N=e.nByteLength;return C=li("compactSignature",C,N*2),new y(m(C,0,N),m(C,N,2*N))}static fromDER(C){let{r:N,s:F}=ml.toSig(li("DER",C));return new y(N,F)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(C){return new y(this.r,this.s,C)}recoverPublicKey(C){let{r:N,s:F,recovery:S}=this,P=B(li("msgHash",C));if(S==null||![0,1,2,3].includes(S))throw new Error("recovery id invalid");let V=S===2||S===3?N+e.n:N;if(V>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");let j=(S&1)===0?"02":"03",oe=l.fromHex(j+f(V)),ee=c(V),Q=a(-P*ee),ae=a(F*ee),te=l.BASE.multiplyAndAddUnsafe(oe,Q,ae);if(!te)throw new Error("point at infinify");return te.assertValidity(),te}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return pl(this.toDERHex())}toDERHex(){return ml.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return pl(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}let E={isValidPrivateKey(w){try{return u(w),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let w=bA(e.n);return UL(e.randomBytes(w),e.n)},precompute(w=8,C=l.BASE){return C._setWindowSize(w),C.multiply(BigInt(3)),C}};function I(w,C=!0){return l.fromPrivateKey(w).toRawBytes(C)}function L(w){let C=w instanceof Uint8Array,N=typeof w=="string",F=(C||N)&&w.length;return C?F===i||F===s:N?F===2*i||F===2*s:w instanceof l}function k(w,C,N=!0){if(L(w))throw new Error("first arg must be private key");if(!L(C))throw new Error("second arg must be public key");return l.fromHex(C).multiply(u(w)).toRawBytes(N)}let D=e.bits2int||function(w){let C=Oo(w),N=w.length*8-e.nBitLength;return N>0?C>>BigInt(N):C},B=e.bits2int_modN||function(w){return a(D(w))},U=hp(e.nBitLength);function T(w){if(typeof w!="bigint")throw new Error("bigint expected");if(!(Po<=w&&w<U))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Oa(w,e.nByteLength)}function $(w,C,N=W){if(["recovered","canonical"].some(re=>re in N))throw new Error("sign() legacy options not supported");let{hash:F,randomBytes:S}=e,{lowS:P,prehash:V,extraEntropy:j}=N;P==null&&(P=!0),w=li("msgHash",w),V&&(w=li("prehashed msgHash",F(w)));let oe=B(w),ee=u(C),Q=[T(ee),T(oe)];if(j!=null){let re=j===!0?S(t.BYTES):j;Q.push(li("extraEntropy",re))}let ae=yd(...Q),te=oe;function be(re){let Ce=D(re);if(!h(Ce))return;let kt=c(Ce),St=l.BASE.multiply(Ce).toAffine(),Wt=a(St.x);if(Wt===Po)return;let En=a(kt*a(te+Wt*ee));if(En===Po)return;let uu=(St.x===Wt?0:2)|Number(St.y&Ui),PN=En;return P&&p(En)&&(PN=g(En),uu^=1),new y(Wt,PN,uu)}return{seed:ae,k2sig:be}}let W={lowS:e.lowS,prehash:!1},M={lowS:e.lowS,prehash:!1};function v(w,C,N=W){let{seed:F,k2sig:S}=$(w,C,N),P=e;return gA(P.hash.outputLen,P.nByteLength,P.hmac)(F,S)}l.BASE._setWindowSize(8);function b(w,C,N,F=M){let S=w;if(C=li("msgHash",C),N=li("publicKey",N),"strict"in F)throw new Error("options.strict was renamed to lowS");let{lowS:P,prehash:V}=F,j,oe;try{if(typeof S=="string"||S instanceof Uint8Array)try{j=y.fromDER(S)}catch(St){if(!(St instanceof ml.Err))throw St;j=y.fromCompact(S)}else if(typeof S=="object"&&typeof S.r=="bigint"&&typeof S.s=="bigint"){let{r:St,s:Wt}=S;j=new y(St,Wt)}else throw new Error("PARSE");oe=l.fromHex(N)}catch(St){if(St.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(P&&j.hasHighS())return!1;V&&(C=e.hash(C));let{r:ee,s:Q}=j,ae=B(C),te=c(Q),be=a(ae*te),re=a(ee*te),Ce=l.BASE.multiplyAndAddUnsafe(oe,be,re)?.toAffine();return Ce?a(Ce.x)===ee:!1}return{CURVE:e,getPublicKey:I,getSharedSecret:k,sign:v,verify:b,ProjectivePoint:l,Signature:y,utils:E}}function TJ(n){return{hash:n,hmac:(e,...t)=>rA(n,e,uL(...t)),randomBytes:hL}}function $L(n,e){let t=r=>HL(H(H({},n),TJ(r)));return Object.freeze(ge(H({},t(e)),{create:t}))}var GL=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),qL=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),xJ=BigInt(1),CA=BigInt(2),zL=(n,e)=>(n+e/CA)/e;function DJ(n){let e=GL,t=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=n*n*n%e,u=l*l*n%e,d=ui(u,t,e)*u%e,h=ui(d,t,e)*u%e,f=ui(h,CA,e)*l%e,p=ui(f,i,e)*f%e,g=ui(p,s,e)*p%e,m=ui(g,a,e)*g%e,y=ui(m,c,e)*m%e,E=ui(y,a,e)*g%e,I=ui(E,t,e)*u%e,L=ui(I,o,e)*p%e,k=ui(L,r,e)*l%e,D=ui(k,CA,e);if(!SA.eql(SA.sqr(D),n))throw new Error("Cannot find square root");return D}var SA=FL(GL,void 0,void 0,{sqrt:DJ}),Mo=$L({a:BigInt(0),b:BigInt(7),Fp:SA,n:qL,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{let e=qL,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-xJ*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=BigInt("0x100000000000000000000000000000000"),a=zL(s*n,e),c=zL(-r*n,e),l=Xn(n-a*t-c*i,e),u=Xn(-a*r-c*s,e),d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},Mw),ILe=BigInt(0);var CLe=Mo.ProjectivePoint;var ko="0x0000000000000000000000000000000000000000";var $w="0x0000000000000000000000000000000000000000000000000000000000000000";var WL=BigInt(0),KL=BigInt(1),QL=BigInt(2),YL=BigInt(27),JL=BigInt(28),qw=BigInt(35),wd={};function ZL(n){return Yn(Vt(n),32)}var yn=class n{#e;#t;#n;#r;get r(){return this.#e}set r(e){x(ps(e)===32,"invalid r","value",e),this.#e=Z(e)}get s(){return x(parseInt(this.#t.substring(0,3))<8,"non-canonical s; use ._s","s",this.#t),this.#t}set s(e){x(ps(e)===32,"invalid s","value",e),this.#t=Z(e)}get _s(){return this.#t}isValid(){return parseInt(this.#t.substring(0,3))<8}get v(){return this.#n}set v(e){let t=Ie(e,"value");x(t===27||t===28,"invalid v","v",e),this.#n=t}get networkV(){return this.#r}get legacyChainId(){let e=this.networkV;return e==null?null:n.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){let e=ve(this.s);return this.yParity&&(e[0]|=128),Z(e)}get compactSerialized(){return nt([this.r,this.yParityAndS])}get serialized(){return nt([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(e,t,r,i){fs(e,wd,"Signature"),this.#e=t,this.#t=r,this.#n=i,this.#r=null}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){let e=new n(wd,this.r,this._s,this.v);return this.networkV&&(e.#r=this.networkV),e}toJSON(){let e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){let t=ne(e,"v");return t==YL||t==JL?WL:(x(t>=qw,"invalid EIP-155 v","v",e),(t-qw)/QL)}static getChainIdV(e,t){return ne(e)*QL+BigInt(35+t-27)}static getNormalizedV(e){let t=ne(e);return t===WL||t===YL?27:t===KL||t===JL?28:(x(t>=qw,"invalid v","v",e),t&KL?27:28)}static from(e){function t(l,u){x(l,u,"signature",e)}if(e==null)return new n(wd,$w,$w,27);if(typeof e=="string"){let l=ve(e,"signature");if(l.length===64){let u=Z(l.slice(0,32)),d=l.slice(32,64),h=d[0]&128?28:27;return d[0]&=127,new n(wd,u,Z(d),h)}if(l.length===65){let u=Z(l.slice(0,32)),d=Z(l.slice(32,64)),h=n.getNormalizedV(l[64]);return new n(wd,u,d,h)}t(!1,"invalid raw signature length")}if(e instanceof n)return e.clone();let r=e.r;t(r!=null,"missing r");let i=ZL(r),s=(function(l,u){if(l!=null)return ZL(l);if(u!=null){t($e(u,32),"invalid yParityAndS");let d=ve(u);return d[0]&=127,Z(d)}t(!1,"missing s")})(e.s,e.yParityAndS),{networkV:o,v:a}=(function(l,u,d){if(l!=null){let h=ne(l);return{networkV:h>=qw?h:void 0,v:n.getNormalizedV(h)}}if(u!=null)return t($e(u,32),"invalid yParityAndS"),{v:ve(u)[0]&128?28:27};if(d!=null){switch(Ie(d,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")})(e.v,e.yParityAndS,e.yParity),c=new n(wd,i,s,a);return o&&(c.#r=o),t(e.yParity==null||Ie(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};var Ma=class n{#e;constructor(e){x(ps(e)===32,"invalid private key","privateKey","[REDACTED]"),this.#e=Z(e)}get privateKey(){return this.#e}get publicKey(){return n.computePublicKey(this.#e)}get compressedPublicKey(){return n.computePublicKey(this.#e,!0)}sign(e){x(ps(e)===32,"invalid digest length","digest",e);let t=Mo.sign(Zt(e),Zt(this.#e),{lowS:!0});return yn.from({r:Cr(t.r,32),s:Cr(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){let t=n.computePublicKey(e);return Z(Mo.getSharedSecret(Zt(this.#e),ve(t),!1))}static computePublicKey(e,t){let r=ve(e,"key");if(r.length===32){let s=Mo.getPublicKey(r,!!t);return Z(s)}if(r.length===64){let s=new Uint8Array(65);s[0]=4,s.set(r,1),r=s}let i=Mo.ProjectivePoint.fromHex(r);return Z(i.toRawBytes(t))}static recoverPublicKey(e,t){x(ps(e)===32,"invalid digest length","digest",e);let r=yn.from(t),i=Mo.Signature.fromCompact(Zt(nt([r.r,r.s])));i=i.addRecoveryBit(r.yParity);let s=i.recoverPublicKey(Zt(e));return x(s!=null,"invalid signature for digest","signature",t),"0x"+s.toHex(!1)}static addPoints(e,t,r){let i=Mo.ProjectivePoint.fromHex(n.computePublicKey(e).substring(2)),s=Mo.ProjectivePoint.fromHex(n.computePublicKey(t).substring(2));return"0x"+i.add(s).toHex(!!r)}};var NJ=BigInt(0),RJ=BigInt(36);function XL(n){n=n.toLowerCase();let e=n.substring(2).split(""),t=new Uint8Array(40);for(let i=0;i<40;i++)t[i]=e[i].charCodeAt(0);let r=ve(bt(t));for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(r[i>>1]&15)>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}var AA={};for(let n=0;n<10;n++)AA[String(n)]=String(n);for(let n=0;n<26;n++)AA[String.fromCharCode(65+n)]=String(10+n);var eF=15;function OJ(n){n=n.toUpperCase(),n=n.substring(4)+n.substring(0,2)+"00";let e=n.split("").map(r=>AA[r]).join("");for(;e.length>=eF;){let r=e.substring(0,eF);e=parseInt(r,10)%97+e.substring(r.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}var PJ=(function(){let n={};for(let e=0;e<36;e++){let t="0123456789abcdefghijklmnopqrstuvwxyz"[e];n[t]=BigInt(e)}return n})();function MJ(n){n=n.toLowerCase();let e=NJ;for(let t=0;t<n.length;t++)e=e*RJ+PJ[n[t]];return e}function ke(n){if(x(typeof n=="string","invalid address","address",n),n.match(/^(0x)?[0-9a-fA-F]{40}$/)){n.startsWith("0x")||(n="0x"+n);let e=XL(n);return x(!n.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===n,"bad address checksum","address",n),e}if(n.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){x(n.substring(2,4)===OJ(n),"bad icap checksum","address",n);let e=MJ(n.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return XL("0x"+e)}x(!1,"invalid address","address",n)}function _A(n){let e=ke(n.from),r=ne(n.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,ke(Nt(bt(Fi([e,r])),12))}function zw(n){return n&&typeof n.getAddress=="function"}async function TA(n,e){let t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(G(typeof n!="string","unconfigured name","UNCONFIGURED_NAME",{value:n}),x(!1,"invalid AddressLike value; did not resolve to a value address","target",n)),ke(t)}function cn(n,e){if(typeof n=="string")return n.match(/^0x[0-9a-f]{40}$/i)?ke(n):(G(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),TA(n,e.resolveName(n)));if(zw(n))return TA(n,n.getAddress());if(n&&typeof n.then=="function")return TA(n,n);x(!1,"unsupported addressable value","target",n)}var ws={};function pe(n,e){let t=!1;return e<0&&(t=!0,e*=-1),new Bt(ws,`${t?"":"u"}int${e}`,n,{signed:t,width:e})}function it(n,e){return new Bt(ws,`bytes${e||""}`,n,{size:e})}var tF=Symbol.for("_ethers_typed"),Bt=class n{type;value;#e;_typedSymbol;constructor(e,t,r,i){i==null&&(i=null),fs(ws,e,"Typed"),ce(this,{_typedSymbol:tF,type:t,value:r}),this.#e=i,this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return this.#e}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return this.#e===!0?-1:this.#e===!1?this.value.length:null}static from(e,t){return new n(ws,e,t)}static uint8(e){return pe(e,8)}static uint16(e){return pe(e,16)}static uint24(e){return pe(e,24)}static uint32(e){return pe(e,32)}static uint40(e){return pe(e,40)}static uint48(e){return pe(e,48)}static uint56(e){return pe(e,56)}static uint64(e){return pe(e,64)}static uint72(e){return pe(e,72)}static uint80(e){return pe(e,80)}static uint88(e){return pe(e,88)}static uint96(e){return pe(e,96)}static uint104(e){return pe(e,104)}static uint112(e){return pe(e,112)}static uint120(e){return pe(e,120)}static uint128(e){return pe(e,128)}static uint136(e){return pe(e,136)}static uint144(e){return pe(e,144)}static uint152(e){return pe(e,152)}static uint160(e){return pe(e,160)}static uint168(e){return pe(e,168)}static uint176(e){return pe(e,176)}static uint184(e){return pe(e,184)}static uint192(e){return pe(e,192)}static uint200(e){return pe(e,200)}static uint208(e){return pe(e,208)}static uint216(e){return pe(e,216)}static uint224(e){return pe(e,224)}static uint232(e){return pe(e,232)}static uint240(e){return pe(e,240)}static uint248(e){return pe(e,248)}static uint256(e){return pe(e,256)}static uint(e){return pe(e,256)}static int8(e){return pe(e,-8)}static int16(e){return pe(e,-16)}static int24(e){return pe(e,-24)}static int32(e){return pe(e,-32)}static int40(e){return pe(e,-40)}static int48(e){return pe(e,-48)}static int56(e){return pe(e,-56)}static int64(e){return pe(e,-64)}static int72(e){return pe(e,-72)}static int80(e){return pe(e,-80)}static int88(e){return pe(e,-88)}static int96(e){return pe(e,-96)}static int104(e){return pe(e,-104)}static int112(e){return pe(e,-112)}static int120(e){return pe(e,-120)}static int128(e){return pe(e,-128)}static int136(e){return pe(e,-136)}static int144(e){return pe(e,-144)}static int152(e){return pe(e,-152)}static int160(e){return pe(e,-160)}static int168(e){return pe(e,-168)}static int176(e){return pe(e,-176)}static int184(e){return pe(e,-184)}static int192(e){return pe(e,-192)}static int200(e){return pe(e,-200)}static int208(e){return pe(e,-208)}static int216(e){return pe(e,-216)}static int224(e){return pe(e,-224)}static int232(e){return pe(e,-232)}static int240(e){return pe(e,-240)}static int248(e){return pe(e,-248)}static int256(e){return pe(e,-256)}static int(e){return pe(e,-256)}static bytes1(e){return it(e,1)}static bytes2(e){return it(e,2)}static bytes3(e){return it(e,3)}static bytes4(e){return it(e,4)}static bytes5(e){return it(e,5)}static bytes6(e){return it(e,6)}static bytes7(e){return it(e,7)}static bytes8(e){return it(e,8)}static bytes9(e){return it(e,9)}static bytes10(e){return it(e,10)}static bytes11(e){return it(e,11)}static bytes12(e){return it(e,12)}static bytes13(e){return it(e,13)}static bytes14(e){return it(e,14)}static bytes15(e){return it(e,15)}static bytes16(e){return it(e,16)}static bytes17(e){return it(e,17)}static bytes18(e){return it(e,18)}static bytes19(e){return it(e,19)}static bytes20(e){return it(e,20)}static bytes21(e){return it(e,21)}static bytes22(e){return it(e,22)}static bytes23(e){return it(e,23)}static bytes24(e){return it(e,24)}static bytes25(e){return it(e,25)}static bytes26(e){return it(e,26)}static bytes27(e){return it(e,27)}static bytes28(e){return it(e,28)}static bytes29(e){return it(e,29)}static bytes30(e){return it(e,30)}static bytes31(e){return it(e,31)}static bytes32(e){return it(e,32)}static address(e){return new n(ws,"address",e)}static bool(e){return new n(ws,"bool",!!e)}static bytes(e){return new n(ws,"bytes",e)}static string(e){return new n(ws,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new n(ws,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===tF}static dereference(e,t){if(n.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};var Gw=class extends an{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let r=Bt.dereference(t,"string");try{r=ke(r)}catch(i){return this._throwError(i.message,t)}return e.writeValue(r)}decode(e){return ke(Cr(e.readValue(),20))}};var Ww=class extends an{coder;constructor(e){super(e.name,e.type,"_",e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}};function xA(n,e,t){let r=[];if(Array.isArray(t))r=t;else if(t&&typeof t=="object"){let c={};r=e.map(l=>{let u=l.localName;return G(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),G(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),c[u]=!0,t[u]})}else x(!1,"invalid tuple value","tuple",t);x(e.length===r.length,"types/value length mismatch","tuple",t);let i=new hl,s=new hl,o=[];e.forEach((c,l)=>{let u=r[l];if(c.dynamic){let d=s.length;c.encode(s,u);let h=i.writeUpdatableValue();o.push(f=>{h(f+d)})}else c.encode(i,u)}),o.forEach(c=>{c(i.length)});let a=n.appendWriter(i);return a+=n.appendWriter(s),a}function DA(n,e){let t=[],r=[],i=n.subReader(0);return e.forEach(s=>{let o=null;if(s.dynamic){let a=n.readIndex(),c=i.subReader(a);try{o=s.decode(c)}catch(l){if(Ft(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=s.name,o.name=s.localName,o.type=s.type}}else try{o=s.decode(n)}catch(a){if(Ft(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=s.name,o.name=s.localName,o.type=s.type}if(o==null)throw new Error("investigate");t.push(o),r.push(s.localName||null)}),No.fromItems(t,r)}var Kw=class extends an{coder;length;constructor(e,t,r){let i=e.type+"["+(t>=0?t:"")+"]",s=t===-1||e.dynamic;super("array",i,r,s),ce(this,{coder:e,length:t})}defaultValue(){let e=this.coder.defaultValue(),t=[];for(let r=0;r<this.length;r++)t.push(e);return t}encode(e,t){let r=Bt.dereference(t,"array");Array.isArray(r)||this._throwError("expected array value",r);let i=this.length;i===-1&&(i=r.length,e.writeValue(r.length)),cd(r.length,i,"coder array"+(this.localName?" "+this.localName:""));let s=[];for(let o=0;o<r.length;o++)s.push(this.coder);return xA(e,s,r)}decode(e){let t=this.length;t===-1&&(t=e.readIndex(),G(t*Ln<=e.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:e.bytes,offset:t*Ln,length:e.dataLength}));let r=[];for(let i=0;i<t;i++)r.push(new Ww(this.coder));return DA(e,r)}};var Qw=class extends an{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){let r=Bt.dereference(t,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}};var fp=class extends an{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=Zt(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readIndex(),!0)}},Yw=class extends fp{constructor(e){super("bytes",e)}decode(e){return Z(super.decode(e))}};var Jw=class extends an{size;constructor(e,t){let r="bytes"+String(e);super(r,r,t,!1),ce(this,{size:e},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,t){let r=Zt(Bt.dereference(t,this.type));return r.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(r)}decode(e){return Z(e.readBytes(this.size))}};var kJ=new Uint8Array([]),Zw=class extends an{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(kJ)}decode(e){return e.readBytes(0),null}};var LJ=BigInt(0),FJ=BigInt(1),BJ=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Xw=class extends an{size;signed;constructor(e,t,r){let i=(t?"int":"uint")+e*8;super(i,i,r,!1),ce(this,{size:e,signed:t},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(e,t){let r=ne(Bt.dereference(t,this.type)),i=Li(BJ,Ln*8);if(this.signed){let s=Li(i,this.size*8-1);(r>s||r<-(s+FJ))&&this._throwError("value out-of-bounds",t),r=ud(r,8*Ln)}else(r<LJ||r>Li(i,this.size*8))&&this._throwError("value out-of-bounds",t);return e.writeValue(r)}decode(e){let t=Li(e.readValue(),this.size*8);return this.signed&&(t=Ea(t,this.size*8)),t}};var ev=class extends fp{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Zn(Bt.dereference(t,"string")))}decode(e){return Do(super.decode(e))}};var yl=class extends an{coders;constructor(e,t){let r=!1,i=[];e.forEach(o=>{o.dynamic&&(r=!0),i.push(o.type)});let s="tuple("+i.join(",")+")";super("tuple",s,t,r),ce(this,{coders:Object.freeze(e.slice())})}defaultValue(){let e=[];this.coders.forEach(r=>{e.push(r.defaultValue())});let t=this.coders.reduce((r,i)=>{let s=i.localName;return s&&(r[s]||(r[s]=0),r[s]++),r},{});return this.coders.forEach((r,i)=>{let s=r.localName;!s||t[s]!==1||(s==="length"&&(s="_length"),e[s]==null&&(e[s]=e[i]))}),Object.freeze(e)}encode(e,t){let r=Bt.dereference(t,"tuple");return xA(e,this.coders,r)}decode(e){return DA(e,this.coders)}};function NA(n,e){return{address:ke(n),storageKeys:e.map((t,r)=>(x($e(t,32),"invalid slot",`storageKeys[${r}]`,t),t.toLowerCase()))}}function di(n){if(Array.isArray(n))return n.map((t,r)=>Array.isArray(t)?(x(t.length===2,"invalid slot set",`value[${r}]`,t),NA(t[0],t[1])):(x(t!=null&&typeof t=="object","invalid address-slot set","value",n),NA(t.address,t.storageKeys)));x(n!=null&&typeof n=="object","invalid access list","value",n);let e=Object.keys(n).map(t=>{let r=n[t].reduce((i,s)=>(i[s]=!0,i),{});return NA(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}function pp(n){return{address:ke(n.address),nonce:ne(n.nonce!=null?n.nonce:0),chainId:ne(n.chainId!=null?n.chainId:0),signature:yn.from(n.signature)}}function UJ(n){let e;return typeof n=="string"?e=Ma.computePublicKey(n,!1):e=n.publicKey,ke(bt("0x"+e.substring(4)).substring(26))}function nF(n,e){return UJ(Ma.recoverPublicKey(n,e))}var Tn=BigInt(0),jJ=BigInt(2),VJ=BigInt(27),HJ=BigInt(28),$J=BigInt(35),qJ=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),RA=4096*32;function zJ(n){return{blobToKzgCommitment:r=>{if("computeBlobProof"in n){if("blobToKzgCommitment"in n&&typeof n.blobToKzgCommitment=="function")return ve(n.blobToKzgCommitment(Z(r)))}else if("blobToKzgCommitment"in n&&typeof n.blobToKzgCommitment=="function")return ve(n.blobToKzgCommitment(r));if("blobToKZGCommitment"in n&&typeof n.blobToKZGCommitment=="function")return ve(n.blobToKZGCommitment(Z(r)));x(!1,"unsupported KZG library","kzg",n)},computeBlobKzgProof:(r,i)=>{if("computeBlobProof"in n&&typeof n.computeBlobProof=="function")return ve(n.computeBlobProof(Z(r),Z(i)));if("computeBlobKzgProof"in n&&typeof n.computeBlobKzgProof=="function")return n.computeBlobKzgProof(r,i);if("computeBlobKZGProof"in n&&typeof n.computeBlobKZGProof=="function")return ve(n.computeBlobKZGProof(Z(r),Z(i)));x(!1,"unsupported KZG library","kzg",n)}}}function rF(n,e){let t=n.toString(16);for(;t.length<2;)t="0"+t;return t+=Ra(e).substring(4),"0x"+t}function vd(n){return n==="0x"?null:ke(n)}function tv(n,e){try{return di(n)}catch(t){x(!1,t.message,e,n)}}function GJ(n,e){try{if(!Array.isArray(n))throw new Error("authorizationList: invalid array");let t=[];for(let r=0;r<n.length;r++){let i=n[r];if(!Array.isArray(i))throw new Error(`authorization[${r}]: invalid array`);if(i.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!i[1])throw new Error(`authorization[${r}]: null address`);t.push({address:vd(i[1]),nonce:xt(i[2],"nonce"),chainId:xt(i[0],"chainId"),signature:yn.from({yParity:vl(i[3],"yParity"),r:Yn(i[4],32),s:Yn(i[5],32)})})}return t}catch(t){x(!1,t.message,e,n)}}function vl(n,e){return n==="0x"?0:Ie(n,e)}function xt(n,e){if(n==="0x")return Tn;let t=ne(n,e);return x(t<=qJ,"value exceeds uint size",e,t),t}function We(n,e){let t=ne(n,"value"),r=Vt(t);return x(r.length<=32,"value too large",`tx.${e}`,t),r}function nv(n){return di(n).map(e=>[e.address,e.storageKeys])}function WJ(n){return n.map(e=>[We(e.chainId,"chainId"),e.address,We(e.nonce,"nonce"),We(e.signature.yParity,"yParity"),Vt(e.signature.r),Vt(e.signature.s)])}function KJ(n,e){x(Array.isArray(n),`invalid ${e}`,"value",n);for(let t=0;t<n.length;t++)x($e(n[t],32),"invalid ${ param } hash",`value[${t}]`,n[t]);return n}function QJ(n){let e=Ca(n);x(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",n);let t={type:0,nonce:vl(e[0],"nonce"),gasPrice:xt(e[1],"gasPrice"),gasLimit:xt(e[2],"gasLimit"),to:vd(e[3]),value:xt(e[4],"value"),data:Z(e[5]),chainId:Tn};if(e.length===6)return t;let r=xt(e[6],"v"),i=xt(e[7],"r"),s=xt(e[8],"s");if(i===Tn&&s===Tn)t.chainId=r;else{let o=(r-$J)/jJ;o<Tn&&(o=Tn),t.chainId=o,x(o!==Tn||r===VJ||r===HJ,"non-canonical legacy v","v",e[6]),t.signature=yn.from({r:Yn(e[7],32),s:Yn(e[8],32),v:r})}return t}function YJ(n,e){let t=[We(n.nonce,"nonce"),We(n.gasPrice||0,"gasPrice"),We(n.gasLimit,"gasLimit"),n.to||"0x",We(n.value,"value"),n.data],r=Tn;if(n.chainId!=Tn)r=ne(n.chainId,"tx.chainId"),x(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(n.signature){let s=n.signature.legacyChainId;s!=null&&(r=s)}if(!e)return r!==Tn&&(t.push(Vt(r)),t.push("0x"),t.push("0x")),Fi(t);let i=BigInt(27+e.yParity);return r!==Tn?i=yn.getChainIdV(r,e.v):BigInt(e.v)!==i&&x(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(Vt(i)),t.push(Vt(e.r)),t.push(Vt(e.s)),Fi(t)}function rv(n,e){let t;try{if(t=vl(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{x(!1,"invalid yParity","yParity",e[0])}let r=Yn(e[1],32),i=Yn(e[2],32),s=yn.from({r,s:i,yParity:t});n.signature=s}function JJ(n){let e=Ca(ve(n).slice(1));x(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Z(n));let t={type:2,chainId:xt(e[0],"chainId"),nonce:vl(e[1],"nonce"),maxPriorityFeePerGas:xt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:xt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:xt(e[4],"gasLimit"),to:vd(e[5]),value:xt(e[6],"value"),data:Z(e[7]),accessList:tv(e[8],"accessList")};return e.length===9||rv(t,e.slice(9)),t}function ZJ(n,e){let t=[We(n.chainId,"chainId"),We(n.nonce,"nonce"),We(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),We(n.maxFeePerGas||0,"maxFeePerGas"),We(n.gasLimit,"gasLimit"),n.to||"0x",We(n.value,"value"),n.data,nv(n.accessList||[])];return e&&(t.push(We(e.yParity,"yParity")),t.push(Vt(e.r)),t.push(Vt(e.s))),nt(["0x02",Fi(t)])}function XJ(n){let e=Ca(ve(n).slice(1));x(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Z(n));let t={type:1,chainId:xt(e[0],"chainId"),nonce:vl(e[1],"nonce"),gasPrice:xt(e[2],"gasPrice"),gasLimit:xt(e[3],"gasLimit"),to:vd(e[4]),value:xt(e[5],"value"),data:Z(e[6]),accessList:tv(e[7],"accessList")};return e.length===8||rv(t,e.slice(8)),t}function eZ(n,e){let t=[We(n.chainId,"chainId"),We(n.nonce,"nonce"),We(n.gasPrice||0,"gasPrice"),We(n.gasLimit,"gasLimit"),n.to||"0x",We(n.value,"value"),n.data,nv(n.accessList||[])];return e&&(t.push(We(e.yParity,"recoveryParam")),t.push(Vt(e.r)),t.push(Vt(e.s))),nt(["0x01",Fi(t)])}function tZ(n){let e=Ca(ve(n).slice(1)),t="3",r=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";let s=e[1],o=e[2],a=e[3];x(Array.isArray(s),"invalid network format: blobs not an array","fields[1]",s),x(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),x(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),x(s.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),x(s.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let c=0;c<e[1].length;c++)r.push({data:s[c],commitment:o[c],proof:a[c]});e=e[0]}x(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",Z(n));let i={type:3,chainId:xt(e[0],"chainId"),nonce:vl(e[1],"nonce"),maxPriorityFeePerGas:xt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:xt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:xt(e[4],"gasLimit"),to:vd(e[5]),value:xt(e[6],"value"),data:Z(e[7]),accessList:tv(e[8],"accessList"),maxFeePerBlobGas:xt(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(i.blobs=r),x(i.to!=null,`invalid address for transaction type: ${t}`,"data",n),x(Array.isArray(i.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",n);for(let s=0;s<i.blobVersionedHashes.length;s++)x($e(i.blobVersionedHashes[s],32),`invalid blobVersionedHash at index ${s}: must be length 32`,"data",n);return e.length===11||rv(i,e.slice(11)),i}function nZ(n,e,t){let r=[We(n.chainId,"chainId"),We(n.nonce,"nonce"),We(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),We(n.maxFeePerGas||0,"maxFeePerGas"),We(n.gasLimit,"gasLimit"),n.to||ko,We(n.value,"value"),n.data,nv(n.accessList||[]),We(n.maxFeePerBlobGas||0,"maxFeePerBlobGas"),KJ(n.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(We(e.yParity,"yParity")),r.push(Vt(e.r)),r.push(Vt(e.s)),t)?nt(["0x03",Fi([r,t.map(i=>i.data),t.map(i=>i.commitment),t.map(i=>i.proof)])]):nt(["0x03",Fi(r)])}function rZ(n){let e=Ca(ve(n).slice(1));x(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",Z(n));let t={type:4,chainId:xt(e[0],"chainId"),nonce:vl(e[1],"nonce"),maxPriorityFeePerGas:xt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:xt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:xt(e[4],"gasLimit"),to:vd(e[5]),value:xt(e[6],"value"),data:Z(e[7]),accessList:tv(e[8],"accessList"),authorizationList:GJ(e[9],"authorizationList")};return e.length===10||rv(t,e.slice(10)),t}function iZ(n,e){let t=[We(n.chainId,"chainId"),We(n.nonce,"nonce"),We(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),We(n.maxFeePerGas||0,"maxFeePerGas"),We(n.gasLimit,"gasLimit"),n.to||"0x",We(n.value,"value"),n.data,nv(n.accessList||[]),WJ(n.authorizationList||[])];return e&&(t.push(We(e.yParity,"yParity")),t.push(Vt(e.r)),t.push(Vt(e.s))),nt(["0x04",Fi(t)])}var wl=class n{#e;#t;#n;#r;#i;#o;#s;#a;#d;#l;#p;#g;#c;#u;#h;#f;#y;get type(){return this.#e}set type(e){switch(e){case null:this.#e=null;break;case 0:case"legacy":this.#e=0;break;case 1:case"berlin":case"eip-2930":this.#e=1;break;case 2:case"london":case"eip-1559":this.#e=2;break;case 3:case"cancun":case"eip-4844":this.#e=3;break;case 4:case"pectra":case"eip-7702":this.#e=4;break;default:x(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){let e=this.#t;return e==null&&this.type===3?ko:e}set to(e){this.#t=e==null?null:ke(e)}get nonce(){return this.#r}set nonce(e){this.#r=Ie(e,"value")}get gasLimit(){return this.#i}set gasLimit(e){this.#i=ne(e)}get gasPrice(){let e=this.#o;return e==null&&(this.type===0||this.type===1)?Tn:e}set gasPrice(e){this.#o=e==null?null:ne(e,"gasPrice")}get maxPriorityFeePerGas(){let e=this.#s;return e??(this.type===2||this.type===3?Tn:null)}set maxPriorityFeePerGas(e){this.#s=e==null?null:ne(e,"maxPriorityFeePerGas")}get maxFeePerGas(){let e=this.#a;return e??(this.type===2||this.type===3?Tn:null)}set maxFeePerGas(e){this.#a=e==null?null:ne(e,"maxFeePerGas")}get data(){return this.#n}set data(e){this.#n=Z(e)}get value(){return this.#d}set value(e){this.#d=ne(e,"value")}get chainId(){return this.#l}set chainId(e){this.#l=ne(e)}get signature(){return this.#p||null}set signature(e){this.#p=e==null?null:yn.from(e)}get accessList(){let e=this.#g||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){this.#g=e==null?null:di(e)}get authorizationList(){let e=this.#y||null;return e==null&&this.type===4?[]:e}set authorizationList(e){this.#y=e==null?null:e.map(t=>pp(t))}get maxFeePerBlobGas(){let e=this.#c;return e==null&&this.type===3?Tn:e}set maxFeePerBlobGas(e){this.#c=e==null?null:ne(e,"maxFeePerBlobGas")}get blobVersionedHashes(){let e=this.#u;return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){x(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)x($e(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}this.#u=e}get blobs(){return this.#f==null?null:this.#f.map(e=>Object.assign({},e))}set blobs(e){if(e==null){this.#f=null;return}let t=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if(ba(s)){G(this.#h,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=ve(s);if(x(o.length<=RA,"blob is too large",`blobs[${i}]`,s),o.length!==RA){let l=new Uint8Array(RA);l.set(o),o=l}let a=this.#h.blobToKzgCommitment(o),c=Z(this.#h.computeBlobKzgProof(o,a));t.push({data:Z(o),commitment:Z(a),proof:c}),r.push(rF(1,a))}else{let o=Z(s.commitment);t.push({data:Z(s.data),commitment:o,proof:Z(s.proof)}),r.push(rF(1,o))}}this.#f=t,this.#u=r}get kzg(){return this.#h}set kzg(e){e==null?this.#h=null:this.#h=zJ(e)}constructor(){this.#e=null,this.#t=null,this.#r=0,this.#i=Tn,this.#o=null,this.#s=null,this.#a=null,this.#n="0x",this.#d=Tn,this.#l=Tn,this.#p=null,this.#g=null,this.#c=null,this.#u=null,this.#h=null,this.#f=null,this.#y=null}get hash(){return this.signature==null?null:bt(this.#m(!0,!1))}get unsignedHash(){return bt(this.unsignedSerialized)}get from(){return this.signature==null?null:nF(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Ma.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}#m(e,t){G(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});let r=e?this.signature:null;switch(this.inferType()){case 0:return YJ(this,r);case 1:return eZ(this,r);case 2:return ZJ(this,r);case 3:return nZ(this,r,t?this.blobs:null);case 4:return iZ(this,r)}G(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#m(!0,!0)}get unsignedSerialized(){return this.#m(!1,!1)}inferType(){let e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){let e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,i=this.#c!=null||this.#u;this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&G(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),G(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),G(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});let s=[];return this.type!=null?s.push(this.type):this.authorizationList&&this.authorizationList.length?s.push(4):t?s.push(2):e?(s.push(1),r||s.push(0)):r?(s.push(1),s.push(2)):(i&&this.to||(s.push(0),s.push(1),s.push(2)),s.push(3)),s.sort(),s}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return n.from(this)}toJSON(){let e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new n;if(typeof e=="string"){let r=ve(e);if(r[0]>=127)return n.from(QJ(r));switch(r[0]){case 1:return n.from(XJ(r));case 2:return n.from(JJ(r));case 3:return n.from(tZ(r));case 4:return n.from(rZ(r))}G(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}let t=new n;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=yn.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.authorizationList!=null&&(t.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(x(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),x(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(x(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),x(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};function vs(n){return bt(Zn(n))}var sZ="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI",iF=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),sF=4;function oZ(n){let e=0;function t(){return n[e++]<<8|n[e++]}let r=t(),i=1,s=[0,1];for(let k=1;k<r;k++)s.push(i+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|n[e++],c=8),l>>--c&1}let d=31,h=2**d,f=h>>>1,p=f>>1,g=h-1,m=0;for(let k=0;k<d;k++)m=m<<1|u();let y=[],E=0,I=h;for(;;){let k=Math.floor(((m-E+1)*i-1)/I),D=0,B=r;for(;B-D>1;){let $=D+B>>>1;k<s[$]?B=$:D=$}if(D==0)break;y.push(D);let U=E+Math.floor(I*s[D]/i),T=E+Math.floor(I*s[D+1]/i)-1;for(;((U^T)&f)==0;)m=m<<1&g|u(),U=U<<1&g,T=T<<1&g|1;for(;U&~T&p;)m=m&f|m<<1&g>>>1|u(),U=U<<1^f,T=(T^f)<<1|f|1;E=U,I=1+T-U}let L=r-4;return y.map(k=>{switch(k-L){case 3:return L+65792+(n[a++]<<16|n[a++]<<8|n[a++]);case 2:return L+256+(n[a++]<<8|n[a++]);case 1:return L+n[a++];default:return k-1}})}function aZ(n){let e=0;return()=>n[e++]}function lF(n){return aZ(oZ(cZ(n)))}function cZ(n){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((i,s)=>e[i.charCodeAt(0)]=s);let t=n.length,r=new Uint8Array(6*t>>3);for(let i=0,s=0,o=0,a=0;i<t;i++)a=a<<6|e[n.charCodeAt(i)],o+=6,o>=8&&(r[s++]=a>>(o-=8));return r}function lZ(n){return n&1?~n>>1:n>>1}function uZ(n,e){let t=Array(n);for(let r=0,i=0;r<n;r++)t[r]=i+=lZ(e());return t}function yp(n,e=0){let t=[];for(;;){let r=n(),i=n();if(!i)break;e+=r;for(let s=0;s<i;s++)t.push(e+s);e+=i+1}return t}function uF(n){return wp(()=>{let e=yp(n);if(e.length)return e})}function dF(n){let e=[];for(;;){let t=n();if(t==0)break;e.push(dZ(t,n))}for(;;){let t=n()-1;if(t<0)break;e.push(hZ(t,n))}return e.flat()}function wp(n){let e=[];for(;;){let t=n(e.length);if(!t)break;e.push(t)}return e}function hF(n,e,t){let r=Array(n).fill().map(()=>[]);for(let i=0;i<e;i++)uZ(n,t).forEach((s,o)=>r[o].push(s));return r}function dZ(n,e){let t=1+e(),r=e(),i=wp(e);return hF(i.length,1+n,e).flatMap((o,a)=>{let[c,...l]=o;return Array(i[a]).fill().map((u,d)=>{let h=d*r;return[c+d*t,l.map(f=>f+h)]})})}function hZ(n,e){let t=1+e();return hF(t,1+n,e).map(i=>[i[0],i.slice(1)])}function fZ(n){let e=[],t=yp(n);return i(r([]),[]),e;function r(s){let o=n(),a=wp(()=>{let c=yp(n).map(l=>t[l]);if(c.length)return r(c)});return{S:o,B:a,Q:s}}function i({S:s,B:o},a,c){if(!(s&4&&c===a[a.length-1])){s&2&&(c=a[a.length-1]),s&1&&e.push(a);for(let l of o)for(let u of l.Q)i(l,[...a,u],c)}}}function pZ(n){return n.toString(16).toUpperCase().padStart(2,"0")}function fF(n){return`{${pZ(n)}}`}function gZ(n){let e=[];for(let t=0,r=n.length;t<r;){let i=n.codePointAt(t);t+=i<65536?1:2,e.push(i)}return e}function Id(n){let t=n.length;if(t<4096)return String.fromCodePoint(...n);let r=[];for(let i=0;i<t;)r.push(String.fromCodePoint(...n.slice(i,i+=4096)));return r.join("")}function mZ(n,e){let t=n.length,r=t-e.length;for(let i=0;r==0&&i<t;i++)r=n[i]-e[i];return r}var yZ="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g",vp=44032,sv=4352,ov=4449,av=4519,pF=19,gF=21,Cd=28,cv=gF*Cd,wZ=pF*cv,vZ=vp+wZ,bZ=sv+pF,EZ=ov+gF,IZ=av+Cd;function gp(n){return n>>24&255}function mF(n){return n&16777215}var PA,oF,MA,iv;function CZ(){let n=lF(yZ);PA=new Map(uF(n).flatMap((e,t)=>e.map(r=>[r,t+1<<24]))),oF=new Set(yp(n)),MA=new Map,iv=new Map;for(let[e,t]of dF(n)){if(!oF.has(e)&&t.length==2){let[r,i]=t,s=iv.get(r);s||(s=new Map,iv.set(r,s)),s.set(i,e)}MA.set(e,t.reverse())}}function yF(n){return n>=vp&&n<vZ}function SZ(n,e){if(n>=sv&&n<bZ&&e>=ov&&e<EZ)return vp+(n-sv)*cv+(e-ov)*Cd;if(yF(n)&&e>av&&e<IZ&&(n-vp)%Cd==0)return n+(e-av);{let t=iv.get(n);return t&&(t=t.get(e),t)?t:-1}}function wF(n){PA||CZ();let e=[],t=[],r=!1;function i(s){let o=PA.get(s);o&&(r=!0,s|=o),e.push(s)}for(let s of n)for(;;){if(s<128)e.push(s);else if(yF(s)){let o=s-vp,a=o/cv|0,c=o%cv/Cd|0,l=o%Cd;i(sv+a),i(ov+c),l>0&&i(av+l)}else{let o=MA.get(s);o?t.push(...o):i(s)}if(!t.length)break;s=t.pop()}if(r&&e.length>1){let s=gp(e[0]);for(let o=1;o<e.length;o++){let a=gp(e[o]);if(a==0||s<=a){s=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(s=gp(e[--c]),s<=a))break}s=gp(e[o])}}return e}function AZ(n){let e=[],t=[],r=-1,i=0;for(let s of n){let o=gp(s),a=mF(s);if(r==-1)o==0?r=a:e.push(a);else if(i>0&&i>=o)o==0?(e.push(r,...t),t.length=0,r=a):t.push(a),i=o;else{let c=SZ(r,a);c>=0?r=c:i==0&&o==0?(e.push(r),r=a):(t.push(a),i=o)}}return r>=0&&e.push(r,...t),e}function vF(n){return wF(n).map(mF)}function _Z(n){return AZ(wF(n))}var aF=45;var bF=".",EF=65039,IF=1,lv=n=>Array.from(n);function bp(n,e){return n.P.has(e)||n.Q.has(e)}var kA=class extends Array{get is_emoji(){return!0}},LA,CF,El,FA,SF,TZ,Ed,OA,bd,bl,cF,BA;function UA(){if(LA)return;let n=lF(sZ),e=()=>yp(n),t=()=>new Set(e()),r=(u,d)=>d.forEach(h=>u.add(h));LA=new Map(dF(n)),CF=t(),El=e(),FA=new Set(e().map(u=>El[u])),El=new Set(El),SF=t(),TZ=t();let i=uF(n),s=n(),o=()=>{let u=new Set;return e().forEach(d=>r(u,i[d])),r(u,e()),u};Ed=wp(u=>{let d=wp(n).map(h=>h+96);if(d.length){let h=u>=s;d[0]-=32,d=Id(d),h&&(d=`Restricted[${d}]`);let f=o(),p=o(),g=!n();return{N:d,P:f,Q:p,M:g,R:h}}}),OA=t(),bd=new Map;let a=e().concat(lv(OA)).sort((u,d)=>u-d);a.forEach((u,d)=>{let h=n(),f=a[d]=h?a[d-h]:{V:[],M:new Map};f.V.push(u),OA.has(u)||bd.set(u,f)});for(let{V:u,M:d}of new Set(bd.values())){let h=[];for(let p of u){let g=Ed.filter(y=>bp(y,p)),m=h.find(({G:y})=>g.some(E=>y.has(E)));m||(m={G:new Set,V:[]},h.push(m)),m.V.push(p),r(m.G,g)}let f=h.flatMap(p=>lv(p.G));for(let{G:p,V:g}of h){let m=new Set(f.filter(y=>!p.has(y)));for(let y of g)d.set(y,m)}}bl=new Set;let c=new Set,l=u=>bl.has(u)?c.add(u):bl.add(u);for(let u of Ed){for(let d of u.P)l(d);for(let d of u.Q)l(d)}for(let u of bl)!bd.has(u)&&!c.has(u)&&bd.set(u,IF);r(bl,vF(bl)),cF=fZ(n).map(u=>kA.from(u)).sort(mZ),BA=new Map;for(let u of cF){let d=[BA];for(let h of u){let f=d.map(p=>{let g=p.get(h);return g||(g=new Map,p.set(h,g)),g});h===EF?d.push(...f):d=f}for(let h of d)h.V=u}}function jA(n){return(AF(n)?"":`${VA(uv([n]))} `)+fF(n)}function VA(n){return`"${n}"\u200E`}function xZ(n){if(n.length>=4&&n[2]==aF&&n[3]==aF)throw new Error(`invalid label extension: "${Id(n.slice(0,4))}"`)}function DZ(n){for(let t=n.lastIndexOf(95);t>0;)if(n[--t]!==95)throw new Error("underscore allowed only at start")}function NZ(n){let e=n[0],t=iF.get(e);if(t)throw mp(`leading ${t}`);let r=n.length,i=-1;for(let s=1;s<r;s++){e=n[s];let o=iF.get(e);if(o){if(i==s)throw mp(`${t} + ${o}`);i=s+1,t=o}}if(i==r)throw mp(`trailing ${t}`)}function uv(n,e=1/0,t=fF){let r=[];RZ(n[0])&&r.push("\u25CC"),n.length>e&&(e>>=1,n=[...n.slice(0,e),8230,...n.slice(-e)]);let i=0,s=n.length;for(let o=0;o<s;o++){let a=n[o];AF(a)&&(r.push(Id(n.slice(i,o))),r.push(t(a)),i=o+1)}return r.push(Id(n.slice(i,s))),r.join("")}function RZ(n){return UA(),El.has(n)}function AF(n){return UA(),SF.has(n)}function _F(n){return kZ(OZ(n,_Z,BZ))}function OZ(n,e,t){if(!n)return[];UA();let r=0;return n.split(bF).map(i=>{let s=gZ(i),o={input:s,offset:r};r+=s.length+1;try{let a=o.tokens=FZ(s,e,t),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(DZ(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(h=>h<128))xZ(u),l="ASCII";else{let h=a.flatMap(f=>f.is_emoji?[]:f);if(!h.length)l="Emoji";else{if(El.has(u[0]))throw mp("leading combining mark");for(let g=1;g<c;g++){let m=a[g];if(!m.is_emoji&&El.has(m[0]))throw mp(`emoji + combining mark: "${Id(a[g-1])} + ${uv([m[0]])}"`)}NZ(u);let f=lv(new Set(h)),[p]=MZ(f);LZ(p,h),PZ(p,f),l=p.N}}o.type=l}catch(a){o.error=a}return o})}function PZ(n,e){let t,r=[];for(let i of e){let s=bd.get(i);if(s===IF)return;if(s){let o=s.M.get(i);if(t=t?t.filter(a=>o.has(a)):lv(o),!t.length)return}else r.push(i)}if(t){for(let i of t)if(r.every(s=>bp(i,s)))throw new Error(`whole-script confusable: ${n.N}/${i.N}`)}}function MZ(n){let e=Ed;for(let t of n){let r=e.filter(i=>bp(i,t));if(!r.length)throw Ed.some(i=>bp(i,t))?xF(e[0],t):TF(t);if(e=r,r.length==1)break}return e}function kZ(n){return n.map(({input:e,error:t,output:r})=>{if(t){let i=t.message;throw new Error(n.length==1?i:`Invalid label ${VA(uv(e,63))}: ${i}`)}return Id(r)}).join(bF)}function TF(n){return new Error(`disallowed character: ${jA(n)}`)}function xF(n,e){let t=jA(e),r=Ed.find(i=>i.P.has(e));return r&&(t=`${r.N} ${t}`),new Error(`illegal mixture: ${n.N} + ${t}`)}function mp(n){return new Error(`illegal placement: ${n}`)}function LZ(n,e){for(let t of e)if(!bp(n,t))throw xF(n,t);if(n.M){let t=vF(e);for(let r=1,i=t.length;r<i;r++)if(FA.has(t[r])){let s=r+1;for(let o;s<i&&FA.has(o=t[s]);s++)for(let a=r;a<s;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${jA(o)}`);if(s-r>sF)throw new Error(`excessive non-spacing marks: ${VA(uv(t.slice(r-1,s)))} (${s-r}/${sF})`);r=s}}}function FZ(n,e,t){let r=[],i=[];for(n=n.slice().reverse();n.length;){let s=UZ(n);if(s)i.length&&(r.push(e(i)),i=[]),r.push(t(s));else{let o=n.pop();if(bl.has(o))i.push(o);else{let a=LA.get(o);if(a)i.push(...a);else if(!CF.has(o))throw TF(o)}}}return i.length&&r.push(e(i)),r}function BZ(n){return n.filter(e=>e!=EF)}function UZ(n,e){let t=BA,r,i=n.length;for(;i&&(t=t.get(n[--i]),!!t);){let{V:s}=t;s&&(r=s,e&&e.push(...n.slice(i).reverse()),n.length=i)}return r}var NF=new Uint8Array(32);NF.fill(0);function DF(n){return x(n.length!==0,"invalid ENS name; empty component","comp",n),n}function RF(n){let e=Zn(OF(n)),t=[];if(n.length===0)return t;let r=0;for(let i=0;i<e.length;i++)e[i]===46&&(t.push(DF(e.slice(r,i))),r=i+1);return x(r<e.length,"invalid ENS name; empty component","name",n),t.push(DF(e.slice(r))),t}function OF(n){try{if(n.length===0)throw new Error("empty label");return _F(n)}catch(e){x(!1,`invalid ENS name (${e.message})`,"name",n)}}function Sd(n){x(typeof n=="string","invalid ENS name; not a string","name",n),x(n.length,"invalid ENS name (empty label)","name",n);let e=NF,t=RF(n);for(;t.length;)e=bt(nt([e,bt(t.pop())]));return Z(e)}function HA(n,e){let t=e??63;return x(t<=255,"DNS encoded label cannot exceed 255","length",t),Z(nt(RF(n).map(r=>{x(r.length<=t,`label ${JSON.stringify(n)} exceeds ${t} bytes`,"name",n);let i=new Uint8Array(r.length+1);return i.set(r,1),i[0]=i.length-1,i})))+"00"}var LF=new Uint8Array(32);LF.fill(0);var jZ=BigInt(-1),FF=BigInt(0),BF=BigInt(1),VZ=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function HZ(n){let e=ve(n),t=e.length%32;return t?nt([e,LF.slice(t)]):Z(e)}var $Z=Cr(BF,32),qZ=Cr(FF,32),PF={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},$A=["name","version","chainId","verifyingContract","salt"];function MF(n){return function(e){return x(typeof e=="string",`invalid domain value for ${JSON.stringify(n)}`,`domain.${n}`,e),e}}var zZ={name:MF("name"),version:MF("version"),chainId:function(n){let e=ne(n,"domain.chainId");return x(e>=0,"invalid chain ID","domain.chainId",n),Number.isSafeInteger(e)?Number(e):Jn(e)},verifyingContract:function(n){try{return ke(n).toLowerCase()}catch{}x(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",n)},salt:function(n){let e=ve(n,"domain.salt");return x(e.length===32,'invalid domain value "salt"',"domain.salt",n),Z(e)}};function qA(n){{let e=n.match(/^(u?)int(\d+)$/);if(e){let t=e[1]==="",r=parseInt(e[2]);x(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",n);let i=Li(VZ,t?r-1:r),s=t?(i+BF)*jZ:FF;return function(o){let a=ne(o,"value");return x(a>=s&&a<=i,`value out-of-bounds for ${n}`,"value",a),Cr(t?ud(a,256):a,32)}}}{let e=n.match(/^bytes(\d+)$/);if(e){let t=parseInt(e[1]);return x(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",n),function(r){let i=ve(r);return x(i.length===t,`invalid length for ${n}`,"value",r),HZ(r)}}}switch(n){case"address":return function(e){return Yn(ke(e),32)};case"bool":return function(e){return e?$Z:qZ};case"bytes":return function(e){return bt(e)};case"string":return function(e){return vs(e)}}return null}function kF(n,e){return`${n}(${e.map(({name:t,type:r})=>r+" "+t).join(",")})`}function dv(n){let e=n.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:n}}var Ad=class n{primaryType;#e;get types(){return JSON.parse(this.#e)}#t;#n;constructor(e){this.#t=new Map,this.#n=new Map;let t=new Map,r=new Map,i=new Map,s={};Object.keys(e).forEach(c=>{s[c]=e[c].map(({name:l,type:u})=>{let{base:d,index:h}=dv(u);return d==="int"&&!e.int&&(d="int256"),d==="uint"&&!e.uint&&(d="uint256"),{name:l,type:d+(h||"")}}),t.set(c,new Set),r.set(c,[]),i.set(c,new Set)}),this.#e=JSON.stringify(s);for(let c in s){let l=new Set;for(let u of s[c]){x(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);let d=dv(u.type).base;x(d!==c,`circular type reference to ${JSON.stringify(d)}`,"types",e),!qA(d)&&(x(r.has(d),`unknown type ${JSON.stringify(d)}`,"types",e),r.get(d).push(c),t.get(c).add(d))}}let o=Array.from(r.keys()).filter(c=>r.get(c).length===0);x(o.length!==0,"missing primary type","types",e),x(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),ce(this,{primaryType:o[0]});function a(c,l){x(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(let u of t.get(c))if(r.has(u)){a(u,l);for(let d of l)i.get(d).add(u)}l.delete(c)}a(this.primaryType,new Set);for(let[c,l]of i){let u=Array.from(l);u.sort(),this.#t.set(c,kF(c,s[c])+u.map(d=>kF(d,s[d])).join(""))}}getEncoder(e){let t=this.#n.get(e);return t||(t=this.#r(e),this.#n.set(e,t)),t}#r(e){{let i=qA(e);if(i)return i}let t=dv(e).array;if(t){let i=t.prefix,s=this.getEncoder(i);return o=>{x(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(s);return this.#t.has(i)&&(a=a.map(bt)),bt(nt(a))}}let r=this.types[e];if(r){let i=vs(this.#t.get(e));return s=>{let o=r.map(({name:a,type:c})=>{let l=this.getEncoder(c)(s[a]);return this.#t.has(c)?bt(l):l});return o.unshift(i),nt(o)}}x(!1,`unknown type: ${e}`,"type",e)}encodeType(e){let t=this.#t.get(e);return x(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return bt(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,r){if(qA(e))return r(e,t);let i=dv(e).array;if(i)return x(i.count===-1||i.count===t.length,`array length mismatch; expected length ${i.count}`,"value",t),t.map(o=>this._visit(i.prefix,o,r));let s=this.types[e];if(s)return s.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],r),o),{});x(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new n(e)}static getPrimaryType(e){return n.from(e).primaryType}static hashStruct(e,t,r){return n.from(t).hashStruct(e,r)}static hashDomain(e){let t=[];for(let r in e){if(e[r]==null)continue;let i=PF[r];x(i,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),t.push({name:r,type:i})}return t.sort((r,i)=>$A.indexOf(r.name)-$A.indexOf(i.name)),n.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,r){return nt(["0x1901",n.hashDomain(e),n.from(t).hash(r)])}static hash(e,t,r){return bt(n.encode(e,t,r))}static async resolveNames(e,t,r,i){e=Object.assign({},e);for(let a in e)e[a]==null&&delete e[a];let s={};e.verifyingContract&&!$e(e.verifyingContract,20)&&(s[e.verifyingContract]="0x");let o=n.from(t);o.visit(r,(a,c)=>(a==="address"&&!$e(c,20)&&(s[c]="0x"),c));for(let a in s)s[a]=await i(a);return e.verifyingContract&&s[e.verifyingContract]&&(e.verifyingContract=s[e.verifyingContract]),r=o.visit(r,(a,c)=>a==="address"&&s[c]?s[c]:c),{domain:e,value:r}}static getPayload(e,t,r){n.hashDomain(e);let i={},s=[];$A.forEach(c=>{let l=e[c];l!=null&&(i[c]=zZ[c](l),s.push({name:c,type:PF[c]}))});let o=n.from(t);t=o.types;let a=Object.assign({},t);return x(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=s,o.encode(r),{types:a,domain:i,primaryType:o.primaryType,message:o.visit(r,(c,l)=>{if(c.match(/^bytes(\d*)/))return Z(ve(l));if(c.match(/^u?int/))return ne(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return x(typeof l=="string","invalid string","value",l),l}x(!1,"unsupported type","type",c)})}}};function Sr(n){let e=new Set;return n.forEach(t=>e.add(t)),Object.freeze(e)}var GZ="external public payable override",WZ=Sr(GZ.split(" ")),KF="constant external internal payable private public pure view override",KZ=Sr(KF.split(" ")),QF="constructor error event fallback function receive struct",YF=Sr(QF.split(" ")),JF="calldata memory storage payable indexed",QZ=Sr(JF.split(" ")),YZ="tuple returns",JZ=[QF,JF,YZ,KF].join(" "),ZZ=Sr(JZ.split(" ")),XZ={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},eX=new RegExp("^(\\s*)"),tX=new RegExp("^([0-9]+)"),nX=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),ZF=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),XF=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$"),bs=class n{#e;#t;get offset(){return this.#e}get length(){return this.#t.length-this.#e}constructor(e){this.#e=0,this.#t=e.slice()}clone(){return new n(this.#t)}reset(){this.#e=0}#n(e=0,t=0){return new n(this.#t.slice(e,t).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))}popKeyword(e){let t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){let t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){let e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");let t=this.#n(this.#e+1,e.match+1);return this.#e=e.match+1,t}popParams(){let e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");let t=[];for(;this.#e<e.match-1;){let r=this.peek().linkNext;t.push(this.#n(this.#e+1,r)),this.#e=r}return this.#e=e.match+1,t}peek(){if(this.#e>=this.#t.length)throw new Error("out-of-bounds");return this.#t[this.#e]}peekKeyword(e){let t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;let t=this.peek();return t.type===e?t.text:null}pop(){let e=this.peek();return this.#e++,e}toString(){let e=[];for(let t=this.#e;t<this.#t.length;t++){let r=this.#t[t];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};function ka(n){let e=[],t=o=>{let a=s<n.length?JSON.stringify(n[s]):"$EOI";throw new Error(`invalid token ${a} at ${s}: ${o}`)},r=[],i=[],s=0;for(;s<n.length;){let o=n.substring(s),a=o.match(eX);a&&(s+=a[1].length,o=n.substring(s));let c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:s,value:-1};e.push(c);let l=XZ[o[0]]||"";if(l){if(c.type=l,c.text=o[0],s++,l==="OPEN_PAREN")r.push(e.length-1),i.push(e.length-1);else if(l=="CLOSE_PAREN")r.length===0&&t("no matching open bracket"),c.match=r.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1,i.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){let d=e.pop().text;u=d+u,e[e.length-1].value=Ie(d)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(nX),a){if(c.text=a[1],s+=c.text.length,ZZ.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(XF)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(tX),a){c.text=a[1],c.type="NUMBER",s+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${s}`)}return new bs(e.map(o=>Object.freeze(o)))}function UF(n,e){let t=[];for(let r in e.keys())n.has(r)&&t.push(r);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function fv(n,e){if(e.peekKeyword(YF)){let t=e.pop().text;if(t!==n)throw new Error(`expected ${n}, got ${t}`)}return e.popType("ID")}function Fo(n,e){let t=new Set;for(;;){let r=n.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(n.pop(),t.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);t.add(r)}return Object.freeze(t)}function eB(n){let e=Fo(n,KZ);return UF(e,Sr("constant payable nonpayable".split(" "))),UF(e,Sr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Lo(n,e){return n.popParams().map(t=>wn.from(t,e))}function tB(n){if(n.peekType("AT")){if(n.pop(),n.peekType("NUMBER"))return ne(n.pop().text);throw new Error("invalid gas")}return null}function Al(n){if(n.length)throw new Error(`unexpected tokens at offset ${n.offset}: ${n.toString()}`)}var rX=new RegExp(/^(.*)\[([0-9]*)\]$/);function jF(n){let e=n.match(XF);if(x(e,"invalid type","type",n),n==="uint")return"uint256";if(n==="int")return"int256";if(e[2]){let t=parseInt(e[2]);x(t!==0&&t<=32,"invalid bytes length","type",n)}else if(e[3]){let t=parseInt(e[3]);x(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",n)}return n}var Gt={},Gr=Symbol.for("_ethers_internal"),VF="_ParamTypeInternal",HF="_ErrorInternal",$F="_EventInternal",qF="_ConstructorInternal",zF="_FallbackInternal",GF="_FunctionInternal",WF="_StructInternal",wn=class n{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(e,t,r,i,s,o,a,c){if(fs(e,Gt,"ParamType"),Object.defineProperty(this,Gr,{value:VF}),o&&(o=Object.freeze(o.slice())),i==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(i==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");ce(this,{name:t,type:r,baseType:i,indexed:s,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){let r=this.name||"";if(this.isArray()){let s=JSON.parse(this.arrayChildren.format("json"));return s.name=r,s.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(s)}let i={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(i.indexed=this.indexed),this.isTuple()&&(i.components=this.components.map(s=>JSON.parse(s.format(e)))),JSON.stringify(i)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");let r=this;return e.map(i=>r.arrayChildren.walk(i,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");let r=this;return e.map((i,s)=>r.components[s].walk(i,t))}return t(this.type,e)}#e(e,t,r,i){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");let o=this.arrayChildren,a=t.slice();a.forEach((c,l)=>{o.#e(e,c,r,u=>{a[l]=u})}),i(a);return}if(this.isTuple()){let o=this.components,a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{o[l].#e(e,c,r,u=>{a[l]=u})}),i(a);return}let s=r(this.type,t);s.then?e.push((async function(){i(await s)})()):i(s)}async walkAsync(e,t){let r=[],i=[e];return this.#e(r,e,t,s=>{i[0]=s}),r.length&&await Promise.all(r),i[0]}static from(e,t){if(n.isParamType(e))return e;if(typeof e=="string")try{return n.from(ka(e),t)}catch{x(!1,"invalid param type","obj",e)}else if(e instanceof bs){let a="",c="",l=null;Fo(e,Sr(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(g=>n.from(g)),a=`tuple(${l.map(g=>g.format()).join(",")})`):(a=jF(e.popType("TYPE")),c=a);let u=null,d=null;for(;e.length&&e.peekType("BRACKET");){let g=e.pop();u=new n(Gt,"",a,c,null,l,d,u),d=g.value,a+=g.text,c="array",l=null}let h=null;if(Fo(e,QZ).has("indexed")){if(!t)throw new Error("");h=!0}let p=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new n(Gt,p,a,c,h,l,d,u)}let r=e.name;x(!r||typeof r=="string"&&r.match(ZF),"invalid name","obj.name",r);let i=e.indexed;i!=null&&(x(t,"parameter cannot be indexed","obj.indexed",e.indexed),i=!!i);let s=e.type,o=s.match(rX);if(o){let a=parseInt(o[2]||"-1"),c=n.from({type:o[1],components:e.components});return new n(Gt,r||"",s,"array",i,null,a,c)}if(s==="tuple"||s.startsWith("tuple(")||s.startsWith("(")){let a=e.components!=null?e.components.map(l=>n.from(l)):null;return new n(Gt,r||"",s,"tuple",i,a,null,null)}return s=jF(e.type),new n(Gt,r||"",s,s,i,null,null,null)}static isParamType(e){return e&&e[Gr]===VF}},_l=class n{type;inputs;constructor(e,t,r){fs(e,Gt,"Fragment"),r=Object.freeze(r.slice()),ce(this,{type:t,inputs:r})}static from(e){if(typeof e=="string"){try{n.from(JSON.parse(e))}catch{}return n.from(ka(e))}if(e instanceof bs)switch(e.peekKeyword(YF)){case"constructor":return Cl.from(e);case"error":return ji.from(e);case"event":return Il.from(e);case"fallback":case"receive":return hv.from(e);case"function":return Sl.from(e);case"struct":return Ep.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Cl.from(e);case"error":return ji.from(e);case"event":return Il.from(e);case"fallback":case"receive":return hv.from(e);case"function":return Sl.from(e);case"struct":return Ep.from(e)}G(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}x(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Cl.isFragment(e)}static isError(e){return ji.isFragment(e)}static isEvent(e){return Il.isFragment(e)}static isFunction(e){return Sl.isFragment(e)}static isStruct(e){return Ep.isFragment(e)}},_d=class extends _l{name;constructor(e,t,r,i){super(e,t,i),x(typeof r=="string"&&r.match(ZF),"invalid identifier","name",r),i=Object.freeze(i.slice()),ce(this,{name:r})}};function Ip(n,e){return"("+e.map(t=>t.format(n)).join(n==="full"?", ":",")+")"}var ji=class n extends _d{constructor(e,t,r){super(e,"error",t,r),Object.defineProperty(this,Gr,{value:HF})}get selector(){return vs(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});let t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+Ip(e,this.inputs)),t.join(" ")}static from(e){if(n.isFragment(e))return e;if(typeof e=="string")return n.from(ka(e));if(e instanceof bs){let t=fv("error",e),r=Lo(e);return Al(e),new n(Gt,t,r)}return new n(Gt,e.name,e.inputs?e.inputs.map(wn.from):[])}static isFragment(e){return e&&e[Gr]===HF}},Il=class n extends _d{anonymous;constructor(e,t,r,i){super(e,"event",t,r),Object.defineProperty(this,Gr,{value:$F}),ce(this,{anonymous:i})}get topicHash(){return vs(this.format("sighash"))}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});let t=[];return e!=="sighash"&&t.push("event"),t.push(this.name+Ip(e,this.inputs)),e!=="sighash"&&this.anonymous&&t.push("anonymous"),t.join(" ")}static getTopicHash(e,t){return t=(t||[]).map(i=>wn.from(i)),new n(Gt,e,t,!1).topicHash}static from(e){if(n.isFragment(e))return e;if(typeof e=="string")try{return n.from(ka(e))}catch{x(!1,"invalid event fragment","obj",e)}else if(e instanceof bs){let t=fv("event",e),r=Lo(e,!0),i=!!Fo(e,Sr(["anonymous"])).has("anonymous");return Al(e),new n(Gt,t,r,i)}return new n(Gt,e.name,e.inputs?e.inputs.map(t=>wn.from(t,!0)):[],!!e.anonymous)}static isFragment(e){return e&&e[Gr]===$F}},Cl=class n extends _l{payable;gas;constructor(e,t,r,i,s){super(e,t,r),Object.defineProperty(this,Gr,{value:qF}),ce(this,{payable:i,gas:s})}format(e){if(G(e!=null&&e!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),e==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});let t=[`constructor${Ip(e,this.inputs)}`];return this.payable&&t.push("payable"),this.gas!=null&&t.push(`@${this.gas.toString()}`),t.join(" ")}static from(e){if(n.isFragment(e))return e;if(typeof e=="string")try{return n.from(ka(e))}catch{x(!1,"invalid constuctor fragment","obj",e)}else if(e instanceof bs){Fo(e,Sr(["constructor"]));let t=Lo(e),r=!!Fo(e,WZ).has("payable"),i=tB(e);return Al(e),new n(Gt,"constructor",t,r,i)}return new n(Gt,"constructor",e.inputs?e.inputs.map(wn.from):[],!!e.payable,e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[Gr]===qF}},hv=class n extends _l{payable;constructor(e,t,r){super(e,"fallback",t),Object.defineProperty(this,Gr,{value:zF}),ce(this,{payable:r})}format(e){let t=this.inputs.length===0?"receive":"fallback";if(e==="json"){let r=this.payable?"payable":"nonpayable";return JSON.stringify({type:t,stateMutability:r})}return`${t}()${this.payable?" payable":""}`}static from(e){if(n.isFragment(e))return e;if(typeof e=="string")try{return n.from(ka(e))}catch{x(!1,"invalid fallback fragment","obj",e)}else if(e instanceof bs){let t=e.toString(),r=e.peekKeyword(Sr(["fallback","receive"]));if(x(r,"type must be fallback or receive","obj",t),e.popKeyword(Sr(["fallback","receive"]))==="receive"){let a=Lo(e);return x(a.length===0,"receive cannot have arguments","obj.inputs",a),Fo(e,Sr(["payable"])),Al(e),new n(Gt,[],!0)}let s=Lo(e);s.length?x(s.length===1&&s[0].type==="bytes","invalid fallback inputs","obj.inputs",s.map(a=>a.format("minimal")).join(", ")):s=[wn.from("bytes")];let o=eB(e);if(x(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),Fo(e,Sr(["returns"])).has("returns")){let a=Lo(e);x(a.length===1&&a[0].type==="bytes","invalid fallback outputs","obj.outputs",a.map(c=>c.format("minimal")).join(", "))}return Al(e),new n(Gt,s,o==="payable")}if(e.type==="receive")return new n(Gt,[],!0);if(e.type==="fallback"){let t=[wn.from("bytes")],r=e.stateMutability==="payable";return new n(Gt,t,r)}x(!1,"invalid fallback description","obj",e)}static isFragment(e){return e&&e[Gr]===zF}},Sl=class n extends _d{constant;outputs;stateMutability;payable;gas;constructor(e,t,r,i,s,o){super(e,"function",t,i),Object.defineProperty(this,Gr,{value:GF}),s=Object.freeze(s.slice()),ce(this,{constant:r==="view"||r==="pure",gas:o,outputs:s,payable:r==="payable",stateMutability:r})}get selector(){return vs(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e))),outputs:this.outputs.map(r=>JSON.parse(r.format(e)))});let t=[];return e!=="sighash"&&t.push("function"),t.push(this.name+Ip(e,this.inputs)),e!=="sighash"&&(this.stateMutability!=="nonpayable"&&t.push(this.stateMutability),this.outputs&&this.outputs.length&&(t.push("returns"),t.push(Ip(e,this.outputs))),this.gas!=null&&t.push(`@${this.gas.toString()}`)),t.join(" ")}static getSelector(e,t){return t=(t||[]).map(i=>wn.from(i)),new n(Gt,e,"view",t,[],null).selector}static from(e){if(n.isFragment(e))return e;if(typeof e=="string")try{return n.from(ka(e))}catch{x(!1,"invalid function fragment","obj",e)}else if(e instanceof bs){let r=fv("function",e),i=Lo(e),s=eB(e),o=[];Fo(e,Sr(["returns"])).has("returns")&&(o=Lo(e));let a=tB(e);return Al(e),new n(Gt,r,s,i,o,a)}let t=e.stateMutability;return t==null&&(t="payable",typeof e.constant=="boolean"?(t="view",e.constant||(t="payable",typeof e.payable=="boolean"&&!e.payable&&(t="nonpayable"))):typeof e.payable=="boolean"&&!e.payable&&(t="nonpayable")),new n(Gt,e.name,t,e.inputs?e.inputs.map(wn.from):[],e.outputs?e.outputs.map(wn.from):[],e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[Gr]===GF}},Ep=class n extends _d{constructor(e,t,r){super(e,"struct",t,r),Object.defineProperty(this,Gr,{value:WF})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return n.from(ka(e))}catch{x(!1,"invalid struct fragment","obj",e)}else if(e instanceof bs){let t=fv("struct",e),r=Lo(e);return Al(e),new n(Gt,t,r)}return new n(Gt,e.name,e.inputs?e.inputs.map(wn.from):[])}static isFragment(e){return e&&e[Gr]===WF}};var Es=new Map;Es.set(0,"GENERIC_PANIC");Es.set(1,"ASSERT_FALSE");Es.set(17,"OVERFLOW");Es.set(18,"DIVIDE_BY_ZERO");Es.set(33,"ENUM_RANGE_ERROR");Es.set(34,"BAD_STORAGE_DATA");Es.set(49,"STACK_UNDERFLOW");Es.set(50,"ARRAY_RANGE_ERROR");Es.set(65,"OUT_OF_MEMORY");Es.set(81,"UNINITIALIZED_FUNCTION_CALL");var iX=new RegExp(/^bytes([0-9]*)$/),sX=new RegExp(/^(u?int)([0-9]*)$/),zA=null,nB=1024;function oX(n,e,t,r){let i="missing revert data",s=null,o=null,a=null;if(t){i="execution reverted";let l=ve(t);if(t=Z(t),l.length===0)i+=" (no data present; likely require(false) occurred",s="require(false)";else if(l.length%32!==4)i+=" (could not decode reason; invalid data length)";else if(Z(l.slice(0,4))==="0x08c379a0")try{s=r.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[s]},i+=`: ${JSON.stringify(s)}`}catch{i+=" (could not decode reason; invalid string data)"}else if(Z(l.slice(0,4))==="0x4e487b71")try{let u=Number(r.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},s=`Panic due to ${Es.get(u)||"UNKNOWN"}(${u})`,i+=`: ${s}`}catch{i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}let c={to:e.to?ke(e.to):null,data:e.data||"0x"};return e.from&&(c.from=ke(e.from)),tt(i,"CALL_EXCEPTION",{action:n,data:t,reason:s,transaction:c,invocation:o,revert:a})}var La=class n{#e(e){if(e.isArray())return new Kw(this.#e(e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new yl(e.components.map(r=>this.#e(r)),e.name);switch(e.baseType){case"address":return new Gw(e.name);case"bool":return new Qw(e.name);case"string":return new ev(e.name);case"bytes":return new Yw(e.name);case"":return new Zw(e.name)}let t=e.type.match(sX);if(t){let r=parseInt(t[2]||"256");return x(r!==0&&r<=256&&r%8===0,"invalid "+t[1]+" bit length","param",e),new Xw(r/8,t[1]==="int",e.name)}if(t=e.type.match(iX),t){let r=parseInt(t[1]);return x(r!==0&&r<=32,"invalid bytes length","param",e),new Jw(r,e.name)}x(!1,"invalid type","type",e.type)}getDefaultValue(e){let t=e.map(i=>this.#e(wn.from(i)));return new yl(t,"_").defaultValue()}encode(e,t){cd(t.length,e.length,"types/values length mismatch");let r=e.map(o=>this.#e(wn.from(o))),i=new yl(r,"_"),s=new hl;return i.encode(s,t),s.data}decode(e,t,r){let i=e.map(o=>this.#e(wn.from(o)));return new yl(i,"_").decode(new Dw(t,r,nB))}static _setDefaultMaxInflation(e){x(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),nB=e}static defaultAbiCoder(){return zA==null&&(zA=new n),zA}static getBuiltinCallException(e,t,r){return oX(e,t,r,n.defaultAbiCoder())}};var pv=class{fragment;name;signature;topic;args;constructor(e,t,r){let i=e.name,s=e.format();ce(this,{fragment:e,name:i,signature:s,topic:t,args:r})}},gv=class{fragment;name;args;signature;selector;value;constructor(e,t,r,i){let s=e.name,o=e.format();ce(this,{fragment:e,name:s,args:r,signature:o,selector:t,value:i})}},mv=class{fragment;name;args;signature;selector;constructor(e,t,r){let i=e.name,s=e.format();ce(this,{fragment:e,name:i,args:r,signature:s,selector:t})}},Cp=class{hash;_isIndexed;static isIndexed(e){return!!(e&&e._isIndexed)}constructor(e){ce(this,{hash:e,_isIndexed:!0})}},rB={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},iB={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:n=>`reverted with reason string ${JSON.stringify(n)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:n=>{let e="unknown panic code";return n>=0&&n<=255&&rB[n.toString()]&&(e=rB[n.toString()]),`reverted with panic code 0x${n.toString(16)} (${e})`}}},Sp=class n{fragments;deploy;fallback;receive;#e;#t;#n;#r;constructor(e){let t=[];typeof e=="string"?t=JSON.parse(e):t=e,this.#n=new Map,this.#e=new Map,this.#t=new Map;let r=[];for(let o of t)try{r.push(_l.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}ce(this,{fragments:Object.freeze(r)});let i=null,s=!1;this.#r=this.getAbiCoder(),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}ce(this,{deploy:o});return;case"fallback":o.inputs.length===0?s=!0:(x(!i||o.payable!==i.payable,"conflicting fallback fragments",`fragments[${a}]`,o),i=o,s=i.payable);return;case"function":c=this.#n;break;case"event":c=this.#t;break;case"error":c=this.#e;break;default:return}let l=o.format();c.has(l)||c.set(l,o)}),this.deploy||ce(this,{deploy:Cl.from("constructor()")}),ce(this,{fallback:i,receive:s})}format(e){let t=e?"minimal":"full";return this.fragments.map(i=>i.format(t))}formatJson(){let e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return La.defaultAbiCoder()}#i(e,t,r){if($e(e)){let s=e.toLowerCase();for(let o of this.#n.values())if(s===o.selector)return o;return null}if(e.indexOf("(")===-1){let s=[];for(let[o,a]of this.#n)o.split("(")[0]===e&&s.push(a);if(t){let o=t.length>0?t[t.length-1]:null,a=t.length,c=!0;Bt.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=s.length-1;l>=0;l--){let u=s[l].inputs.length;u!==a&&(!c||u!==a-1)&&s.splice(l,1)}for(let l=s.length-1;l>=0;l--){let u=s[l].inputs;for(let d=0;d<t.length;d++)if(Bt.isTyped(t[d])){if(d>=u.length){if(t[d].type==="overrides")continue;s.splice(l,1);break}if(t[d].type!==u[d].baseType){s.splice(l,1);break}}}}if(s.length===1&&t&&t.length!==s[0].inputs.length){let o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&s.splice(0,1)}if(s.length===0)return null;if(s.length>1&&r){let o=s.map(a=>JSON.stringify(a.format())).join(", ");x(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return s[0]}let i=this.#n.get(Sl.from(e).format());return i||null}getFunctionName(e){let t=this.#i(e,null,!1);return x(t,"no matching function","key",e),t.name}hasFunction(e){return!!this.#i(e,null,!1)}getFunction(e,t){return this.#i(e,t||null,!0)}forEachFunction(e){let t=Array.from(this.#n.keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){let i=t[r];e(this.#n.get(i),r)}}#o(e,t,r){if($e(e)){let s=e.toLowerCase();for(let o of this.#t.values())if(s===o.topicHash)return o;return null}if(e.indexOf("(")===-1){let s=[];for(let[o,a]of this.#t)o.split("(")[0]===e&&s.push(a);if(t){for(let o=s.length-1;o>=0;o--)s[o].inputs.length<t.length&&s.splice(o,1);for(let o=s.length-1;o>=0;o--){let a=s[o].inputs;for(let c=0;c<t.length;c++)if(Bt.isTyped(t[c])&&t[c].type!==a[c].baseType){s.splice(o,1);break}}}if(s.length===0)return null;if(s.length>1&&r){let o=s.map(a=>JSON.stringify(a.format())).join(", ");x(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return s[0]}let i=this.#t.get(Il.from(e).format());return i||null}getEventName(e){let t=this.#o(e,null,!1);return x(t,"no matching event","key",e),t.name}hasEvent(e){return!!this.#o(e,null,!1)}getEvent(e,t){return this.#o(e,t||null,!0)}forEachEvent(e){let t=Array.from(this.#t.keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){let i=t[r];e(this.#t.get(i),r)}}getError(e,t){if($e(e)){let i=e.toLowerCase();if(iB[i])return ji.from(iB[i].signature);for(let s of this.#e.values())if(i===s.selector)return s;return null}if(e.indexOf("(")===-1){let i=[];for(let[s,o]of this.#e)s.split("(")[0]===e&&i.push(o);if(i.length===0)return e==="Error"?ji.from("error Error(string)"):e==="Panic"?ji.from("error Panic(uint256)"):null;if(i.length>1){let s=i.map(o=>JSON.stringify(o.format())).join(", ");x(!1,`ambiguous error description (i.e. ${s})`,"name",e)}return i[0]}if(e=ji.from(e).format(),e==="Error(string)")return ji.from("error Error(string)");if(e==="Panic(uint256)")return ji.from("error Panic(uint256)");let r=this.#e.get(e);return r||null}forEachError(e){let t=Array.from(this.#e.keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){let i=t[r];e(this.#e.get(i),r)}}_decodeParams(e,t){return this.#r.decode(e,t)}_encodeParams(e,t){return this.#r.encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){let r=this.getError(e);x(r,"unknown error","fragment",e),e=r}return x(Nt(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Nt(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){let r=this.getError(e);x(r,"unknown error","fragment",e),e=r}return nt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){let r=this.getFunction(e);x(r,"unknown function","fragment",e),e=r}return x(Nt(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Nt(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){let r=this.getFunction(e);x(r,"unknown function","fragment",e),e=r}return nt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){let s=this.getFunction(e);x(s,"unknown function","fragment",e),e=s}let r="invalid length for result data",i=Zt(t);if(i.length%32===0)try{return this.#r.decode(e.outputs,i)}catch{r="could not decode result data"}G(!1,r,"BAD_DATA",{value:Z(i),info:{method:e.name,signature:e.format()}})}makeError(e,t){let r=ve(e,"data"),i=La.getBuiltinCallException("call",t,r);if(i.message.startsWith("execution reverted (unknown custom error)")){let a=Z(r.slice(0,4)),c=this.getError(a);if(c)try{let l=this.#r.decode(c.inputs,r.slice(4));i.revert={name:c.name,signature:c.format(),args:l},i.reason=i.revert.signature,i.message=`execution reverted: ${i.reason}`}catch{i.message="execution reverted (coult not decode custom error)"}}let o=this.parseTransaction(t);return o&&(i.invocation={method:o.name,signature:o.signature,args:o.args}),i}encodeFunctionResult(e,t){if(typeof e=="string"){let r=this.getFunction(e);x(r,"unknown function","fragment",e),e=r}return Z(this.#r.encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){let s=this.getEvent(e);x(s,"unknown event","eventFragment",e),e=s}G(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});let r=[];e.anonymous||r.push(e.topicHash);let i=(s,o)=>s.type==="string"?vs(o):s.type==="bytes"?bt(Z(o)):(s.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":s.type.match(/^u?int/)?o=Cr(o):s.type.match(/^bytes/)?o=bw(o,32):s.type==="address"&&this.#r.encode(["address"],[o]),Yn(Z(o),32));for(t.forEach((s,o)=>{let a=e.inputs[o];if(!a.indexed){x(s==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,s);return}s==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?x(!1,"filtering with tuples or arrays not supported","contract."+a.name,s):Array.isArray(s)?r.push(s.map(c=>i(a,c))):r.push(i(a,s))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,t){if(typeof e=="string"){let o=this.getEvent(e);x(o,"unknown event","eventFragment",e),e=o}let r=[],i=[],s=[];return e.anonymous||r.push(e.topicHash),x(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{let c=t[a];if(o.indexed)if(o.type==="string")r.push(vs(c));else if(o.type==="bytes")r.push(bt(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(this.#r.encode([o.type],[c]))}else i.push(o),s.push(c)}),{data:this.#r.encode(i,s),topics:r}}decodeEventLog(e,t,r){if(typeof e=="string"){let f=this.getEvent(e);x(f,"unknown event","eventFragment",e),e=f}if(r!=null&&!e.anonymous){let f=e.topicHash;x($e(r[0],32)&&r[0].toLowerCase()===f,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}let i=[],s=[],o=[];e.inputs.forEach((f,p)=>{f.indexed?f.type==="string"||f.type==="bytes"||f.baseType==="tuple"||f.baseType==="array"?(i.push(wn.from({type:"bytes32",name:f.name})),o.push(!0)):(i.push(f),o.push(!1)):(s.push(f),o.push(!1))});let a=r!=null?this.#r.decode(i,nt(r)):null,c=this.#r.decode(s,t,!0),l=[],u=[],d=0,h=0;return e.inputs.forEach((f,p)=>{let g=null;if(f.indexed)if(a==null)g=new Cp(null);else if(o[p])g=new Cp(a[h++]);else try{g=a[h++]}catch(m){g=m}else try{g=c[d++]}catch(m){g=m}l.push(g),u.push(f.name||null)}),No.fromItems(l,u)}parseTransaction(e){let t=ve(e.data,"tx.data"),r=ne(e.value!=null?e.value:0,"tx.value"),i=this.getFunction(Z(t.slice(0,4)));if(!i)return null;let s=this.#r.decode(i.inputs,t.slice(4));return new gv(i,i.selector,s,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){let t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new pv(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){let t=Z(e),r=this.getError(Nt(t,0,4));if(!r)return null;let i=this.#r.decode(r.inputs,Nt(t,4));return new mv(r,r.selector,i)}static from(e){return e instanceof n?e:typeof e=="string"?new n(JSON.parse(e)):typeof e.formatJson=="function"?new n(e.formatJson()):typeof e.format=="function"?new n(e.format("json")):new n(e)}};var sB=BigInt(0);function Td(n){return n??null}function sn(n){return n==null?null:n.toString()}var xd=class{gasPrice;maxFeePerGas;maxPriorityFeePerGas;constructor(e,t,r){ce(this,{gasPrice:Td(e),maxFeePerGas:Td(t),maxPriorityFeePerGas:Td(r)})}toJSON(){let{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:sn(e),maxFeePerGas:sn(t),maxPriorityFeePerGas:sn(r)}}};function Ba(n){let e={};n.to&&(e.to=n.to),n.from&&(e.from=n.from),n.data&&(e.data=Z(n.data));let t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(let i of t)!(i in n)||n[i]==null||(e[i]=ne(n[i],`request.${i}`));let r="type,nonce".split(/,/);for(let i of r)!(i in n)||n[i]==null||(e[i]=Ie(n[i],`request.${i}`));return n.accessList&&(e.accessList=di(n.accessList)),n.authorizationList&&(e.authorizationList=n.authorizationList.slice()),"blockTag"in n&&(e.blockTag=n.blockTag),"enableCcipRead"in n&&(e.enableCcipRead=!!n.enableCcipRead),"customData"in n&&(e.customData=n.customData),"blobVersionedHashes"in n&&n.blobVersionedHashes&&(e.blobVersionedHashes=n.blobVersionedHashes.slice()),"kzg"in n&&(e.kzg=n.kzg),"blobs"in n&&n.blobs&&(e.blobs=n.blobs.map(i=>ba(i)?Z(i):Object.assign({},i))),e}var Ap=class{provider;number;hash;timestamp;parentHash;parentBeaconBlockRoot;nonce;difficulty;gasLimit;gasUsed;stateRoot;receiptsRoot;blobGasUsed;excessBlobGas;miner;prevRandao;extraData;baseFeePerGas;#e;constructor(e,t){this.#e=e.transactions.map(r=>typeof r!="string"?new Fa(r,t):r),ce(this,{provider:t,hash:Td(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:Td(e.prevRandao),extraData:e.extraData,baseFeePerGas:Td(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return this.#e.map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){let e=this.#e.slice();return e.length===0?[]:(G(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){let{baseFeePerGas:e,difficulty:t,extraData:r,gasLimit:i,gasUsed:s,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:p,timestamp:g,transactions:m}=this;return{_type:"Block",baseFeePerGas:sn(e),difficulty:sn(t),extraData:r,gasLimit:sn(i),gasUsed:sn(s),blobGasUsed:sn(this.blobGasUsed),excessBlobGas:sn(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,timestamp:g,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:p,transactions:m}}[Symbol.iterator](){let e=0,t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return this.#e.length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=this.#e[e];else{let r=e.toLowerCase();for(let i of this.#e)if(typeof i=="string"){if(i!==r)continue;t=i;break}else{if(i.hash!==r)continue;t=i;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){let t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(let r of t)if(r.hash===e)return r;x(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return cX(this)}},Is=class{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(e,t){this.provider=t;let r=Object.freeze(e.topics.slice());ce(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){let{address:e,blockHash:t,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:t,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){let e=await this.provider.getBlock(this.blockHash);return G(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){let e=await this.provider.getTransaction(this.transactionHash);return G(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){let e=await this.provider.getTransactionReceipt(this.transactionHash);return G(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return lX(this)}},Tl=class{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#e;constructor(e,t){this.#e=Object.freeze(e.logs.map(i=>new Is(i,t)));let r=sB;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),ce(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return this.#e}toJSON(){let{to:e,from:t,contractAddress:r,hash:i,index:s,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:d}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:sn(this.cumulativeGasUsed),from:t,gasPrice:sn(this.gasPrice),blobGasUsed:sn(this.blobGasUsed),blobGasPrice:sn(this.blobGasPrice),gasUsed:sn(this.gasUsed),hash:i,index:s,logs:l,logsBloom:c,root:d,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){let e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){let e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return aB(this)}reorderedEvent(e){return G(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),oB(this,e)}},Fa=class n{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;authorizationList;#e;constructor(e,t){this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,this.#e=-1}toJSON(){let{blockNumber:e,blockHash:t,index:r,hash:i,type:s,to:o,from:a,nonce:c,data:l,signature:u,accessList:d,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:d,blockNumber:e,blockHash:t,blobVersionedHashes:h,chainId:sn(this.chainId),data:l,from:a,gasLimit:sn(this.gasLimit),gasPrice:sn(this.gasPrice),hash:i,maxFeePerGas:sn(this.maxFeePerGas),maxPriorityFeePerGas:sn(this.maxPriorityFeePerGas),maxFeePerBlobGas:sn(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:r,type:s,value:sn(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){let r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;let t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){let{tx:t,blockNumber:r}=await Jt({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:r-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){let r=e??1,i=t??0,s=this.#e,o=-1,a=s===-1,c=async()=>{if(a)return null;let{blockNumber:h,nonce:f}=await Jt({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(f<this.nonce){s=h;return}if(a)return null;let p=await this.getTransaction();if(!(p&&p.blockNumber!=null))for(o===-1&&(o=s-3,o<this.#e&&(o=this.#e));o<=h;){if(a)return null;let g=await this.provider.getBlock(o,!0);if(g==null)return;for(let m of g)if(m===this.hash)return;for(let m=0;m<g.length;m++){let y=await g.getTransaction(m);if(y.from===this.from&&y.nonce===this.nonce){if(a)return null;let E=await this.provider.getTransactionReceipt(y.hash);if(E==null||h-E.blockNumber+1<r)return;let I="replaced";y.data===this.data&&y.to===this.to&&y.value===this.value?I="repriced":y.data==="0x"&&y.from===y.to&&y.value===sB&&(I="cancelled"),G(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:I==="replaced"||I==="cancelled",reason:I,replacement:y.replaceableTransaction(s),hash:y.hash,receipt:E})}}o++}},l=h=>{if(h==null||h.status!==0)return h;G(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return l(u);if(u){if(r===1||await u.confirmations()>=r)return l(u)}else if(await c(),r===0)return null;return await new Promise((h,f)=>{let p=[],g=()=>{p.forEach(y=>y())};if(p.push(()=>{a=!0}),i>0){let y=setTimeout(()=>{g(),f(tt("wait for transaction timeout","TIMEOUT"))},i);p.push(()=>{clearTimeout(y)})}let m=async y=>{if(await y.confirmations()>=r){g();try{h(l(y))}catch(E){f(E)}}};if(p.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),s>=0){let y=async()=>{try{await c()}catch(E){if(Ft(E,"TRANSACTION_REPLACED")){g(),f(E);return}}a||this.provider.once("block",y)};p.push(()=>{this.provider.off("block",y)}),this.provider.once("block",y)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return G(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),aB(this)}reorderedEvent(e){return G(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),G(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),oB(this,e)}replaceableTransaction(e){x(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);let t=new n(this,this.provider);return t.#e=e,t}};function cX(n){return{orphan:"drop-block",hash:n.hash,number:n.number}}function oB(n,e){return{orphan:"reorder-transaction",tx:n,other:e}}function aB(n){return{orphan:"drop-transaction",tx:n}}function lX(n){return{orphan:"drop-log",log:{transactionHash:n.transactionHash,blockHash:n.blockHash,blockNumber:n.blockNumber,address:n.address,data:n.data,topics:Object.freeze(n.topics.slice()),index:n.index}}}var xl=class extends Is{interface;fragment;args;constructor(e,t,r){super(e,e.provider);let i=t.decodeEventLog(r,e.data,e.topics);ce(this,{args:i,fragment:r,interface:t})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}},Dd=class extends Is{error;constructor(e,t){super(e,e.provider),ce(this,{error:t})}},yv=class extends Tl{#e;constructor(e,t,r){super(r,t),this.#e=e}get logs(){return super.logs.map(e=>{let t=e.topics.length?this.#e.getEvent(e.topics[0]):null;if(t)try{return new xl(e,this.#e,t)}catch(r){return new Dd(e,r)}return e})}},Dl=class extends Fa{#e;constructor(e,t,r){super(r,t),this.#e=e}async wait(e,t){let r=await super.wait(e,t);return r==null?null:new yv(this.#e,this.provider,r)}},Nd=class extends Ia{log;constructor(e,t,r,i){super(e,t,r),ce(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}},_p=class extends Nd{constructor(e,t,r,i,s){super(e,t,r,new xl(s,e.interface,i));let o=e.interface.decodeEventLog(i,this.log.data,this.log.topics);ce(this,{args:o,fragment:i})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}};var cB=BigInt(0);function uB(n){return n&&typeof n.call=="function"}function dB(n){return n&&typeof n.estimateGas=="function"}function bv(n){return n&&typeof n.resolveName=="function"}function hB(n){return n&&typeof n.sendTransaction=="function"}function fB(n){if(n!=null){if(bv(n))return n;if(n.provider)return n.provider}}var GA=class{#e;fragment;constructor(e,t,r){if(ce(this,{fragment:t}),t.inputs.length<r.length)throw new Error("too many arguments");let i=Rl(e.runner,"resolveName"),s=bv(i)?i:null;this.#e=(async function(){let o=await Promise.all(t.inputs.map((a,c)=>r[c]==null?null:a.walkAsync(r[c],(u,d)=>u==="address"?Array.isArray(d)?Promise.all(d.map(h=>cn(h,s))):cn(d,s):d)));return e.interface.encodeFilterTopics(t,o)})()}getTopicFilter(){return this.#e}};function Rl(n,e){return n==null?null:typeof n[e]=="function"?n:n.provider&&typeof n.provider[e]=="function"?n.provider:null}function Nl(n){return n==null?null:n.provider||null}async function pB(n,e){let t=Bt.dereference(n,"overrides");x(typeof t=="object","invalid overrides parameter","overrides",n);let r=Ba(t);return x(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),x(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function uX(n,e,t){let r=Rl(n,"resolveName"),i=bv(r)?r:null;return await Promise.all(e.map((s,o)=>s.walkAsync(t[o],(a,c)=>(c=Bt.dereference(c,a),a==="address"?cn(c,i):c))))}function dX(n){let e=async function(o){let a=await pB(o,["data"]);a.to=await n.getAddress(),a.from&&(a.from=await cn(a.from,fB(n.runner)));let c=n.interface,l=ne(a.value||cB,"overrides.value")===cB,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&x(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),x(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);let d=c.receive||c.fallback&&c.fallback.payable;return x(d||l,"cannot send value to non-payable fallback","overrides.value",a.value),x(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){let a=Rl(n.runner,"call");G(uB(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});let c=await e(o);try{return await a.call(c)}catch(l){throw ll(l)&&l.data?n.interface.makeError(l.data,c):l}},r=async function(o){let a=n.runner;G(hB(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});let c=await a.sendTransaction(await e(o)),l=Nl(n.runner);return new Dl(n.interface,l,c)},i=async function(o){let a=Rl(n.runner,"estimateGas");return G(dB(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},s=async o=>await r(o);return ce(s,{_contract:n,estimateGas:i,populateTransaction:e,send:r,staticCall:t}),s}function hX(n,e){let t=function(...l){let u=n.interface.getFunction(e,l);return G(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},r=async function(...l){let u=t(...l),d={};if(u.inputs.length+1===l.length&&(d=await pB(l.pop()),d.from&&(d.from=await cn(d.from,fB(n.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");let h=await uX(n.runner,u.inputs,l);return Object.assign({},d,await Jt({to:n.getAddress(),data:n.interface.encodeFunctionData(u,h)}))},i=async function(...l){let u=await a(...l);return u.length===1?u[0]:u},s=async function(...l){let u=n.runner;G(hB(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});let d=await u.sendTransaction(await r(...l)),h=Nl(n.runner);return new Dl(n.interface,h,d)},o=async function(...l){let u=Rl(n.runner,"estimateGas");return G(dB(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...l))},a=async function(...l){let u=Rl(n.runner,"call");G(uB(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});let d=await r(...l),h="0x";try{h=await u.call(d)}catch(p){throw ll(p)&&p.data?n.interface.makeError(p.data,d):p}let f=t(...l);return n.interface.decodeFunctionResult(f,h)},c=async(...l)=>t(...l).constant?await i(...l):await s(...l);return ce(c,{name:n.interface.getFunctionName(e),_contract:n,_key:e,getFragment:t,estimateGas:o,populateTransaction:r,send:s,staticCall:i,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{let l=n.interface.getFunction(e);return G(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function fX(n,e){let t=function(...i){let s=n.interface.getEvent(e,i);return G(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:i}}),s},r=function(...i){return new GA(n,t(...i),i)};return ce(r,{name:n.interface.getEventName(e),_contract:n,_key:e,getFragment:t}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{let i=n.interface.getEvent(e);return G(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),i}}),r}var vv=Symbol.for("_ethersInternal_contract"),gB=new WeakMap;function pX(n,e){gB.set(n[vv],e)}function hi(n){return gB.get(n[vv])}function gX(n){return n&&typeof n=="object"&&"getTopicFilter"in n&&typeof n.getTopicFilter=="function"&&n.fragment}async function QA(n,e){let t,r=null;if(Array.isArray(e)){let s=function(o){if($e(o,32))return o;let a=n.interface.getEvent(o);return x(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(s):s(o))}else e==="*"?t=[null]:typeof e=="string"?$e(e,32)?t=[e]:(r=n.interface.getEvent(e),x(r,"unknown fragment","event",e),t=[r.topicHash]):gX(e)?t=await e.getTopicFilter():"fragment"in e?(r=e.fragment,t=[r.topicHash]):x(!1,"unknown event name","event",e);t=t.map(s=>{if(s==null)return null;if(Array.isArray(s)){let o=Array.from(new Set(s.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return s.toLowerCase()});let i=t.map(s=>s==null?"null":Array.isArray(s)?s.join("|"):s).join("&");return{fragment:r,tag:i,topics:t}}async function Tp(n,e){let{subs:t}=hi(n);return t.get((await QA(n,e)).tag)||null}async function lB(n,e,t){let r=Nl(n.runner);G(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});let{fragment:i,tag:s,topics:o}=await QA(n,t),{addr:a,subs:c}=hi(n),l=c.get(s);if(!l){let d={address:a||n,topics:o},h=m=>{let y=i;if(y==null)try{y=n.interface.getEvent(m.topics[0])}catch{}if(y){let E=y,I=i?n.interface.decodeEventLog(i,m.data,m.topics):[];KA(n,t,I,L=>new _p(n,L,t,E,m))}else KA(n,t,[],E=>new Nd(n,E,t,m))},f=[];l={tag:s,listeners:[],start:()=>{f.length||f.push(r.on(d,h))},stop:async()=>{if(f.length==0)return;let m=f;f=[],await Promise.all(m),r.off(d,h)}},c.set(s,l)}return l}var WA=Promise.resolve();async function mX(n,e,t,r){await WA;let i=await Tp(n,e);if(!i)return!1;let s=i.listeners.length;return i.listeners=i.listeners.filter(({listener:o,once:a})=>{let c=Array.from(t);r&&c.push(r(a?null:o));try{o.call(n,...c)}catch{}return!a}),i.listeners.length===0&&(i.stop(),hi(n).subs.delete(i.tag)),s>0}async function KA(n,e,t,r){try{await WA}catch{}let i=mX(n,e,t,r);return WA=i,await i}var wv=["then"],xp=class n{target;interface;runner;filters;[vv];fallback;constructor(e,t,r,i){x(typeof e=="string"||zw(e),"invalid value for Contract target","target",e),r==null&&(r=null);let s=Sp.from(t);ce(this,{target:e,runner:r,interface:s}),Object.defineProperty(this,vv,{value:{}});let o,a=null,c=null;if(i){let d=Nl(r);c=new Dl(this.interface,d,i)}let l=new Map;if(typeof e=="string")if($e(e))a=e,o=Promise.resolve(e);else{let d=Rl(r,"resolveName");if(!bv(d))throw tt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=d.resolveName(e).then(h=>{if(h==null)throw tt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return hi(this).addr=h,h})}else o=e.getAddress().then(d=>{if(d==null)throw new Error("TODO");return hi(this).addr=d,d});pX(this,{addrPromise:o,addr:a,deployTx:c,subs:l});let u=new Proxy({},{get:(d,h,f)=>{if(typeof h=="symbol"||wv.indexOf(h)>=0)return Reflect.get(d,h,f);try{return this.getEvent(h)}catch(p){if(!Ft(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(d,h)=>wv.indexOf(h)>=0?Reflect.has(d,h):Reflect.has(d,h)||this.interface.hasEvent(String(h))});return ce(this,{filters:u}),ce(this,{fallback:s.receive||s.fallback?dX(this):null}),new Proxy(this,{get:(d,h,f)=>{if(typeof h=="symbol"||h in d||wv.indexOf(h)>=0)return Reflect.get(d,h,f);try{return d.getFunction(h)}catch(p){if(!Ft(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(d,h)=>typeof h=="symbol"||h in d||wv.indexOf(h)>=0?Reflect.has(d,h):d.interface.hasFunction(h)})}connect(e){return new n(this.target,this.interface,e)}attach(e){return new n(e,this.interface,this.runner)}async getAddress(){return await hi(this).addrPromise}async getDeployedCode(){let e=Nl(this.runner);G(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});let t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){let e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;let r=Nl(this.runner);return G(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((i,s)=>{let o=async()=>{try{if(await this.getDeployedCode()!=null)return i(this);r.once("block",o)}catch(a){s(a)}};o()})}deploymentTransaction(){return hi(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),hX(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),fX(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,r){t==null&&(t=0),r==null&&(r="latest");let{addr:i,addrPromise:s}=hi(this),o=i||await s,{fragment:a,topics:c}=await QA(this,e),l={address:o,topics:c,fromBlock:t,toBlock:r},u=Nl(this.runner);return G(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(d=>{let h=a;if(h==null)try{h=this.interface.getEvent(d.topics[0])}catch{}if(h)try{return new xl(d,this.interface,h)}catch(f){return new Dd(d,f)}return new Is(d,u)})}async on(e,t){let r=await lB(this,"on",e);return r.listeners.push({listener:t,once:!1}),r.start(),this}async once(e,t){let r=await lB(this,"once",e);return r.listeners.push({listener:t,once:!0}),r.start(),this}async emit(e,...t){return await KA(this,e,t,null)}async listenerCount(e){if(e){let i=await Tp(this,e);return i?i.listeners.length:0}let{subs:t}=hi(this),r=0;for(let{listeners:i}of t.values())r+=i.length;return r}async listeners(e){if(e){let i=await Tp(this,e);return i?i.listeners.map(({listener:s})=>s):[]}let{subs:t}=hi(this),r=[];for(let{listeners:i}of t.values())r=r.concat(i.map(({listener:s})=>s));return r}async off(e,t){let r=await Tp(this,e);if(!r)return this;if(t){let i=r.listeners.map(({listener:s})=>s).indexOf(t);i>=0&&r.listeners.splice(i,1)}return(t==null||r.listeners.length===0)&&(r.stop(),hi(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){let t=await Tp(this,e);if(!t)return this;t.stop(),hi(this).subs.delete(t.tag)}else{let{subs:t}=hi(this);for(let{tag:r,stop:i}of t.values())i(),t.delete(r)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends n{constructor(i,s=null){super(i,e,s)}}return t}static from(e,t,r){return r==null&&(r=null),new this(e,t,r)}};function yX(){return xp}var ln=class extends yX(){};function YA(n){return n.match(/^ipfs:\/\/ipfs\//i)?n=n.substring(12):n.match(/^ipfs:\/\//i)?n=n.substring(7):x(!1,"unsupported IPFS format","link",n),`https://gateway.ipfs.io/ipfs/${n}`}var Ev=class{name;constructor(e){ce(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}};var yB=new RegExp("^(ipfs)://(.*)$","i"),mB=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),yB,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")],Rd=class n{provider;address;name;#e;#t;constructor(e,t,r){ce(this,{provider:e,address:t,name:r}),this.#e=null,this.#t=new ln(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e)}async supportsWildcard(){return this.#e==null&&(this.#e=(async()=>{try{return await this.#t.supportsInterface("0x9061b923")}catch(e){if(Ft(e,"CALL_EXCEPTION"))return!1;throw this.#e=null,e}})()),await this.#e}async#n(e,t){t=(t||[]).slice();let r=this.#t.interface;t.unshift(Sd(this.name));let i=null;await this.supportsWildcard()&&(i=r.getFunction(e),G(i,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[HA(this.name,255),r.encodeFunctionData(i,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{let s=await this.#t[e](...t);return i?r.decodeFunctionResult(i,s)[0]:s}catch(s){if(!Ft(s,"CALL_EXCEPTION"))throw s}return null}async getAddress(e){if(e==null&&(e=60),e===60)try{let s=await this.#n("addr(bytes32)");return s==null||s===ko?null:s}catch(s){if(Ft(s,"CALL_EXCEPTION"))return null;throw s}if(e>=0&&e<2147483648){let s=e+2147483648,o=await this.#n("addr(bytes32,uint)",[s]);if($e(o,20))return ke(o)}let t=null;for(let s of this.provider.plugins)if(s instanceof Ev&&s.supportsCoinType(e)){t=s;break}if(t==null)return null;let r=await this.#n("addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;let i=await t.decodeAddress(e,r);if(i!=null)return i;G(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){let t=await this.#n("text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){let e=await this.#n("contenthash(bytes32)");if(e==null||e==="0x")return null;let t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){let i=t[1]==="e3010170"?"ipfs":"ipns",s=parseInt(t[4],16);if(t[5].length===s*2)return`${i}://${Cw("0x"+t[2])}`}let r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;G(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){let e=[{type:"name",value:this.name}];try{let t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let r=0;r<mB.length;r++){let i=t.match(mB[r]);if(i==null)continue;let s=i[1].toLowerCase();switch(s){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{let o=YA(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{let o=s==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:s,value:t});let a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};let c=(i[2]||"").split("/");if(c.length!==2)return e.push({type:`!${s}caip`,value:i[2]||""}),{url:null,linkage:e};let l=c[1],u=new ln(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(s==="erc721"){let g=await u.ownerOf(l);if(a!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(s==="erc1155"){let g=await u.balanceOf(a,l);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let d=await u[o](l);if(d==null||d==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:d}),s==="erc1155"&&(d=d.replace("{id}",Cr(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:d})),d.match(/^ipfs:/i)&&(d=YA(d)),e.push({type:"metadata-url",value:d});let h={},f=await new zr(d).send();f.assertOk();try{h=f.bodyJson}catch{try{e.push({type:"!metadata",value:f.bodyText})}catch{let y=f.body;return y&&e.push({type:"!metadata",value:Z(y)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!h)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(h)});let p=h.image;if(typeof p!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(yB)==null)return e.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:p}),p=YA(p)}return e.push({type:"url",value:p}),{linkage:e,url:p}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){let t=await e.getNetwork(),r=t.getPlugin("org.ethers.plugins.network.Ens");return G(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),r.address}static async#r(e,t){let r=await n.getEnsAddress(e);try{let s=await new ln(r,["function resolver(bytes32) view returns (address)"],e).resolver(Sd(t),{enableCcipRead:!0});return s===ko?null:s}catch(i){throw i}return null}static async fromName(e,t){let r=t;for(;;){if(r===""||r==="."||t!=="eth"&&r==="eth")return null;let i=await n.#r(e,r);if(i!=null){let s=new n(e,i,t);return r!==t&&!await s.supportsWildcard()?null:s}r=r.split(".").slice(1).join(".")}}};var wB=BigInt(0);function Ke(n,e){return function(t){return t==null?e:n(t)}}function Dp(n,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(r=>n(r))}}function Np(n,e){return t=>{let r={};for(let i in n){let s=i;if(e&&i in e&&!(s in t)){for(let o of e[i])if(o in t){s=o;break}}try{let o=n[i](t[s]);o!==void 0&&(r[i]=o)}catch(o){let a=o instanceof Error?o.message:"not-an-error";G(!1,`invalid value for value.${i} (${a})`,"BAD_DATA",{value:t})}}return r}}function wX(n){switch(n){case!0:case"true":return!0;case!1:case"false":return!1}x(!1,`invalid boolean; ${JSON.stringify(n)}`,"value",n)}function Od(n){return x($e(n,!0),"invalid data","value",n),n}function Fn(n){return x($e(n,32),"invalid hash","value",n),n}var vX=Np({address:ke,blockHash:Fn,blockNumber:Ie,data:Od,index:Ie,removed:Ke(wX,!1),topics:Dp(Fn),transactionHash:Fn,transactionIndex:Ie},{index:["logIndex"]});function vB(n){return vX(n)}var bX=Np({hash:Ke(Fn),parentHash:Fn,parentBeaconBlockRoot:Ke(Fn,null),number:Ie,timestamp:Ie,nonce:Ke(Od),difficulty:ne,gasLimit:ne,gasUsed:ne,stateRoot:Ke(Fn,null),receiptsRoot:Ke(Fn,null),blobGasUsed:Ke(ne,null),excessBlobGas:Ke(ne,null),miner:Ke(ke),prevRandao:Ke(Fn,null),extraData:Od,baseFeePerGas:Ke(ne)},{prevRandao:["mixHash"]});function bB(n){let e=bX(n);return e.transactions=n.transactions.map(t=>typeof t=="string"?t:JA(t)),e}var EX=Np({transactionIndex:Ie,blockNumber:Ie,transactionHash:Fn,address:ke,topics:Dp(Fn),data:Od,index:Ie,blockHash:Fn},{index:["logIndex"]});function IX(n){return EX(n)}var CX=Np({to:Ke(ke,null),from:Ke(ke,null),contractAddress:Ke(ke,null),index:Ie,root:Ke(Z),gasUsed:ne,blobGasUsed:Ke(ne,null),logsBloom:Ke(Od),blockHash:Fn,hash:Fn,logs:Dp(IX),blockNumber:Ie,cumulativeGasUsed:ne,effectiveGasPrice:Ke(ne),blobGasPrice:Ke(ne,null),status:Ke(Ie),type:Ke(Ie,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function EB(n){return CX(n)}function JA(n){n.to&&ne(n.to)===wB&&(n.to="0x0000000000000000000000000000000000000000");let e=Np({hash:Fn,index:Ke(Ie,void 0),type:t=>t==="0x"||t==null?0:Ie(t),accessList:Ke(di,null),blobVersionedHashes:Ke(Dp(Fn,!0),null),authorizationList:Ke(Dp(t=>{let r;if(t.signature)r=t.signature;else{let i=t.yParity;i==="0x1b"?i=0:i==="0x1c"&&(i=1),r=Object.assign({},t,{yParity:i})}return{address:ke(t.address),chainId:ne(t.chainId),nonce:ne(t.nonce),signature:yn.from(r)}},!1),null),blockHash:Ke(Fn,null),blockNumber:Ke(Ie,null),transactionIndex:Ke(Ie,null),from:ke,gasPrice:Ke(ne),maxPriorityFeePerGas:Ke(ne),maxFeePerGas:Ke(ne),maxFeePerBlobGas:Ke(ne,null),gasLimit:ne,to:Ke(ke,null),value:ne,nonce:Ie,data:Od,creates:Ke(ke,null),chainId:Ke(ne,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(n);if(e.to==null&&e.creates==null&&(e.creates=_A(e)),(n.type===1||n.type===2)&&n.accessList==null&&(e.accessList=[]),n.signature?e.signature=yn.from(n.signature):e.signature=yn.from(n),e.chainId==null){let t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&ne(e.blockHash)===wB&&(e.blockHash=null),e}var SX="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",Pd=class n{name;constructor(e){ce(this,{name:e})}clone(){return new n(this.name)}},Md=class n extends Pd{effectiveBlock;txBase;txCreate;txDataZero;txDataNonzero;txAccessListStorageKey;txAccessListAddress;constructor(e,t){e==null&&(e=0),super(`org.ethers.network.plugins.GasCost#${e||0}`);let r={effectiveBlock:e};function i(s,o){let a=(t||{})[s];a==null&&(a=o),x(typeof a=="number",`invalud value for ${s}`,"costs",t),r[s]=a}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),ce(this,r)}clone(){return new n(this.effectiveBlock,this)}},kd=class n extends Pd{address;targetNetwork;constructor(e,t){super("org.ethers.plugins.network.Ens"),ce(this,{address:e||SX,targetNetwork:t??1})}clone(){return new n(this.address,this.targetNetwork)}};var Rp=class extends Pd{#e;#t;get url(){return this.#e}get processFunc(){return this.#t}constructor(e,t){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),this.#e=e,this.#t=t}clone(){return this}};var ZA=new Map,fi=class n{#e;#t;#n;constructor(e,t){this.#e=e,this.#t=ne(t),this.#n=new Map}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return this.#e}set name(e){this.#e=e}get chainId(){return this.#t}set chainId(e){this.#t=ne(e,"chainId")}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===ne(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===ne(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===ne(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(this.#n.values())}attachPlugin(e){if(this.#n.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#n.set(e.name,e.clone()),this}getPlugin(e){return this.#n.get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){let e=new n(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){let t=this.getPlugin("org.ethers.plugins.network.GasCost")||new Md,r=t.txBase;if(e.to==null&&(r+=t.txCreate),e.data)for(let i=2;i<e.data.length;i+=2)e.data.substring(i,i+2)==="00"?r+=t.txDataZero:r+=t.txDataNonzero;if(e.accessList){let i=di(e.accessList);for(let s in i)r+=t.txAccessListAddress+t.txAccessListStorageKey*i[s].storageKeys.length}return r}static from(e){if(AX(),e==null)return n.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){let t=ZA.get(e);if(t)return t();if(typeof e=="bigint")return new n("unknown",e);x(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){x(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);let t=new n(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new kd(e.ensAddress,e.ensNetwork)),t}x(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));let r=ZA.get(e);r&&x(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),ZA.set(e,t)}};function IB(n,e){let t=String(n);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${n}`);let r=t.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${n}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let i=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||i++,r[1]=i.toString()}return BigInt(r[0]+r[1])}function CB(n){return new Rp(n,async(e,t,r)=>{r.setHeader("User-Agent","ethers");let i;try{let[s,o]=await Promise.all([r.send(),e()]);i=s;let a=i.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:IB(a.maxFee,9),maxPriorityFeePerGas:IB(a.maxPriorityFee,9)}}catch(s){G(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:i,error:s})}})}var SB=!1;function AX(){if(SB)return;SB=!0;function n(e,t,r){let i=function(){let s=new fi(e,t);return r.ensNetwork!=null&&s.attachPlugin(new kd(null,r.ensNetwork)),s.attachPlugin(new Md),(r.plugins||[]).forEach(o=>{s.attachPlugin(o)}),s};fi.register(e,i),fi.register(t,i),r.altNames&&r.altNames.forEach(s=>{fi.register(s,i)})}n("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),n("ropsten",3,{ensNetwork:3}),n("rinkeby",4,{ensNetwork:4}),n("goerli",5,{ensNetwork:5}),n("kovan",42,{ensNetwork:42}),n("sepolia",11155111,{ensNetwork:11155111}),n("holesky",17e3,{ensNetwork:17e3}),n("classic",61,{}),n("classicKotti",6,{}),n("arbitrum",42161,{ensNetwork:1}),n("arbitrum-goerli",421613,{}),n("arbitrum-sepolia",421614,{}),n("base",8453,{ensNetwork:1}),n("base-goerli",84531,{}),n("base-sepolia",84532,{}),n("bnb",56,{ensNetwork:1}),n("bnbt",97,{}),n("linea",59144,{ensNetwork:1}),n("linea-goerli",59140,{}),n("linea-sepolia",59141,{}),n("matic",137,{ensNetwork:1,plugins:[CB("https://gasstation.polygon.technology/v2")]}),n("matic-amoy",80002,{}),n("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[CB("https://gasstation-testnet.polygon.technology/v2")]}),n("optimism",10,{ensNetwork:1,plugins:[]}),n("optimism-goerli",420,{}),n("optimism-sepolia",11155420,{}),n("xdai",100,{ensNetwork:1})}function XA(n){return JSON.parse(JSON.stringify(n))}var Iv=class{#e;#t;#n;#r;constructor(e){this.#e=e,this.#t=null,this.#n=4e3,this.#r=-2}get pollingInterval(){return this.#n}set pollingInterval(e){this.#n=e}async#i(){try{let e=await this.#e.getBlockNumber();if(this.#r===-2){this.#r=e;return}if(e!==this.#r){for(let t=this.#r+1;t<=e;t++){if(this.#t==null)return;await this.#e.emit("block",t)}this.#r=e}}catch{}this.#t!=null&&(this.#t=this.#e._setTimeout(this.#i.bind(this),this.#n))}start(){this.#t||(this.#t=this.#e._setTimeout(this.#i.bind(this),this.#n),this.#i())}stop(){this.#t&&(this.#e._clearTimeout(this.#t),this.#t=null)}pause(e){this.stop(),e&&(this.#r=-2)}resume(){this.start()}},Op=class{#e;#t;#n;constructor(e){this.#e=e,this.#n=!1,this.#t=t=>{this._poll(t,this.#e)}}async _poll(e,t){throw new Error("sub-classes must override this")}start(){this.#n||(this.#n=!0,this.#t(-2),this.#e.on("block",this.#t))}stop(){this.#n&&(this.#n=!1,this.#e.off("block",this.#t))}pause(e){this.stop()}resume(){this.start()}},Cv=class extends Op{#e;#t;constructor(e,t){super(e),this.#e=t,this.#t=-2}pause(e){e&&(this.#t=-2),super.pause(e)}async _poll(e,t){let r=await t.getBlock(this.#e);r!=null&&(this.#t===-2?this.#t=r.number:r.number>this.#t&&(t.emit(this.#e,r.number),this.#t=r.number))}},Sv=class extends Op{#e;constructor(e,t){super(e),this.#e=XA(t)}async _poll(e,t){throw new Error("@TODO")}},Av=class extends Op{#e;constructor(e,t){super(e),this.#e=t}async _poll(e,t){let r=await t.getTransactionReceipt(this.#e);r&&t.emit(this.#e,r)}},Ua=class{#e;#t;#n;#r;#i;constructor(e,t){this.#e=e,this.#t=XA(t),this.#n=this.#o.bind(this),this.#r=!1,this.#i=-2}async#o(e){if(this.#i===-2)return;let t=XA(this.#t);t.fromBlock=this.#i+1,t.toBlock=e;let r=await this.#e.getLogs(t);if(r.length===0){this.#i<e-60&&(this.#i=e-60);return}for(let i of r)this.#e.emit(this.#t,i),this.#i=i.blockNumber}start(){this.#r||(this.#r=!0,this.#i===-2&&this.#e.getBlockNumber().then(e=>{this.#i=e}),this.#e.on("block",this.#n))}stop(){this.#r&&(this.#r=!1,this.#e.off("block",this.#n))}pause(e){this.stop(),e&&(this.#i=-2)}resume(){this.start()}};var _X=BigInt(2),TX=10;function _v(n){return n&&typeof n.then=="function"}function Tv(n,e){return n+":"+JSON.stringify(e,(t,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){let i=Object.keys(r);return i.sort(),i.reduce((s,o)=>(s[o]=r[o],s),{})}return r})}var Ld=class{name;constructor(e){ce(this,{name:e})}start(){}stop(){}pause(e){}resume(){}};function xX(n){return JSON.parse(JSON.stringify(n))}function n_(n){return n=Array.from(new Set(n).values()),n.sort(),n}async function e_(n,e){if(n==null)throw new Error("invalid event");if(Array.isArray(n)&&(n={topics:n}),typeof n=="string")switch(n){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:n,tag:n}}if($e(n,32)){let t=n.toLowerCase();return{type:"transaction",tag:Tv("tx",{hash:t}),hash:t}}if(n.orphan){let t=n;return{type:"orphan",tag:Tv("orphan",t),filter:xX(t)}}if(n.address||n.topics){let t=n,r={topics:(t.topics||[]).map(i=>i==null?null:Array.isArray(i)?n_(i.map(s=>s.toLowerCase())):i.toLowerCase())};if(t.address){let i=[],s=[],o=a=>{$e(a)?i.push(a):s.push((async()=>{i.push(await cn(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),s.length&&await Promise.all(s),r.address=n_(i.map(a=>a.toLowerCase()))}return{filter:r,tag:Tv("event",r),type:"event"}}x(!1,"unknown ProviderEvent","event",n)}function t_(){return new Date().getTime()}var DX={cacheTimeout:250,pollingInterval:4e3},Pp=class{#e;#t;#n;#r;#i;#o;#s;#a;#d;#l;#p;#g;constructor(e,t){if(this.#g=Object.assign({},DX,t||{}),e==="any")this.#o=!0,this.#i=null;else if(e){let r=fi.from(e);this.#o=!1,this.#i=Promise.resolve(r),setTimeout(()=>{this.emit("network",r,null)},0)}else this.#o=!1,this.#i=null;this.#a=-1,this.#s=new Map,this.#e=new Map,this.#t=new Map,this.#n=null,this.#r=!1,this.#d=1,this.#l=new Map,this.#p=!1}get pollingInterval(){return this.#g.pollingInterval}get provider(){return this}get plugins(){return Array.from(this.#t.values())}attachPlugin(e){if(this.#t.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#t.set(e.name,e.connect(this)),this}getPlugin(e){return this.#t.get(e)||null}get disableCcipRead(){return this.#p}set disableCcipRead(e){this.#p=!!e}async#c(e){let t=this.#g.cacheTimeout;if(t<0)return await this._perform(e);let r=Tv(e.method,e),i=this.#s.get(r);return i||(i=this._perform(e),this.#s.set(r,i),setTimeout(()=>{this.#s.get(r)===i&&this.#s.delete(r)},t)),await i}async ccipReadFetch(e,t,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;let i=e.to.toLowerCase(),s=t.toLowerCase(),o=[];for(let a=0;a<r.length;a++){let c=r[a],l=c.replace("{sender}",i).replace("{data}",s),u=new zr(l);c.indexOf("{data}")===-1&&(u.body={data:s,sender:i}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:r});let d="unknown error",h;try{h=await u.send()}catch(f){o.push(f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:f}});continue}try{let f=h.bodyJson;if(f.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:f}),f.data;f.message&&(d=f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:f})}catch{}G(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${d}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:d}}),o.push(d)}G(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,t){return new Ap(bB(e),this)}_wrapLog(e,t){return new Is(vB(e),this)}_wrapTransactionReceipt(e,t){return new Tl(EB(e),this)}_wrapTransactionResponse(e,t){return new Fa(JA(e),this)}_detectNetwork(){G(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){G(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){let e=Ie(await this.#c({method:"getBlockNumber"}),"%response");return this.#a>=0&&(this.#a=e),e}_getAddress(e){return cn(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if($e(e))return $e(e,32)?e:Jn(e);if(typeof e=="bigint"&&(e=Ie(e,"blockTag")),typeof e=="number")return e>=0?Jn(e):this.#a>=0?Jn(this.#a+e):this.getBlockNumber().then(t=>Jn(t+e));x(!1,"invalid blockTag","blockTag",e)}_getFilter(e){let t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?n_(c.map(l=>l.toLowerCase())):c.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,i=(c,l,u)=>{let d;switch(c.length){case 0:break;case 1:d=c[0];break;default:c.sort(),d=c}if(r&&(l!=null||u!=null))throw new Error("invalid filter");let h={};return d&&(h.address=d),t.length&&(h.topics=t),l&&(h.fromBlock=l),u&&(h.toBlock=u),r&&(h.blockHash=r),h},s=[];if(e.address)if(Array.isArray(e.address))for(let c of e.address)s.push(this._getAddress(c));else s.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),s.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(s),o,a]).then(c=>i(c[0],c[1],c[2])):i(s,o,a)}_getTransactionRequest(e){let t=Ba(e),r=[];if(["to","from"].forEach(i=>{if(t[i]==null)return;let s=cn(t[i],this);_v(s)?r.push((async function(){t[i]=await s})()):t[i]=s}),t.blockTag!=null){let i=this._getBlockTag(t.blockTag);_v(i)?r.push((async function(){t.blockTag=await i})()):t.blockTag=i}return r.length?(async function(){return await Promise.all(r),t})():t}async getNetwork(){if(this.#i==null){let i=(async()=>{try{let s=await this._detectNetwork();return this.emit("network",s,null),s}catch(s){throw this.#i===i&&(this.#i=null),s}})();return this.#i=i,(await i).clone()}let e=this.#i,[t,r]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==r.chainId&&(this.#o?(this.emit("network",r,t),this.#i===e&&(this.#i=Promise.resolve(r))):G(!1,`network changed: ${t.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){let e=await this.getNetwork(),t=async()=>{let{_block:i,gasPrice:s,priorityFee:o}=await Jt({_block:this.#y("latest",!1),gasPrice:(async()=>{try{let u=await this.#c({method:"getGasPrice"});return ne(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{let u=await this.#c({method:"getPriorityFee"});return ne(u,"%response")}catch{}return null})()}),a=null,c=null,l=this._wrapBlock(i,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*_X+c),new xd(s,a,c)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){let i=new zr(r.url),s=await r.processFunc(t,this,i);return new xd(s.gasPrice,s.maxFeePerGas,s.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return _v(t)&&(t=await t),ne(await this.#c({method:"estimateGas",transaction:t}),"%response")}async#u(e,t,r){G(r<TX,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});let i=Ba(e);try{return Z(await this._perform({method:"call",transaction:i,blockTag:t}))}catch(s){if(!this.disableCcipRead&&ll(s)&&s.data&&r>=0&&t==="latest"&&i.to!=null&&Nt(s.data,0,4)==="0x556f1830"){let o=s.data,a=await cn(i.to,this),c;try{c=MX(Nt(s.data,4))}catch(d){G(!1,d.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:i,info:{data:o}})}G(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:i,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});let l=await this.ccipReadFetch(i,c.calldata,c.urls);G(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:i,info:{data:s.data,errorArgs:c.errorArgs}});let u={to:a,data:nt([c.selector,PX([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{let d=await this.#u(u,t,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:d}),d}catch(d){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:d}),d}}throw s}}async#h(e){let{value:t}=await Jt({network:this.getNetwork(),value:e});return t}async call(e){let{tx:t,blockTag:r}=await Jt({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await this.#h(this.#u(t,r,e.enableCcipRead?0:-1))}async#f(e,t,r){let i=this._getAddress(t),s=this._getBlockTag(r);return(typeof i!="string"||typeof s!="string")&&([i,s]=await Promise.all([i,s])),await this.#h(this.#c(Object.assign(e,{address:i,blockTag:s})))}async getBalance(e,t){return ne(await this.#f({method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Ie(await this.#f({method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Z(await this.#f({method:"getCode"},e,t))}async getStorage(e,t,r){let i=ne(t,"position");return Z(await this.#f({method:"getStorage",position:i},e,r))}async broadcastTransaction(e){let{blockNumber:t,hash:r,network:i}=await Jt({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),s=wl.from(e);if(s.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(s,i).replaceableTransaction(t)}async#y(e,t){if($e(e,32))return await this.#c({method:"getBlock",blockHash:e,includeTransactions:t});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await this.#c({method:"getBlock",blockTag:r,includeTransactions:t})}async getBlock(e,t){let{network:r,params:i}=await Jt({network:this.getNetwork(),params:this.#y(e,!!t)});return i==null?null:this._wrapBlock(i,r)}async getTransaction(e){let{network:t,params:r}=await Jt({network:this.getNetwork(),params:this.#c({method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,t)}async getTransactionReceipt(e){let{network:t,params:r}=await Jt({network:this.getNetwork(),params:this.#c({method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){let i=await this.#c({method:"getTransaction",hash:e});if(i==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=i.gasPrice}return this._wrapTransactionReceipt(r,t)}async getTransactionResult(e){let{result:t}=await Jt({network:this.getNetwork(),result:this.#c({method:"getTransactionResult",hash:e})});return t==null?null:Z(t)}async getLogs(e){let t=this._getFilter(e);_v(t)&&(t=await t);let{network:r,params:i}=await Jt({network:this.getNetwork(),params:this.#c({method:"getLogs",filter:t})});return i.map(s=>this._wrapLog(s,r))}_getProvider(e){G(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Rd.fromName(this,e)}async getAvatar(e){let t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){let t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=ke(e);let t=Sd(e.substring(2).toLowerCase()+".addr.reverse");try{let r=await Rd.getEnsAddress(this),s=await new ln(r,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(s==null||s===ko)return null;let a=await new ln(s,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(r){if(Ft(r,"BAD_DATA")&&r.value==="0x"||Ft(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,t,r){let i=t??1;return i===0?this.getTransactionReceipt(e):new Promise(async(s,o)=>{let a=null,c=async l=>{try{let u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=i){s(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)};r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(tt("timeout","TIMEOUT",{reason:"timeout"})))},r)),c(await this.getBlockNumber())})}async waitForBlock(e){G(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){let t=this.#l.get(e);t&&(t.timer&&clearTimeout(t.timer),this.#l.delete(e))}_setTimeout(e,t){t==null&&(t=0);let r=this.#d++,i=()=>{this.#l.delete(r),e()};if(this.paused)this.#l.set(r,{timer:null,func:i,time:t});else{let s=setTimeout(i,t);this.#l.set(r,{timer:s,func:i,time:t_()})}return r}_forEachSubscriber(e){for(let t of this.#e.values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new Ld(e.type);case"block":{let t=new Iv(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new Cv(this,e.type);case"event":return new Ua(this,e.filter);case"transaction":return new Av(this,e.hash);case"orphan":return new Sv(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(let r of this.#e.values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=t,r.started&&t.start(),this.#n!=null&&t.pause(this.#n);break}}async#m(e,t){let r=await e_(e,this);return r.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(r=await e_({orphan:"drop-log",log:t[0]},this)),this.#e.get(r.tag)||null}async#w(e){let t=await e_(e,this),r=t.tag,i=this.#e.get(r);return i||(i={subscriber:this._getSubscriber(t),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},this.#e.set(r,i)),i}async on(e,t){let r=await this.#w(e);return r.listeners.push({listener:t,once:!1}),r.started||(r.subscriber.start(),r.started=!0,this.#n!=null&&r.subscriber.pause(this.#n)),this}async once(e,t){let r=await this.#w(e);return r.listeners.push({listener:t,once:!0}),r.started||(r.subscriber.start(),r.started=!0,this.#n!=null&&r.subscriber.pause(this.#n)),this}async emit(e,...t){let r=await this.#m(e,t);if(!r||r.listeners.length===0)return!1;let i=r.listeners.length;return r.listeners=r.listeners.filter(({listener:s,once:o})=>{let a=new Ia(this,o?null:s,e);try{s.call(this,...t,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),this.#e.delete(r.tag)),i>0}async listenerCount(e){if(e){let r=await this.#m(e);return r?r.listeners.length:0}let t=0;for(let{listeners:r}of this.#e.values())t+=r.length;return t}async listeners(e){if(e){let r=await this.#m(e);return r?r.listeners.map(({listener:i})=>i):[]}let t=[];for(let{listeners:r}of this.#e.values())t=t.concat(r.map(({listener:i})=>i));return t}async off(e,t){let r=await this.#m(e);if(!r)return this;if(t){let i=r.listeners.map(({listener:s})=>s).indexOf(t);i>=0&&r.listeners.splice(i,1)}return(!t||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),this.#e.delete(r.tag)),this}async removeAllListeners(e){if(e){let{tag:t,started:r,subscriber:i}=await this.#w(e);r&&i.stop(),this.#e.delete(t)}else for(let[t,{started:r,subscriber:i}]of this.#e)r&&i.stop(),this.#e.delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return this.#r}destroy(){this.removeAllListeners();for(let e of this.#l.keys())this._clearTimeout(e);this.#r=!0}get paused(){return this.#n!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(this.#a=-1,this.#n!=null){if(this.#n==!!e)return;G(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),this.#n=!!e;for(let t of this.#l.values())t.timer&&clearTimeout(t.timer),t.time=t_()-t.time}resume(){if(this.#n!=null){this._forEachSubscriber(e=>e.resume()),this.#n=null;for(let e of this.#l.values()){let t=e.time;t<0&&(t=0),e.time=t_(),setTimeout(e.func,t)}}}};function NX(n,e){try{let t=r_(n,e);if(t)return Do(t)}catch{}return null}function r_(n,e){if(n==="0x")return null;try{let t=Ie(Nt(n,e,e+32)),r=Ie(Nt(n,t,t+32));return Nt(n,t+32,t+32+r)}catch{}return null}function AB(n){let e=Vt(n);if(e.length>32)throw new Error("internal; should not happen");let t=new Uint8Array(32);return t.set(e,32-e.length),t}function RX(n){if(n.length%32===0)return n;let e=new Uint8Array(Math.ceil(n.length/32)*32);return e.set(n),e}var OX=new Uint8Array([]);function PX(n){let e=[],t=0;for(let r=0;r<n.length;r++)e.push(OX),t+=32;for(let r=0;r<n.length;r++){let i=ve(n[r]);e[r]=AB(t),e.push(AB(i.length)),e.push(RX(i)),t+=32+Math.ceil(i.length/32)*32}return nt(e)}var _B="0x0000000000000000000000000000000000000000000000000000000000000000";function MX(n){let e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};G(ps(n)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});let t=Nt(n,0,32);G(Nt(t,0,12)===Nt(_B,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Nt(t,12);try{let r=[],i=Ie(Nt(n,32,64)),s=Ie(Nt(n,i,i+32)),o=Nt(n,i+32);for(let a=0;a<s;a++){let c=NX(o,a*32);if(c==null)throw new Error("abort");r.push(c)}e.urls=r}catch{G(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{let r=r_(n,64);if(r==null)throw new Error("abort");e.calldata=r}catch{G(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}G(Nt(n,100,128)===Nt(_B,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Nt(n,96,100);try{let r=r_(n,128);if(r==null)throw new Error("abort");e.extraData=r}catch{G(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function Ol(n,e){if(n.provider)return n.provider;G(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function TB(n,e){let t=Ba(e);if(t.to!=null&&(t.to=cn(t.to,n)),t.from!=null){let r=t.from;t.from=Promise.all([n.getAddress(),cn(r,n)]).then(([i,s])=>(x(i.toLowerCase()===s.toLowerCase(),"transaction from mismatch","tx.from",s),i))}else t.from=n.getAddress();return await Jt(t)}var Mp=class{provider;constructor(e){ce(this,{provider:e||null})}async getNonce(e){return Ol(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await TB(this,e)}async populateTransaction(e){let t=Ol(this,"populateTransaction"),r=await TB(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));let i=await this.provider.getNetwork();if(r.chainId!=null){let o=ne(r.chainId);x(o===i.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=i.chainId;let s=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||s)?x(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&s&&x(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){let o=await t.getFeeData();G(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{let o=await t.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){let a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(G(!s,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):G(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Jt(r)}async populateAuthorization(e){let t=Object.assign({},e);return t.chainId==null&&(t.chainId=(await Ol(this,"getNetwork").getNetwork()).chainId),t.nonce==null&&(t.nonce=await this.getNonce()),t}async estimateGas(e){return Ol(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return Ol(this,"call").call(await this.populateCall(e))}async resolveName(e){return await Ol(this,"resolveName").resolveName(e)}async sendTransaction(e){let t=Ol(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;let i=wl.from(r);return await t.broadcastTransaction(await this.signTransaction(i))}authorize(e){G(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}};function kX(n){return JSON.parse(JSON.stringify(n))}var xv=class{#e;#t;#n;#r;#i;#o;constructor(e){this.#e=e,this.#t=null,this.#n=this.#s.bind(this),this.#r=!1,this.#i=null,this.#o=!1}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}async#s(e){try{this.#t==null&&(this.#t=this._subscribe(this.#e));let t=null;try{t=await this.#t}catch(s){if(!Ft(s,"UNSUPPORTED_OPERATION")||s.operation!=="eth_newFilter")throw s}if(t==null){this.#t=null,this.#e._recoverSubscriber(this,this._recover(this.#e));return}let r=await this.#e.getNetwork();if(this.#i||(this.#i=r),this.#i.chainId!==r.chainId)throw new Error("chaid changed");if(this.#o)return;let i=await this.#e.send("eth_getFilterChanges",[t]);await this._emitResults(this.#e,i)}catch(t){console.log("@TODO",t)}this.#e.once("block",this.#n)}#a(){let e=this.#t;e&&(this.#t=null,e.then(t=>{this.#e.destroyed||this.#e.send("eth_uninstallFilter",[t])}))}start(){this.#r||(this.#r=!0,this.#s(-2))}stop(){this.#r&&(this.#r=!1,this.#o=!0,this.#a(),this.#e.off("block",this.#n))}pause(e){e&&this.#a(),this.#e.off("block",this.#n)}resume(){this.start()}},Dv=class extends xv{#e;constructor(e,t){super(e),this.#e=kX(t)}_recover(e){return new Ua(e,this.#e)}async _subscribe(e){return await e.send("eth_newFilter",[this.#e])}async _emitResults(e,t){for(let r of t)e.emit(this.#e,e._wrapLog(r,e._network))}},Nv=class extends xv{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(let r of t)e.emit("pending",r)}};var LX="bigint,boolean,function,number,string,symbol".split(/,/g);function Rv(n){if(n==null||LX.indexOf(typeof n)>=0||typeof n.getAddress=="function")return n;if(Array.isArray(n))return n.map(Rv);if(typeof n=="object")return Object.keys(n).reduce((e,t)=>(e[t]=n[t],e),{});throw new Error(`should not happen: ${n} (${typeof n})`)}function FX(n){return new Promise(e=>{setTimeout(e,n)})}function Fd(n){return n&&n.toLowerCase()}function xB(n){return n&&typeof n.pollingInterval=="number"}var DB={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3},Pl=class extends Mp{address;constructor(e,t){super(e),t=ke(t),ce(this,{address:t})}connect(e){G(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(e){return await this.populateCall(e)}async sendUncheckedTransaction(e){let t=Rv(e),r=[];if(t.from){let s=t.from;r.push((async()=>{let o=await cn(s,this.provider);x(o!=null&&o.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),t.from=o})())}else t.from=this.address;if(t.gasLimit==null&&r.push((async()=>{t.gasLimit=await this.provider.estimateGas(ge(H({},t),{from:this.address}))})()),t.to!=null){let s=t.to;r.push((async()=>{t.to=await cn(s,this.provider)})())}r.length&&await Promise.all(r);let i=this.provider.getRpcTransaction(t);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(e){let t=await this.provider.getBlockNumber(),r=await this.sendUncheckedTransaction(e);return await new Promise((i,s)=>{let o=[1e3,100],a=0,c=async()=>{try{let l=await this.provider.getTransaction(r);if(l!=null){i(l.replaceableTransaction(t));return}}catch(l){if(Ft(l,"CANCELLED")||Ft(l,"BAD_DATA")||Ft(l,"NETWORK_ERROR")||Ft(l,"UNSUPPORTED_OPERATION")){l.info==null&&(l.info={}),l.info.sendTransactionHash=r,s(l);return}if(Ft(l,"INVALID_ARGUMENT")&&(a++,l.info==null&&(l.info={}),l.info.sendTransactionHash=r,a>10)){s(l);return}this.provider.emit("error",tt("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:l}))}this.provider._setTimeout(()=>{c()},o.pop()||4e3)};c()})}async signTransaction(e){let t=Rv(e);if(t.from){let i=await cn(t.from,this.provider);x(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),t.from=i}else t.from=this.address;let r=this.provider.getRpcTransaction(t);return await this.provider.send("eth_signTransaction",[r])}async signMessage(e){let t=typeof e=="string"?Zn(e):e;return await this.provider.send("personal_sign",[Z(t),this.address.toLowerCase()])}async signTypedData(e,t,r){let i=Rv(r),s=await Ad.resolveNames(e,t,i,async o=>{let a=await cn(o);return x(a!=null,"TypedData does not support null address","value",o),a});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Ad.getPayload(s.domain,t,s.value))])}async unlock(e){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),e,null])}async _legacySignMessage(e){let t=typeof e=="string"?Zn(e):e;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Z(t)])}},kp=class extends Pp{#e;#t;#n;#r;#i;#o;#s;#a(){if(this.#r)return;let e=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");this.#r=setTimeout(()=>{this.#r=null;let t=this.#n;for(this.#n=[];t.length;){let r=[t.shift()];for(;t.length&&r.length!==this.#e.batchMaxCount;)if(r.push(t.shift()),JSON.stringify(r.map(s=>s.payload)).length>this.#e.batchMaxSize){t.unshift(r.pop());break}(async()=>{let i=r.length===1?r[0].payload:r.map(s=>s.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{let s=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:s});for(let{resolve:o,reject:a,payload:c}of r){if(this.destroyed){a(tt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:c.method}));continue}let l=s.filter(u=>u.id===c.id)[0];if(l==null){let u=tt("missing response for request","BAD_DATA",{value:s,info:{payload:c}});this.emit("error",u),a(u);continue}if("error"in l){a(this.getRpcError(c,l));continue}o(l.result)}}catch(s){this.emit("debug",{action:"receiveRpcError",error:s});for(let{reject:o}of r)o(s)}})()}},e)}constructor(e,t){super(e,t),this.#t=1,this.#e=Object.assign({},DB,t||{}),this.#n=[],this.#r=null,this.#o=null,this.#s=null;{let i=null,s=new Promise(o=>{i=o});this.#i={promise:s,resolve:i}}let r=this._getOption("staticNetwork");typeof r=="boolean"?(x(!r||e!=="any","staticNetwork cannot be used on special network 'any'","options",t),r&&e!=null&&(this.#o=fi.from(e))):r&&(x(e==null||r.matches(e),"staticNetwork MUST match network object","options",t),this.#o=r)}_getOption(e){return this.#e[e]}get _network(){return G(this.#o,"network is not available yet","NETWORK_ERROR"),this.#o}async _perform(e){if(e.method==="call"||e.method==="estimateGas"){let r=e.transaction;if(r&&r.type!=null&&ne(r.type)&&r.maxFeePerGas==null&&r.maxPriorityFeePerGas==null){let i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(e=Object.assign({},e,{transaction:Object.assign({},r,{type:void 0})}))}}let t=this.getRpcRequest(e);return t!=null?await this.send(t.method,t.args):super._perform(e)}async _detectNetwork(){let e=this._getOption("staticNetwork");if(e)if(e===!0){if(this.#o)return this.#o}else return e;return this.#s?await this.#s:this.ready?(this.#s=(async()=>{try{let t=fi.from(ne(await this.send("eth_chainId",[])));return this.#s=null,t}catch(t){throw this.#s=null,t}})(),await this.#s):(this.#s=(async()=>{let t={id:this.#t++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:t});let r;try{r=(await this._send(t))[0],this.#s=null}catch(i){throw this.#s=null,this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:r}),"result"in r)return fi.from(ne(r.result));throw this.getRpcError(t,r)})(),await this.#s)}_start(){this.#i==null||this.#i.resolve==null||(this.#i.resolve(),this.#i=null,(async()=>{for(;this.#o==null&&!this.destroyed;)try{this.#o=await this._detectNetwork()}catch(e){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",tt("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:e}})),await FX(1e3)}this.#a()})())}async _waitUntilReady(){if(this.#i!=null)return await this.#i.promise}_getSubscriber(e){return e.type==="pending"?new Nv(this):e.type==="event"?this._getOption("polling")?new Ua(this,e.filter):new Dv(this,e.filter):e.type==="orphan"&&e.filter.orphan==="drop-log"?new Ld("orphan"):super._getSubscriber(e)}get ready(){return this.#i==null}getRpcTransaction(e){let t={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(r=>{if(e[r]==null)return;let i=r;r==="gasLimit"&&(i="gas"),t[i]=Jn(ne(e[r],`tx.${r}`))}),["from","to","data"].forEach(r=>{e[r]!=null&&(t[r]=Z(e[r]))}),e.accessList&&(t.accessList=di(e.accessList)),e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes.map(r=>r.toLowerCase())),e.authorizationList&&(t.authorizationList=e.authorizationList.map(r=>{let i=pp(r);return{address:i.address,nonce:Jn(i.nonce),chainId:Jn(i.chainId),yParity:Jn(i.signature.yParity),r:Jn(i.signature.r),s:Jn(i.signature.s)}})),t}getRpcRequest(e){switch(e.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Fd(e.address),e.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Fd(e.address),e.blockTag]};case"getCode":return{method:"eth_getCode",args:[Fd(e.address),e.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Fd(e.address),"0x"+e.position.toString(16),e.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[e.signedTransaction]};case"getBlock":if("blockTag"in e)return{method:"eth_getBlockByNumber",args:[e.blockTag,!!e.includeTransactions]};if("blockHash"in e)return{method:"eth_getBlockByHash",args:[e.blockHash,!!e.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[e.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[e.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(e.transaction),e.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(e.transaction)]};case"getLogs":return e.filter&&e.filter.address!=null&&(Array.isArray(e.filter.address)?e.filter.address=e.filter.address.map(Fd):e.filter.address=Fd(e.filter.address)),{method:"eth_getLogs",args:[e.filter]}}return null}getRpcError(e,t){let{method:r}=e,{error:i}=t;if(r==="eth_estimateGas"&&i.message){let a=i.message;if(!a.match(/revert/i)&&a.match(/insufficient funds/i))return tt("insufficient funds","INSUFFICIENT_FUNDS",{transaction:e.params[0],info:{payload:e,error:i}});if(a.match(/nonce/i)&&a.match(/too low/i))return tt("nonce has already been used","NONCE_EXPIRED",{transaction:e.params[0],info:{payload:e,error:i}})}if(r==="eth_call"||r==="eth_estimateGas"){let a=i_(i),c=La.getBuiltinCallException(r==="eth_call"?"call":"estimateGas",e.params[0],a?a.data:null);return c.info={error:i,payload:e},c}let s=JSON.stringify(BX(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return tt("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[r]||"unknown",reason:"rejected",info:{payload:e,error:i}});if(r==="eth_sendRawTransaction"||r==="eth_sendTransaction"){let a=e.params[0];if(s.match(/insufficient funds|base fee exceeds gas limit/i))return tt("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:a,info:{error:i}});if(s.match(/nonce/i)&&s.match(/too low/i))return tt("nonce has already been used","NONCE_EXPIRED",{transaction:a,info:{error:i}});if(s.match(/replacement transaction/i)&&s.match(/underpriced/i))return tt("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:a,info:{error:i}});if(s.match(/only replay-protected/i))return tt("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:r,info:{transaction:a,info:{error:i}}})}let o=!!s.match(/the method .* does not exist/i);return o||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(o=!0),o?tt("unsupported operation","UNSUPPORTED_OPERATION",{operation:e.method,info:{error:i,payload:e}}):tt("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:e})}send(e,t){if(this.destroyed)return Promise.reject(tt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e}));let r=this.#t++,i=new Promise((s,o)=>{this.#n.push({resolve:s,reject:o,payload:{method:e,params:t,id:r,jsonrpc:"2.0"}})});return this.#a(),i}async getSigner(e){e==null&&(e=0);let t=this.send("eth_accounts",[]);if(typeof e=="number"){let i=await t;if(e>=i.length)throw new Error("no such account");return new Pl(this,i[e])}let{accounts:r}=await Jt({network:this.getNetwork(),accounts:t});e=ke(e);for(let i of r)if(ke(i)===e)return new Pl(this,e);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(t=>new Pl(this,t))}destroy(){this.#r&&(clearTimeout(this.#r),this.#r=null);for(let{payload:e,reject:t}of this.#n)t(tt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e.method}));this.#n=[],super.destroy()}},Lp=class extends kp{#e;constructor(e,t){super(e,t);let r=this._getOption("pollingInterval");r==null&&(r=DB.pollingInterval),this.#e=r}_getSubscriber(e){let t=super._getSubscriber(e);return xB(t)&&(t.pollingInterval=this.#e),t}get pollingInterval(){return this.#e}set pollingInterval(e){if(!Number.isInteger(e)||e<0)throw new Error("invalid interval");this.#e=e,this._forEachSubscriber(t=>{xB(t)&&(t.pollingInterval=this.#e)})}},Cs=class extends Lp{#e;constructor(e,t,r){e==null&&(e="http://localhost:8545"),super(t,r),typeof e=="string"?this.#e=new zr(e):this.#e=e.clone()}_getConnection(){return this.#e.clone()}async send(e,t){return await this._start(),await super.send(e,t)}async _send(e){let t=this._getConnection();t.body=JSON.stringify(e),t.setHeader("content-type","application/json");let r=await t.send();r.assertOk();let i=r.bodyJson;return Array.isArray(i)||(i=[i]),i}};function i_(n){if(n==null)return null;if(typeof n.message=="string"&&n.message.match(/revert/i)&&$e(n.data))return{message:n.message,data:n.data};if(typeof n=="object"){for(let e in n){let t=i_(n[e]);if(t)return t}return null}if(typeof n=="string")try{return i_(JSON.parse(n))}catch{}return null}function s_(n,e){if(n!=null){if(typeof n.message=="string"&&e.push(n.message),typeof n=="object")for(let t in n)s_(n[t],e);if(typeof n=="string")try{return s_(JSON.parse(n),e)}catch{}}}function BX(n){let e=[];return s_(n,e),e}var ja=class n extends Lp{#e;#t;constructor(e,t,r){let i=Object.assign({},r??{},{batchMaxCount:1});x(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(t,i),this.#t=null,r&&r.providerInfo&&(this.#t=r.providerInfo),this.#e=async(s,o)=>{let a={method:s,params:o};this.emit("debug",{action:"sendEip1193Request",payload:a});try{let c=await e.request(a);return this.emit("debug",{action:"receiveEip1193Result",result:c}),c}catch(c){let l=new Error(c.message);throw l.code=c.code,l.data=c.data,l.payload=a,this.emit("debug",{action:"receiveEip1193Error",error:l}),l}}}get providerInfo(){return this.#t}async send(e,t){return await this._start(),await super.send(e,t)}async _send(e){x(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{let t=await this.#e(e.method,e.params||[]);return[{id:e.id,result:t}]}catch(t){return[{id:e.id,error:{code:t.code,data:t.data,message:t.message}}]}}getRpcError(e,t){switch(t=JSON.parse(JSON.stringify(t)),t.error.code||-1){case 4001:t.error.message=`ethers-user-denied: ${t.error.message}`;break;case 4200:t.error.message=`ethers-unsupported: ${t.error.message}`;break}return super.getRpcError(e,t)}async hasSigner(e){e==null&&(e=0);let t=await this.send("eth_accounts",[]);return typeof e=="number"?t.length>e:(e=e.toLowerCase(),t.filter(r=>r.toLowerCase()===e).length!==0)}async getSigner(e){if(e==null&&(e=0),!await this.hasSigner(e))try{await this.#e("eth_requestAccounts",[])}catch(t){let r=t.payload;throw this.getRpcError(r,{id:r.id,error:t})}return await super.getSigner(e)}static async discover(e){if(e==null&&(e={}),e.provider)return new n(e.provider);let t=e.window?e.window:typeof window<"u"?window:null;if(t==null)return null;let r=e.anyProvider;if(r&&t.ethereum)return new n(t.ethereum);if(!("addEventListener"in t&&"dispatchEvent"in t&&"removeEventListener"in t))return null;let i=e.timeout?e.timeout:300;return i===0?null:await new Promise((s,o)=>{let a=[],c=d=>{a.push(d.detail),r&&l()},l=()=>{if(clearTimeout(u),a.length)if(e&&e.filter){let d=e.filter(a.map(h=>Object.assign({},h.info)));if(d==null)s(null);else if(d instanceof n)s(d);else{let h=null;if(d.uuid&&(h=a.filter(p=>d.uuid===p.info.uuid)[0]),h){let{provider:f,info:p}=h;s(new n(f,void 0,{providerInfo:p}))}else o(tt("filter returned unknown info","UNSUPPORTED_OPERATION",{value:d}))}}else{let{provider:d,info:h}=a[0];s(new n(d,void 0,{providerInfo:h}))}else s(null);t.removeEventListener("eip6963:announceProvider",c)},u=setTimeout(()=>{l()},i);t.addEventListener("eip6963:announceProvider",c),t.dispatchEvent(new Event("eip6963:requestProvider"))})}};var uq=du(lq());var vt={production:!1,vestingContractAddress:"0xF0497a44ECE2D5f7f4a442766e4941a8D544A584",coinAddress:"0x83A9c9e0dB0f82d91B86f4c3539c28983CDc393f",coinSymbol:"QONE",supabaseRestUrl:"https://uvqnyufffifclezqkmzh.supabase.co/functions/v1/proof-by-address",walletConnectProjectId:"051e4ff495bf3f36a63792e87bf4ba7e",networkDetails:{chainId:"0x3E6",chainName:"Hyperliquid TestNet",nativeCurrency:{name:"HYPE",symbol:"HYPE",decimals:18},rpcUrls:["https://rpc.hyperliquid-testnet.xyz/evm"],blockExplorerUrls:["https://testnet.purrsec.com/"]}};var C0e=["function balanceOf(address owner) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)"],Zi=class n{currentAccount=gt(null);accounts=gt([]);isConnecting=gt(!1);error=gt(null);hypeBalance=gt(null);qoneBalance=gt(null);activeProviderType=gt(null);walletConnectProvider=null;metaMaskProvider=null;ACTIVE_PROVIDER_KEY="active_provider";rpcProvider=new Cs(vt.networkDetails.rpcUrls[0]);balancesInFlight=new Map;isMetaMaskListenerSet=!1;wcConnectInFlight=null;log(...e){console.log(`[WalletService ${new Date().toISOString()}]`,...e)}warn(...e){console.warn(`[WalletService ${new Date().toISOString()}]`,...e)}err(...e){console.error(`[WalletService ${new Date().toISOString()}]`,...e)}constructor(){this.tryEip6963Discovery();let e=localStorage.getItem(this.ACTIVE_PROVIDER_KEY);this.log("Constructor: savedProvider =",e),e&&(this.activeProviderType.set(e),e==="metamask"?this.rehydrateMetaMask():e==="walletconnect"&&this.initWalletConnect())}getMetaMaskProvider(){if(typeof window>"u")return null;if(this.metaMaskProvider)return this.log("getMetaMaskProvider: using cached MetaMask provider"),this.metaMaskProvider;let e=window.ethereum;if(!e)return this.warn("getMetaMaskProvider: window.ethereum not found"),null;if(e.providers?.length){let t=e.providers.find(i=>i.isMetaMask&&!i.isRabby&&!i.isCoinbaseWallet&&!i.isBraveWallet);if(t)return this.metaMaskProvider=t,this.log("getMetaMaskProvider: found real MetaMask in ethereum.providers[]"),t;let r=e.providers.find(i=>i.isMetaMask);if(r)return this.metaMaskProvider=r,this.log("getMetaMaskProvider: found a MetaMask-compatible provider in ethereum.providers[]"),r}return e.isMetaMask?(this.metaMaskProvider=e,this.log("getMetaMaskProvider: window.ethereum is MetaMask"),e):(this.warn("getMetaMaskProvider: MetaMask not detected via legacy paths"),null)}tryEip6963Discovery(){if(typeof window>"u")return;let e=t=>{let r=t.detail;this.log("EIP-6963 announceProvider:",r?.info?.rdns,r?.info?.name),r?.info?.rdns==="io.metamask"&&(this.metaMaskProvider=r.provider,this.log("EIP-6963: cached MetaMask provider from announcement"))};window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new Event("eip6963:requestProvider")),setTimeout(()=>{window.removeEventListener("eip6963:announceProvider",e),this.log("EIP-6963: discovery listener removed")},1500)}getActiveEip1193Provider(){let e=this.activeProviderType();return this.log("getActiveEip1193Provider: activeProviderType =",e),e==="walletconnect"?this.walletConnectProvider:e==="metamask"?this.getMetaMaskProvider():this.getMetaMaskProvider()}getBrowserProvider(){let e=this.getActiveEip1193Provider();return e?new ja(e):null}async getSigner(e){let t=this.getBrowserProvider();if(!t)throw new Error("No provider available");let r=e||this.currentAccount();return this.log("getSigner: target =",r),await this.validateAndSwitchNetwork(),r?t.getSigner(r):t.getSigner()}async validateAndSwitchNetwork(){this.log("validateAndSwitchNetwork: begin");let e=this.getActiveEip1193Provider(),t=this.activeProviderType();if(!e||!t)throw this.warn("validateAndSwitchNetwork: no active provider"),new Error("No wallet connected");try{let r=Number(vt.networkDetails.chainId),i=Number(e?.chainId??await e?.request?.({method:"eth_chainId"}));if(this.log("validateAndSwitchNetwork: chain check",{current:i,expected:r}),i!==r){if(this.log("validateAndSwitchNetwork: wrong network, attempting to switch..."),await this.addOrSwitchNetwork(e),Number(e?.chainId??await e?.request?.({method:"eth_chainId"}))!==r)throw new Error(`Please switch to ${vt.networkDetails.chainName} in your wallet`);this.log("validateAndSwitchNetwork: successfully switched to correct network")}else this.log("validateAndSwitchNetwork: already on correct network")}catch(r){throw this.err("validateAndSwitchNetwork: error:",r),new Error(r?.message||`Please switch to ${vt.networkDetails.chainName}`)}}async initWalletConnect(){this.log("initWalletConnect: begin"),this.walletConnectProvider?this.log("initWalletConnect: provider already exists"):(this.log("initWalletConnect: creating EthereumProvider.init(...)"),this.walletConnectProvider=await uq.EthereumProvider.init({projectId:vt.walletConnectProjectId,chains:[Number(vt.networkDetails.chainId)],showQrModal:!0,qrModalOptions:{themeMode:"dark"},rpcMap:{[Number(vt.networkDetails.chainId)]:vt.networkDetails.rpcUrls[0]}}),this.walletConnectProvider.on("display_uri",r=>{this.log("WalletConnect display_uri:",r)}),this.walletConnectProvider.on("connect",r=>{this.log("WalletConnect connect event:",r),this.log("WalletConnect session now:",this.walletConnectProvider?.session),this.log("WalletConnect accounts now:",this.walletConnectProvider?.accounts),this.validateChainOrSetError(this.walletConnectProvider,"WalletConnect")}),this.walletConnectProvider.on("accountsChanged",r=>{this.log("WalletConnect accountsChanged:",r),r?.length>0&&this.closeWcModal("accountsChanged"),this.handleAccountsChanged(r)}),this.walletConnectProvider.on("chainChanged",r=>{this.log("WalletConnect chainChanged:",r)}),this.walletConnectProvider.on("disconnect",r=>{this.warn("WalletConnect disconnect event:",r),this.handleAccountsChanged([])}),this.log("initWalletConnect: listeners attached"));let e=this.walletConnectProvider.accounts??[],t=!!this.walletConnectProvider?.session;return this.log("initWalletConnect: restored",{hasSession:t,accounts:e}),e.length>0?(await this.setActiveSession("walletconnect",e),await this.validateChainOrSetError(this.walletConnectProvider,"WalletConnect"),!0):!1}async connectWalletConnect(){return this.log("connectWalletConnect: begin"),this.wcConnectInFlight?(this.warn("connectWalletConnect: already in flight, returning existing promise"),this.wcConnectInFlight):(this.wcConnectInFlight=(async()=>{this.walletConnectProvider||(this.log("connectWalletConnect: provider missing, calling initWalletConnect()"),await this.initWalletConnect());let e=!!this.walletConnectProvider?.session,t=this.walletConnectProvider?.accounts??[];if(this.log("connectWalletConnect: pre-check",{hasSession:e,accounts:t}),e||t.length>0){this.log("connectWalletConnect: already connected/restored, skipping connect()"),t.length>0&&await this.setActiveSession("walletconnect",t),this.closeWcModal("pre-check");return}try{this.log("connectWalletConnect: calling provider.connect() => QR may appear"),await this.walletConnectProvider.connect();let r=this.walletConnectProvider?.accounts??[];this.log("connectWalletConnect: post-connect accounts =",r),r.length>0?(await this.setActiveSession("walletconnect",r),this.closeWcModal("post-connect")):this.warn("connectWalletConnect: connect() finished but accounts still empty")}catch(r){this.err("connectWalletConnect: error:",r);let i=String(r?.message??"");throw(r?.code===4001||/reset/i.test(i)||/rejected/i.test(i)||/closed/i.test(i)||/canceled|cancelled/i.test(i))&&(this.warn("connectWalletConnect: cancelled/reset/closed"),(!i||i==="[object Object]")&&(r.message="Connection request cancelled")),r}})().finally(()=>{this.wcConnectInFlight=null,this.log("connectWalletConnect: end (inFlight cleared)")}),this.wcConnectInFlight)}async getWalletConnectProvider(){return this.walletConnectProvider||await this.initWalletConnect(),this.walletConnectProvider}async rehydrateMetaMask(){this.log("rehydrateMetaMask: begin");let e=this.getMetaMaskProvider();if(!e){this.warn("rehydrateMetaMask: MetaMask provider not found");return}this.listenForMetaMaskAccountChanges();try{let i=(await new ja(e).listAccounts()).map(s=>s.address);this.log("rehydrateMetaMask: listAccounts =",i),i.length>0?(await this.setActiveSession("metamask",i),await this.validateChainOrSetError(e,"MetaMask")):(this.log("rehydrateMetaMask: no connected accounts"),localStorage.removeItem(this.ACTIVE_PROVIDER_KEY),this.activeProviderType.set(null))}catch(t){this.err("rehydrateMetaMask: error:",t)}}listenForMetaMaskAccountChanges(){if(this.isMetaMaskListenerSet){this.log("listenForMetaMaskAccountChanges: already set");return}let e=this.getMetaMaskProvider();if(!e){this.warn("listenForMetaMaskAccountChanges: provider missing");return}e.on("accountsChanged",t=>{this.log("MetaMask accountsChanged:",t),this.handleAccountsChanged(t)}),e.on("chainChanged",t=>{this.log("MetaMask chainChanged:",t)}),this.isMetaMaskListenerSet=!0,this.log("listenForMetaMaskAccountChanges: listener attached")}async connectWallet(e){this.log("connectWallet:",{type:e}),this.isConnecting.set(!0),this.error.set(null);try{if(e==="metamask"){let t=this.getMetaMaskProvider();if(t||(this.log("MetaMask not found immediately, waiting for discovery..."),await new Promise(s=>setTimeout(s,500)),t=this.getMetaMaskProvider()),!t)throw new Error("MetaMask is not installed or not detected. If you have multiple wallets, please ensure MetaMask is active.");this.listenForMetaMaskAccountChanges(),this.log("MetaMask: wallet_requestPermissions..."),await t.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}),this.log("MetaMask: addOrSwitchNetwork..."),await this.addOrSwitchNetwork(t);let r=new ja(t);this.log("MetaMask: eth_requestAccounts...");let i=await r.send("eth_requestAccounts",[]);this.log("MetaMask: connected accounts:",i),await this.setActiveSession("metamask",i),await this.validateChainOrSetError(t,"MetaMask")}e==="walletconnect"&&await this.connectWalletConnect()}catch(t){this.err("connectWallet: error:",t),t?.code===4001?this.error.set("User rejected the connection request"):this.error.set(t?.message||`Failed to connect ${e}`),localStorage.removeItem(this.ACTIVE_PROVIDER_KEY),this.activeProviderType.set(null)}finally{this.isConnecting.set(!1),this.log("connectWallet: done, isConnecting=false")}}async setActiveSession(e,t){this.log("setActiveSession:",{type:e,accounts:t}),t?.length>0?(this.activeProviderType.set(e),localStorage.setItem(this.ACTIVE_PROVIDER_KEY,e),await this.handleAccountsChanged(t)):this.warn("setActiveSession: empty accounts; not setting session")}async handleAccountsChanged(e){if(this.log("handleAccountsChanged:",e),this.accounts.set(e),e.length>0){let t=this.currentAccount();!t||!e.includes(t)?(this.log("handleAccountsChanged: selecting primary account:",e[0]),this.currentAccount.set(e[0]),await this.fetchBalances(e[0])):(this.log("handleAccountsChanged: keeping current account:",t),await this.fetchBalances(t));return}this.warn("handleAccountsChanged: disconnected (0 accounts)"),this.activeProviderType.set(null),localStorage.removeItem(this.ACTIVE_PROVIDER_KEY),this.currentAccount.set(null),this.resetBalances()}async addOrSwitchNetwork(e){this.log("addOrSwitchNetwork: target chainId =",vt.networkDetails.chainId);try{await e.request({method:"wallet_switchEthereumChain",params:[{chainId:vt.networkDetails.chainId}]}),this.log("addOrSwitchNetwork: switched OK")}catch(t){if(this.warn("addOrSwitchNetwork: switch failed:",t),t?.code===4902){this.log("addOrSwitchNetwork: chain missing, adding..."),await e.request({method:"wallet_addEthereumChain",params:[vt.networkDetails]}),this.log("addOrSwitchNetwork: added OK");return}throw new Error(t?.message||"Failed to switch network")}}async fetchBalances(e){let t=e.toLowerCase(),r=this.balancesInFlight.get(t);if(r)return this.log("fetchBalances: already in flight for",t),r;let i=(async()=>{this.log("fetchBalances:",e),await Promise.all([this.fetchHypeBalance(e),this.fetchQoneBalance(e)])})().finally(()=>this.balancesInFlight.delete(t));return this.balancesInFlight.set(t,i),i}async fetchHypeBalance(e){this.log("fetchHypeBalance: begin");try{let t=await this.rpcProvider.getBalance(e),r=Tw(t);this.log("fetchHypeBalance: value =",r),this.hypeBalance.set(r)}catch(t){this.err("fetchHypeBalance: error:",t),this.hypeBalance.set(null)}}async fetchQoneBalance(e){this.log("fetchQoneBalance: begin");try{let t=new ln(vt.coinAddress,C0e,this.rpcProvider),[r,i]=await Promise.all([t.balanceOf(e),t.decimals()]),s=Bi(r,i);this.log("fetchQoneBalance: value =",s),this.qoneBalance.set(s)}catch(t){this.err("fetchQoneBalance: error:",t),this.qoneBalance.set(null)}}async addTokenToMetaMask(){this.log("addTokenToMetaMask: begin");let e=this.getMetaMaskProvider();if(!e){this.warn("addTokenToMetaMask: MetaMask provider not found"),this.error.set("MetaMask is not installed");return}try{await e.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:vt.coinAddress,symbol:vt.coinSymbol,decimals:18}}}),this.log("addTokenToMetaMask: request sent")}catch(t){this.err("addTokenToMetaMask: error:",t),this.error.set("Failed to add token to MetaMask")}}async disconnectWallet(){if(this.log("disconnectWallet: begin"),localStorage.removeItem(this.ACTIVE_PROVIDER_KEY),this.walletConnectProvider)try{this.log("disconnectWallet: disconnecting WalletConnect session..."),await this.walletConnectProvider.disconnect(),this.log("disconnectWallet: WalletConnect disconnected")}catch(e){this.err("disconnectWallet: WalletConnect disconnect error:",e)}finally{this.walletConnectProvider=null}this.activeProviderType.set(null),this.currentAccount.set(null),this.accounts.set([]),this.resetBalances(),this.log("disconnectWallet: done")}switchAccount(e){this.log("switchAccount:",e),this.accounts().includes(e)?(this.currentAccount.set(e),this.fetchBalances(e)):this.warn("switchAccount: unknown account:",e)}async refreshBalances(){let e=this.currentAccount();this.log("refreshBalances:",e),e&&await this.fetchBalances(e)}resetBalances(){this.log("resetBalances"),this.hypeBalance.set(null),this.qoneBalance.set(null)}async validateChainOrSetError(e,t){try{let r=Number(vt.networkDetails.chainId),i=Number(e?.chainId??await e?.request?.({method:"eth_chainId"}));return this.log(`${t}: chain check`,{current:i,expected:r}),i!==r?(this.error.set(`Wrong network. Please switch to ${vt.networkDetails.chainName}.`),!1):!0}catch(r){return this.err(`${t}: chain check failed`,r),!0}}closeWcModal(e){let t=this.walletConnectProvider?.modal;t?.closeModal&&(this.log(`WalletConnect modal: closing (${e})`),t.closeModal())}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})};var oE=class n{walletService=X(Zi);router=X(ki);constructor(){Kc(()=>{this.walletService.currentAccount()&&this.router.navigate(["/vesting"])})}async connect(e){try{await this.walletService.connectWallet(e),this.walletService.currentAccount()&&this.router.navigate(["/vesting"])}catch(t){console.error("Connection failed",t)}}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ls({type:n,selectors:[["app-connect"]],decls:23,vars:0,consts:[[1,"connect-container"],[1,"connect-card"],[1,"corner","top-left"],[1,"corner","top-right"],[1,"corner","bottom-left"],[1,"corner","bottom-right"],[1,"card-content"],[1,"title"],[1,"white"],[1,"green"],[1,"buttons"],[1,"connect-btn",3,"click"],["src","metamask.png","alt","MetaMask",1,"icon"],["src","walletconnect.svg","alt","WalletConnect",1,"icon"],["href","#",1,"info-link"]],template:function(t,r){t&1&&(Ae(0,"div",0)(1,"div",1),Co(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),Ae(6,"div",6)(7,"h1",7)(8,"span",8),fe(9,"Claim Your"),De(),Ae(10,"span",9),fe(11,"qOne Tokens"),De()(),Ae(12,"div",10)(13,"button",11),Oi("click",function(){return r.connect("metamask")}),Ae(14,"span"),fe(15,"Metamask"),De(),Co(16,"img",12),De(),Ae(17,"button",11),Oi("click",function(){return r.connect("walletconnect")}),Ae(18,"span"),fe(19,"WalletConnect"),De(),Co(20,"img",13),De()(),Ae(21,"a",14),fe(22,"How Claiming Works?"),De()()()())},dependencies:[Qs],styles:[".connect-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;width:100%}.connect-card[_ngcontent-%COMP%]{position:relative;background:#000000e6;border:1px solid rgba(255,255,255,.2);padding:3rem 4rem;width:100%;max-width:500px;text-align:center;box-shadow:0 0 50px #00000080}.connect-card[_ngcontent-%COMP%]   .corner[_ngcontent-%COMP%]{position:absolute;width:15px;height:15px;border:2px solid #a3ff12;z-index:1}.connect-card[_ngcontent-%COMP%]   .corner.top-left[_ngcontent-%COMP%]{top:-1px;left:-1px;border-right:none;border-bottom:none}.connect-card[_ngcontent-%COMP%]   .corner.top-right[_ngcontent-%COMP%]{top:-1px;right:-1px;border-left:none;border-bottom:none}.connect-card[_ngcontent-%COMP%]   .corner.bottom-left[_ngcontent-%COMP%]{bottom:-1px;left:-1px;border-right:none;border-top:none}.connect-card[_ngcontent-%COMP%]   .corner.bottom-right[_ngcontent-%COMP%]{bottom:-1px;right:-1px;border-left:none;border-top:none}.card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2.5rem}.title[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;display:flex;flex-direction:column;gap:.5rem;margin:0}.title[_ngcontent-%COMP%]   .white[_ngcontent-%COMP%]{color:#fff;font-size:2.5rem;letter-spacing:-1px}.title[_ngcontent-%COMP%]   .green[_ngcontent-%COMP%]{color:#a3ff12;font-size:3rem;letter-spacing:-2px}.buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.connect-btn[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;background:#a3ff12;color:#000;border:none;padding:1rem 2rem;border-radius:8px;font-size:1.25rem;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:all .2s ease}.connect-btn[_ngcontent-%COMP%]:hover{background:#8ce60e;transform:translateY(-2px)}.connect-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:24px;height:24px;object-fit:contain}.info-link[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;color:#fff;text-decoration:none;font-size:.9rem;opacity:.8;transition:opacity .2s}.info-link[_ngcontent-%COMP%]:hover{opacity:1;text-decoration:underline}@media(max-width:600px){.connect-card[_ngcontent-%COMP%]{padding:2rem;margin:1rem}.title[_ngcontent-%COMP%]   .white[_ngcontent-%COMP%]{font-size:2rem}.title[_ngcontent-%COMP%]   .green[_ngcontent-%COMP%]{font-size:2.5rem}}"]})};var xh=["function getClaimableAmount(address beneficiary, uint8 category) public view returns (uint256)","function claim(uint8 category) external","function initializeMyAllocation(uint256 totalAmount, uint8 category, bytes32[] calldata proof) external","function getAllocation(address beneficiary, uint8 category) external view returns (tuple(uint256 totalAmount, uint256 claimedAmount, bool initialized))","function tgeTimestamp() external view returns (uint256)","function totalAllocated() external view returns (uint256)","function totalClaimed() external view returns (uint256)"],Dh=class n{walletService=X(Zi);claimableAmount=gt(null);claimableCategories=gt([]);isClaiming=gt(!1);isInitializing=gt(!1);isLoading=gt(!1);initializingCategoryName=gt(null);uninitializedAllocations=gt([]);initializationNeeded=gt(!1);allocationStatuses=gt([]);error=gt(null);userAllocations=gt([]);userRemainingAllocation=gt(null);tgeDate=gt(null);totalAllocated=gt(null);totalClaimed=gt(null);categoryNames={0:'"Early Supporters"',1:'"Community Round"',2:'"Public Sale"',3:'"Team & Advisors"',4:'"Liquidity/Treasury"',5:'"Community Airdrops"'};constructor(){this.fetchGlobalStats()}async fetchGlobalStats(){console.log("VestingService: Fetching global stats...");try{let e=new Cs(vt.networkDetails.rpcUrls[0]),t=new ln(vt.vestingContractAddress,xh,e),[r,i,s]=await Promise.all([t.tgeTimestamp(),t.totalAllocated(),t.totalClaimed()]);console.log("VestingService: Global stats fetched:",{tgeTs:r,totalAlloc:i,totalClm:s}),this.tgeDate.set(new Date(Number(r)*1e3)),this.totalAllocated.set(Bi(i,18)),this.totalClaimed.set(Bi(s,18))}catch(e){console.error("Error fetching global vesting stats:",e)}}async fetchClaimableAmount(e,t=!1){console.log(`VestingService: Fetching claimable amount for ${e}, silent: ${t}`),t||this.isLoading.set(!0);try{await this.checkInitializationNeeded(e),await this.fetchAllocationStatuses(e);let r=new Cs(vt.networkDetails.rpcUrls[0]),i=new ln(vt.vestingContractAddress,xh,r),s=0n,o=[];for(let a=0;a<=5;a++){let c=await i.getClaimableAmount(e,a);c>0n&&(console.log(`VestingService: Found claimable amount for category ${a}: ${c}`),s+=c,o.push({category:a,name:this.categoryNames[a],amount:Bi(c,18)}))}console.log(`VestingService: Total claimable for ${e}: ${s}`),this.claimableAmount.set(Bi(s,18)),this.claimableCategories.set(o)}catch(r){console.error("Error fetching claimable amount:",r),this.claimableAmount.set(null),this.claimableCategories.set([])}finally{this.isLoading.set(!1)}}async claim(e,t=!1){console.log(`VestingService: Attempting to claim category ${e}, isBatch: ${t}`),t||this.isClaiming.set(!0),this.error.set(null);try{let r=this.walletService.currentAccount();console.log("VestingService: Getting signer for account:",r);let i=await this.walletService.getSigner(r||void 0),o=await new ln(vt.vestingContractAddress,xh,i).claim(e);console.log("VestingService: Claim transaction sent:",o.hash),await o.wait(),console.log("VestingService: Claim transaction confirmed");let a=await i.getAddress();await this.fetchClaimableAmount(a,!0),await this.fetchGlobalStats()}catch(r){console.error("VestingService: Error claiming tokens:",r);let i=r.reason||r.message||"Failed to claim tokens";throw this.error.set(i),r}finally{t||this.isClaiming.set(!1)}}async checkInitializationNeeded(e){console.log(`VestingService: Checking initialization needed for ${e}`);try{let t=new Cs(vt.networkDetails.rpcUrls[0]),r=new ln(vt.vestingContractAddress,xh,t),i=await fetch(`${vt.supabaseRestUrl}?address=${e}`);if(!i.ok){console.error("VestingService: Failed to fetch Supabase data");return}let o=(await i.json()).data||[];console.log(`VestingService: Found ${o.length} allocations in DB for ${e}`);let a=[],c=[],l=0n,u=!1;for(let d of o){let h=d.category,f=BigInt(d.amount_wei);l+=f;let p={category:h,name:this.categoryNames[h],amount:Bi(f,18),rawAmount:f};a.push(p),(await r.getAllocation(e,h))[2]?console.log(`VestingService: Allocation for category ${h} already initialized`):(console.log(`VestingService: Allocation for category ${h} needs initialization`),u=!0,c.push(p))}this.userAllocations.set(a),this.initializationNeeded.set(u),this.uninitializedAllocations.set(c)}catch(t){console.error("Error checking initialization:",t),this.userAllocations.set([]),this.uninitializedAllocations.set([])}}async fetchAllocationStatuses(e){console.log(`VestingService: Fetching allocation statuses for ${e}`);try{let t=new Cs(vt.networkDetails.rpcUrls[0]),r=new ln(vt.vestingContractAddress,xh,t),i=[],s=0n,o=this.userAllocations();for(let a=0;a<=5;a++){let[c,l]=await Promise.all([r.getClaimableAmount(e,a),r.getAllocation(e,a)]),u=BigInt(l[0]),d=BigInt(l[1]),h=!!l[2];if(!h){let f=o.find(p=>p.category===a);f&&f.rawAmount&&(u=f.rawAmount)}if(h||u>0n){let f=d+c,p=u>0n?Number(f*10000n/u)/100:0,g=u-d;s+=g,i.push({name:this.categoryNames[a],percentage:p,isCompleted:p>=100,category:a})}}this.allocationStatuses.set(i),this.userRemainingAllocation.set(Bi(s,18))}catch(t){console.error("Error fetching allocation statuses:",t),this.userRemainingAllocation.set(null)}}async initializeAllocations(e){console.log(`VestingService: initializeAllocations called for ${e}`),this.isInitializing.set(!0),this.error.set(null);try{let t=await fetch(`${vt.supabaseRestUrl}?address=${e}`);if(!t.ok)throw new Error("Failed to fetch allocation data");let i=(await t.json()).data||[];console.log("VestingService: Allocations to process:",i);try{console.log("VestingService: Getting signer for address:",e);let s=await this.walletService.getSigner(e),o=new ln(vt.vestingContractAddress,xh,s);for(let a of i){let{category:c,amount_wei:l,proof:u}=a;if((await o.getAllocation(e,c))[2])console.log(`VestingService: Skipping category ${c}, already initialized`);else{let h;h=BigInt(l),console.log(`VestingService: Initializing category ${c} with amount ${h}, proof: ${u}`),this.initializingCategoryName.set(this.categoryNames[c]);let f=await o.initializeMyAllocation(h,c,u);console.log("VestingService: Initialization tx sent:",f.hash),await f.wait(),console.log("VestingService: Initialization tx confirmed"),this.initializingCategoryName.set(null)}}this.initializationNeeded.set(!1),await this.fetchClaimableAmount(e),await this.fetchGlobalStats()}catch(s){throw s}}catch(t){console.error("VestingService: Error initializing allocations:",t);let r=t.reason||t.message||"Failed to initialize allocations";throw this.error.set(r),t}finally{this.isInitializing.set(!1),this.initializingCategoryName.set(null)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})};function S0e(n,e){n&1&&(Ee(0,"div",3),br(1,"div",4),Ee(2,"span"),fe(3,"Loading allocations..."),Pe()())}function A0e(n,e){if(n&1){let t=Er();Ee(0,"div",14)(1,"div",15),ss(),Ee(2,"svg",16),br(3,"circle",17)(4,"path",18)(5,"path",19),Pe(),qs(),Ee(6,"span",20),fe(7),Pe()(),Ee(8,"button",21),Ri("click",function(){pn(t);let i=et(2);return gn(i.vestingService.error.set(null))}),fe(9,"\xD7"),Pe()()}if(n&2){let t=et(2);we(7),jr(t.vestingService.error())}}function _0e(n,e){if(n&1){let t=Er();Ee(0,"div",22)(1,"div",23)(2,"h2",24),fe(3," No Tokens Available"),br(4,"br"),Ee(5,"span",25),fe(6,"for This Wallet"),Pe()(),Ee(7,"p",26),fe(8," This Wallet does not have an active qOne allocation. If you believe this is incorrect, "),Ee(9,"span",25),fe(10,"please review the FAQ"),Pe(),fe(11," or connect different wallet. "),Pe(),Ee(12,"button",27),Ri("click",function(){pn(t);let i=et(2);return gn(i.switchWallet())}),fe(13," Switch Wallet "),Pe()()()}}function T0e(n,e){n&1&&(Ee(0,"span"),fe(1,"Claim Tokens"),Pe())}function x0e(n,e){n&1&&(Ee(0,"span"),fe(1,"Claiming..."),Pe())}function D0e(n,e){if(n&1){let t=Er();Ee(0,"button",39),Ri("click",function(){pn(t);let i=et(3);return gn(i.claimAll())}),vr(1,T0e,2,0,"span",40)(2,x0e,2,0,"span",40),Pe()}if(n&2){let t=et(3);qt("disabled",t.vestingService.isClaiming()||!t.vestingService.claimableAmount()||t.vestingService.claimableAmount()==="0"||t.vestingService.claimableAmount()==="0.0"),we(),qt("ngIf",!t.vestingService.isClaiming()),we(),qt("ngIf",t.vestingService.isClaiming())}}function N0e(n,e){n&1&&(Ee(0,"span"),fe(1,"Initialize"),Pe())}function R0e(n,e){n&1&&(Ee(0,"span"),fe(1,"Initializing..."),Pe())}function O0e(n,e){if(n&1){let t=Er();Ee(0,"button",41),Ri("click",function(){pn(t);let i=et(3);return gn(i.initialize())}),vr(1,N0e,2,0,"span",40)(2,R0e,2,0,"span",40),Pe()}if(n&2){let t=et(3);qt("disabled",t.vestingService.isInitializing()),we(),qt("ngIf",!t.vestingService.isInitializing()),we(),qt("ngIf",t.vestingService.isInitializing())}}function P0e(n,e){if(n&1&&(Af(0),fe(1),_f()),n&2){let t=et().$implicit;we(),An("",t.percentage,"% vested")}}function M0e(n,e){n&1&&(Af(0),fe(1,"Completed"),_f())}function k0e(n,e){if(n&1&&(Ee(0,"div",42)(1,"span",43),fe(2),Pe(),Ee(3,"span",44),vr(4,P0e,2,1,"ng-container",40)(5,M0e,2,0,"ng-container",40),Pe()()),n&2){let t=e.$implicit;we(2),jr(t.name),we(),ga("completed",t.isCompleted),we(),qt("ngIf",!t.isCompleted),we(),qt("ngIf",t.isCompleted)}}function L0e(n,e){if(n&1&&(Ee(0,"div",28)(1,"div",29)(2,"div",30)(3,"span",31),fe(4,"Remaining allocation"),Pe(),Ee(5,"span",32),fe(6),Vr(7,"number"),Pe()(),Ee(8,"div",30)(9,"span",31),fe(10,"Available To Claim"),Pe(),Ee(11,"span",32),fe(12),Vr(13,"number"),Pe()()(),vr(14,D0e,3,3,"button",33)(15,O0e,3,3,"button",34),Ee(16,"div",35)(17,"h2",36),fe(18,"Vesting Status"),Pe(),Ee(19,"div",37),vr(20,k0e,6,5,"div",38),Pe()()()),n&2){let t=et(2);we(6),jr(Hr(7,5,t.vestingService.userRemainingAllocation()||"0","1.0-0")),we(6),jr(Hr(13,8,t.vestingService.claimableAmount()||"0","1.0-0")),we(2),qt("ngIf",!t.vestingService.initializationNeeded()),we(),qt("ngIf",t.vestingService.initializationNeeded()),we(5),qt("ngForOf",t.vestingService.allocationStatuses())}}function F0e(n,e){if(n&1&&(Ee(0,"div",5),br(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9),Ee(5,"h1",10),fe(6,"Available Allocation"),Pe(),vr(7,A0e,10,1,"div",11)(8,_0e,14,0,"div",12)(9,L0e,21,11,"div",13),Pe()),n&2){let t=et();we(7),qt("ngIf",t.vestingService.error()),we(),qt("ngIf",!t.hasAllocations()),we(),qt("ngIf",t.hasAllocations())}}var aE=class n{walletService=X(Zi);vestingService=X(Dh);router=X(ki);constructor(){Kc(()=>{let e=this.walletService.currentAccount(),t=!!localStorage.getItem("active_provider");e?this.vestingService.fetchClaimableAmount(e):t||this.router.navigate(["/"])})}async claimAll(){console.log("VestingComponent: Starting claimAll");let e=this.vestingService.claimableCategories();if(e.length===0){console.warn("VestingComponent: No categories to claim");return}this.vestingService.isClaiming.set(!0);try{for(let t of e)console.log(`VestingComponent: Claiming category ${t.name} (${t.category})`),await this.vestingService.claim(t.category,!0)}catch(t){console.error("VestingComponent: Error in claimAll loop:",t)}finally{this.vestingService.isClaiming.set(!1)}}async initialize(){console.log("VestingComponent: Starting initialize");let e=this.walletService.currentAccount();if(e)try{await this.vestingService.initializeAllocations(e)}catch(t){console.error("VestingComponent: Initialization failed:",t)}}async switchWallet(){await this.walletService.disconnectWallet(),this.router.navigate(["/"])}hasAllocations(){return this.vestingService.userAllocations().length>0||this.vestingService.allocationStatuses().length>0}shortenAddress(e){return e?`${e.substring(0,6)}...${e.substring(e.length-4)}`:""}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ls({type:n,selectors:[["app-vesting"]],decls:3,vars:2,consts:[[1,"vesting-container"],["class","loading-state",4,"ngIf"],["class","vesting-card",4,"ngIf"],[1,"loading-state"],[1,"loader"],[1,"vesting-card"],[1,"corner","top-left"],[1,"corner","top-right"],[1,"corner","bottom-left"],[1,"corner","bottom-right"],[1,"page-title"],["class","error-banner",4,"ngIf"],["class","no-tokens-container",4,"ngIf"],["class","allocation-content",4,"ngIf"],[1,"error-banner"],[1,"error-content"],["width","20","height","20","viewBox","0 0 20 20","fill","none","xmlns","http://www.w3.org/2000/svg",1,"error-icon"],["cx","10","cy","10","r","9","stroke","currentColor","stroke-width","2"],["d","M10 6V11","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["d","M10 14V14.01","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"error-text"],[1,"error-close",3,"click"],[1,"no-tokens-container"],[1,"no-tokens-content"],[1,"no-tokens-title"],[1,"highlight"],[1,"no-tokens-desc"],[1,"action-btn","switch-btn",3,"click"],[1,"allocation-content"],[1,"stats-box"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value"],["class","action-btn",3,"disabled","click",4,"ngIf"],["class","action-btn initialize",3,"disabled","click",4,"ngIf"],[1,"status-section"],[1,"status-title"],[1,"status-list"],["class","status-row",4,"ngFor","ngForOf"],[1,"action-btn",3,"click","disabled"],[4,"ngIf"],[1,"action-btn","initialize",3,"click","disabled"],[1,"status-row"],[1,"row-label"],[1,"row-value"]],template:function(t,r){t&1&&(Ee(0,"div",0),vr(1,S0e,4,0,"div",1)(2,F0e,10,3,"div",2),Pe()),t&2&&(we(),qt("ngIf",r.vestingService.isLoading()),we(),qt("ngIf",!r.vestingService.isLoading()))},dependencies:[Qs,Qu,Mf,kf],styles:['.vesting-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:550px;margin:0 auto;padding:1.5rem 1rem}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;color:#fff;font-family:Neue Machina,sans-serif}.loading-state[_ngcontent-%COMP%]   .loader[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid rgba(255,255,255,.1);border-top-color:#a3ff12;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.no-tokens-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;width:100%;padding:1rem 0}.no-tokens-container[_ngcontent-%COMP%]   .no-tokens-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1.5rem}.no-tokens-container[_ngcontent-%COMP%]   .no-tokens-title[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;font-size:1.75rem;line-height:1.1;color:#fff;margin:0}.no-tokens-container[_ngcontent-%COMP%]   .no-tokens-title[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#a3ff12}.no-tokens-container[_ngcontent-%COMP%]   .no-tokens-desc[_ngcontent-%COMP%]{font-family:Inter,sans-serif;color:#fff;font-size:1rem;line-height:1.6;max-width:350px;margin:0}.no-tokens-container[_ngcontent-%COMP%]   .no-tokens-desc[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#a3ff12;text-decoration:underline;cursor:pointer}.no-tokens-container[_ngcontent-%COMP%]   .switch-btn[_ngcontent-%COMP%]{margin-top:.5rem}.page-title[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;font-size:1.75rem;color:#fff;margin:0;text-align:center}.error-banner[_ngcontent-%COMP%]{margin:1rem 0;padding:.75rem 1rem;background:#ff3b301a;border:1px solid rgba(255,59,48,.3);border-radius:4px;display:flex;align-items:center;justify-content:space-between;gap:1rem;width:100%;box-sizing:border-box}.error-banner[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;color:#ff3b30}.error-banner[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500}.error-banner[_ngcontent-%COMP%]   .error-close[_ngcontent-%COMP%]{background:none;border:none;color:#ff3b30;font-size:1.25rem;cursor:pointer;padding:0;line-height:1;opacity:.7}.error-banner[_ngcontent-%COMP%]   .error-close[_ngcontent-%COMP%]:hover{opacity:1}.vesting-card[_ngcontent-%COMP%]{width:100%;position:relative;border:1px solid #333;background:#000;padding:2rem 1.5rem;display:flex;flex-direction:column;min-height:400px;justify-content:center}.vesting-card[_ngcontent-%COMP%]   .corner[_ngcontent-%COMP%]{position:absolute;width:18px;height:18px;border:3px solid #a3ff12;pointer-events:none}.vesting-card[_ngcontent-%COMP%]   .corner.top-left[_ngcontent-%COMP%]{top:-2px;left:-2px;border-right:none;border-bottom:none}.vesting-card[_ngcontent-%COMP%]   .corner.top-right[_ngcontent-%COMP%]{top:-2px;right:-2px;border-left:none;border-bottom:none}.vesting-card[_ngcontent-%COMP%]   .corner.bottom-left[_ngcontent-%COMP%]{bottom:-2px;left:-2px;border-right:none;border-top:none}.vesting-card[_ngcontent-%COMP%]   .corner.bottom-right[_ngcontent-%COMP%]{bottom:-2px;right:-2px;border-left:none;border-top:none}.allocation-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;width:100%}.stats-box[_ngcontent-%COMP%]{background:linear-gradient(90deg,#5b841b,#1e2b09);display:flex;padding:1.25rem;border-radius:2px;position:relative;gap:1.5rem}.stats-box[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.5rem;position:relative}.stats-box[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:first-child:after{content:"";position:absolute;right:-.75rem;top:15%;bottom:15%;width:1px;background:#fff3}.stats-box[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#fff;font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;opacity:.9}.stats-box[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;font-size:2rem;color:#fff;line-height:1;letter-spacing:-.01em}.stats-box[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]:after{content:"";display:block;width:100%;height:1px;background:#ffffff4d;margin-top:.4rem}.action-btn[_ngcontent-%COMP%]{width:100%;background-color:#a3ff12;color:#000;border:none;padding:1rem;font-family:Neue Machina,sans-serif;font-weight:800;font-size:1.25rem;cursor:pointer;transition:all .2s;clip-path:polygon(0 6px,6px 0,calc(100% - 6px) 0,100% 6px,100% calc(100% - 6px),calc(100% - 6px) 100%,6px 100%,0 calc(100% - 6px))}.action-btn[_ngcontent-%COMP%]:hover:not(:disabled){opacity:.9}.action-btn[_ngcontent-%COMP%]:disabled{background-color:#333;color:#666;cursor:not-allowed}.status-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.status-title[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;font-size:1.5rem;color:#fff;text-align:center}.status-list[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:4px;padding:1rem 1.5rem;display:flex;flex-direction:column}.status-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 0;border-bottom:1px solid #333}.status-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.status-row[_ngcontent-%COMP%]   .row-label[_ngcontent-%COMP%]{color:#fff;font-size:.8rem;font-weight:700}.status-row[_ngcontent-%COMP%]   .row-value[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;font-size:1.5rem;color:#fff;white-space:nowrap}']})};var ON=(n,e)=>e.category;function B0e(n,e){n&1&&(Ae(0,"div",3)(1,"h3"),fe(2,"HYPE Balance"),De(),Ae(3,"p"),fe(4),Vr(5,"number"),De()()),n&2&&(we(4),An("",Hr(5,1,e,"1.0-6")," HYPE"))}function U0e(n,e){if(n&1&&(Ae(0,"option",8),fe(1),De()),n&2){let t=e.$implicit;nl("value",t),we(),jr(t)}}function j0e(n,e){if(n&1&&(Ae(0,"div",19)(1,"span"),fe(2),De(),Ae(3,"span"),fe(4),Vr(5,"number"),De()()),n&2){let t=e.$implicit;we(2),An("",t.name,":"),we(2),An("",Hr(5,2,t.amount,"1.0-6")," qONE")}}function V0e(n,e){if(n&1&&(Ae(0,"div",12)(1,"p"),fe(2,"Allocations:"),De(),Ae(3,"div",18),zu(4,j0e,6,5,"div",19,ON),De()()),n&2){let t=et(2);we(4),Gu(t.vestingService.userAllocations())}}function H0e(n,e){if(n&1){let t=Er();Ae(0,"div",12)(1,"div",20)(2,"code",21)(3,"div",19)(4,"span"),fe(5,"qONE Balance:"),De(),Ae(6,"span"),fe(7),Vr(8,"number"),De()()(),Ae(9,"button",22),Oi("click",function(){pn(t);let i=et(2);return gn(i.walletService.addTokenToMetaMask())}),ss(),Ae(10,"svg",23),Co(11,"path",24),De()()()()}n&2&&(we(7),An("",Hr(8,1,e,"1.0-2")," qONE"))}function $0e(n,e){if(n&1&&(Ae(0,"li",27)(1,"span"),fe(2),De(),Ae(3,"span"),fe(4),Vr(5,"number"),De()()),n&2){let t=e.$implicit;we(2),jr(t.name),we(2),An("",Hr(5,2,t.amount,"1.0-6")," qONE")}}function q0e(n,e){if(n&1){let t=Er();Ae(0,"div",14)(1,"p",25),fe(2,"You have pending vesting allocations to initialize:"),De(),Ae(3,"ul",26),zu(4,$0e,6,5,"li",27,ON),De(),Ae(6,"button",28),Oi("click",function(){pn(t);let i=et(),s=et();return gn(s.vestingService.initializeAllocations(i))}),fe(7),De()()}if(n&2){let t=et(2);we(4),Gu(t.vestingService.uninitializedAllocations()),we(2),nl("disabled",t.vestingService.isInitializing()),we(),An(" ",t.vestingService.isInitializing()?"Initializing "+(t.vestingService.initializingCategoryName()||"")+"...":"Initialize "+(t.vestingService.uninitializedAllocations().length===1?t.vestingService.uninitializedAllocations()[0].name:"Allocations ("+t.vestingService.uninitializedAllocations().length+")")," ")}}function z0e(n,e){if(n&1){let t=Er();Ae(0,"div",31)(1,"p"),fe(2),Vr(3,"number"),De(),Ae(4,"button",33),Oi("click",function(){let i=pn(t).$implicit,s=et(3);return gn(s.vestingService.claim(i.category))}),fe(5),De()()}if(n&2){let t=e.$implicit,r=et(3);we(2),Ty("",t.name,": ",Hr(3,4,t.amount,"1.0-6")," qONE"),we(2),nl("disabled",r.vestingService.isClaiming()),we(),An(" ",r.vestingService.isClaiming()?"Claiming...":"Claim"," ")}}function G0e(n,e){if(n&1&&(Ae(0,"p",32),fe(1),De()),n&2){let t=et(3);we(),jr(t.vestingService.error())}}function W0e(n,e){if(n&1&&(Ae(0,"div",15)(1,"div",12)(2,"p"),fe(3,"Total Claimable Vested Tokens:"),De(),Ae(4,"code",29),fe(5),Vr(6,"number"),De()(),Ae(7,"div",30),zu(8,z0e,6,7,"div",31,ON),Eo(10,G0e,2,1,"p",32),De()()),n&2){let t=et(2);we(5),An("",Hr(6,2,e,"1.0-6")," qONE"),we(3),Gu(t.vestingService.claimableCategories()),we(2),Io(t.vestingService.error()?10:-1)}}function K0e(n,e){if(n&1){let t=Er();Ae(0,"div",5)(1,"p"),fe(2,"Connected Address:"),De(),Ae(3,"div",6)(4,"select",7),Oi("change",function(i){pn(t);let s=et();return gn(s.walletService.switchAccount(i.target.value))}),zu(5,U0e,2,2,"option",8,XC),De(),Ae(7,"button",9),Oi("click",function(){pn(t);let i=et();return gn(i.refresh())}),ss(),Ae(8,"svg",10),Co(9,"path",11),De()()(),Eo(10,V0e,6,0,"div",12),qs(),Ae(11,"div",13),Eo(12,H0e,12,4,"div",12),De(),Eo(13,q0e,8,2,"div",14),Eo(14,W0e,11,5,"div",15),Ae(15,"p",16),fe(16," Heads up! After claiming qONE, it can take 10\u201330 seconds for the blockchain to update your balance. If you still see the old amount, just tap Refresh. "),De(),Ae(17,"button",17),Oi("click",function(){pn(t);let i=et();return gn(i.walletService.disconnectWallet())}),fe(18," Disconnect "),De()()}if(n&2){let t,r,i=et();we(4),nl("value",e),we(),Gu(i.walletService.accounts()),we(5),Io(i.vestingService.userAllocations().length>0?10:-1),we(2),Io((t=i.walletService.qoneBalance())?12:-1,t),we(),Io(i.vestingService.initializationNeeded()?13:-1),we(),Io((r=i.vestingService.claimableAmount())?14:-1,r)}}var cE=class n{walletService=X(Zi);vestingService=X(Dh);router=X(ki);constructor(){Kc(()=>{let e=this.walletService.currentAccount(),t=!!localStorage.getItem("active_provider");e?this.vestingService.fetchClaimableAmount(e):t||(this.vestingService.claimableAmount.set(null),this.router.navigate(["/"]))})}async refresh(){await this.walletService.refreshBalances();let e=this.walletService.currentAccount();e&&await this.vestingService.fetchClaimableAmount(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ls({type:n,selectors:[["app-vesting-details"]],decls:26,vars:14,consts:[[1,"vesting-container"],[1,"content-grid"],[1,"stats-section"],[1,"stat-card"],[1,"wallet-section"],[1,"connected-view"],[1,"address-selector"],[1,"account-select",3,"change","value"],[3,"value"],["title","Refresh Balances",1,"btn-icon","refresh-btn",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"],[1,"balance-item"],[1,"balances-container"],[1,"init-section"],[1,"vesting-section"],[1,"info-text"],[1,"btn","btn-disconnect",3,"click"],[1,"balance-value","allocations-list"],[1,"allocation-row"],[1,"balance-value-row"],[1,"balance-value","text-left","flex-grow"],["title","Add QLABS to MetaMask",1,"btn-icon",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12 5v14M5 12h14"],[1,"warning-text"],[1,"pending-list"],[1,"pending-item"],[1,"btn","btn-init",3,"click","disabled"],[1,"balance-value","claimable"],[1,"claim-actions"],[1,"claim-item"],[1,"error-message"],[1,"btn","btn-claim",3,"click","disabled"]],template:function(t,r){if(t&1&&(Ae(0,"div",0)(1,"h1"),fe(2,"qONE Vesting"),De(),Ae(3,"div",1)(4,"div",2)(5,"div",3)(6,"h3"),fe(7,"TGE Date"),De(),Ae(8,"p"),fe(9),Vr(10,"date"),De()(),Ae(11,"div",3)(12,"h3"),fe(13,"Global Allocated"),De(),Ae(14,"p"),fe(15),Vr(16,"number"),De()(),Ae(17,"div",3)(18,"h3"),fe(19,"Global Claimed"),De(),Ae(20,"p"),fe(21),Vr(22,"number"),De()(),Eo(23,B0e,6,4,"div",3),De(),Ae(24,"div",4),Eo(25,K0e,19,5,"div",5),De()()()),t&2){let i,s;we(9),jr(Hr(10,5,r.vestingService.tgeDate(),"mediumDate")),we(6),An("",Hr(16,8,r.vestingService.totalAllocated(),"1.0-0")," qONE"),we(6),An("",Hr(22,11,r.vestingService.totalClaimed(),"1.0-0")," qONE"),we(2),Io((i=r.walletService.hypeBalance())?23:-1,i),we(2),Io((s=r.walletService.currentAccount())?25:-1,s)}},dependencies:[Qs,kf,mS],styles:['@charset "UTF-8";h1[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:2rem;color:#a3ff12;text-transform:uppercase;z-index:1}.content-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;width:100%;max-width:1000px;z-index:1}.stats-section[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;justify-content:center}.stat-card[_ngcontent-%COMP%]{background:#111c;padding:1rem;border-radius:12px;box-shadow:0 2px 4px #00000080;min-width:180px;text-align:center;border:1px solid #333;flex:1;word-break:break-all}.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.9rem;color:#a3ff12;text-transform:uppercase;letter-spacing:.5px}.stat-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:#fff}.wallet-section[_ngcontent-%COMP%]{padding:1.5rem;border-radius:12px;background:#111c;box-shadow:0 4px 6px #00000080;min-width:300px;text-align:center;border:1px solid #333}@media(min-width:768px){.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:300px 1fr;align-items:start;gap:3rem}.stats-section[_ngcontent-%COMP%]{flex-direction:column}.stat-card[_ngcontent-%COMP%]{width:100%;min-width:auto}}.address-selector[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin:1rem 0}.account-select[_ngcontent-%COMP%]{flex-grow:1;background:#222;color:#a3ff12;border:1px solid #333;padding:.5rem;border-radius:6px;font-family:monospace;outline:none;width:100%}.account-select[_ngcontent-%COMP%]:focus{border-color:#a3ff12}.balances-container[_ngcontent-%COMP%]{margin:1.5rem 0;display:flex;flex-direction:column;gap:1rem}.allocations-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;text-align:left}.allocation-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem;font-size:.9rem}.balance-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#fff;font-weight:500;text-align:left}.balance-value[_ngcontent-%COMP%]{display:block;background:#222;padding:.5rem 1rem;border-radius:6px;margin:1rem 0;font-family:monospace;word-break:break-all;color:#a3ff12;border:1px solid #a3ff12;text-align:center}.balance-value.text-left[_ngcontent-%COMP%]{text-align:left}.balance-value.claimable[_ngcontent-%COMP%]{background:#222;color:#a3ff12;border:1px solid #a3ff12}.balance-value.flex-grow[_ngcontent-%COMP%]{flex-grow:1;margin:0}.balance-value-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:stretch}.vesting-section[_ngcontent-%COMP%], .init-section[_ngcontent-%COMP%]{margin:1.5rem 0;padding:1rem;border-top:1px solid #333}.init-section[_ngcontent-%COMP%]{border:1px solid #a3ff12;border-radius:8px;background:#a3ff121a}.init-section[_ngcontent-%COMP%]   .warning-text[_ngcontent-%COMP%]{color:#a3ff12;font-weight:600;margin-bottom:1rem;margin-top:0}.claim-actions[_ngcontent-%COMP%]{margin-top:1rem;display:flex;flex-direction:column;gap:1rem}.claim-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;background:#222;padding:1rem;border-radius:8px;border:1px solid #333}.claim-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:500;font-size:.9rem;color:#fff}.info-text[_ngcontent-%COMP%]{font-size:.85rem;color:#888;margin-bottom:1rem;font-style:italic}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-size:1rem}.btn-init[_ngcontent-%COMP%], .btn-claim[_ngcontent-%COMP%]{background-color:#a3ff12;color:#000;width:100%}.btn-init[_ngcontent-%COMP%]:hover:not(:disabled), .btn-claim[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#8ce60e}.btn-init[_ngcontent-%COMP%]:disabled, .btn-claim[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.btn-disconnect[_ngcontent-%COMP%]{background-color:#ff4d4d;color:#fff}.btn-disconnect[_ngcontent-%COMP%]:hover{background-color:#e60000}.btn-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 1rem;background:transparent;border:1px solid #a3ff12;color:#a3ff12;border-radius:6px;cursor:pointer;transition:all .2s}.btn-icon.refresh-btn[_ngcontent-%COMP%]{padding:0;width:40px;height:40px}.btn-icon.refresh-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.btn-icon[_ngcontent-%COMP%]:hover{background:#a3ff12;color:#000}.pending-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 1rem;text-align:left}.pending-item[_ngcontent-%COMP%]{color:#a3ff12;font-size:.9rem;padding:.25rem 0 .25rem 1rem;position:relative;display:flex;justify-content:space-between;align-items:center}.pending-item[_ngcontent-%COMP%]:before{content:"\\2022";position:absolute;left:0;color:#a3ff12}.error-message[_ngcontent-%COMP%]{color:#ff4d4d;margin-top:1rem;font-size:.9rem}']})};var dq=[{path:"",component:oE},{path:"vesting",component:aE},{path:"vesting-details",component:cE},{path:"**",redirectTo:""}];var hq={providers:[GI(),QS(dq)]};function Q0e(n,e){if(n&1){let t=Er();Ee(0,"div",30),Ri("click",function(){let i=pn(t).$implicit,s=et(3);return gn(s.selectAccount(i))}),fe(1),Pe()}if(n&2){let t=e.$implicit,r=et(3);ga("active",t===r.walletService.currentAccount()),we(),An(" ",r.shortenAddress(t)," ")}}function Y0e(n,e){if(n&1&&(Ee(0,"div",28),vr(1,Q0e,2,3,"div",29),Pe()),n&2){let t=et(2);we(),qt("ngForOf",t.walletService.accounts())}}function J0e(n,e){if(n&1){let t=Er();Ee(0,"div",15)(1,"div",16)(2,"div",17),Ri("click",function(){pn(t);let i=et();return gn(i.toggleWalletDropdown())}),Ee(3,"div",18),ss(),Ee(4,"svg",19),br(5,"rect",20)(6,"path",21),Pe()(),qs(),Ee(7,"span",22),fe(8),Pe(),Ee(9,"div",23),ss(),Ee(10,"svg",24),br(11,"path",25),Pe()()(),vr(12,Y0e,2,1,"div",26),Pe(),qs(),Ee(13,"button",27),Ri("click",function(){pn(t);let i=et();return gn(i.disconnect())}),fe(14," Disconnect "),Pe()()}if(n&2){let t=et();we(2),ga("open",t.showWalletDropdown),we(6),jr(t.shortenAddress(t.walletService.currentAccount())),we(),ga("open",t.showWalletDropdown),we(3),qt("ngIf",t.showWalletDropdown)}}function Z0e(n,e){if(n&1){let t=Er();Ee(0,"button",31),Ri("click",function(){pn(t);let i=et();return gn(i.addToken())}),fe(1," Add To MetaMask "),Pe()}}var lE=class n{walletService=X(Zi);router=X(ki);showWalletDropdown=!1;toggleWalletDropdown(){this.showWalletDropdown=!this.showWalletDropdown}selectAccount(e){this.walletService.switchAccount(e),this.showWalletDropdown=!1}async disconnect(){await this.walletService.disconnectWallet(),this.showWalletDropdown=!1,this.router.navigate(["/"])}shortenAddress(e){return e?`${e.substring(0,6)}...${e.substring(e.length-4)}`:""}async addToken(){await this.walletService.addTokenToMetaMask()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ls({type:n,selectors:[["app-root"]],decls:20,vars:2,consts:[[1,"app-header"],[1,"header-content"],[1,"header-left"],[1,"header-center"],[1,"qone-text"],["class","header-wallet-section",4,"ngIf"],[1,"header-right"],["class","qlabs-btn",3,"click",4,"ngIf"],["href","https://x.com/qlabsofficial","target","_blank",1,"icon-link"],[1,"icon-square"],["viewBox","0 0 24 24","aria-hidden","true",1,"x-icon"],["d","M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231 5.45-6.231zm-1.161 17.52h1.833L7.084 4.126H5.117L17.083 19.77z"],["href","https://qlabs.gitbook.io/quantum-crypto-wrapper-by-01-quantum-inc./qlabs-litepaper/","target","_blank",1,"litepaper-btn"],["href","https://qonetoken.io/","target","_blank",1,"qlabs-btn"],[1,"main-container"],[1,"header-wallet-section"],[1,"wallet-selector-container"],[1,"wallet-dropdown-trigger",3,"click"],[1,"wallet-icon-circle"],["width","12","height","12","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["x","2","y","5","width","20","height","14","rx","2"],["d","M22 10h-4a2 2 0 0 0 0 4h4"],[1,"address"],[1,"chevron"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6 9L12 15L18 9","stroke","currentColor","stroke-width","3","stroke-linecap","round","stroke-linejoin","round"],["class","wallet-dropdown-menu",4,"ngIf"],[1,"header-disconnect-btn",3,"click"],[1,"wallet-dropdown-menu"],["class","wallet-option",3,"active","click",4,"ngFor","ngForOf"],[1,"wallet-option",3,"click"],[1,"qlabs-btn",3,"click"]],template:function(t,r){t&1&&(Ee(0,"header",0)(1,"div",1),br(2,"div",2),Ee(3,"div",3)(4,"span",4),fe(5,"qONE"),Pe(),vr(6,J0e,15,6,"div",5),Pe(),Ee(7,"div",6),vr(8,Z0e,2,0,"button",7),Ee(9,"a",8)(10,"div",9),ss(),Ee(11,"svg",10)(12,"g"),br(13,"path",11),Pe()()()(),qs(),Ee(14,"a",12),fe(15," LITEPAPER "),Pe(),Ee(16,"a",13),fe(17," $qLABS "),Pe()()()(),Ee(18,"main",14),br(19,"router-outlet"),Pe()),t&2&&(we(6),qt("ngIf",r.walletService.currentAccount()),we(2),qt("ngIf",r.walletService.currentAccount()))},dependencies:[tp,Qs,Qu,Mf],styles:['.app-header[_ngcontent-%COMP%]{width:100%;background-color:#000;border-bottom:1px solid #111;position:relative;z-index:100;box-sizing:border-box}.app-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:20% 60% 20%;align-items:center;width:100%;padding:.5rem 2rem;box-sizing:border-box}@media(max-width:768px){.app-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;padding:1rem}}.app-header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1.5rem}.app-header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]   .qone-text[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;font-weight:800;font-size:1.25rem;color:#fff;letter-spacing:.1em}.app-header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]   .header-wallet-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.app-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:1rem}@media(max-width:768px){.app-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{width:100%;justify-content:center}}.app-header[_ngcontent-%COMP%]   .wallet-selector-container[_ngcontent-%COMP%]{position:relative;z-index:10;display:flex;justify-content:center}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.35rem .8rem;background:#ffffff0d;border:1px solid #333;border-radius:6px;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1);min-width:180px;justify-content:flex-start}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]:hover, .app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger.open[_ngcontent-%COMP%]{background:#ffffff1a;border-color:#a3ff12}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]:hover   .chevron[_ngcontent-%COMP%], .app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger.open[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{color:#a3ff12}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]   .wallet-icon-circle[_ngcontent-%COMP%]{width:24px;height:24px;background:#a3ff121a;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#a3ff12;flex-shrink:0}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{font-family:Neue Machina,sans-serif;color:#fff;font-size:.85rem;font-weight:800;white-space:nowrap}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;margin-left:auto;color:#fff;transition:transform .3s ease;flex-shrink:0}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;fill:none;stroke:currentColor;stroke-width:3px}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-trigger[_ngcontent-%COMP%]   .chevron.open[_ngcontent-%COMP%]{transform:rotate(180deg)}.app-header[_ngcontent-%COMP%]   .wallet-dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 8px);left:0;right:0;background:#0a0a0a;border:1px solid #333;border-radius:8px;overflow:hidden;box-shadow:0 12px 30px #000000e6;animation:_ngcontent-%COMP%_dropdownFade .2s ease-out;z-index:1000}@keyframes _ngcontent-%COMP%_dropdownFade{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.app-header[_ngcontent-%COMP%]   .wallet-option[_ngcontent-%COMP%]{padding:.6rem 1rem;color:#fff;font-family:Neue Machina,sans-serif;font-size:.8rem;cursor:pointer;transition:all .2s}.app-header[_ngcontent-%COMP%]   .wallet-option[_ngcontent-%COMP%]:hover{background:#ffffff0d}.app-header[_ngcontent-%COMP%]   .wallet-option.active[_ngcontent-%COMP%]{color:#a3ff12;background:#a3ff120d}.app-header[_ngcontent-%COMP%]   .header-disconnect-btn[_ngcontent-%COMP%]{background:transparent;border:1px solid #333;color:#fff;padding:.35rem .8rem;border-radius:4px;font-family:Neue Machina,sans-serif;font-weight:800;font-size:.8rem;cursor:pointer;transition:all .2s}.app-header[_ngcontent-%COMP%]   .header-disconnect-btn[_ngcontent-%COMP%]:hover{border-color:#ff3b30;color:#ff3b30}.icon-square[_ngcontent-%COMP%]{width:28px;height:28px;background-color:#a3ff12;border-radius:2px;display:flex;align-items:center;justify-content:center;transition:opacity .2s}.icon-square[_ngcontent-%COMP%]:hover{opacity:.8}.icon-square[_ngcontent-%COMP%]   .x-icon[_ngcontent-%COMP%]{width:16px;height:16px;fill:#000}.litepaper-btn[_ngcontent-%COMP%], .qlabs-btn[_ngcontent-%COMP%]{padding:.4rem .9rem;font-family:Neue Machina,sans-serif;font-weight:800;font-size:.8rem;text-decoration:none;border-radius:2px;display:flex;align-items:center;justify-content:center;min-width:100px;transition:all .2s;position:relative;border:none;cursor:pointer}.litepaper-btn[_ngcontent-%COMP%]{background-color:#000;color:#fff;border:1px solid #333}.litepaper-btn[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-1px;right:-1px;width:8px;height:8px;background-color:#a3ff12;clip-path:polygon(100% 0,0 0,100% 100%)}.litepaper-btn[_ngcontent-%COMP%]:hover{border-color:#a3ff12;color:#a3ff12}.qlabs-btn[_ngcontent-%COMP%]{background-color:#a3ff12;color:#000;clip-path:polygon(0 0,calc(100% - 8px) 0,100% 8px,100% 100%,0 100%)}.qlabs-btn[_ngcontent-%COMP%]:hover{opacity:.9}.main-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 60px);padding:1rem;color:#fff;position:relative;overflow:hidden}']})};_S(lE,hq).catch(n=>console.error(n));
